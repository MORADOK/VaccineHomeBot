<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üì± Phone Input Test - VCHome Registration</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      margin: 20px;
      background: #f8f9fa;
      line-height: 1.6;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .test-section {
      margin: 30px 0;
      padding: 20px;
      border: 1px solid #e1e5e9;
      border-radius: 10px;
      background: #f8f9fa;
    }
    .form-group {
      margin: 20px 0;
    }
    .label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 16px;
      color: #333;
    }
    .input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      font-size: 16px;
      font-family: 'Sarabun', sans-serif;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }
    .input:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }
    .input.error {
      border-color: #dc3545;
      background-color: #fff5f5;
    }
    .error {
      color: #dc3545;
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }
    .test-result {
      margin: 10px 0;
      padding: 15px;
      border-radius: 8px;
      font-weight: 500;
    }
    .pass { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .fail { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px;
      font-family: 'Sarabun', sans-serif;
      font-weight: 500;
    }
    button:hover { background: #0056b3; }
    .test-cases {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .test-case {
      padding: 15px;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      background: white;
    }
    .console-output {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üì± Phone Input Test Suite</h1>
    <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö VCHome Registration System</p>

    <!-- Live Phone Input Test -->
    <div class="test-section">
      <h3>üß™ Live Phone Input Test</h3>
      <div class="form-group">
        <label class="label" for="testPhone">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
        <input type="tel" id="testPhone" class="input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" maxlength="12">
        <div class="error" id="phoneError">‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</div>
      </div>
      
      <div id="phoneInfo" class="test-result info">
        <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong><br>
        Display Value: <span id="displayValue">-</span><br>
        Raw Value: <span id="rawValue">-</span><br>
        Validation: <span id="validationResult">-</span>
      </div>
    </div>

    <!-- Test Cases -->
    <div class="test-section">
      <h3>üìã Test Cases</h3>
      <button onclick="runAllTests()">üöÄ Run All Tests</button>
      <button onclick="clearResults()">üßπ Clear Results</button>
      
      <div class="test-cases" id="testCases">
        <!-- Test cases will be populated here -->
      </div>
    </div>

    <!-- Manual Test Cases -->
    <div class="test-section">
      <h3>‚úã Manual Test Cases</h3>
      <p>‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô:</p>
      <ul>
        <li><strong>0812345678</strong> - ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏Ñ‡∏ß‡∏£‡∏ú‡πà‡∏≤‡∏ô)</li>
        <li><strong>812345678</strong> - ‡πÑ‡∏°‡πà‡∏°‡∏µ 0 ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡∏° 0 ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</li>
        <li><strong>+66812345678</strong> - ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö +66 (‡∏Ñ‡∏ß‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô 08)</li>
        <li><strong>66812345678</strong> - ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 66 (‡∏Ñ‡∏ß‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô 08)</li>
        <li><strong>08-1234-5678</strong> - ‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ (‡∏Ñ‡∏ß‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡∏Å)</li>
        <li><strong>0712345678</strong> - ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏ô (‡∏Ñ‡∏ß‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô)</li>
        <li><strong>081234567</strong> - ‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏Ñ‡∏ß‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô)</li>
        <li><strong>08123456789</strong> - ‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏Ñ‡∏ß‡∏£‡∏ï‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 10 ‡∏´‡∏•‡∏±‡∏Å)</li>
      </ul>
    </div>

    <!-- Console Output -->
    <div class="test-section">
      <h3>üìã Console Output</h3>
      <div id="console" class="console-output">Console output will appear here...</div>
      <button onclick="clearConsole()">Clear Console</button>
    </div>
  </div>

  <!-- Include validation service -->
  <script src="./config.js"></script>
  <script src="./validation.js"></script>

  <script>
    // Console capture
    const consoleDiv = document.getElementById('console');
    const originalLog = console.log;
    const originalError = console.error;
    
    function logToConsole(type, ...args) {
      const timestamp = new Date().toLocaleTimeString();
      const message = args.map(arg => 
        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
      ).join(' ');
      consoleDiv.textContent += `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
      consoleDiv.scrollTop = consoleDiv.scrollHeight;
    }
    
    console.log = (...args) => {
      originalLog(...args);
      logToConsole('log', ...args);
    };
    
    console.error = (...args) => {
      originalError(...args);
      logToConsole('error', ...args);
    };

    // Initialize validation service
    let validationService;
    
    document.addEventListener('DOMContentLoaded', () => {
      try {
        validationService = new ValidationService();
        console.log('‚úÖ ValidationService initialized');
        setupPhoneInput();
        generateTestCases();
      } catch (error) {
        console.error('‚ùå Failed to initialize ValidationService:', error);
      }
    });

    function setupPhoneInput() {
      const elPhone = document.getElementById('testPhone');
      const phoneError = document.getElementById('phoneError');
      const displayValue = document.getElementById('displayValue');
      const rawValue = document.getElementById('rawValue');
      const validationResult = document.getElementById('validationResult');

      // Same logic as in main index.html
      elPhone.addEventListener('input', (e) => {
        // Clean input in real-time - ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        const cleaned = e.target.value.replace(/[^\d]/g, '');
        
        // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏´‡∏•‡∏±‡∏Å
        const limited = cleaned.substring(0, 10);
        
        if (limited !== e.target.value) {
          e.target.value = limited;
        }

        // Auto-format ‡πÄ‡∏õ‡πá‡∏ô xxx-xxx-xxxx ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå
        if (limited.length >= 3) {
          let formatted = limited;
          if (limited.length >= 6) {
            formatted = limited.substring(0, 3) + '-' + limited.substring(3, 6) + '-' + limited.substring(6);
          } else if (limited.length >= 3) {
            formatted = limited.substring(0, 3) + '-' + limited.substring(3);
          }
          
          // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó display value ‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö raw value ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô data attribute
          e.target.setAttribute('data-raw-value', limited);
          if (formatted !== e.target.value) {
            const cursorPos = e.target.selectionStart;
            e.target.value = formatted;
            // ‡∏Ñ‡∏∑‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á cursor
            const newPos = cursorPos + (formatted.length - limited.length);
            e.target.setSelectionRange(newPos, newPos);
          }
        }

        // Update info display
        displayValue.textContent = e.target.value;
        rawValue.textContent = limited;

        // Real-time validation feedback
        if (validationService && limited.length > 2) {
          const validation = validationService.validatePhoneNumber(limited);
          validationResult.textContent = validation.isValid ? '‚úÖ Valid' : '‚ùå ' + validation.errors[0];
          
          if (limited.length >= 9) { // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ 9 ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
            if (validation.isValid) {
              e.target.classList.remove('error');
              phoneError.style.display = 'none';
              phoneError.textContent = '';
            } else {
              e.target.classList.add('error');
              phoneError.textContent = validation.errors[0] || '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
              phoneError.style.display = 'block';
            }
          } else {
            // ‡∏¢‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á error
            e.target.classList.remove('error');
            phoneError.style.display = 'none';
          }
        } else {
          validationResult.textContent = 'Waiting for input...';
        }
      });

      elPhone.addEventListener('blur', (e) => {
        if (validationService) {
          const rawVal = e.target.getAttribute('data-raw-value') || e.target.value.replace(/[^\d]/g, '');
          const validation = validationService.validatePhoneNumber(rawVal);
          
          if (validation.isValid) {
            // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°
            const formatted = validation.sanitized.replace(/^(\d{3})(\d{3})(\d{4})$/, '$1-$2-$3');
            e.target.value = formatted;
            e.target.setAttribute('data-raw-value', validation.sanitized);
            e.target.classList.remove('error');
            phoneError.style.display = 'none';
            validationResult.textContent = '‚úÖ Valid: ' + validation.sanitized;
          } else if (rawVal.length > 0) {
            // ‡πÅ‡∏™‡∏î‡∏á error ‡πÄ‡∏°‡∏∑‡πà‡∏≠ blur ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            e.target.classList.add('error');
            phoneError.textContent = validation.errors[0] || '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
            phoneError.style.display = 'block';
            validationResult.textContent = '‚ùå Invalid: ' + validation.errors[0];
          }
        }
      });

      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠ focus ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
      elPhone.addEventListener('focus', (e) => {
        const rawVal = e.target.getAttribute('data-raw-value') || e.target.value.replace(/[^\d]/g, '');
        if (rawVal) {
          e.target.value = rawVal;
          displayValue.textContent = rawVal;
        }
      });
    }

    function generateTestCases() {
      const testCases = [
        { input: '0812345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥' },
        { input: '0912345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 09' },
        { input: '0612345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 06' },
        { input: '812345678', expected: true, description: '‡πÑ‡∏°‡πà‡∏°‡∏µ 0 ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤' },
        { input: '+66812345678', expected: true, description: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö +66' },
        { input: '66812345678', expected: true, description: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 66' },
        { input: '0712345678', expected: false, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏ô (07)' },
        { input: '081234567', expected: false, description: '‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ' },
        { input: '08123456789', expected: false, description: '‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ' },
        { input: '1234567890', expected: false, description: '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏ó‡∏¢' },
        { input: '', expected: false, description: '‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤' },
        { input: 'abc', expected: false, description: '‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£' }
      ];

      const container = document.getElementById('testCases');
      container.innerHTML = testCases.map((test, index) => `
        <div class="test-case" id="test-${index}">
          <strong>${test.description}</strong><br>
          Input: "${test.input}"<br>
          Expected: ${test.expected ? 'Valid' : 'Invalid'}<br>
          <div id="result-${index}" class="test-result info">Not tested</div>
        </div>
      `).join('');
    }

    function runAllTests() {
      console.log('üöÄ Running all phone validation tests...');
      
      const testCases = [
        { input: '0812345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥' },
        { input: '0912345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 09' },
        { input: '0612345678', expected: true, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 06' },
        { input: '812345678', expected: true, description: '‡πÑ‡∏°‡πà‡∏°‡∏µ 0 ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤' },
        { input: '+66812345678', expected: true, description: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö +66' },
        { input: '66812345678', expected: true, description: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 66' },
        { input: '0712345678', expected: false, description: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏ô (07)' },
        { input: '081234567', expected: false, description: '‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ' },
        { input: '08123456789', expected: false, description: '‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ' },
        { input: '1234567890', expected: false, description: '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏ó‡∏¢' },
        { input: '', expected: false, description: '‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤' },
        { input: 'abc', expected: false, description: '‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£' }
      ];

      let passed = 0;
      let failed = 0;

      testCases.forEach((test, index) => {
        const result = validationService.validatePhoneNumber(test.input);
        const success = result.isValid === test.expected;
        
        const resultDiv = document.getElementById(`result-${index}`);
        resultDiv.className = `test-result ${success ? 'pass' : 'fail'}`;
        resultDiv.innerHTML = `
          ${success ? '‚úÖ PASS' : '‚ùå FAIL'}<br>
          Result: ${result.isValid ? 'Valid' : 'Invalid'}<br>
          ${result.isValid ? 'Sanitized: ' + result.sanitized : 'Error: ' + result.errors[0]}
        `;

        if (success) {
          passed++;
        } else {
          failed++;
          console.error(`‚ùå Test failed: ${test.description} - Expected: ${test.expected}, Got: ${result.isValid}`);
        }
      });

      console.log(`‚úÖ Tests completed: ${passed} passed, ${failed} failed`);
    }

    function clearResults() {
      const testCases = document.querySelectorAll('[id^="result-"]');
      testCases.forEach(result => {
        result.className = 'test-result info';
        result.textContent = 'Not tested';
      });
      console.log('üßπ Test results cleared');
    }

    function clearConsole() {
      consoleDiv.textContent = 'Console cleared...\n';
    }
  </script>
</body>
</html>