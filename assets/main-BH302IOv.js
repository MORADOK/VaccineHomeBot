var rl=Object.defineProperty;var il=(t,s,a)=>s in t?rl(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var ta=(t,s,a)=>il(t,typeof s!="symbol"?s+"":s,a);import{c as ir,a as ol,u as Wa,j as e,B as ll,P as Ke,b as or,d as lr,e as Ve,f as Rs,V as cr,R as cl,g as dl,h as ml,i as ul,k as hl,o as xl,s as pl,l as fl,m as gl,n as vl,p as bl,q as jl,r as yl,S as Zt,O as zs,t as dr,C as Us,v as mr,T as Bs,D as Hs,w as ur,L as hr,x as xr,y as pr,z as Nl,A as fr,I as wl,E as gr,F as vr,G as _l,H as br,J as Sl,K as jr,M as yr,N as Cl,Q as kl,U as Nr,W as Dl,X as El,Y as Il,Z as Tl}from"./ui-vendor-BROl4RDT.js";import{a as za,r as m,R as q,b as Pl,c as wr,u as _r,N as vn,e as Rt,L as sa,H as Al,B as Rl,f as Ml,h as be}from"./react-vendor-BwSztqlq.js";import{c as Sr}from"./chart-vendor-pIViOuo6.js";import{X as Ct,T as Ye,R as pe,D as We,C as Et,a as Ie,b as lt,c as Te,S as Pe,H as Ll,W as $l,B as us,Z as va,d as ee,F as Ol,e as Ue,A as ft,f as Fl,g as $e,I as Wl,M as ot,h as Gt,U as ct,i as Ce,j as Be,k as Me,l as he,m as It,n as Cr,o as zl,p as kr,q as Ge,r as Ul,P as Dr,s as Ua,L as Er,t as Tt,Q as bn,E as Bl,u as Jt,G as Ir,v as Tr,w as Pr,x as Hl,y as Qe,z as Ar,J as ba,K as Ms,N as Rr,O as Mr,V as Vl,Y as Ls,_ as _s,$ as Yl,a0 as Lr,a1 as Gl,a2 as ja,a3 as ls,a4 as ql,a5 as Kl,a6 as Jl,a7 as Xl,a8 as Ql,a9 as aa,aa as jn,ab as Zl,ac as ec,ad as yn,ae as Ss,af as tc,ag as sc,ah as ac}from"./icons-vendor-DlTKgGlq.js";import{Q as nc,a as Nn}from"./query-vendor-DgHmE7TK.js";import{c as rc,A as ic}from"./supabase-vendor-BL3BVkN7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();var $r,wn=za;$r=wn.createRoot,wn.hydrateRoot;const oc=1,lc=1e6;let na=0;function cc(){return na=(na+1)%Number.MAX_SAFE_INTEGER,na.toString()}const ra=new Map,_n=t=>{if(ra.has(t))return;const s=setTimeout(()=>{ra.delete(t),cs({type:"REMOVE_TOAST",toastId:t})},lc);ra.set(t,s)},dc=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,oc)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?_n(a):t.toasts.forEach(n=>{_n(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},Ts=[];let Ps={toasts:[]};function cs(t){Ps=dc(Ps,t),Ts.forEach(s=>{s(Ps)})}function mc({...t}){const s=cc(),a=r=>cs({type:"UPDATE_TOAST",toast:{...r,id:s}}),n=()=>cs({type:"DISMISS_TOAST",toastId:s});return cs({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:r=>{r||n()}}}),{id:s,dismiss:n,update:a}}function xe(){const[t,s]=m.useState(Ps);return m.useEffect(()=>(Ts.push(s),()=>{const a=Ts.indexOf(s);a>-1&&Ts.splice(a,1)}),[t]),{...t,toast:mc,dismiss:a=>cs({type:"DISMISS_TOAST",toastId:a})}}var Ba="ToastProvider",[Ha,uc,hc]=ol("Toast"),[Or]=ir("Toast",[hc]),[xc,Vs]=Or(Ba),Fr=t=>{const{__scopeToast:s,label:a="Notification",duration:n=5e3,swipeDirection:r="right",swipeThreshold:i=50,children:o}=t,[c,d]=m.useState(null),[x,h]=m.useState(0),f=m.useRef(!1),l=m.useRef(!1);return a.trim()||console.error(`Invalid prop \`label\` supplied to \`${Ba}\`. Expected non-empty \`string\`.`),e.jsx(Ha.Provider,{scope:s,children:e.jsx(xc,{scope:s,label:a,duration:n,swipeDirection:r,swipeThreshold:i,toastCount:x,viewport:c,onViewportChange:d,onToastAdd:m.useCallback(()=>h(u=>u+1),[]),onToastRemove:m.useCallback(()=>h(u=>u-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:l,children:o})})};Fr.displayName=Ba;var Wr="ToastViewport",pc=["F8"],ya="toast.viewportPause",Na="toast.viewportResume",zr=m.forwardRef((t,s)=>{const{__scopeToast:a,hotkey:n=pc,label:r="Notifications ({hotkey})",...i}=t,o=Vs(Wr,a),c=uc(a),d=m.useRef(null),x=m.useRef(null),h=m.useRef(null),f=m.useRef(null),l=Wa(s,f,o.onViewportChange),u=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;m.useEffect(()=>{const g=p=>{var N;n.length!==0&&n.every(_=>p[_]||p.code===_)&&((N=f.current)==null||N.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n]),m.useEffect(()=>{const g=d.current,p=f.current;if(v&&g&&p){const y=()=>{if(!o.isClosePausedRef.current){const T=new CustomEvent(ya);p.dispatchEvent(T),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const T=new CustomEvent(Na);p.dispatchEvent(T),o.isClosePausedRef.current=!1}},_=T=>{!g.contains(T.relatedTarget)&&N()},D=()=>{g.contains(document.activeElement)||N()};return g.addEventListener("focusin",y),g.addEventListener("focusout",_),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",D),window.addEventListener("blur",y),window.addEventListener("focus",N),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",_),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",D),window.removeEventListener("blur",y),window.removeEventListener("focus",N)}}},[v,o.isClosePausedRef]);const b=m.useCallback(({tabbingDirection:g})=>{const y=c().map(N=>{const _=N.ref.current,D=[_,...Dc(_)];return g==="forwards"?D:D.reverse()});return(g==="forwards"?y.reverse():y).flat()},[c]);return m.useEffect(()=>{const g=f.current;if(g){const p=y=>{var D,T,O;const N=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!N){const k=document.activeElement,B=y.shiftKey;if(y.target===g&&B){(D=x.current)==null||D.focus();return}const w=b({tabbingDirection:B?"backwards":"forwards"}),M=w.findIndex(F=>F===k);ia(w.slice(M+1))?y.preventDefault():B?(T=x.current)==null||T.focus():(O=h.current)==null||O.focus()}};return g.addEventListener("keydown",p),()=>g.removeEventListener("keydown",p)}},[c,b]),e.jsxs(ll,{ref:d,role:"region","aria-label":r.replace("{hotkey}",u),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&e.jsx(wa,{ref:x,onFocusFromOutsideViewport:()=>{const g=b({tabbingDirection:"forwards"});ia(g)}}),e.jsx(Ha.Slot,{scope:a,children:e.jsx(Ke.ol,{tabIndex:-1,...i,ref:l})}),v&&e.jsx(wa,{ref:h,onFocusFromOutsideViewport:()=>{const g=b({tabbingDirection:"backwards"});ia(g)}})]})});zr.displayName=Wr;var Ur="ToastFocusProxy",wa=m.forwardRef((t,s)=>{const{__scopeToast:a,onFocusFromOutsideViewport:n,...r}=t,i=Vs(Ur,a);return e.jsx(cr,{"aria-hidden":!0,tabIndex:0,...r,ref:s,style:{position:"fixed"},onFocus:o=>{var x;const c=o.relatedTarget;!((x=i.viewport)!=null&&x.contains(c))&&n()}})});wa.displayName=Ur;var Ys="Toast",fc="toast.swipeStart",gc="toast.swipeMove",vc="toast.swipeCancel",bc="toast.swipeEnd",Br=m.forwardRef((t,s)=>{const{forceMount:a,open:n,defaultOpen:r,onOpenChange:i,...o}=t,[c=!0,d]=or({prop:n,defaultProp:r,onChange:i});return e.jsx(lr,{present:a||c,children:e.jsx(Nc,{open:c,...o,ref:s,onClose:()=>d(!1),onPause:Rs(t.onPause),onResume:Rs(t.onResume),onSwipeStart:Ve(t.onSwipeStart,x=>{x.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ve(t.onSwipeMove,x=>{const{x:h,y:f}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","move"),x.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Ve(t.onSwipeCancel,x=>{x.currentTarget.setAttribute("data-swipe","cancel"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ve(t.onSwipeEnd,x=>{const{x:h,y:f}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","end"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});Br.displayName=Ys;var[jc,yc]=Or(Ys,{onClose(){}}),Nc=m.forwardRef((t,s)=>{const{__scopeToast:a,type:n="foreground",duration:r,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:x,onSwipeStart:h,onSwipeMove:f,onSwipeCancel:l,onSwipeEnd:u,...v}=t,b=Vs(Ys,a),[g,p]=m.useState(null),y=Wa(s,F=>p(F)),N=m.useRef(null),_=m.useRef(null),D=r||b.duration,T=m.useRef(0),O=m.useRef(D),k=m.useRef(0),{onToastAdd:B,onToastRemove:C}=b,j=Rs(()=>{var U;(g==null?void 0:g.contains(document.activeElement))&&((U=b.viewport)==null||U.focus()),o()}),w=m.useCallback(F=>{!F||F===1/0||(window.clearTimeout(k.current),T.current=new Date().getTime(),k.current=window.setTimeout(j,F))},[j]);m.useEffect(()=>{const F=b.viewport;if(F){const U=()=>{w(O.current),x==null||x()},H=()=>{const P=new Date().getTime()-T.current;O.current=O.current-P,window.clearTimeout(k.current),d==null||d()};return F.addEventListener(ya,H),F.addEventListener(Na,U),()=>{F.removeEventListener(ya,H),F.removeEventListener(Na,U)}}},[b.viewport,D,d,x,w]),m.useEffect(()=>{i&&!b.isClosePausedRef.current&&w(D)},[i,D,b.isClosePausedRef,w]),m.useEffect(()=>(B(),()=>C()),[B,C]);const M=m.useMemo(()=>g?Jr(g):null,[g]);return b.viewport?e.jsxs(e.Fragment,{children:[M&&e.jsx(wc,{__scopeToast:a,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),e.jsx(jc,{scope:a,onClose:j,children:za.createPortal(e.jsx(Ha.ItemSlot,{scope:a,children:e.jsx(cl,{asChild:!0,onEscapeKeyDown:Ve(c,()=>{b.isFocusedToastEscapeKeyDownRef.current||j(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(Ke.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":b.swipeDirection,...v,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Ve(t.onKeyDown,F=>{F.key==="Escape"&&(c==null||c(F.nativeEvent),F.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:Ve(t.onPointerDown,F=>{F.button===0&&(N.current={x:F.clientX,y:F.clientY})}),onPointerMove:Ve(t.onPointerMove,F=>{if(!N.current)return;const U=F.clientX-N.current.x,H=F.clientY-N.current.y,P=!!_.current,L=["left","right"].includes(b.swipeDirection),Y=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,X=L?Y(0,U):0,S=L?0:Y(0,H),E=F.pointerType==="touch"?10:2,G={x:X,y:S},K={originalEvent:F,delta:G};P?(_.current=G,Cs(gc,f,K,{discrete:!1})):Sn(G,b.swipeDirection,E)?(_.current=G,Cs(fc,h,K,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(U)>E||Math.abs(H)>E)&&(N.current=null)}),onPointerUp:Ve(t.onPointerUp,F=>{const U=_.current,H=F.target;if(H.hasPointerCapture(F.pointerId)&&H.releasePointerCapture(F.pointerId),_.current=null,N.current=null,U){const P=F.currentTarget,L={originalEvent:F,delta:U};Sn(U,b.swipeDirection,b.swipeThreshold)?Cs(bc,u,L,{discrete:!0}):Cs(vc,l,L,{discrete:!0}),P.addEventListener("click",Y=>Y.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),wc=t=>{const{__scopeToast:s,children:a,...n}=t,r=Vs(Ys,s),[i,o]=m.useState(!1),[c,d]=m.useState(!1);return Cc(()=>o(!0)),m.useEffect(()=>{const x=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(x)},[]),c?null:e.jsx(dl,{asChild:!0,children:e.jsx(cr,{...n,children:i&&e.jsxs(e.Fragment,{children:[r.label," ",a]})})})},_c="ToastTitle",Hr=m.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t;return e.jsx(Ke.div,{...n,ref:s})});Hr.displayName=_c;var Sc="ToastDescription",Vr=m.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t;return e.jsx(Ke.div,{...n,ref:s})});Vr.displayName=Sc;var Yr="ToastAction",Gr=m.forwardRef((t,s)=>{const{altText:a,...n}=t;return a.trim()?e.jsx(Kr,{altText:a,asChild:!0,children:e.jsx(Va,{...n,ref:s})}):(console.error(`Invalid prop \`altText\` supplied to \`${Yr}\`. Expected non-empty \`string\`.`),null)});Gr.displayName=Yr;var qr="ToastClose",Va=m.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t,r=yc(qr,a);return e.jsx(Kr,{asChild:!0,children:e.jsx(Ke.button,{type:"button",...n,ref:s,onClick:Ve(t.onClick,r.onClose)})})});Va.displayName=qr;var Kr=m.forwardRef((t,s)=>{const{__scopeToast:a,altText:n,...r}=t;return e.jsx(Ke.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...r,ref:s})});function Jr(t){const s=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&s.push(n.textContent),kc(n)){const r=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!r)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&s.push(o)}else s.push(...Jr(n))}}),s}function Cs(t,s,a,{discrete:n}){const r=a.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:a});s&&r.addEventListener(t,s,{once:!0}),n?ul(r,i):r.dispatchEvent(i)}var Sn=(t,s,a=0)=>{const n=Math.abs(t.x),r=Math.abs(t.y),i=n>r;return s==="left"||s==="right"?i&&n>a:!i&&r>a};function Cc(t=()=>{}){const s=Rs(t);ml(()=>{let a=0,n=0;return a=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(s)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(n)}},[s])}function kc(t){return t.nodeType===t.ELEMENT_NODE}function Dc(t){const s=[],a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)s.push(a.currentNode);return s}function ia(t){const s=document.activeElement;return t.some(a=>a===s?!0:(a.focus(),document.activeElement!==s))}var Ec=Fr,Xr=zr,Qr=Br,Zr=Hr,ei=Vr,ti=Gr,si=Va;const Cn=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,kn=Sr,Mt=(t,s)=>a=>{var n;if((s==null?void 0:s.variants)==null)return kn(t,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:r,defaultVariants:i}=s,o=Object.keys(r).map(x=>{const h=a==null?void 0:a[x],f=i==null?void 0:i[x];if(h===null)return null;const l=Cn(h)||Cn(f);return r[x][l]}),c=a&&Object.entries(a).reduce((x,h)=>{let[f,l]=h;return l===void 0||(x[f]=l),x},{}),d=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((x,h)=>{let{class:f,className:l,...u}=h;return Object.entries(u).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...i,...c}[b]):{...i,...c}[b]===g})?[...x,f,l]:x},[]);return kn(t,o,d,a==null?void 0:a.class,a==null?void 0:a.className)},Ya="-",Ic=t=>{const s=Pc(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const c=o.split(Ya);return c[0]===""&&c.length!==1&&c.shift(),ai(c,s)||Tc(o)},getConflictingClassGroupIds:(o,c)=>{const d=a[o]||[];return c&&n[o]?[...d,...n[o]]:d}}},ai=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const a=t[0],n=s.nextPart.get(a),r=n?ai(t.slice(1),n):void 0;if(r)return r;if(s.validators.length===0)return;const i=t.join(Ya);return(o=s.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},Dn=/^\[(.+)\]$/,Tc=t=>{if(Dn.test(t)){const s=Dn.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},Pc=t=>{const{theme:s,prefix:a}=t,n={nextPart:new Map,validators:[]};return Rc(Object.entries(t.classGroups),a).forEach(([i,o])=>{_a(o,n,i,s)}),n},_a=(t,s,a,n)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?s:En(s,r);i.classGroupId=a;return}if(typeof r=="function"){if(Ac(r)){_a(r(n),s,a,n);return}s.validators.push({validator:r,classGroupId:a});return}Object.entries(r).forEach(([i,o])=>{_a(o,En(s,i),a,n)})})},En=(t,s)=>{let a=t;return s.split(Ya).forEach(n=>{a.nextPart.has(n)||a.nextPart.set(n,{nextPart:new Map,validators:[]}),a=a.nextPart.get(n)}),a},Ac=t=>t.isThemeGetter,Rc=(t,s)=>s?t.map(([a,n])=>{const r=n.map(i=>typeof i=="string"?s+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[s+o,c])):i);return[a,r]}):t,Mc=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,n=new Map;const r=(i,o)=>{a.set(i,o),s++,s>t&&(s=0,n=a,a=new Map)};return{get(i){let o=a.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return r(i,o),o},set(i,o){a.has(i)?a.set(i,o):r(i,o)}}},ni="!",Lc=t=>{const{separator:s,experimentalParseClassName:a}=t,n=s.length===1,r=s[0],i=s.length,o=c=>{const d=[];let x=0,h=0,f;for(let g=0;g<c.length;g++){let p=c[g];if(x===0){if(p===r&&(n||c.slice(g,g+i)===s)){d.push(c.slice(h,g)),h=g+i;continue}if(p==="/"){f=g;continue}}p==="["?x++:p==="]"&&x--}const l=d.length===0?c:c.substring(h),u=l.startsWith(ni),v=u?l.substring(1):l,b=f&&f>h?f-h:void 0;return{modifiers:d,hasImportantModifier:u,baseClassName:v,maybePostfixModifierPosition:b}};return a?c=>a({className:c,parseClassName:o}):o},$c=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(n=>{n[0]==="["?(s.push(...a.sort(),n),a=[]):a.push(n)}),s.push(...a.sort()),s},Oc=t=>({cache:Mc(t.cacheSize),parseClassName:Lc(t),...Ic(t)}),Fc=/\s+/,Wc=(t,s)=>{const{parseClassName:a,getClassGroupId:n,getConflictingClassGroupIds:r}=s,i=[],o=t.trim().split(Fc);let c="";for(let d=o.length-1;d>=0;d-=1){const x=o[d],{modifiers:h,hasImportantModifier:f,baseClassName:l,maybePostfixModifierPosition:u}=a(x);let v=!!u,b=n(v?l.substring(0,u):l);if(!b){if(!v){c=x+(c.length>0?" "+c:c);continue}if(b=n(l),!b){c=x+(c.length>0?" "+c:c);continue}v=!1}const g=$c(h).join(":"),p=f?g+ni:g,y=p+b;if(i.includes(y))continue;i.push(y);const N=r(b,v);for(let _=0;_<N.length;++_){const D=N[_];i.push(p+D)}c=x+(c.length>0?" "+c:c)}return c};function zc(){let t=0,s,a,n="";for(;t<arguments.length;)(s=arguments[t++])&&(a=ri(s))&&(n&&(n+=" "),n+=a);return n}const ri=t=>{if(typeof t=="string")return t;let s,a="";for(let n=0;n<t.length;n++)t[n]&&(s=ri(t[n]))&&(a&&(a+=" "),a+=s);return a};function Uc(t,...s){let a,n,r,i=o;function o(d){const x=s.reduce((h,f)=>f(h),t());return a=Oc(x),n=a.cache.get,r=a.cache.set,i=c,c(d)}function c(d){const x=n(d);if(x)return x;const h=Wc(d,a);return r(d,h),h}return function(){return i(zc.apply(null,arguments))}}const we=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},ii=/^\[(?:([a-z-]+):)?(.+)\]$/i,Bc=/^\d+\/\d+$/,Hc=new Set(["px","full","screen"]),Vc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Gc=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,qc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Kc=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ht=t=>qt(t)||Hc.has(t)||Bc.test(t),jt=t=>es(t,"length",ad),qt=t=>!!t&&!Number.isNaN(Number(t)),oa=t=>es(t,"number",qt),rs=t=>!!t&&Number.isInteger(Number(t)),Jc=t=>t.endsWith("%")&&qt(t.slice(0,-1)),oe=t=>ii.test(t),yt=t=>Vc.test(t),Xc=new Set(["length","size","percentage"]),Qc=t=>es(t,Xc,oi),Zc=t=>es(t,"position",oi),ed=new Set(["image","url"]),td=t=>es(t,ed,rd),sd=t=>es(t,"",nd),is=()=>!0,es=(t,s,a)=>{const n=ii.exec(t);return n?n[1]?typeof s=="string"?n[1]===s:s.has(n[1]):a(n[2]):!1},ad=t=>Yc.test(t)&&!Gc.test(t),oi=()=>!1,nd=t=>qc.test(t),rd=t=>Kc.test(t),id=()=>{const t=we("colors"),s=we("spacing"),a=we("blur"),n=we("brightness"),r=we("borderColor"),i=we("borderRadius"),o=we("borderSpacing"),c=we("borderWidth"),d=we("contrast"),x=we("grayscale"),h=we("hueRotate"),f=we("invert"),l=we("gap"),u=we("gradientColorStops"),v=we("gradientColorStopPositions"),b=we("inset"),g=we("margin"),p=we("opacity"),y=we("padding"),N=we("saturate"),_=we("scale"),D=we("sepia"),T=we("skew"),O=we("space"),k=we("translate"),B=()=>["auto","contain","none"],C=()=>["auto","hidden","clip","visible","scroll"],j=()=>["auto",oe,s],w=()=>[oe,s],M=()=>["",ht,jt],F=()=>["auto",qt,oe],U=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],P=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],Y=()=>["","0",oe],X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],S=()=>[qt,oe];return{cacheSize:500,separator:":",theme:{colors:[is],spacing:[ht,jt],blur:["none","",yt,oe],brightness:S(),borderColor:[t],borderRadius:["none","","full",yt,oe],borderSpacing:w(),borderWidth:M(),contrast:S(),grayscale:Y(),hueRotate:S(),invert:Y(),gap:w(),gradientColorStops:[t],gradientColorStopPositions:[Jc,jt],inset:j(),margin:j(),opacity:S(),padding:w(),saturate:S(),scale:S(),sepia:Y(),skew:S(),space:w(),translate:w()},classGroups:{aspect:[{aspect:["auto","square","video",oe]}],container:["container"],columns:[{columns:[yt]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...U(),oe]}],overflow:[{overflow:C()}],"overflow-x":[{"overflow-x":C()}],"overflow-y":[{"overflow-y":C()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",rs,oe]}],basis:[{basis:j()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",oe]}],grow:[{grow:Y()}],shrink:[{shrink:Y()}],order:[{order:["first","last","none",rs,oe]}],"grid-cols":[{"grid-cols":[is]}],"col-start-end":[{col:["auto",{span:["full",rs,oe]},oe]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[is]}],"row-start-end":[{row:["auto",{span:[rs,oe]},oe]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",oe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",oe]}],gap:[{gap:[l]}],"gap-x":[{"gap-x":[l]}],"gap-y":[{"gap-y":[l]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[O]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[O]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",oe,s]}],"min-w":[{"min-w":[oe,s,"min","max","fit"]}],"max-w":[{"max-w":[oe,s,"none","full","min","max","fit","prose",{screen:[yt]},yt]}],h:[{h:[oe,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[oe,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[oe,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[oe,s,"auto","min","max","fit"]}],"font-size":[{text:["base",yt,jt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",oa]}],"font-family":[{font:[is]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",oe]}],"line-clamp":[{"line-clamp":["none",qt,oa]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ht,oe]}],"list-image":[{"list-image":["none",oe]}],"list-style-type":[{list:["none","disc","decimal",oe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ht,jt]}],"underline-offset":[{"underline-offset":["auto",ht,oe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",oe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",oe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...U(),Zc]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Qc]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},td]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[u]}],"gradient-via":[{via:[u]}],"gradient-to":[{to:[u]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:H()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[ht,oe]}],"outline-w":[{outline:[ht,jt]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[ht,jt]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",yt,sd]}],"shadow-color":[{shadow:[is]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...P(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":P()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",yt,oe]}],grayscale:[{grayscale:[x]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[x]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",oe]}],duration:[{duration:S()}],ease:[{ease:["linear","in","out","in-out",oe]}],delay:[{delay:S()}],animate:[{animate:["none","spin","ping","pulse","bounce",oe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[rs,oe]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",oe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",oe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",oe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ht,jt,oa]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},od=Uc(id);function V(...t){return od(Sr(t))}const ld=Ec,li=m.forwardRef(({className:t,...s},a)=>e.jsx(Xr,{ref:a,className:V("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));li.displayName=Xr.displayName;const cd=Mt("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ci=m.forwardRef(({className:t,variant:s,...a},n)=>e.jsx(Qr,{ref:n,className:V(cd({variant:s}),t),...a}));ci.displayName=Qr.displayName;const dd=m.forwardRef(({className:t,...s},a)=>e.jsx(ti,{ref:a,className:V("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));dd.displayName=ti.displayName;const di=m.forwardRef(({className:t,...s},a)=>e.jsx(si,{ref:a,className:V("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(Ct,{className:"h-4 w-4"})}));di.displayName=si.displayName;const mi=m.forwardRef(({className:t,...s},a)=>e.jsx(Zr,{ref:a,className:V("text-sm font-semibold",t),...s}));mi.displayName=Zr.displayName;const ui=m.forwardRef(({className:t,...s},a)=>e.jsx(ei,{ref:a,className:V("text-sm opacity-90",t),...s}));ui.displayName=ei.displayName;function In(){const{toasts:t}=xe();return e.jsxs(ld,{children:[t.map(function({id:s,title:a,description:n,action:r,...i}){return e.jsxs(ci,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(mi,{children:a}),n&&e.jsx(ui,{children:n})]}),r,e.jsx(di,{})]},s)}),e.jsx(li,{})]})}var Tn=["light","dark"],md="(prefers-color-scheme: dark)",ud=m.createContext(void 0),hd={setTheme:t=>{},themes:[]},xd=()=>{var t;return(t=m.useContext(ud))!=null?t:hd};m.memo(({forcedTheme:t,storageKey:s,attribute:a,enableSystem:n,enableColorScheme:r,defaultTheme:i,value:o,attrs:c,nonce:d})=>{let x=i==="system",h=a==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${a}',s='setAttribute';`,f=r?Tn.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",l=(v,b=!1,g=!0)=>{let p=o?o[v]:v,y=b?v+"|| ''":`'${p}'`,N="";return r&&g&&!b&&Tn.includes(v)&&(N+=`d.style.colorScheme = '${v}';`),a==="class"?b||p?N+=`c.add(${y})`:N+="null":p&&(N+=`d[s](n,${y})`),N},u=t?`!function(){${h}${l(t)}}()`:n?`!function(){try{${h}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${x})){var t='${md}',m=window.matchMedia(t);if(m.media!==t||m.matches){${l("dark")}}else{${l("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${l(o?"x[e]":"e",!0)}}${x?"":"else{"+l(i,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${h}var e=localStorage.getItem('${s}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${l(o?"x[e]":"e",!0)}}else{${l(i,!1,!1)};}${f}}catch(t){}}();`;return m.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:u}})});var pd=t=>{switch(t){case"success":return vd;case"info":return jd;case"warning":return bd;case"error":return yd;default:return null}},fd=Array(12).fill(0),gd=({visible:t})=>q.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},q.createElement("div",{className:"sonner-spinner"},fd.map((s,a)=>q.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),vd=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),bd=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),jd=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),yd=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Nd=()=>{let[t,s]=q.useState(document.hidden);return q.useEffect(()=>{let a=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",a),()=>window.removeEventListener("visibilitychange",a)},[]),t},Sa=1,wd=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let s=this.subscribers.indexOf(t);this.subscribers.splice(s,1)}),this.publish=t=>{this.subscribers.forEach(s=>s(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var s;let{message:a,...n}=t,r=typeof(t==null?void 0:t.id)=="number"||((s=t.id)==null?void 0:s.length)>0?t.id:Sa++,i=this.toasts.find(c=>c.id===r),o=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(c=>c.id===r?(this.publish({...c,...t,id:r,title:a}),{...c,...t,id:r,dismissible:o,title:a}):c):this.addToast({title:a,...n,dismissible:o,id:r}),r},this.dismiss=t=>(t||this.toasts.forEach(s=>{this.subscribers.forEach(a=>a({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:t,dismiss:!0})),t),this.message=(t,s)=>this.create({...s,message:t}),this.error=(t,s)=>this.create({...s,message:t,type:"error"}),this.success=(t,s)=>this.create({...s,type:"success",message:t}),this.info=(t,s)=>this.create({...s,type:"info",message:t}),this.warning=(t,s)=>this.create({...s,type:"warning",message:t}),this.loading=(t,s)=>this.create({...s,type:"loading",message:t}),this.promise=(t,s)=>{if(!s)return;let a;s.loading!==void 0&&(a=this.create({...s,promise:t,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));let n=t instanceof Promise?t:t(),r=a!==void 0;return n.then(async i=>{if(Sd(i)&&!i.ok){r=!1;let o=typeof s.error=="function"?await s.error(`HTTP error! status: ${i.status}`):s.error,c=typeof s.description=="function"?await s.description(`HTTP error! status: ${i.status}`):s.description;this.create({id:a,type:"error",message:o,description:c})}else if(s.success!==void 0){r=!1;let o=typeof s.success=="function"?await s.success(i):s.success,c=typeof s.description=="function"?await s.description(i):s.description;this.create({id:a,type:"success",message:o,description:c})}}).catch(async i=>{if(s.error!==void 0){r=!1;let o=typeof s.error=="function"?await s.error(i):s.error,c=typeof s.description=="function"?await s.description(i):s.description;this.create({id:a,type:"error",message:o,description:c})}}).finally(()=>{var i;r&&(this.dismiss(a),a=void 0),(i=s.finally)==null||i.call(s)}),a},this.custom=(t,s)=>{let a=(s==null?void 0:s.id)||Sa++;return this.create({jsx:t(a),id:a,...s}),a},this.subscribers=[],this.toasts=[]}},ze=new wd,_d=(t,s)=>{let a=(s==null?void 0:s.id)||Sa++;return ze.addToast({title:t,...s,id:a}),a},Sd=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Cd=_d,kd=()=>ze.toasts;Object.assign(Cd,{success:ze.success,info:ze.info,warning:ze.warning,error:ze.error,custom:ze.custom,message:ze.message,promise:ze.promise,dismiss:ze.dismiss,loading:ze.loading},{getHistory:kd});function Dd(t,{insertAt:s}={}){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}Dd(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ks(t){return t.label!==void 0}var Ed=3,Id="32px",Td=4e3,Pd=356,Ad=14,Rd=20,Md=200;function Ld(...t){return t.filter(Boolean).join(" ")}var $d=t=>{var s,a,n,r,i,o,c,d,x,h;let{invert:f,toast:l,unstyled:u,interacting:v,setHeights:b,visibleToasts:g,heights:p,index:y,toasts:N,expanded:_,removeToast:D,defaultRichColors:T,closeButton:O,style:k,cancelButtonStyle:B,actionButtonStyle:C,className:j="",descriptionClassName:w="",duration:M,position:F,gap:U,loadingIcon:H,expandByDefault:P,classNames:L,icons:Y,closeButtonAriaLabel:X="Close toast",pauseWhenPageIsHidden:S,cn:E}=t,[G,K]=q.useState(!1),[re,Z]=q.useState(!1),[ge,ve]=q.useState(!1),[de,ke]=q.useState(!1),[Ft,kt]=q.useState(0),[_e,tt]=q.useState(0),st=q.useRef(null),Le=q.useRef(null),ut=y===0,ns=y+1<=g,De=l.type,Wt=l.dismissible!==!1,Qo=l.className||"",Zo=l.descriptionClassName||"",Ns=q.useMemo(()=>p.findIndex(ie=>ie.toastId===l.id)||0,[p,l.id]),el=q.useMemo(()=>{var ie;return(ie=l.closeButton)!=null?ie:O},[l.closeButton,O]),hn=q.useMemo(()=>l.duration||M||Td,[l.duration,M]),Zs=q.useRef(0),zt=q.useRef(0),xn=q.useRef(0),Ut=q.useRef(null),[pn,tl]=F.split("-"),fn=q.useMemo(()=>p.reduce((ie,Ne,je)=>je>=Ns?ie:ie+Ne.height,0),[p,Ns]),gn=Nd(),sl=l.invert||f,ea=De==="loading";zt.current=q.useMemo(()=>Ns*U+fn,[Ns,fn]),q.useEffect(()=>{K(!0)},[]),q.useLayoutEffect(()=>{if(!G)return;let ie=Le.current,Ne=ie.style.height;ie.style.height="auto";let je=ie.getBoundingClientRect().height;ie.style.height=Ne,tt(je),b(at=>at.find(nt=>nt.toastId===l.id)?at.map(nt=>nt.toastId===l.id?{...nt,height:je}:nt):[{toastId:l.id,height:je,position:l.position},...at])},[G,l.title,l.description,b,l.id]);let bt=q.useCallback(()=>{Z(!0),kt(zt.current),b(ie=>ie.filter(Ne=>Ne.toastId!==l.id)),setTimeout(()=>{D(l)},Md)},[l,D,b,zt]);q.useEffect(()=>{if(l.promise&&De==="loading"||l.duration===1/0||l.type==="loading")return;let ie,Ne=hn;return _||v||S&&gn?(()=>{if(xn.current<Zs.current){let je=new Date().getTime()-Zs.current;Ne=Ne-je}xn.current=new Date().getTime()})():Ne!==1/0&&(Zs.current=new Date().getTime(),ie=setTimeout(()=>{var je;(je=l.onAutoClose)==null||je.call(l,l),bt()},Ne)),()=>clearTimeout(ie)},[_,v,P,l,hn,bt,l.promise,De,S,gn]),q.useEffect(()=>{let ie=Le.current;if(ie){let Ne=ie.getBoundingClientRect().height;return tt(Ne),b(je=>[{toastId:l.id,height:Ne,position:l.position},...je]),()=>b(je=>je.filter(at=>at.toastId!==l.id))}},[b,l.id]),q.useEffect(()=>{l.delete&&bt()},[bt,l.delete]);function al(){return Y!=null&&Y.loading?q.createElement("div",{className:"sonner-loader","data-visible":De==="loading"},Y.loading):H?q.createElement("div",{className:"sonner-loader","data-visible":De==="loading"},H):q.createElement(gd,{visible:De==="loading"})}return q.createElement("li",{"aria-live":l.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Le,className:E(j,Qo,L==null?void 0:L.toast,(s=l==null?void 0:l.classNames)==null?void 0:s.toast,L==null?void 0:L.default,L==null?void 0:L[De],(a=l==null?void 0:l.classNames)==null?void 0:a[De]),"data-sonner-toast":"","data-rich-colors":(n=l.richColors)!=null?n:T,"data-styled":!(l.jsx||l.unstyled||u),"data-mounted":G,"data-promise":!!l.promise,"data-removed":re,"data-visible":ns,"data-y-position":pn,"data-x-position":tl,"data-index":y,"data-front":ut,"data-swiping":ge,"data-dismissible":Wt,"data-type":De,"data-invert":sl,"data-swipe-out":de,"data-expanded":!!(_||P&&G),style:{"--index":y,"--toasts-before":y,"--z-index":N.length-y,"--offset":`${re?Ft:zt.current}px`,"--initial-height":P?"auto":`${_e}px`,...k,...l.style},onPointerDown:ie=>{ea||!Wt||(st.current=new Date,kt(zt.current),ie.target.setPointerCapture(ie.pointerId),ie.target.tagName!=="BUTTON"&&(ve(!0),Ut.current={x:ie.clientX,y:ie.clientY}))},onPointerUp:()=>{var ie,Ne,je,at;if(de||!Wt)return;Ut.current=null;let nt=Number(((ie=Le.current)==null?void 0:ie.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ws=new Date().getTime()-((Ne=st.current)==null?void 0:Ne.getTime()),nl=Math.abs(nt)/ws;if(Math.abs(nt)>=Rd||nl>.11){kt(zt.current),(je=l.onDismiss)==null||je.call(l,l),bt(),ke(!0);return}(at=Le.current)==null||at.style.setProperty("--swipe-amount","0px"),ve(!1)},onPointerMove:ie=>{var Ne;if(!Ut.current||!Wt)return;let je=ie.clientY-Ut.current.y,at=ie.clientX-Ut.current.x,nt=(pn==="top"?Math.min:Math.max)(0,je),ws=ie.pointerType==="touch"?10:2;Math.abs(nt)>ws?(Ne=Le.current)==null||Ne.style.setProperty("--swipe-amount",`${je}px`):Math.abs(at)>ws&&(Ut.current=null)}},el&&!l.jsx?q.createElement("button",{"aria-label":X,"data-disabled":ea,"data-close-button":!0,onClick:ea||!Wt?()=>{}:()=>{var ie;bt(),(ie=l.onDismiss)==null||ie.call(l,l)},className:E(L==null?void 0:L.closeButton,(r=l==null?void 0:l.classNames)==null?void 0:r.closeButton)},q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},q.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),q.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,l.jsx||q.isValidElement(l.title)?l.jsx||l.title:q.createElement(q.Fragment,null,De||l.icon||l.promise?q.createElement("div",{"data-icon":"",className:E(L==null?void 0:L.icon,(i=l==null?void 0:l.classNames)==null?void 0:i.icon)},l.promise||l.type==="loading"&&!l.icon?l.icon||al():null,l.type!=="loading"?l.icon||(Y==null?void 0:Y[De])||pd(De):null):null,q.createElement("div",{"data-content":"",className:E(L==null?void 0:L.content,(o=l==null?void 0:l.classNames)==null?void 0:o.content)},q.createElement("div",{"data-title":"",className:E(L==null?void 0:L.title,(c=l==null?void 0:l.classNames)==null?void 0:c.title)},l.title),l.description?q.createElement("div",{"data-description":"",className:E(w,Zo,L==null?void 0:L.description,(d=l==null?void 0:l.classNames)==null?void 0:d.description)},l.description):null),q.isValidElement(l.cancel)?l.cancel:l.cancel&&ks(l.cancel)?q.createElement("button",{"data-button":!0,"data-cancel":!0,style:l.cancelButtonStyle||B,onClick:ie=>{var Ne,je;ks(l.cancel)&&Wt&&((je=(Ne=l.cancel).onClick)==null||je.call(Ne,ie),bt())},className:E(L==null?void 0:L.cancelButton,(x=l==null?void 0:l.classNames)==null?void 0:x.cancelButton)},l.cancel.label):null,q.isValidElement(l.action)?l.action:l.action&&ks(l.action)?q.createElement("button",{"data-button":!0,"data-action":!0,style:l.actionButtonStyle||C,onClick:ie=>{var Ne,je;ks(l.action)&&(ie.defaultPrevented||((je=(Ne=l.action).onClick)==null||je.call(Ne,ie),bt()))},className:E(L==null?void 0:L.actionButton,(h=l==null?void 0:l.classNames)==null?void 0:h.actionButton)},l.action.label):null))};function Pn(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var Od=t=>{let{invert:s,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:r,closeButton:i,className:o,offset:c,theme:d="light",richColors:x,duration:h,style:f,visibleToasts:l=Ed,toastOptions:u,dir:v=Pn(),gap:b=Ad,loadingIcon:g,icons:p,containerAriaLabel:y="Notifications",pauseWhenPageIsHidden:N,cn:_=Ld}=t,[D,T]=q.useState([]),O=q.useMemo(()=>Array.from(new Set([a].concat(D.filter(S=>S.position).map(S=>S.position)))),[D,a]),[k,B]=q.useState([]),[C,j]=q.useState(!1),[w,M]=q.useState(!1),[F,U]=q.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),H=q.useRef(null),P=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=q.useRef(null),Y=q.useRef(!1),X=q.useCallback(S=>{var E;(E=D.find(G=>G.id===S.id))!=null&&E.delete||ze.dismiss(S.id),T(G=>G.filter(({id:K})=>K!==S.id))},[D]);return q.useEffect(()=>ze.subscribe(S=>{if(S.dismiss){T(E=>E.map(G=>G.id===S.id?{...G,delete:!0}:G));return}setTimeout(()=>{Pl.flushSync(()=>{T(E=>{let G=E.findIndex(K=>K.id===S.id);return G!==-1?[...E.slice(0,G),{...E[G],...S},...E.slice(G+1)]:[S,...E]})})})}),[]),q.useEffect(()=>{if(d!=="system"){U(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:S})=>{U(S?"dark":"light")})},[d]),q.useEffect(()=>{D.length<=1&&j(!1)},[D]),q.useEffect(()=>{let S=E=>{var G,K;n.every(re=>E[re]||E.code===re)&&(j(!0),(G=H.current)==null||G.focus()),E.code==="Escape"&&(document.activeElement===H.current||(K=H.current)!=null&&K.contains(document.activeElement))&&j(!1)};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[n]),q.useEffect(()=>{if(H.current)return()=>{L.current&&(L.current.focus({preventScroll:!0}),L.current=null,Y.current=!1)}},[H.current]),D.length?q.createElement("section",{"aria-label":`${y} ${P}`,tabIndex:-1},O.map((S,E)=>{var G;let[K,re]=S.split("-");return q.createElement("ol",{key:S,dir:v==="auto"?Pn():v,tabIndex:-1,ref:H,className:o,"data-sonner-toaster":!0,"data-theme":F,"data-y-position":K,"data-x-position":re,style:{"--front-toast-height":`${((G=k[0])==null?void 0:G.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||Id,"--width":`${Pd}px`,"--gap":`${b}px`,...f},onBlur:Z=>{Y.current&&!Z.currentTarget.contains(Z.relatedTarget)&&(Y.current=!1,L.current&&(L.current.focus({preventScroll:!0}),L.current=null))},onFocus:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||Y.current||(Y.current=!0,L.current=Z.relatedTarget)},onMouseEnter:()=>j(!0),onMouseMove:()=>j(!0),onMouseLeave:()=>{w||j(!1)},onPointerDown:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||M(!0)},onPointerUp:()=>M(!1)},D.filter(Z=>!Z.position&&E===0||Z.position===S).map((Z,ge)=>{var ve,de;return q.createElement($d,{key:Z.id,icons:p,index:ge,toast:Z,defaultRichColors:x,duration:(ve=u==null?void 0:u.duration)!=null?ve:h,className:u==null?void 0:u.className,descriptionClassName:u==null?void 0:u.descriptionClassName,invert:s,visibleToasts:l,closeButton:(de=u==null?void 0:u.closeButton)!=null?de:i,interacting:w,position:S,style:u==null?void 0:u.style,unstyled:u==null?void 0:u.unstyled,classNames:u==null?void 0:u.classNames,cancelButtonStyle:u==null?void 0:u.cancelButtonStyle,actionButtonStyle:u==null?void 0:u.actionButtonStyle,removeToast:X,toasts:D.filter(ke=>ke.position==Z.position),heights:k.filter(ke=>ke.position==Z.position),setHeights:B,expandByDefault:r,gap:b,loadingIcon:g,expanded:C,pauseWhenPageIsHidden:N,cn:_})}))})):null};const An=({...t})=>{const{theme:s="system"}=xd();return e.jsx(Od,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};function pt(t,s,{checkForDefaultPrevented:a=!0}={}){return function(r){if(t==null||t(r),a===!1||!r.defaultPrevented)return s==null?void 0:s(r)}}function Rn(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function hi(...t){return s=>{let a=!1;const n=t.map(r=>{const i=Rn(r,s);return!a&&typeof i=="function"&&(a=!0),i});if(a)return()=>{for(let r=0;r<n.length;r++){const i=n[r];typeof i=="function"?i():Rn(t[r],null)}}}}function Lt(...t){return m.useCallback(hi(...t),t)}function xi(t,s=[]){let a=[];function n(i,o){const c=m.createContext(o),d=a.length;a=[...a,o];const x=f=>{var p;const{scope:l,children:u,...v}=f,b=((p=l==null?void 0:l[t])==null?void 0:p[d])||c,g=m.useMemo(()=>v,Object.values(v));return e.jsx(b.Provider,{value:g,children:u})};x.displayName=i+"Provider";function h(f,l){var b;const u=((b=l==null?void 0:l[t])==null?void 0:b[d])||c,v=m.useContext(u);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[x,h]}const r=()=>{const i=a.map(o=>m.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return r.scopeName=t,[n,Fd(r,...s)]}function Fd(...t){const s=t[0];if(t.length===1)return s;const a=()=>{const n=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=n.reduce((c,{useScope:d,scopeName:x})=>{const f=d(i)[`__scope${x}`];return{...c,...f}},{});return m.useMemo(()=>({[`__scope${s.scopeName}`]:o}),[o])}};return a.scopeName=s.scopeName,a}function Wd(t){const s=zd(t),a=m.forwardRef((n,r)=>{const{children:i,...o}=n,c=m.Children.toArray(i),d=c.find(Bd);if(d){const x=d.props.children,h=c.map(f=>f===d?m.Children.count(x)>1?m.Children.only(null):m.isValidElement(x)?x.props.children:null:f);return e.jsx(s,{...o,ref:r,children:m.isValidElement(x)?m.cloneElement(x,void 0,h):null})}return e.jsx(s,{...o,ref:r,children:i})});return a.displayName=`${t}.Slot`,a}function zd(t){const s=m.forwardRef((a,n)=>{const{children:r,...i}=a;if(m.isValidElement(r)){const o=Vd(r),c=Hd(i,r.props);return r.type!==m.Fragment&&(c.ref=n?hi(n,o):o),m.cloneElement(r,c)}return m.Children.count(r)>1?m.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var pi=Symbol("radix.slottable");function Ud(t){const s=({children:a})=>e.jsx(e.Fragment,{children:a});return s.displayName=`${t}.Slottable`,s.__radixId=pi,s}function Bd(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===pi}function Hd(t,s){const a={...s};for(const n in s){const r=t[n],i=s[n];/^on[A-Z]/.test(n)?r&&i?a[n]=(...c)=>{const d=i(...c);return r(...c),d}:r&&(a[n]=r):n==="style"?a[n]={...r,...i}:n==="className"&&(a[n]=[r,i].filter(Boolean).join(" "))}return{...t,...a}}function Vd(t){var n,r;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var Yd=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$t=Yd.reduce((t,s)=>{const a=Wd(`Primitive.${s}`),n=m.forwardRef((r,i)=>{const{asChild:o,...c}=r,d=o?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:i})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function Gd(t,s){t&&za.flushSync(()=>t.dispatchEvent(s))}function Gs(t){const s=m.useRef(t);return m.useEffect(()=>{s.current=t}),m.useMemo(()=>(...a)=>{var n;return(n=s.current)==null?void 0:n.call(s,...a)},[])}function qd(t,s=globalThis==null?void 0:globalThis.document){const a=Gs(t);m.useEffect(()=>{const n=r=>{r.key==="Escape"&&a(r)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[a,s])}var Kd="DismissableLayer",Ca="dismissableLayer.update",Jd="dismissableLayer.pointerDownOutside",Xd="dismissableLayer.focusOutside",Mn,fi=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),gi=m.forwardRef((t,s)=>{const{disableOutsidePointerEvents:a=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...d}=t,x=m.useContext(fi),[h,f]=m.useState(null),l=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,u]=m.useState({}),v=Lt(s,O=>f(O)),b=Array.from(x.layers),[g]=[...x.layersWithOutsidePointerEventsDisabled].slice(-1),p=b.indexOf(g),y=h?b.indexOf(h):-1,N=x.layersWithOutsidePointerEventsDisabled.size>0,_=y>=p,D=em(O=>{const k=O.target,B=[...x.branches].some(C=>C.contains(k));!_||B||(r==null||r(O),o==null||o(O),O.defaultPrevented||c==null||c())},l),T=tm(O=>{const k=O.target;[...x.branches].some(C=>C.contains(k))||(i==null||i(O),o==null||o(O),O.defaultPrevented||c==null||c())},l);return qd(O=>{y===x.layers.size-1&&(n==null||n(O),!O.defaultPrevented&&c&&(O.preventDefault(),c()))},l),m.useEffect(()=>{if(h)return a&&(x.layersWithOutsidePointerEventsDisabled.size===0&&(Mn=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),x.layersWithOutsidePointerEventsDisabled.add(h)),x.layers.add(h),Ln(),()=>{a&&x.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=Mn)}},[h,l,a,x]),m.useEffect(()=>()=>{h&&(x.layers.delete(h),x.layersWithOutsidePointerEventsDisabled.delete(h),Ln())},[h,x]),m.useEffect(()=>{const O=()=>u({});return document.addEventListener(Ca,O),()=>document.removeEventListener(Ca,O)},[]),e.jsx($t.div,{...d,ref:v,style:{pointerEvents:N?_?"auto":"none":void 0,...t.style},onFocusCapture:pt(t.onFocusCapture,T.onFocusCapture),onBlurCapture:pt(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:pt(t.onPointerDownCapture,D.onPointerDownCapture)})});gi.displayName=Kd;var Qd="DismissableLayerBranch",Zd=m.forwardRef((t,s)=>{const a=m.useContext(fi),n=m.useRef(null),r=Lt(s,n);return m.useEffect(()=>{const i=n.current;if(i)return a.branches.add(i),()=>{a.branches.delete(i)}},[a.branches]),e.jsx($t.div,{...t,ref:r})});Zd.displayName=Qd;function em(t,s=globalThis==null?void 0:globalThis.document){const a=Gs(t),n=m.useRef(!1),r=m.useRef(()=>{});return m.useEffect(()=>{const i=c=>{if(c.target&&!n.current){let d=function(){vi(Jd,a,x,{discrete:!0})};const x={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",r.current),r.current=d,s.addEventListener("click",r.current,{once:!0})):d()}else s.removeEventListener("click",r.current);n.current=!1},o=window.setTimeout(()=>{s.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),s.removeEventListener("pointerdown",i),s.removeEventListener("click",r.current)}},[s,a]),{onPointerDownCapture:()=>n.current=!0}}function tm(t,s=globalThis==null?void 0:globalThis.document){const a=Gs(t),n=m.useRef(!1);return m.useEffect(()=>{const r=i=>{i.target&&!n.current&&vi(Xd,a,{originalEvent:i},{discrete:!1})};return s.addEventListener("focusin",r),()=>s.removeEventListener("focusin",r)},[s,a]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Ln(){const t=new CustomEvent(Ca);document.dispatchEvent(t)}function vi(t,s,a,{discrete:n}){const r=a.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:a});s&&r.addEventListener(t,s,{once:!0}),n?Gd(r,i):r.dispatchEvent(i)}var Pt=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},sm=wr[" useId ".trim().toString()]||(()=>{}),am=0;function nm(t){const[s,a]=m.useState(sm());return Pt(()=>{a(n=>n??String(am++))},[t]),s?`radix-${s}`:""}var rm="Arrow",bi=m.forwardRef((t,s)=>{const{children:a,width:n=10,height:r=5,...i}=t;return e.jsx($t.svg,{...i,ref:s,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?a:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});bi.displayName=rm;var im=bi;function om(t){const[s,a]=m.useState(void 0);return Pt(()=>{if(t){a({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,c;if("borderBoxSize"in i){const d=i.borderBoxSize,x=Array.isArray(d)?d[0]:d;o=x.inlineSize,c=x.blockSize}else o=t.offsetWidth,c=t.offsetHeight;a({width:o,height:c})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else a(void 0)},[t]),s}var Ga="Popper",[ji,yi]=xi(Ga),[lm,Ni]=ji(Ga),wi=t=>{const{__scopePopper:s,children:a}=t,[n,r]=m.useState(null);return e.jsx(lm,{scope:s,anchor:n,onAnchorChange:r,children:a})};wi.displayName=Ga;var _i="PopperAnchor",Si=m.forwardRef((t,s)=>{const{__scopePopper:a,virtualRef:n,...r}=t,i=Ni(_i,a),o=m.useRef(null),c=Lt(s,o),d=m.useRef(null);return m.useEffect(()=>{const x=d.current;d.current=(n==null?void 0:n.current)||o.current,x!==d.current&&i.onAnchorChange(d.current)}),n?null:e.jsx($t.div,{...r,ref:c})});Si.displayName=_i;var qa="PopperContent",[cm,dm]=ji(qa),Ci=m.forwardRef((t,s)=>{var ge,ve,de,ke,Ft,kt;const{__scopePopper:a,side:n="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:x=[],collisionPadding:h=0,sticky:f="partial",hideWhenDetached:l=!1,updatePositionStrategy:u="optimized",onPlaced:v,...b}=t,g=Ni(qa,a),[p,y]=m.useState(null),N=Lt(s,_e=>y(_e)),[_,D]=m.useState(null),T=om(_),O=(T==null?void 0:T.width)??0,k=(T==null?void 0:T.height)??0,B=n+(i!=="center"?"-"+i:""),C=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},j=Array.isArray(x)?x:[x],w=j.length>0,M={padding:C,boundary:j.filter(um),altBoundary:w},{refs:F,floatingStyles:U,placement:H,isPositioned:P,middlewareData:L}=hl({strategy:"fixed",placement:B,whileElementsMounted:(..._e)=>yl(..._e,{animationFrame:u==="always"}),elements:{reference:g.anchor},middleware:[xl({mainAxis:r+k,alignmentAxis:o}),d&&pl({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?jl():void 0,...M}),d&&fl({...M}),gl({...M,apply:({elements:_e,rects:tt,availableWidth:st,availableHeight:Le})=>{const{width:ut,height:ns}=tt.reference,De=_e.floating.style;De.setProperty("--radix-popper-available-width",`${st}px`),De.setProperty("--radix-popper-available-height",`${Le}px`),De.setProperty("--radix-popper-anchor-width",`${ut}px`),De.setProperty("--radix-popper-anchor-height",`${ns}px`)}}),_&&vl({element:_,padding:c}),hm({arrowWidth:O,arrowHeight:k}),l&&bl({strategy:"referenceHidden",...M})]}),[Y,X]=Ei(H),S=Gs(v);Pt(()=>{P&&(S==null||S())},[P,S]);const E=(ge=L.arrow)==null?void 0:ge.x,G=(ve=L.arrow)==null?void 0:ve.y,K=((de=L.arrow)==null?void 0:de.centerOffset)!==0,[re,Z]=m.useState();return Pt(()=>{p&&Z(window.getComputedStyle(p).zIndex)},[p]),e.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:P?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ke=L.transformOrigin)==null?void 0:ke.x,(Ft=L.transformOrigin)==null?void 0:Ft.y].join(" "),...((kt=L.hide)==null?void 0:kt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(cm,{scope:a,placedSide:Y,onArrowChange:D,arrowX:E,arrowY:G,shouldHideArrow:K,children:e.jsx($t.div,{"data-side":Y,"data-align":X,...b,ref:N,style:{...b.style,animation:P?void 0:"none"}})})})});Ci.displayName=qa;var ki="PopperArrow",mm={top:"bottom",right:"left",bottom:"top",left:"right"},Di=m.forwardRef(function(s,a){const{__scopePopper:n,...r}=s,i=dm(ki,n),o=mm[i.placedSide];return e.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:e.jsx(im,{...r,ref:a,style:{...r.style,display:"block"}})})});Di.displayName=ki;function um(t){return t!==null}var hm=t=>({name:"transformOrigin",options:t,fn(s){var g,p,y;const{placement:a,rects:n,middlewareData:r}=s,o=((g=r.arrow)==null?void 0:g.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[x,h]=Ei(a),f={start:"0%",center:"50%",end:"100%"}[h],l=(((p=r.arrow)==null?void 0:p.x)??0)+c/2,u=(((y=r.arrow)==null?void 0:y.y)??0)+d/2;let v="",b="";return x==="bottom"?(v=o?f:`${l}px`,b=`${-d}px`):x==="top"?(v=o?f:`${l}px`,b=`${n.floating.height+d}px`):x==="right"?(v=`${-d}px`,b=o?f:`${u}px`):x==="left"&&(v=`${n.floating.width+d}px`,b=o?f:`${u}px`),{data:{x:v,y:b}}}});function Ei(t){const[s,a="center"]=t.split("-");return[s,a]}var xm=wi,pm=Si,fm=Ci,gm=Di;function vm(t,s){return m.useReducer((a,n)=>s[a][n]??a,t)}var Ii=t=>{const{present:s,children:a}=t,n=bm(s),r=typeof a=="function"?a({present:n.isPresent}):m.Children.only(a),i=Lt(n.ref,jm(r));return typeof a=="function"||n.isPresent?m.cloneElement(r,{ref:i}):null};Ii.displayName="Presence";function bm(t){const[s,a]=m.useState(),n=m.useRef(null),r=m.useRef(t),i=m.useRef("none"),o=t?"mounted":"unmounted",[c,d]=vm(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const x=Ds(n.current);i.current=c==="mounted"?x:"none"},[c]),Pt(()=>{const x=n.current,h=r.current;if(h!==t){const l=i.current,u=Ds(x);t?d("MOUNT"):u==="none"||(x==null?void 0:x.display)==="none"?d("UNMOUNT"):d(h&&l!==u?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,d]),Pt(()=>{if(s){let x;const h=s.ownerDocument.defaultView??window,f=u=>{const b=Ds(n.current).includes(CSS.escape(u.animationName));if(u.target===s&&b&&(d("ANIMATION_END"),!r.current)){const g=s.style.animationFillMode;s.style.animationFillMode="forwards",x=h.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=g)})}},l=u=>{u.target===s&&(i.current=Ds(n.current))};return s.addEventListener("animationstart",l),s.addEventListener("animationcancel",f),s.addEventListener("animationend",f),()=>{h.clearTimeout(x),s.removeEventListener("animationstart",l),s.removeEventListener("animationcancel",f),s.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:m.useCallback(x=>{n.current=x?getComputedStyle(x):null,a(x)},[])}}function Ds(t){return(t==null?void 0:t.animationName)||"none"}function jm(t){var n,r;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var ym=wr[" useInsertionEffect ".trim().toString()]||Pt;function Nm({prop:t,defaultProp:s,onChange:a=()=>{},caller:n}){const[r,i,o]=wm({defaultProp:s,onChange:a}),c=t!==void 0,d=c?t:r;{const h=m.useRef(t!==void 0);m.useEffect(()=>{const f=h.current;f!==c&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,n])}const x=m.useCallback(h=>{var f;if(c){const l=_m(h)?h(t):h;l!==t&&((f=o.current)==null||f.call(o,l))}else i(h)},[c,t,i,o]);return[d,x]}function wm({defaultProp:t,onChange:s}){const[a,n]=m.useState(t),r=m.useRef(a),i=m.useRef(s);return ym(()=>{i.current=s},[s]),m.useEffect(()=>{var o;r.current!==a&&((o=i.current)==null||o.call(i,a),r.current=a)},[a,r]),[a,n,i]}function _m(t){return typeof t=="function"}var Sm=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Cm="VisuallyHidden",Ti=m.forwardRef((t,s)=>e.jsx($t.span,{...t,ref:s,style:{...Sm,...t.style}}));Ti.displayName=Cm;var km=Ti,[qs]=xi("Tooltip",[yi]),Ks=yi(),Pi="TooltipProvider",Dm=700,ka="tooltip.open",[Em,Ka]=qs(Pi),Ai=t=>{const{__scopeTooltip:s,delayDuration:a=Dm,skipDelayDuration:n=300,disableHoverableContent:r=!1,children:i}=t,o=m.useRef(!0),c=m.useRef(!1),d=m.useRef(0);return m.useEffect(()=>{const x=d.current;return()=>window.clearTimeout(x)},[]),e.jsx(Em,{scope:s,isOpenDelayedRef:o,delayDuration:a,onOpen:m.useCallback(()=>{window.clearTimeout(d.current),o.current=!1},[]),onClose:m.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:m.useCallback(x=>{c.current=x},[]),disableHoverableContent:r,children:i})};Ai.displayName=Pi;var hs="Tooltip",[Im,Js]=qs(hs),Ri=t=>{const{__scopeTooltip:s,children:a,open:n,defaultOpen:r,onOpenChange:i,disableHoverableContent:o,delayDuration:c}=t,d=Ka(hs,t.__scopeTooltip),x=Ks(s),[h,f]=m.useState(null),l=nm(),u=m.useRef(0),v=o??d.disableHoverableContent,b=c??d.delayDuration,g=m.useRef(!1),[p,y]=Nm({prop:n,defaultProp:r??!1,onChange:O=>{O?(d.onOpen(),document.dispatchEvent(new CustomEvent(ka))):d.onClose(),i==null||i(O)},caller:hs}),N=m.useMemo(()=>p?g.current?"delayed-open":"instant-open":"closed",[p]),_=m.useCallback(()=>{window.clearTimeout(u.current),u.current=0,g.current=!1,y(!0)},[y]),D=m.useCallback(()=>{window.clearTimeout(u.current),u.current=0,y(!1)},[y]),T=m.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>{g.current=!0,y(!0),u.current=0},b)},[b,y]);return m.useEffect(()=>()=>{u.current&&(window.clearTimeout(u.current),u.current=0)},[]),e.jsx(xm,{...x,children:e.jsx(Im,{scope:s,contentId:l,open:p,stateAttribute:N,trigger:h,onTriggerChange:f,onTriggerEnter:m.useCallback(()=>{d.isOpenDelayedRef.current?T():_()},[d.isOpenDelayedRef,T,_]),onTriggerLeave:m.useCallback(()=>{v?D():(window.clearTimeout(u.current),u.current=0)},[D,v]),onOpen:_,onClose:D,disableHoverableContent:v,children:a})})};Ri.displayName=hs;var Da="TooltipTrigger",Mi=m.forwardRef((t,s)=>{const{__scopeTooltip:a,...n}=t,r=Js(Da,a),i=Ka(Da,a),o=Ks(a),c=m.useRef(null),d=Lt(s,c,r.onTriggerChange),x=m.useRef(!1),h=m.useRef(!1),f=m.useCallback(()=>x.current=!1,[]);return m.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),e.jsx(pm,{asChild:!0,...o,children:e.jsx($t.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...n,ref:d,onPointerMove:pt(t.onPointerMove,l=>{l.pointerType!=="touch"&&!h.current&&!i.isPointerInTransitRef.current&&(r.onTriggerEnter(),h.current=!0)}),onPointerLeave:pt(t.onPointerLeave,()=>{r.onTriggerLeave(),h.current=!1}),onPointerDown:pt(t.onPointerDown,()=>{r.open&&r.onClose(),x.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:pt(t.onFocus,()=>{x.current||r.onOpen()}),onBlur:pt(t.onBlur,r.onClose),onClick:pt(t.onClick,r.onClose)})})});Mi.displayName=Da;var Tm="TooltipPortal",[Ig,Pm]=qs(Tm,{forceMount:void 0}),Xt="TooltipContent",Li=m.forwardRef((t,s)=>{const a=Pm(Xt,t.__scopeTooltip),{forceMount:n=a.forceMount,side:r="top",...i}=t,o=Js(Xt,t.__scopeTooltip);return e.jsx(Ii,{present:n||o.open,children:o.disableHoverableContent?e.jsx($i,{side:r,...i,ref:s}):e.jsx(Am,{side:r,...i,ref:s})})}),Am=m.forwardRef((t,s)=>{const a=Js(Xt,t.__scopeTooltip),n=Ka(Xt,t.__scopeTooltip),r=m.useRef(null),i=Lt(s,r),[o,c]=m.useState(null),{trigger:d,onClose:x}=a,h=r.current,{onPointerInTransitChange:f}=n,l=m.useCallback(()=>{c(null),f(!1)},[f]),u=m.useCallback((v,b)=>{const g=v.currentTarget,p={x:v.clientX,y:v.clientY},y=Om(p,g.getBoundingClientRect()),N=Fm(p,y),_=Wm(b.getBoundingClientRect()),D=Um([...N,..._]);c(D),f(!0)},[f]);return m.useEffect(()=>()=>l(),[l]),m.useEffect(()=>{if(d&&h){const v=g=>u(g,h),b=g=>u(g,d);return d.addEventListener("pointerleave",v),h.addEventListener("pointerleave",b),()=>{d.removeEventListener("pointerleave",v),h.removeEventListener("pointerleave",b)}}},[d,h,u,l]),m.useEffect(()=>{if(o){const v=b=>{const g=b.target,p={x:b.clientX,y:b.clientY},y=(d==null?void 0:d.contains(g))||(h==null?void 0:h.contains(g)),N=!zm(p,o);y?l():N&&(l(),x())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[d,h,o,x,l]),e.jsx($i,{...t,ref:i})}),[Rm,Mm]=qs(hs,{isInside:!1}),Lm=Ud("TooltipContent"),$i=m.forwardRef((t,s)=>{const{__scopeTooltip:a,children:n,"aria-label":r,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,d=Js(Xt,a),x=Ks(a),{onClose:h}=d;return m.useEffect(()=>(document.addEventListener(ka,h),()=>document.removeEventListener(ka,h)),[h]),m.useEffect(()=>{if(d.trigger){const f=l=>{const u=l.target;u!=null&&u.contains(d.trigger)&&h()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,h]),e.jsx(gi,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:h,children:e.jsxs(fm,{"data-state":d.stateAttribute,...x,...c,ref:s,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Lm,{children:n}),e.jsx(Rm,{scope:a,isInside:!0,children:e.jsx(km,{id:d.contentId,role:"tooltip",children:r||n})})]})})});Li.displayName=Xt;var Oi="TooltipArrow",$m=m.forwardRef((t,s)=>{const{__scopeTooltip:a,...n}=t,r=Ks(a);return Mm(Oi,a).isInside?null:e.jsx(gm,{...r,...n,ref:s})});$m.displayName=Oi;function Om(t,s){const a=Math.abs(s.top-t.y),n=Math.abs(s.bottom-t.y),r=Math.abs(s.right-t.x),i=Math.abs(s.left-t.x);switch(Math.min(a,n,r,i)){case i:return"left";case r:return"right";case a:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Fm(t,s,a=5){const n=[];switch(s){case"top":n.push({x:t.x-a,y:t.y+a},{x:t.x+a,y:t.y+a});break;case"bottom":n.push({x:t.x-a,y:t.y-a},{x:t.x+a,y:t.y-a});break;case"left":n.push({x:t.x+a,y:t.y-a},{x:t.x+a,y:t.y+a});break;case"right":n.push({x:t.x-a,y:t.y-a},{x:t.x-a,y:t.y+a});break}return n}function Wm(t){const{top:s,right:a,bottom:n,left:r}=t;return[{x:r,y:s},{x:a,y:s},{x:a,y:n},{x:r,y:n}]}function zm(t,s){const{x:a,y:n}=t;let r=!1;for(let i=0,o=s.length-1;i<s.length;o=i++){const c=s[i],d=s[o],x=c.x,h=c.y,f=d.x,l=d.y;h>n!=l>n&&a<(f-x)*(n-h)/(l-h)+x&&(r=!r)}return r}function Um(t){const s=t.slice();return s.sort((a,n)=>a.x<n.x?-1:a.x>n.x?1:a.y<n.y?-1:a.y>n.y?1:0),Bm(s)}function Bm(t){if(t.length<=1)return t.slice();const s=[];for(let n=0;n<t.length;n++){const r=t[n];for(;s.length>=2;){const i=s[s.length-1],o=s[s.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))s.pop();else break}s.push(r)}s.pop();const a=[];for(let n=t.length-1;n>=0;n--){const r=t[n];for(;a.length>=2;){const i=a[a.length-1],o=a[a.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))a.pop();else break}a.push(r)}return a.pop(),s.length===1&&a.length===1&&s[0].x===a[0].x&&s[0].y===a[0].y?s:s.concat(a)}var Hm=Ai,Vm=Ri,Ym=Mi,Fi=Li;const Ea=Hm,Gm=Vm,qm=Ym,Wi=m.forwardRef(({className:t,sideOffset:s=4,...a},n)=>e.jsx(Fi,{ref:n,sideOffset:s,className:V("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));Wi.displayName=Fi.displayName;const A=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:V("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));A.displayName="Card";const W=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:V("flex flex-col space-y-1.5 p-6",t),...s}));W.displayName="CardHeader";const z=m.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:V("text-2xl font-semibold leading-none tracking-tight",t),...s}));z.displayName="CardTitle";const ue=m.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:V("text-sm text-muted-foreground",t),...s}));ue.displayName="CardDescription";const R=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:V("p-6 pt-0",t),...s}));R.displayName="CardContent";const Km=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:V("flex items-center p-6 pt-0",t),...s}));Km.displayName="CardFooter";const Ia=Mt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),I=m.forwardRef(({className:t,variant:s,size:a,asChild:n=!1,...r},i)=>{const o=n?Zt:"button";return e.jsx(o,{className:V(Ia({variant:s,size:a,className:t})),ref:i,...r})});I.displayName="Button";const Jm=Mt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),le=m.forwardRef(({className:t,variant:s,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:V(Jm({variant:s}),t),...a}));le.displayName="Alert";const Xm=m.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:V("mb-1 font-medium leading-none tracking-tight",t),...s}));Xm.displayName="AlertTitle";const me=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:V("text-sm [&_p]:leading-relaxed",t),...s}));me.displayName="AlertDescription";class $n extends m.Component{constructor(a){super(a);ta(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0}}componentDidCatch(a,n){console.error("ErrorBoundary caught an error:",a,n),this.setState({error:a,errorInfo:n})}render(){var a;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:e.jsxs(A,{className:"max-w-md w-full",children:[e.jsxs(W,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(Ye,{className:"h-12 w-12 text-destructive"})}),e.jsx(z,{className:"text-destructive",children:""}),e.jsx(ue,{children:" "})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(le,{variant:"destructive",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx(me,{children:((a=this.state.error)==null?void 0:a.message)||"Unknown error occurred"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(I,{onClick:this.handleReset,className:"w-full",variant:"outline",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),""]}),e.jsx(I,{onClick:()=>window.location.reload(),className:"w-full",variant:"secondary",children:""})]}),!1]})]})}):this.props.children}}const ps=ur,Qm=dr,zi=m.forwardRef(({className:t,...s},a)=>e.jsx(zs,{ref:a,className:V("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));zi.displayName=zs.displayName;const ts=m.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Qm,{children:[e.jsx(zi,{}),e.jsxs(Us,{ref:n,className:V("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(mr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ts.displayName=Us.displayName;const ss=({className:t,...s})=>e.jsx("div",{className:V("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});ss.displayName="DialogHeader";const fs=({className:t,...s})=>e.jsx("div",{className:V("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});fs.displayName="DialogFooter";const as=m.forwardRef(({className:t,...s},a)=>e.jsx(Bs,{ref:a,className:V("text-lg font-semibold leading-none tracking-tight",t),...s}));as.displayName=Bs.displayName;const gs=m.forwardRef(({className:t,...s},a)=>e.jsx(Hs,{ref:a,className:V("text-sm text-muted-foreground",t),...s}));gs.displayName=Hs.displayName;function Zm({open:t,updateInfo:s,onDownload:a,onSkip:n}){const r=()=>{var o;(o=window.electron)!=null&&o.ipcRenderer&&window.electron.ipcRenderer.send("download-update"),a()},i=()=>{var o;(o=window.electron)!=null&&o.ipcRenderer&&window.electron.ipcRenderer.send("skip-version",s.version),n()};return e.jsx(ps,{open:t,onOpenChange:o=>!o&&n(),children:e.jsxs(ts,{className:"sm:max-w-[500px]",children:[e.jsxs(ss,{children:[e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5 text-primary"}),"Update Available"]}),e.jsx(gs,{children:"A new version of VCHome Hospital is ready to download"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"New Version:"}),e.jsxs("span",{className:"text-sm font-semibold text-primary",children:["v",s.version]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Release Date:"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(s.releaseDate).toLocaleDateString()})]})]}),s.releaseNotes&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"What's New:"}),e.jsx("div",{className:"rounded-md border bg-muted/50 p-3 text-sm text-muted-foreground max-h-[200px] overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans",children:s.releaseNotes})})]})]}),e.jsxs(fs,{className:"gap-2",children:[e.jsxs(I,{variant:"outline",onClick:i,children:[e.jsx(Ct,{className:"h-4 w-4"}),"Skip This Version"]}),e.jsxs(I,{onClick:r,children:[e.jsx(We,{className:"h-4 w-4"}),"Download Update"]})]})]})})}function eu(t,s=[]){let a=[];function n(i,o){const c=m.createContext(o),d=a.length;a=[...a,o];function x(f){const{scope:l,children:u,...v}=f,b=(l==null?void 0:l[t][d])||c,g=m.useMemo(()=>v,Object.values(v));return e.jsx(b.Provider,{value:g,children:u})}function h(f,l){const u=(l==null?void 0:l[t][d])||c,v=m.useContext(u);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return x.displayName=i+"Provider",[x,h]}const r=()=>{const i=a.map(o=>m.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return r.scopeName=t,[n,tu(r,...s)]}function tu(...t){const s=t[0];if(t.length===1)return s;const a=()=>{const n=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=n.reduce((c,{useScope:d,scopeName:x})=>{const f=d(i)[`__scope${x}`];return{...c,...f}},{});return m.useMemo(()=>({[`__scope${s.scopeName}`]:o}),[o])}};return a.scopeName=s.scopeName,a}var Ja="Progress",Xa=100,[su]=eu(Ja),[au,nu]=su(Ja),Ui=m.forwardRef((t,s)=>{const{__scopeProgress:a,value:n=null,max:r,getValueLabel:i=ru,...o}=t;(r||r===0)&&!On(r)&&console.error(iu(`${r}`,"Progress"));const c=On(r)?r:Xa;n!==null&&!Fn(n,c)&&console.error(ou(`${n}`,"Progress"));const d=Fn(n,c)?n:null,x=$s(d)?i(d,c):void 0;return e.jsx(au,{scope:a,value:d,max:c,children:e.jsx(Ke.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":$s(d)?d:void 0,"aria-valuetext":x,role:"progressbar","data-state":Vi(d,c),"data-value":d??void 0,"data-max":c,...o,ref:s})})});Ui.displayName=Ja;var Bi="ProgressIndicator",Hi=m.forwardRef((t,s)=>{const{__scopeProgress:a,...n}=t,r=nu(Bi,a);return e.jsx(Ke.div,{"data-state":Vi(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...n,ref:s})});Hi.displayName=Bi;function ru(t,s){return`${Math.round(t/s*100)}%`}function Vi(t,s){return t==null?"indeterminate":t===s?"complete":"loading"}function $s(t){return typeof t=="number"}function On(t){return $s(t)&&!isNaN(t)&&t>0}function Fn(t,s){return $s(t)&&!isNaN(t)&&t<=s&&t>=0}function iu(t,s){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Xa}\`.`}function ou(t,s){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Xa} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Yi=Ui,lu=Hi;const Gi=m.forwardRef(({className:t,value:s,...a},n)=>e.jsx(Yi,{ref:n,className:V("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...a,children:e.jsx(lu,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Gi.displayName=Yi.displayName;function cu({open:t,progress:s,onCancel:a}){const n=o=>{if(o===0)return"0 B";const c=1024,d=["B","KB","MB","GB"],x=Math.floor(Math.log(o)/Math.log(c));return`${(o/Math.pow(c,x)).toFixed(2)} ${d[x]}`},r=o=>`${(o/1048576).toFixed(2)} MB/s`,i=()=>{if(s.bytesPerSecond===0)return"Calculating...";const c=(s.total-s.transferred)/s.bytesPerSecond;if(c<60)return`${Math.ceil(c)} seconds`;if(c<3600){const d=Math.ceil(c/60);return`${d} minute${d>1?"s":""}`}else{const d=Math.floor(c/3600),x=Math.ceil(c%3600/60);return`${d}h ${x}m`}};return e.jsx(ps,{open:t,onOpenChange:()=>{},children:e.jsxs(ts,{className:"sm:max-w-[450px]",onInteractOutside:o=>o.preventDefault(),onEscapeKeyDown:o=>o.preventDefault(),children:[e.jsxs(ss,{children:[e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5 text-primary animate-pulse"}),"Downloading Update"]}),e.jsx(gs,{children:"Please wait while the update is being downloaded"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Progress"}),e.jsxs("span",{className:"font-semibold text-primary",children:[s.percent.toFixed(1),"%"]})]}),e.jsx(Gi,{value:s.percent,className:"h-3"})]}),e.jsxs("div",{className:"space-y-3 rounded-md border bg-muted/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Download Speed:"}),e.jsx("span",{className:"font-medium",children:r(s.bytesPerSecond)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Downloaded:"}),e.jsxs("span",{className:"font-medium",children:[n(s.transferred)," / ",n(s.total)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Time Remaining:"}),e.jsx("span",{className:"font-medium",children:i()})]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"The application will prompt you to install once the download is complete"})]})]})})}function du({open:t,version:s,onInstallNow:a,onInstallLater:n}){const r=()=>{var o;(o=window.electron)!=null&&o.ipcRenderer&&window.electron.ipcRenderer.send("install-update"),a()},i=()=>{n()};return e.jsx(ps,{open:t,onOpenChange:o=>!o&&n(),children:e.jsxs(ts,{className:"sm:max-w-[500px]",children:[e.jsxs(ss,{children:[e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"h-5 w-5 text-green-600"}),"Update Ready to Install"]}),e.jsxs(gs,{children:["Version ",s," has been downloaded successfully"]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-md border border-green-200 bg-green-50 p-4 dark:border-green-900 dark:bg-green-950",children:[e.jsx(Et,{className:"h-5 w-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Download Complete"}),e.jsx("p",{className:"text-xs text-green-700 dark:text-green-300",children:"The update is ready to be installed on your system"})]})]}),e.jsxs(le,{variant:"default",className:"border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950",children:[e.jsx(Ye,{className:"h-4 w-4 text-amber-600"}),e.jsxs(me,{className:"text-amber-900 dark:text-amber-100",children:[e.jsx("strong",{children:"Important:"})," The application will restart to complete the installation. Please save any unsaved work before proceeding."]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex items-start gap-3 rounded-md border bg-muted/30 p-3",children:[e.jsx(Et,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Install Now"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quit and install the update immediately to get the latest features and fixes"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 rounded-md border bg-muted/30 p-3",children:[e.jsx(Ie,{className:"h-5 w-5 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Install Later"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Continue working and install the update when you quit the application"})]})]})]})]}),e.jsxs(fs,{className:"gap-2",children:[e.jsxs(I,{variant:"outline",onClick:i,children:[e.jsx(Ie,{className:"h-4 w-4"}),"Install Later"]}),e.jsxs(I,{onClick:r,children:[e.jsx(Et,{className:"h-4 w-4"}),"Install Now"]})]})]})})}function mu({open:t,error:s,onRetry:a,onManualDownload:n,onClose:r}){const i=()=>{switch(s.type){case"network":return e.jsx($l,{className:"h-5 w-5 text-red-600"});case"disk_space":return e.jsx(Ll,{className:"h-5 w-5 text-red-600"});case"permission":return e.jsx(Pe,{className:"h-5 w-5 text-red-600"});case"integrity":return e.jsx(Te,{className:"h-5 w-5 text-red-600"});default:return e.jsx(lt,{className:"h-5 w-5 text-red-600"})}},o=()=>{switch(s.type){case"network":return"Network Connection Error";case"disk_space":return"Insufficient Disk Space";case"permission":return"Permission Denied";case"integrity":return"Download Verification Failed";case"rate_limit":return"Rate Limit Exceeded";default:return"Update Failed"}};return e.jsx(ps,{open:t,onOpenChange:c=>!c&&r(),children:e.jsxs(ts,{className:"sm:max-w-[500px]",children:[e.jsxs(ss,{children:[e.jsxs(as,{className:"flex items-center gap-2",children:[i(),o()]}),e.jsx(gs,{children:"An error occurred while updating the application"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(le,{variant:"destructive",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx(me,{children:s.message})]}),s.technicalDetails&&e.jsxs("details",{className:"rounded-md border bg-muted/30 p-3",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-muted-foreground hover:text-foreground",children:"Technical Details"}),e.jsx("div",{className:"mt-2 text-xs text-muted-foreground font-mono break-all",children:s.technicalDetails})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"What you can do:"}),s.canRetry&&e.jsxs("div",{className:"flex items-start gap-3 rounded-md border bg-muted/30 p-3",children:[e.jsx(pe,{className:"h-4 w-4 text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Try Again"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Retry the update process"})]})]}),s.manualDownloadUrl&&e.jsxs("div",{className:"flex items-start gap-3 rounded-md border bg-muted/30 p-3",children:[e.jsx(We,{className:"h-4 w-4 text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Manual Download"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Download and install the update manually from our website"})]})]})]}),s.type==="network"&&e.jsx("div",{className:"rounded-md border border-blue-200 bg-blue-50 p-3 dark:border-blue-900 dark:bg-blue-950",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Tip:"})," Check your internet connection and firewall settings. If you're behind a proxy, make sure it's configured correctly."]})}),s.type==="permission"&&e.jsx("div",{className:"rounded-md border border-blue-200 bg-blue-50 p-3 dark:border-blue-900 dark:bg-blue-950",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Tip:"})," Try running the application as administrator or check that you have write permissions to the installation directory."]})}),s.type==="disk_space"&&e.jsx("div",{className:"rounded-md border border-blue-200 bg-blue-50 p-3 dark:border-blue-900 dark:bg-blue-950",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Tip:"})," Free up at least 500 MB of disk space and try again."]})})]}),e.jsxs(fs,{className:"gap-2",children:[e.jsx(I,{variant:"outline",onClick:r,children:"Close"}),s.manualDownloadUrl&&e.jsxs(I,{variant:"secondary",onClick:n,children:[e.jsx(We,{className:"h-4 w-4"}),"Manual Download"]}),s.canRetry&&e.jsxs(I,{onClick:a,children:[e.jsx(pe,{className:"h-4 w-4"}),"Try Again"]})]})]})})}const mt=Nl,qe=m.forwardRef(({className:t,...s},a)=>e.jsx(hr,{ref:a,className:V("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));qe.displayName=hr.displayName;const te=m.forwardRef(({className:t,...s},a)=>e.jsx(xr,{ref:a,className:V("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));te.displayName=xr.displayName;const ne=m.forwardRef(({className:t,...s},a)=>e.jsx(pr,{ref:a,className:V("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));ne.displayName=pr.displayName;const uu=Mt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function J({className:t,variant:s,...a}){return e.jsx("div",{className:V(uu({variant:s}),t),...a})}const Ot=m.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:V("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s}));Ot.displayName="Textarea";var hu="Separator",Wn="horizontal",xu=["horizontal","vertical"],qi=m.forwardRef((t,s)=>{const{decorative:a,orientation:n=Wn,...r}=t,i=pu(n)?n:Wn,c=a?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(Ke.div,{"data-orientation":i,...c,...r,ref:s})});qi.displayName=hu;function pu(t){return xu.includes(t)}var Ki=qi;const Ae=m.forwardRef(({className:t,orientation:s="horizontal",decorative:a=!0,...n},r)=>e.jsx(Ki,{ref:r,decorative:a,orientation:s,className:V("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Ae.displayName=Ki.displayName;const fu=({workflowNodes:t=[]})=>{const[s,a]=m.useState([]),[n,r]=m.useState(null),{toast:i}=xe(),o=()=>{const u=[{id:"ai-smart-router",name:"AI Smart Router (Rich Menu Compatible)",type:"ai-router",description:" Rich Menu, Postback  Quick Reply",replaces:t.filter(b=>b.type==="n8n-nodes-base.switch").map(b=>b.name),code:`// AI Smart Router - Rich Menu & Quick Reply Compatible
const input = $json.body?.events?.[0];
if (!input) {
  throw new Error('Invalid webhook payload: No events found');
}

//  text message, postback  quick reply
const userMessage = input.message?.text || 
                   input.postbackData?.data || 
                   input.message?.quickReply?.postbackData?.data || 
                   input.postback?.data || '';

const userId = input.source?.userId;
const eventType = input.type; // message, postback, follow, etc.

if (!userId) {
  throw new Error('Invalid webhook payload: No userId found');
}

//  LINE Profile  Display Name
let displayName = ""; // default fallback
try {
  const profileResponse = await $http.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + $node.context().get("channelAccessToken")
    }
  });
  
  if (profileResponse.statusCode === 200) {
    displayName = profileResponse.body.displayName || "";
  }
} catch (error) {
  console.log("Error fetching profile:", error);
  //  fallback 
}

//  Rich Menu Actions  Quick Replies
let processedMessage = userMessage;
let isRichMenuAction = false;
let dataCollected = {};

//  Postback Data  Rich Menu
if (input.postback?.data) {
  isRichMenuAction = true;
  console.log("Raw postback data:", input.postback.data);
  try {
    //  Postback data  JSON
    dataCollected = JSON.parse(input.postback.data);
    processedMessage = dataCollected.action || dataCollected.type || userMessage;
    console.log("Parsed postback data:", dataCollected);
    console.log("Processed message:", processedMessage);
  } catch (error) {
    //  Postback data  string
    processedMessage = input.postback.data;
    console.log("String postback data:", processedMessage);
  }
}

//  datetime picker result
if (input.postback?.params?.date) {
  dataCollected.selectedDate = input.postback.params.date;
  processedMessage = 'confirm_appointment_date';
}

if (input.postback?.params?.time) {
  dataCollected.selectedTime = input.postback.params.time;
}

// AI Prompt  Rich Menu 
const routingPrompt = \` Smart Router  Rich Menu 

Input: "\${processedMessage}"
Event Type: "\${eventType}"
Is Rich Menu Action: \${isRichMenuAction}
Collected Data: \${JSON.stringify(dataCollected)}

 JSON:
{
  "action": "checkin|record_appointment|hospital_info|vaccine_info|book_appointment|cancel_booking|check_status|general_info|show_rich_menu|show_vaccine_menu",
  "vaccine_type": "covid|flu|hepatitis|hpv|other",
  "intent_confidence": 0.8,
  "required_data": ["name", "phone", "vaccine_type", "date", "time", "symptoms"],
  "response_type": "rich_menu|quick_reply|datetime_picker|flex_message|confirm_template|form_input",
  "data_collection_step": "start|collecting|complete",
  "next_action": "show_menu|collect_missing_data|confirm|complete"
}

 Rich Menu:
- "checkin"  action: "checkin" ()
- "record_appointment"  action: "record_appointment" (/)
- "hospital_info"  action: "hospital_info" ()
- "show_vaccine_menu"  action: "show_vaccine_menu" ()
- "book_vaccine"  action: "book_appointment", vaccine_type: "covid"
- datetime selection  action: "collect_data", data_collection_step: "collecting"

 action:
-  input  "show_vaccine_menu"  action: "show_vaccine_menu"
-  input  vaccine postback (pfizer, moderna, )  action: "book_appointment"
\`;

//  HTTP Request
$json.openai_request = {
  model: 'gpt-4',
  messages: [{ role: 'user', content: routingPrompt }],
  temperature: 0.1
};

$json.userId = userId;
$json.displayName = displayName;
$json.originalInput = input;
$json.userMessage = processedMessage;
$json.eventType = eventType;
$json.isRichMenuAction = isRichMenuAction;
$json.collectedData = dataCollected;
$json.timestamp = new Date().toISOString();

return $input.all();`},{id:"dynamic-response-generator",name:"Dynamic Response Generator",type:"response-generator",description:" response  dynamic  AI routing results",replaces:["Static Response Nodes"],code:`// Rich Menu Enhanced Dynamic Response Generator (Fixed)
const { routing, userId, displayName, collectedData, isRichMenuAction } = $json;

//  localStorage  getWorkflowStaticData  ReferenceError
const nodeKey = 'vaccine_system_data';
let systemData = {};

try {
  //  localStorage ( database )
  const existingData = $node.context().get(nodeKey);
  systemData = existingData || {};
} catch (e) {
  systemData = {};
}

// Database Node -   
if (!systemData.userBookings) systemData.userBookings = {};
if (!systemData.checkinRecords) systemData.checkinRecords = {};
if (!systemData.vaccineSlots) {
  systemData.vaccineSlots = {
    "2024-12-20": { available: 5, booked: 0 },
    "2024-12-21": { available: 8, booked: 0 },
    "2024-12-22": { available: 3, booked: 2 }
  };
}

// Configuration  Rich Menu Compatible
const vaccineConfig = {
  "covid": {
    "info": "-19   ",
    "price": " ()",
    "duration": "6 ",
    "age_requirement": "6 ",
    "postback_data": { "action": "book_vaccine", "type": "covid" }
  },
  "flu": {
    "info": "  ",
    "price": "800 ",
    "duration": "1 ", 
    "age_requirement": "6 ",
    "postback_data": { "action": "book_vaccine", "type": "flu" }
  },
  "hepatitis": {
    "info": " ",
    "price": "1,200 ",
    "duration": "",
    "age_requirement": "",
    "postback_data": { "action": "book_vaccine", "type": "hepatitis" }
  },
  "hpv": {
    "info": " HPV ",
    "price": "3,500 ",
    "duration": "",
    "age_requirement": "9-45 ",
    "postback_data": { "action": "book_vaccine", "type": "hpv" }
  }
};

//  Response  Rich Menu Compatible
let response = {};

switch(routing.action) {
  case 'show_rich_menu':
    // Main Rich Menu 
    response = {
      type: 'flex',
      altText: ' - ',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: ' ',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446',
              align: 'center'
            },
            {
              type: 'text',
              text: '',
              wrap: true,
              margin: 'md',
              color: '#666666',
              align: 'center'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'box',
              layout: 'vertical',
              margin: 'xl',
              spacing: 'md',
              contents: [
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'primary',
                      color: '#1DB446',
                      action: {
                        type: 'postback',
                        label: ' ',
                        data: JSON.stringify({ action: 'checkin' })
                      }
                    }
                  ]
                },
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'secondary',
                      action: {
                        type: 'postback',
                        label: ' ',
                        data: JSON.stringify({ action: 'record_appointment' })
                      }
                    }
                  ]
                },
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'secondary',
                      action: {
                        type: 'postback',
                        label: ' ',
                        data: JSON.stringify({ action: 'hospital_info' })
                      }
                    }
                  ]
                }
              ]
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'text',
              text: '',
              weight: 'bold',
              margin: 'xl',
              color: '#666666'
            },
            {
              type: 'box',
              layout: 'horizontal',
              margin: 'md',
              spacing: 'sm',
              contents: [
                {
                  type: 'button',
                  flex: 1,
                  height: 'sm',
                  style: 'link',
                  action: {
                    type: 'postback',
                    label: ' ',
                    data: JSON.stringify({ action: 'show_vaccine_menu' })
                  }
                },
                {
                  type: 'button',
                  flex: 1,
                  height: 'sm',
                  style: 'link',
                  action: {
                    type: 'postback',
                    label: ' ',
                    data: JSON.stringify({ action: 'check_status' })
                  }
                }
              ]
            }
          ]
        }
      }
    };
    break;

  case 'show_vaccine_menu':
    // Vaccine Menu 
    response = {
      type: 'flex',
      altText: ' - ',
      contents: {
        type: 'carousel',
        contents: Object.keys(vaccineConfig).map(vaccineType => {
          const vaccine = vaccineConfig[vaccineType];
          return {
            type: 'bubble',
            hero: {
              type: 'image',
              url: 'https://via.placeholder.com/300x200/1DB446/FFFFFF?text=' + vaccineType.toUpperCase(),
              size: 'full',
              aspectRatio: '20:13',
              aspectMode: 'cover'
            },
            body: {
              type: 'box',
              layout: 'vertical',
              contents: [
                {
                  type: 'text',
                  text: \` \${vaccineType.toUpperCase()}\`,
                  weight: 'bold',
                  size: 'xl',
                  color: '#1DB446'
                },
                {
                  type: 'text',
                  text: vaccine.info,
                  wrap: true,
                  margin: 'md',
                  size: 'sm'
                },
                {
                  type: 'box',
                  layout: 'vertical',
                  margin: 'lg',
                  spacing: 'sm',
                  contents: [
                    {
                      type: 'box',
                      layout: 'baseline',
                      spacing: 'sm',
                      contents: [
                        { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                        { type: 'text', text: vaccine.price, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                      ]
                    },
                    {
                      type: 'box',
                      layout: 'baseline',
                      spacing: 'sm',
                      contents: [
                        { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                        { type: 'text', text: vaccine.duration, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                      ]
                    }
                  ]
                }
              ]
            },
            footer: {
              type: 'box',
              layout: 'vertical',
              spacing: 'sm',
              contents: [
                {
                  type: 'button',
                  style: 'primary',
                  height: 'sm',
                  action: {
                    type: 'postback',
                    label: '',
                    data: JSON.stringify(vaccine.postback_data)
                  }
                },
                {
                  type: 'button',
                  style: 'secondary',
                  height: 'sm',
                  action: {
                    type: 'postback',
                    label: '',
                    data: JSON.stringify({ "action": "view_info", "type": vaccineType })
                  }
                }
              ]
            }
          };
        })
      }
    };
    break;

  case 'vaccine_info':
    const vaccineData = vaccineConfig[routing.vaccine_type];
    if (vaccineData) {
      response = {
        type: 'flex',
        altText: \` \${routing.vaccine_type}\`,
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: \` \${routing.vaccine_type.toUpperCase()}\`,
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: vaccineData.info,
                wrap: true,
                margin: 'md'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.price, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.age_requirement, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.duration, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'primary',
                action: {
                  type: 'postback',
                  label: '',
                  data: JSON.stringify(vaccineData.postback_data)
                }
              },
              {
                type: 'button',
                style: 'secondary',
                action: {
                  type: 'postback',
                  label: '',
                  data: JSON.stringify({ "action": "show_menu" })
                }
              }
            ]
          }
        }
      };
    }
    break;

  case 'book_appointment':
    // 
    const currentBooking = systemData.userBookings[userId] || {};
    
    if (collectedData.selectedDate) {
      //  ->  Time Picker
      response = {
        type: 'template',
        altText: '',
        template: {
          type: 'buttons',
          text: \` \${collectedData.selectedDate}\`,
          actions: [
            {
              type: 'datetimepicker',
              label: '9:00-12:00',
              data: JSON.stringify({
                action: 'confirm_booking',
                date: collectedData.selectedDate,
                time: '09:00-12:00',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'time'
            },
            {
              type: 'datetimepicker', 
              label: '13:00-16:00',
              data: JSON.stringify({
                action: 'confirm_booking',
                date: collectedData.selectedDate,
                time: '13:00-16:00',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'time'
            },
            {
              type: 'message',
              label: '',
              text: ''
            }
          ]
        }
      };
    } else {
      //  ->  Date Picker
      response = {
        type: 'template',
        altText: '',
        template: {
          type: 'buttons',
          text: " " + routing.vaccine_type.toUpperCase() + "\\n",
          actions: [
            { 
              type: 'datetimepicker', 
              label: '', 
              data: JSON.stringify({
                action: 'collect_date',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'date'
            },
            { 
              type: 'postback', 
              label: '', 
              data: JSON.stringify({
                action: 'view_info',
                type: routing.vaccine_type
              })
            },
            { 
              type: 'message', 
              label: '', 
              text: '' 
            }
          ]
        }
      };
    }
    break;

  case 'confirm_booking':
    // 
    if (collectedData.selectedDate && collectedData.selectedTime) {
      const bookingId = 'BK' + Date.now();
      systemData.userBookings[userId] = {
        id: bookingId,
        vaccineType: routing.vaccine_type || collectedData.vaccine_type,
        date: collectedData.selectedDate,
        time: collectedData.selectedTime,
        status: 'confirmed',
        createdAt: new Date().toISOString()
      };
      
      // Update available slots
      if (systemData.vaccineSlots[collectedData.selectedDate]) {
        systemData.vaccineSlots[collectedData.selectedDate].booked += 1;
      }
      
      response = {
        type: 'flex',
        altText: '',
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: ' !',
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: \`: \${bookingId}\`,
                margin: 'md',
                color: '#666666'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: (routing.vaccine_type || collectedData.vaccine_type).toUpperCase(), wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: collectedData.selectedDate, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: collectedData.selectedTime, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'primary',
                action: {
                  type: 'postback',
                  label: '',
                  data: JSON.stringify({ action: 'view_booking', booking_id: bookingId })
                }
              }
            ]
          }
        }
      };
    }
    break;

  case 'cancel_booking':
    const userBooking = systemData.userBookings[userId];
    if (userBooking) {
      response = {
        type: 'template',
        altText: '',
        template: {
          type: 'confirm',
          text: " " + userBooking.id + "?\\n: " + userBooking.vaccineType + "\\n: " + userBooking.date,
          actions: [
            {
              type: 'postback',
              label: '',
              data: JSON.stringify({ action: 'confirm_cancel', booking_id: userBooking.id })
            },
            {
              type: 'message',
              label: '',
              text: ''
            }
          ]
        }
      };
    } else {
      response = {
        type: 'text',
        text: ' '
      };
    }
    break;

  case 'check_status':
    const booking = systemData.userBookings[userId];
    if (booking) {
      response = {
        type: 'flex',
        altText: '',
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: '',
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: \`: \${booking.id}\`,
                margin: 'md',
                color: '#666666'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.vaccineType.toUpperCase(), wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.date, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.status === 'confirmed' ? ' ' : booking.status, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'secondary',
                action: {
                  type: 'postback',
                  label: '',
                  data: JSON.stringify({ action: 'cancel_booking' })
                }
              }
            ]
          }
        }
      };
    } else {
      response = {
        type: 'text',
        text: ' ',
        quickReply: {
          items: [
            {
              type: 'action',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'show_menu' })
              }
            }
          ]
        }
      };
    }
    break;

  case 'checkin':
    //  - 
    const checkinId = 'CI' + Date.now();
    systemData.checkinRecords[userId] = {
      id: checkinId,
      userId: userId,
      checkinTime: new Date().toISOString(),
      status: 'checked_in',
      appointment: systemData.userBookings[userId] || null
    };
    
    response = {
      type: 'flex',
      altText: '',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: "  " + (displayName || "") + "!",
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: \`: \${checkinId}\`,
              margin: 'md',
              color: '#666666'
            },
            {
              type: 'text',
              text: \`: \${new Date().toLocaleString('th-TH')}\`,
              margin: 'sm',
              color: '#666666',
              size: 'sm'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'text',
              text: '',
              margin: 'xl',
              color: '#FF5555',
              weight: 'bold'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'check_queue' })
              }
            }
          ]
        }
      }
    };
    break;

  case 'record_appointment':
    // /
    response = {
      type: 'flex',
      altText: '',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: ' ',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: '',
              wrap: true,
              margin: 'md'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'new_appointment_record' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'record_vaccine_name' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'view_records' })
              }
            }
          ]
        }
      }
    };
    break;

  case 'hospital_info':
    // 
    response = {
      type: 'flex',
      altText: '',
      contents: {
        type: 'bubble',
        hero: {
          type: 'image',
          url: 'https://via.placeholder.com/300x200/1DB446/FFFFFF?text=HOSPITAL',
          size: 'full',
          aspectRatio: '20:13',
          aspectMode: 'cover'
        },
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: ' ',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'box',
              layout: 'vertical',
              margin: 'xl',
              spacing: 'sm',
              contents: [
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: '123    10400', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: '- 8:00-20:00\\n- 9:00-17:00', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: '02-123-4567', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: '', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: ' 200 ', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                }
              ]
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'uri',
                label: '',
                uri: 'https://maps.google.com/?q='
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'uri',
                label: '',
                uri: 'tel:021234567'
              }
            }
          ]
        }
      }
    };
    break;

  case 'general_info':
    response = {
      type: 'flex',
      altText: ' - ',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: ' ',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: '',
              wrap: true,
              margin: 'md',
              color: '#666666'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: ' ',
                data: JSON.stringify({ action: 'checkin' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: ' /',
                data: JSON.stringify({ action: 'record_appointment' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: ' ',
                data: JSON.stringify({ action: 'hospital_info' })
              }
            },
            {
              type: 'button',
              style: 'link',
              action: {
                type: 'postback',
                label: '',
                data: JSON.stringify({ action: 'show_menu' })
              }
            }
          ]
        }
      }
    };
    break;

  default:
    response = {
      type: 'text',
      text: '  ',
      quickReply: {
        items: [
          {
            type: 'action',
            action: {
              type: 'postback',
              label: '',
              data: JSON.stringify({ action: 'show_menu' })
            }
          }
        ]
      }
    };
}

//  node context
try {
  $node.context().set(nodeKey, systemData);
} catch (e) {
  console.error('Cannot save data to context:', e);
}

$json.lineResponse = response;
$json.processedBy = 'rich-menu-response-generator';
$json.savedData = systemData.userBookings[userId] || null;

return $input.all();`},{id:"context-manager",name:"Context Manager",type:"context-manager",description:" user context  session state",replaces:["Multiple Set Nodes"],code:`// Context Manager -  User Session (Fixed)
const { routing, userId } = $json;

//  node context  getWorkflowStaticData  
const nodeKey = 'user_sessions_data';
let sessionData = {};

try {
  const existingData = $node.context().get(nodeKey);
  sessionData = existingData || {};
} catch (e) {
  sessionData = {};
}

//  User Context
if (!sessionData.userSessions) sessionData.userSessions = {};
if (!sessionData.userSessions[userId]) {
  sessionData.userSessions[userId] = {
    currentFlow: null,
    data: {},
    history: [],
    preferences: {},
    lastActivity: new Date().toISOString()
  };
}

const userSession = sessionData.userSessions[userId];

// Update Context based on AI Routing
switch(routing.action) {
  case 'book_appointment':
    userSession.currentFlow = 'booking';
    userSession.data.vaccineType = routing.vaccine_type;
    userSession.data.step = 'select_date';
    userSession.data.confidence = routing.intent_confidence;
    break;
    
  case 'cancel_booking':
    userSession.currentFlow = 'cancellation';
    userSession.data.step = 'confirm_cancel';
    break;
    
  case 'vaccine_info':
    userSession.currentFlow = 'information';
    userSession.data.viewedVaccines = userSession.data.viewedVaccines || [];
    if (!userSession.data.viewedVaccines.includes(routing.vaccine_type)) {
      userSession.data.viewedVaccines.push(routing.vaccine_type);
    }
    break;
    
  case 'check_status':
    userSession.currentFlow = 'status_check';
    break;
}

//  ( 10 )
userSession.history.push({
  input: $json.originalInput,
  routing: routing,
  timestamp: new Date().toISOString(),
  confidence: routing.intent_confidence
});

if (userSession.history.length > 10) {
  userSession.history = userSession.history.slice(-10);
}

// Update last activity
userSession.lastActivity = new Date().toISOString();

//  old sessions ( 24 )
const now = new Date();
Object.keys(sessionData.userSessions).forEach(sessionUserId => {
  const session = sessionData.userSessions[sessionUserId];
  const lastActivity = new Date(session.lastActivity);
  const hoursDiff = (now.getTime() - lastActivity.getTime()) / (1000 * 60 * 60);
  
  if (hoursDiff > 24) {
    delete sessionData.userSessions[sessionUserId];
  }
});

// Set user preferences based on behavior
if (userSession.history.length >= 3) {
  const recentActions = userSession.history.slice(-3).map(h => h.routing.action);
  const mostCommonAction = recentActions.reduce((a, b, _, arr) => 
    arr.filter(v => v === a).length >= arr.filter(v => v === b).length ? a : b
  );
  userSession.preferences.preferredAction = mostCommonAction;
}

// Determine next action
let nextAction = 'continue';
if (routing.action === 'book_appointment' && routing.intent_confidence < 0.6) {
  nextAction = 'clarify_vaccine_type';
} else if (routing.action === 'general_info' && routing.intent_confidence < 0.5) {
  nextAction = 'show_menu';
} else if (userSession.currentFlow === 'booking' && userSession.data.step === 'select_date') {
  nextAction = 'handle_date_selection';
}

//  session  context
try {
  $node.context().set(nodeKey, sessionData);
} catch (e) {
  console.error('Cannot save session data:', e);
}

$json.userSession = userSession;
$json.nextAction = nextAction;
$json.sessionStats = {
  totalUsers: Object.keys(sessionData.userSessions).length,
  currentUserHistory: userSession.history.length,
  userPreferences: userSession.preferences
};

return $input.all();`}],v={name:"Smart Routing Vaccine Booking Workflow (HTTP Version)",nodes:[{parameters:{httpMethod:"POST",path:"vaccine-webhook",options:{}},id:"webhook-node",name:"Webhook",type:"n8n-nodes-base.webhook",typeVersion:1,position:[240,300],webhookId:"webhook-id"},{parameters:{jsCode:u[0].code},id:"input-processor-node",name:"Input Processor",type:"n8n-nodes-base.code",typeVersion:2,position:[460,300]},{parameters:{url:"https://api.openai.com/v1/chat/completions",method:"POST",authentication:"predefinedCredentialType",nodeCredentialType:"openAiApi",headers:{"Content-Type":"application/json"},body:"={{ JSON.stringify($json.openai_request) }}",options:{timeout:15e3,response:{response:{neverError:!0,responseFormat:"json"}},redirect:{redirect:{followRedirect:!1,maxRedirect:0}}}},id:"openai-http-node",name:"OpenAI HTTP Request (with Credentials)",type:"n8n-nodes-base.httpRequest",typeVersion:4,position:[680,300]},{parameters:{jsCode:`// AI Response Processor with Robust Error Handling
try {
  const httpResponse = $json;
  let routing = {};
  
  //  HTTP status  response structure
  if (httpResponse.statusCode && httpResponse.statusCode !== 200) {
    console.warn('OpenAI API returned non-200 status:', httpResponse.statusCode);
    throw new Error(\`API returned status: \${httpResponse.statusCode}\`);
  }
  
  //  response structure
  if (!httpResponse.choices || !httpResponse.choices[0] || !httpResponse.choices[0].message) {
    throw new Error('Invalid OpenAI API response format');
  }
  
  // Parse AI response with validation
  try {
    routing = JSON.parse(httpResponse.choices[0].message.content);
  } catch (parseError) {
    //  JSON   fallback
    routing = {
      action: 'general_info',
      vaccine_type: 'covid',
      intent_confidence: 0.3,
      required_data: [],
      response_type: 'text'
    };
  }
  
  // Validate routing object
  if (!routing.action) {
    routing.action = 'general_info';
  }
  if (!routing.intent_confidence || routing.intent_confidence < 0 || routing.intent_confidence > 1) {
    routing.intent_confidence = 0.5;
  }
  
  // Combine with previous data
  $json.routing = routing;
  $json.userId = $('Input Processor').item.json.userId;
  $json.originalInput = $('Input Processor').item.json.originalInput;
  $json.userMessage = $('Input Processor').item.json.userMessage;
  $json.timestamp = $('Input Processor').item.json.timestamp;
  $json.apiSuccess = true;
  
} catch (error) {
  // Error handling -  fallback routing
  console.error('OpenAI API Error:', error);
  
  $json.routing = {
    action: 'general_info',
    vaccine_type: 'covid',
    intent_confidence: 0.2,
    required_data: [],
    response_type: 'text',
    error: true
  };
  $json.userId = $('Input Processor').item.json.userId;
  $json.originalInput = $('Input Processor').item.json.originalInput;
  $json.userMessage = $('Input Processor').item.json.userMessage;
  $json.timestamp = $('Input Processor').item.json.timestamp;
  $json.apiSuccess = false;
  $json.errorMessage = error.message;
}

return $input.all();`},id:"ai-response-processor-node",name:"AI Response Processor",type:"n8n-nodes-base.code",typeVersion:2,position:[900,300]},{parameters:{jsCode:u[2].code},id:"context-manager-node",name:"Context Manager",type:"n8n-nodes-base.code",typeVersion:2,position:[1120,300]},{parameters:{jsCode:u[1].code},id:"response-generator-node",name:"Dynamic Response Generator",type:"n8n-nodes-base.code",typeVersion:2,position:[1340,300]},{parameters:{authentication:"lineNotifyOAuth2Api",resource:"message",operation:"send",message:"={{ $json.lineResponse }}"},id:"line-response-node",name:"LINE Response",type:"n8n-nodes-base.line",typeVersion:1,position:[1560,300]}],connections:{Webhook:{main:[[{node:"Input Processor",type:"main",index:0}]]},"Input Processor":{main:[[{node:"OpenAI HTTP Request (with Credentials)",type:"main",index:0}]]},"OpenAI HTTP Request (with Credentials)":{main:[[{node:"AI Response Processor",type:"main",index:0}]]},"AI Response Processor":{main:[[{node:"Context Manager",type:"main",index:0}]]},"Context Manager":{main:[[{node:"Dynamic Response Generator",type:"main",index:0}]]},"Dynamic Response Generator":{main:[[{node:"LINE Response",type:"main",index:0}]]}},active:!1,settings:{executionOrder:"v1"},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),id:"smart-routing-workflow-http",tags:[]};u.forEach(b=>{b.workflowJSON=v}),a(u)},c=async(l,u)=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(l);else{const v=document.createElement("textarea");v.value=l,v.style.position="fixed",v.style.left="-999999px",v.style.top="-999999px",document.body.appendChild(v),v.focus(),v.select(),document.execCommand("copy"),v.remove()}r(u),setTimeout(()=>r(null),2e3),i({title:"",description:" clipboard "})}catch(v){console.error("Failed to copy: ",v),i({title:"",description:" ",variant:"destructive"})}},d=(l,u)=>{const v=new Blob([l],{type:"text/javascript"}),b=URL.createObjectURL(v),g=document.createElement("a");g.href=b,g.download=`${u}.js`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(b)},x=l=>{const u=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),v=URL.createObjectURL(u),b=document.createElement("a");b.href=v,b.download="smart-routing-workflow.json",document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(v),i({title:"",description:" workflow JSON   import  n8n "})},h=l=>{switch(l){case"ai-router":return e.jsx(us,{className:"w-4 h-4"});case"response-generator":return e.jsx(va,{className:"w-4 h-4"});case"context-manager":return e.jsx($e,{className:"w-4 h-4"});default:return e.jsx(Fl,{className:"w-4 h-4"})}},f=l=>{switch(l){case"ai-router":return"bg-blue-500";case"response-generator":return"bg-green-500";case"context-manager":return"bg-purple-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(us,{className:"w-5 h-5"}),"Smart Routing Generator"]}),e.jsx(ue,{children:" AI Smart Routing  Switch nodes  workflow"})]}),e.jsx(R,{children:t.length===0?e.jsx(le,{children:e.jsx(me,{children:" workflow  nodes  Smart Routing "})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",t.filter(l=>l.type==="n8n-nodes-base.switch").length," Switch nodes "]})}),e.jsxs(I,{onClick:o,className:"flex items-center gap-2",children:[e.jsx(va,{className:"w-4 h-4"})," Smart Routing"]})]}),s.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(le,{className:"border-green-200 bg-green-50",children:[e.jsx(ee,{className:"w-4 h-4 text-green-600"}),e.jsx(me,{className:"text-green-700",children:" Smart Routing !  Workflow JSON  import  n8n "})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>x(s[0].workflowJSON),className:"flex items-center gap-2",variant:"default",children:[e.jsx(Ol,{className:"w-4 h-4"})," Complete Workflow (JSON)"]}),e.jsxs(I,{onClick:()=>c(JSON.stringify(s[0].workflowJSON,null,2),"workflow-json"),variant:"outline",className:"flex items-center gap-2",children:[n==="workflow-json"?e.jsx(ee,{className:"w-4 h-4"}):e.jsx(Ue,{className:"w-4 h-4"}),n==="workflow-json"?"":" JSON"]})]})]})]})})]}),s.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:s.map(l=>e.jsxs(A,{className:"border-l-4",style:{borderLeftColor:f(l.type).replace("bg-","")},children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-md text-white ${f(l.type)}`,children:h(l.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx(z,{className:"text-lg",children:l.name}),e.jsx(ue,{className:"text-sm mt-1",children:l.description})]})]})}),e.jsxs(R,{className:"pt-0 space-y-3",children:[l.replaces.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.replaces.map((u,v)=>e.jsx(J,{variant:"outline",className:"text-xs",children:u},v))})]}),e.jsx(Ae,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"font-medium text-sm",children:"Code  n8n:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>c(l.code,l.id),className:"flex items-center gap-1",children:[n===l.id?e.jsx(ee,{className:"w-3 h-3"}):e.jsx(Ue,{className:"w-3 h-3"}),n===l.id?"":""]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>d(l.code,l.id),className:"flex items-center gap-1",children:[e.jsx(We,{className:"w-3 h-3"}),""]})]})]}),e.jsx(Ot,{value:l.code,readOnly:!0,className:"font-mono text-xs h-32 bg-muted"})]})]})]},l.id))}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"w-5 h-5"})," Smart Routing"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"1.  Environment Variables"}),e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsx("code",{className:"text-sm",children:"OPENAI_API_KEY=your_openai_api_key"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"2.  Code Nodes"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:'  Code node  "AI Smart Router"'}),e.jsx("li",{children:'  Code node  "Dynamic Response Generator"'}),e.jsx("li",{children:'  Code node  "Context Manager"'})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"3.  Nodes "}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" Smart Router  Database Nodes "}),e.jsx("li",{children:" Response Generator  LINE Response "}),e.jsx("li",{children:" Context Manager  HTTP Request "}),e.jsx("li",{children:"  Merge Node  flow "})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"4.  Switch Nodes "}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"  Switch nodes "}),e.jsx("li",{children:"  Static response nodes"}),e.jsx("li",{children:"  workflow "})]})]})]}),e.jsxs(le,{children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:"Integration  Flow :"}),"  Database, HTTP Request,  LINE nodes   Merge Node  Switch nodes "]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-md",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"  Migration :"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("li",{children:["1. ",e.jsx("strong",{children:"Backup"})," workflow "]}),e.jsxs("li",{children:["2. ",e.jsx("strong",{children:"Import"})," Smart Routing workflow "]}),e.jsxs("li",{children:["3. ",e.jsx("strong",{children:"Test"}),"  development environment"]}),e.jsxs("li",{children:["4. ",e.jsx("strong",{children:"Connect"}),"  nodes "]}),e.jsxs("li",{children:["5. ",e.jsx("strong",{children:"Remove"})," Switch nodes "]})]})]})]})]})]})]})},gu=()=>{const[t,s]=m.useState(null),[a,n]=m.useState([]),[r,i]=m.useState(""),[o,c]=m.useState(!1),d=u=>{const v=[],b=new Set(u.nodes.map(k=>k.id)),g=new Set;Object.entries(u.connections).forEach(([k,B])=>{B.main&&B.main.forEach((C,j)=>{Array.isArray(C)&&C.forEach(w=>{g.add(k),g.add(w.node),b.has(w.node)||v.push({type:"error",title:"Connection  Node ",description:`Node "${k}"  node "${w.node}"  workflow`,nodeId:k,solution:" connection  node "})})})}),u.nodes.forEach(k=>{!g.has(k.id)&&k.type!=="n8n-nodes-base.webhook"&&v.push({type:"warning",title:"Node  (Isolated)",description:`Node "${k.name}" (${k.id})  node `,nodeId:k.id,solution:" node  workflow "})});const p=u.nodes.filter(k=>k.type==="n8n-nodes-base.webhook"),y=u.nodes.filter(k=>k.type==="n8n-nodes-base.switch"),N=u.nodes.filter(k=>k.type==="n8n-nodes-base.httpRequest");y.forEach(k=>{var C,j,w,M,F,U,H;const B=u.connections[k.id];if(B&&B.main){B.main.filter(Y=>Y&&Y.length>0).length;const P=((w=(j=(C=k.parameters)==null?void 0:C.conditions)==null?void 0:j.conditions)==null?void 0:w.length)||((U=(F=(M=k.parameters)==null?void 0:M.rules)==null?void 0:F.rules)==null?void 0:U.length)||0;!(B.main.length>P&&((H=B.main[B.main.length-1])==null?void 0:H.length)>0)&&P>0&&v.push({type:"warning",title:"Switch Node  Fallback Path",description:`Switch node "${k.name}"  ${P}   fallback path `,nodeId:k.id,solution:" fallback path  output  Switch node "})}}),N.forEach(k=>{var w,M,F,U,H,P,L;const B=u.connections[k.id],C=(B==null?void 0:B.main)&&B.main.length>1&&((w=B.main[1])==null?void 0:w.length)>0,j=((F=(M=k.parameters)==null?void 0:M.url)==null?void 0:F.includes("api.line.me"))||((H=(U=k.parameters)==null?void 0:U.url)==null?void 0:H.includes("openai.com"))||((P=k.name)==null?void 0:P.toLowerCase().includes("line"))||((L=k.name)==null?void 0:L.toLowerCase().includes("ai"));C||v.push({type:j?"error":"warning",title:"HTTP Request  Error Handling",description:`HTTP node "${k.name}" ${j?"(Critical API)":""}  error  request `,nodeId:k.id,solution:" error output  error handling nodes  Set node  log  HTTP node "})});const _=p.length>0,D=u.nodes.filter(k=>{var B,C;return k.name.toLowerCase().includes("line")||k.type==="n8n-nodes-base.httpRequest"&&((C=(B=k.parameters)==null?void 0:B.url)==null?void 0:C.includes("api.line.me"))});return _&&D.length===0&&v.push({type:"error",title:" LINE Response Node",description:"Chatbot workflow  node  LINE API",solution:" HTTP Request node  https://api.line.me/v2/bot/message/reply  reply token "}),D.forEach(k=>{var C,j,w,M;((j=(C=k.parameters)==null?void 0:C.bodyParametersJson)==null?void 0:j.includes("replyToken"))||((M=(w=k.parameters)==null?void 0:w.body)==null?void 0:M.includes("replyToken"))||JSON.stringify(k.parameters).includes("replyToken")||v.push({type:"error",title:"LINE Node  Reply Token",description:`LINE response node "${k.name}"  reply token  webhook`,nodeId:k.id,solution:' reply token  webhook data  {{ $json["events"][0]["replyToken"] }}'})}),u.nodes.filter(k=>k.type.includes("langchain")||k.type.includes("openai")||k.name.toLowerCase().includes("ai")||k.name.toLowerCase().includes("gpt")).forEach(k=>{var j,w,M,F,U,H;((j=k.parameters)==null?void 0:j.prompt)||((w=k.parameters)==null?void 0:w.text)||((M=k.parameters)==null?void 0:M.message)||v.push({type:"warning",title:"AI Agent  Prompt",description:`AI node "${k.name}"  prompt  instruction `,nodeId:k.id,solution:" prompt   role, context  instruction  AI Agent"}),!(((F=k.parameters)==null?void 0:F.apiKey)||k.credentials||((U=k.parameters)==null?void 0:U.authentication)||((H=k.parameters)==null?void 0:H.model))&&(k.type.includes("openai")||k.type.includes("langchain"))&&v.push({type:"error",title:"AI Agent  API Key",description:`AI node "${k.name}"  API key  credentials  AI service`,nodeId:k.id,solution:" API key  credentials  parameters  node  AI service "})}),u.nodes.filter(k=>k.type==="n8n-nodes-base.googleSheets").forEach(k=>{var B;(B=k.parameters)!=null&&B.documentId||v.push({type:"error",title:"Google Sheets  Document ID",description:`Google Sheets node "${k.name}"  spreadsheet `,nodeId:k.id,solution:" Google Sheets document ID  sheet name "})}),v},x=()=>{c(!0);try{const u=JSON.parse(r);s(u);const v=d(u);n(v)}catch{n([{type:"error",title:"JSON Format ",description:" parse JSON   JSON",solution:" syntax JSON    comma, brackets  quotes"}])}c(!1)},h=u=>u.includes("webhook")?e.jsx(ot,{className:"w-4 h-4"}):u.includes("switch")?e.jsx($e,{className:"w-4 h-4"}):u.includes("langchain")?e.jsx(va,{className:"w-4 h-4"}):u.includes("httpRequest")?e.jsx(ot,{className:"w-4 h-4"}):u.includes("googleSheets")?e.jsx(Gt,{className:"w-4 h-4"}):e.jsx($e,{className:"w-4 h-4"}),f=u=>u.includes("webhook")?"bg-node-webhook":u.includes("switch")?"bg-node-switch":u.includes("langchain")?"bg-node-ai":u.includes("httpRequest")?"bg-node-http":u.includes("googleSheets")?"bg-node-function":"bg-muted",l=u=>{switch(u){case"error":return e.jsx(Te,{className:"w-4 h-4 text-workflow-error"});case"warning":return e.jsx(Ye,{className:"w-4 h-4 text-workflow-warning"});case"info":return e.jsx(Wl,{className:"w-4 h-4 text-workflow-info"});default:return e.jsx(ee,{className:"w-4 h-4 text-workflow-success"})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-workflow-primary to-workflow-info bg-clip-text text-transparent",children:"n8n Workflow Analyzer"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:" n8n workflow  "})]}),e.jsxs(A,{className:"shadow-workflow",children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"})," Workflow JSON"]}),e.jsx(ue,{children:" JSON  n8n workflow "})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsx(Ot,{placeholder:" n8n workflow JSON ...",value:r,onChange:u=>i(u.target.value),className:"min-h-[200px] font-mono text-sm"}),e.jsx(I,{onClick:x,disabled:!r.trim()||o,className:"w-full",children:o?"...":" Workflow"})]})]}),t&&e.jsxs(mt,{defaultValue:"issues",className:"space-y-4",children:[e.jsxs(qe,{className:"grid w-full grid-cols-4",children:[e.jsxs(te,{value:"issues",children:[" (",a.length,")"]}),e.jsx(te,{value:"overview",children:" "}),e.jsx(te,{value:"smart-routing",children:"Smart Routing"}),e.jsx(te,{value:"troubleshooting",children:""})]}),e.jsx(ne,{value:"issues",className:"space-y-4",children:a.length===0?e.jsxs(le,{className:"border-workflow-success",children:[e.jsx(ee,{className:"w-4 h-4 text-workflow-success"}),e.jsx(me,{className:"text-workflow-success",children:" workflow  "})]}):e.jsx("div",{className:"space-y-4",children:a.map((u,v)=>e.jsxs(A,{className:`border-l-4 ${u.type==="error"?"border-l-workflow-error":u.type==="warning"?"border-l-workflow-warning":"border-l-workflow-info"}`,children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[l(u.type),e.jsxs("div",{className:"flex-1",children:[e.jsx(z,{className:"text-lg",children:u.title}),u.nodeId&&e.jsxs(J,{variant:"outline",className:"mt-1",children:["Node: ",u.nodeId.slice(0,8),"..."]})]}),e.jsx(J,{variant:u.type==="error"?"destructive":u.type==="warning"?"secondary":"default",children:u.type==="error"?"":u.type==="warning"?"":""})]})}),e.jsxs(R,{className:"pt-0 space-y-3",children:[e.jsx("p",{className:"text-muted-foreground",children:u.description}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-workflow-primary",children:" :"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded-md",children:u.solution})]})]})]},v))})}),e.jsxs(ne,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(A,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:" Nodes"})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-primary",children:t.nodes.length})})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:""})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-info",children:Object.keys(t.connections).length})})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:""})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-error",children:a.filter(u=>u.type==="error").length})})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:""})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-warning",children:a.filter(u=>u.type==="warning").length})})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:" Nodes"})}),e.jsx(R,{children:e.jsx("div",{className:"space-y-2",children:t.nodes.map(u=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-md ${f(u.type)}`,children:h(u.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:u.type})]}),e.jsxs(J,{variant:"outline",className:"font-mono text-xs",children:[u.id.slice(0,8),"..."]})]},u.id))})})]})]}),e.jsx(ne,{value:"smart-routing",className:"space-y-4",children:e.jsx(fu,{workflowNodes:(t==null?void 0:t.nodes)||[]})}),e.jsx(ne,{value:"troubleshooting",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"}),""]}),e.jsx(ue,{children:" workflow "})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[a.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:" workflow  :"}),a.map((u,v)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l(u.type),e.jsx("h4",{className:"font-semibold",children:u.title})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.description}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:" :"}),e.jsx("p",{className:"text-sm",children:u.solution})]}),u.nodeId&&e.jsxs(J,{variant:"outline",className:"text-xs",children:["Node: ",u.nodeId.slice(0,8),"..."]})]},v))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold text-green-700",children:"Workflow !"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" workflow  "})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsx("h4",{className:"font-semibold mb-3",children:" Checklist :"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:" workflow "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:" API keys  credentials"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:" error scenarios"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:" performance  rate limits"})]})]})]})]})})]})})]})]})},vu=()=>{const[t,s]=m.useState("overview"),{toast:a}=xe(),n=[{id:"webhook",name:"LINE Webhook",type:"trigger",description:" LINE Bot  Rich Menu",implementation:`// Webhook Configuration
HTTP POST: https://your-n8n.domain/webhook/line-bot
Method: POST
Content-Type: application/json

// Rich Menu Configuration
{
  "areas": [
    {
      "bounds": {"x": 0, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback",
        "data": "{\\"action\\":\\"register\\"}",
        "displayText": ""
      }
    },
    {
      "bounds": {"x": 834, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback", 
        "data": "{\\"action\\":\\"show_vaccine_menu\\"}",
        "displayText": ""
      }
    },
    {
      "bounds": {"x": 1667, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback",
        "data": "{\\"action\\":\\"check_booking\\"}",
        "displayText": ""
      }
    }
  ]
}`,connections:["user-validator"],icon:ot,color:"bg-blue-500"},{id:"user-validator",name:"User Data Validator",type:"logic",description:" LINE Profile",implementation:`// User Validation  Profile Fetching
const input = $json.body?.events?.[0];
const userId = input?.source?.userId;
const eventType = input?.type;

if (!userId) {
  throw new Error('Invalid webhook: No userId found');
}

//   Environment Variables  context
const CHANNEL_ACCESS_TOKEN = process.env.LINE_CHANNEL_ACCESS_TOKEN;
const SPREADSHEET_ID = process.env.GOOGLE_SPREADSHEET_ID;
const GOOGLE_ACCESS_TOKEN = process.env.GOOGLE_ACCESS_TOKEN;

//  LINE Profile
let userProfile = null;
try {
  const profileResponse = await $http.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + CHANNEL_ACCESS_TOKEN
    }
  });
  
  userProfile = profileResponse.body;
} catch (error) {
  console.log("Profile fetch error:", error);
  userProfile = { displayName: "", userId: userId };
}

// Helper function  Google Sheets
async function checkUserInSheets(userId, spreadsheetId, accessToken) {
  const response = await $http.request({
    method: 'GET',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${spreadsheetId}/values/Users:A:G\`,
    headers: {
      'Authorization': 'Bearer ' + accessToken
    }
  });
  
  const rows = response.body.values || [];
  
  for (let i = 1; i < rows.length; i++) {
    if (rows[i][0] === userId) {
      return {
        exists: true,
        row: i + 1,
        data: {
          userId: rows[i][0],
          name: rows[i][1],
          phone: rows[i][2],
          email: rows[i][3],
          dateOfBirth: rows[i][4],
          address: rows[i][5],
          emergencyContact: rows[i][6]
        }
      };
    }
  }
  
  return { exists: false };
}

const existingUser = await checkUserInSheets(userId, SPREADSHEET_ID, GOOGLE_ACCESS_TOKEN);

$json.userId = userId;
$json.userProfile = userProfile;
$json.existingUser = existingUser;
$json.input = input;
$json.timestamp = new Date().toISOString();

return $input.all();`,connections:["smart-router"],icon:Me,color:"bg-green-500"},{id:"smart-router",name:"AI Smart Router",type:"logic",description:" intent ",implementation:`// AI Smart Router with Rich Menu Support
const { input, userProfile, existingUser } = $json;

let action = 'unknown';
let collectedData = {};

//  Postback Data
if (input.postback?.data) {
  try {
    const postbackData = JSON.parse(input.postback.data);
    action = postbackData.action;
    collectedData = postbackData;
  } catch {
    action = input.postback.data;
  }
}

//  text message
const userMessage = input.message?.text || '';

// AI Routing Logic
const routingPrompt = \`
 Smart Router 
Input: "\${userMessage}"
Action: "\${action}"
User Profile: \${JSON.stringify(userProfile)}
Existing User: \${!!existingUser}

 JSON:
{
  "route": "register|vaccine_menu|booking|status_check|appointment_reminder",
  "vaccine_type": "covid|flu|hepatitis|hpv|other",
  "required_fields": ["name", "phone", "id_card", "vaccine_type", "date", "time"],
  "next_step": "collect_data|show_calendar|confirm|complete",
  "is_returning_user": \${!!existingUser}
}
\`;

// OpenAI Request
$json.openai_request = {
  model: 'gpt-4',
  messages: [{ role: 'user', content: routingPrompt }],
  temperature: 0.1
};

$json.action = action;
$json.userMessage = userMessage;
$json.collectedData = collectedData;

return $input.all();`,connections:["user-registration","vaccine-booking"],icon:$e,color:"bg-purple-500"},{id:"user-registration",name:"User Registration",type:"action",description:"",implementation:`// User Registration Process
const { userProfile, routing } = $json;

if (routing.route === 'register') {
  // 
  const userData = {
    userId: userProfile.userId,
    displayName: userProfile.displayName,
    pictureUrl: userProfile.pictureUrl || '',
    registeredAt: new Date().toISOString(),
    status: 'active',
    vaccineHistory: [],
    appointments: []
  };

  //  Google Sheets
  const sheetData = [
    userData.userId,
    userData.displayName,
    userData.pictureUrl,
    userData.registeredAt,
    userData.status,
    '[]', // vaccineHistory
    '[]'  // appointments
  ];

  await saveToGoogleSheets('Users', sheetData);

  // Response 
  $json.response = {
    type: 'text',
    text: \` \${userData.displayName}! 
    


 
 
 

 "" \`
  };

  $json.userData = userData;
}

return $input.all();`,connections:["response-sender"],icon:ct,color:"bg-teal-500"},{id:"vaccine-booking",name:"Vaccine Booking System",type:"action",description:"",implementation:`// Vaccine Booking with Multi-dose Support
const { routing, userProfile, collectedData } = $json;

const vaccineTypes = {
  covid: { doses: 2, interval: 21, name: '-19' },
  flu: { doses: 1, interval: 0, name: '' },
  hepatitis: { doses: 3, interval: 30, name: '' },
  hpv: { doses: 2, interval: 60, name: 'HPV' }
};

if (routing.route === 'vaccine_menu') {
  // 
  $json.response = {
    type: 'flex',
    altText: '',
    contents: {
      type: 'carousel',
      contents: Object.keys(vaccineTypes).map(type => ({
        type: 'bubble',
        hero: {
          type: 'image',
          url: \`https://via.placeholder.com/300x200/42A5F5/FFFFFF?text=\${vaccineTypes[type].name}\`,
          size: 'full'
        },
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: vaccineTypes[type].name,
              weight: 'bold',
              size: 'xl'
            },
            {
              type: 'text',
              text: \`: \${vaccineTypes[type].doses}\`,
              margin: 'md'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          contents: [{
            type: 'button',
            action: {
              type: 'postback',
              label: '',
              data: JSON.stringify({ 
                action: 'book_vaccine', 
                vaccine_type: type 
              })
            }
          }]
        }
      }))
    }
  };
}

if (routing.route === 'booking' && collectedData.vaccine_type) {
  const vaccine = vaccineTypes[collectedData.vaccine_type];
  
  // 
  const appointment = {
    appointmentId: generateId(),
    userId: userProfile.userId,
    vaccineType: collectedData.vaccine_type,
    vaccineName: vaccine.name,
    doseNumber: 1,
    totalDoses: vaccine.doses,
    appointmentDate: collectedData.date,
    appointmentTime: collectedData.time,
    status: 'confirmed',
    createdAt: new Date().toISOString()
  };

  //  ()
  if (vaccine.doses > 1) {
    const nextDate = new Date(collectedData.date);
    nextDate.setDate(nextDate.getDate() + vaccine.interval);
    appointment.nextAppointment = nextDate.toISOString().split('T')[0];
  }

  //  Google Sheets
  await saveAppointmentToSheets(appointment);

  $json.appointment = appointment;
  $json.response = {
    type: 'text',
    text: \` !

 :
 : \${vaccine.name}
 : 1/\${vaccine.doses}
 : \${collectedData.date}
 : \${collectedData.time}

\${vaccine.doses > 1 ? \` : \${appointment.nextAppointment}\` : ''}

 
  1 \`
  };
}

return $input.all();`,connections:["calendar-scheduler","response-sender"],icon:Ce,color:"bg-red-500"},{id:"calendar-scheduler",name:"Google Calendar Scheduler",type:"calendar",description:" Google Calendar ",implementation:`// Google Calendar Integration with Auto Reminders
const { appointment } = $json;

if (appointment) {
  //  Google Calendar
  const CALENDAR_ID = 'primary'; //  calendar ID 
  
  //  Event  Google Calendar
  const eventData = {
    summary: \` \${appointment.vaccineName} -  \${appointment.doseNumber}/\${appointment.totalDoses}\`,
    description: \` 
    
 : \${appointment.userProfile?.displayName || ''}
 : \${appointment.vaccineName}
 : \${appointment.doseNumber}  \${appointment.totalDoses} 
 LINE User ID: \${appointment.userId}
 Appointment ID: \${appointment.appointmentId}

 : 
\${appointment.nextAppointment ? \` : \${appointment.nextAppointment}\` : ''}\`,
    
    start: {
      dateTime: \`\${appointment.appointmentDate}T\${appointment.appointmentTime}:00+07:00\`,
      timeZone: 'Asia/Bangkok'
    },
    end: {
      dateTime: \`\${appointment.appointmentDate}T\${String(parseInt(appointment.appointmentTime.split(':')[0]) + 1).padStart(2, '0')}:\${appointment.appointmentTime.split(':')[1]}:00+07:00\`,
      timeZone: 'Asia/Bangkok'
    },
    
    // 
    reminders: {
      useDefault: false,
      overrides: [
        { method: 'email', minutes: 24 * 60 }, // 1 
        { method: 'popup', minutes: 60 },      // 1 
        { method: 'email', minutes: 30 }       // 30 
      ]
    },
    
    //  Attendee
    attendees: [
      {
        email: 'vaccine.admin@hospital.com',
        displayName: 'Vaccine Administrator',
        responseStatus: 'accepted'
      }
    ],
    
    // 
    status: 'confirmed',
    transparency: 'opaque',
    visibility: 'private',
    
    // Extended Properties 
    extendedProperties: {
      private: {
        lineUserId: appointment.userId,
        appointmentId: appointment.appointmentId,
        vaccineType: appointment.vaccineType,
        doseNumber: appointment.doseNumber.toString(),
        totalDoses: appointment.totalDoses.toString(),
        isVaccineAppointment: 'true'
      }
    }
  };

  //  Event  Google Calendar
  const calendarResponse = await $http.request({
    method: 'POST',
    url: \`https://www.googleapis.com/calendar/v3/calendars/\${CALENDAR_ID}/events\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: eventData
  });

  //  Event ID 
  const calendarEvent = calendarResponse.body;
  appointment.calendarEventId = calendarEvent.id;
  appointment.calendarEventUrl = calendarEvent.htmlLink;

  //  Scheduled Reminder  n8n ( Cron Trigger)
  const reminderDate = new Date(appointment.appointmentDate);
  reminderDate.setDate(reminderDate.getDate() - 1); // 1 
  reminderDate.setHours(9, 0, 0, 0); //  9:00 .

  const reminderData = {
    reminderId: generateId(),
    scheduledFor: reminderDate.toISOString(),
    userId: appointment.userId,
    appointmentId: appointment.appointmentId,
    calendarEventId: calendarEvent.id,
    message: \` 

 (\${appointment.appointmentDate}) :

 : \${appointment.vaccineName}
 : \${appointment.doseNumber}/\${appointment.totalDoses}
 : \${appointment.appointmentTime} .
 : /

 :
 
  ()
 

   24 
  "" \`,
    type: 'appointment_reminder',
    status: 'pending'
  };

  //  Reminder Schedule
  await saveReminderToSheets(reminderData);

  //   Event  ( Tentative)
  if (appointment.nextAppointment) {
    const nextEventData = {
      ...eventData,
      summary: \` \${appointment.vaccineName} -  \${appointment.doseNumber + 1}/\${appointment.totalDoses} ()\`,
      description: \`  ()
      
 : \${appointment.userProfile?.displayName || ''}
 : \${appointment.vaccineName}
 : \${appointment.doseNumber + 1}  \${appointment.totalDoses} 
 : 

 \`,
      start: {
        dateTime: \`\${appointment.nextAppointment}T09:00:00+07:00\`,
        timeZone: 'Asia/Bangkok'
      },
      end: {
        dateTime: \`\${appointment.nextAppointment}T10:00:00+07:00\`,
        timeZone: 'Asia/Bangkok'
      },
      status: 'tentative', // 
      transparency: 'transparent'
    };

    const nextCalendarResponse = await $http.request({
      method: 'POST',
      url: \`https://www.googleapis.com/calendar/v3/calendars/\${CALENDAR_ID}/events\`,
      headers: {
        'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
        'Content-Type': 'application/json'
      },
      body: nextEventData
    });

    //  Reminder 
    const nextReminderDate = new Date(appointment.nextAppointment);
    nextReminderDate.setDate(nextReminderDate.getDate() - 7); // 1 
    nextReminderDate.setHours(10, 0, 0, 0);

    const nextReminderData = {
      reminderId: generateId(),
      scheduledFor: nextReminderDate.toISOString(),
      userId: appointment.userId,
      appointmentId: appointment.appointmentId,
      relatedAppointmentId: appointment.appointmentId,
      calendarEventId: nextCalendarResponse.body.id,
      message: \` 

 1 !

 : \${appointment.vaccineName}
 : \${appointment.doseNumber + 1}/\${appointment.totalDoses}
 : \${appointment.nextAppointment}

  ""
 \`,
      type: 'next_dose_reminder',
      status: 'pending'
    };

    await saveReminderToSheets(nextReminderData);
    
    appointment.nextCalendarEventId = nextCalendarResponse.body.id;
  }

  //  appointment  Calendar Event IDs
  await updateAppointmentInSheets(appointment);

  $json.calendarEvent = calendarEvent;
  $json.reminderScheduled = true;
  $json.calendarCreated = true;
}

// Helper Functions
function generateId() {
  return Math.random().toString(36).substr(2, 9) + Date.now().toString(36);
}

async function saveReminderToSheets(reminderData) {
  const sheetData = [
    reminderData.reminderId,
    reminderData.scheduledFor,
    reminderData.userId,
    reminderData.appointmentId,
    reminderData.calendarEventId || '',
    reminderData.message,
    reminderData.type,
    reminderData.status,
    new Date().toISOString()
  ];

  return await $http.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${SPREADSHEET_ID}/values/Reminders:append\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [sheetData],
      valueInputOption: 'RAW'
    }
  });
}

async function updateAppointmentInSheets(appointment) {
  //  appointment  calendar event IDs
  //  Google Sheets API  appointmentId
}

return $input.all();`,connections:["google-sheets"],icon:he,color:"bg-orange-500"},{id:"google-sheets",name:"Google Sheets Database",type:"data",description:" Google Sheets",implementation:`// Google Sheets Database Management
const SPREADSHEET_ID = 'your-spreadsheet-id';

// Sheets Structure:
// 1. Users: userId, displayName, pictureUrl, registeredAt, status, vaccineHistory, appointments
// 2. Appointments: appointmentId, userId, vaccineType, doseNumber, totalDoses, date, time, status, createdAt
// 3. Reminders: reminderId, userId, appointmentId, scheduledFor, message, type, sent
// 4. VaccineHistory: historyId, userId, vaccineType, vaccineName, doseNumber, date, location, batch

async function saveToGoogleSheets(sheetName, data) {
  const response = await $http.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${SPREADSHEET_ID}/values/\${sheetName}:append\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [data],
      valueInputOption: 'RAW'
    }
  });
  
  return response.body;
}


// Auto-backup and data integrity
const backupData = {
  timestamp: new Date().toISOString(),
  totalUsers: await countRows('Users'),
  totalAppointments: await countRows('Appointments'),
  pendingReminders: await countPendingReminders()
};

$json.backupInfo = backupData;
$json.dataOperation = 'success';

return $input.all();`,connections:["response-sender"],icon:Gt,color:"bg-indigo-500"},{id:"response-sender",name:"LINE Response Handler",type:"action",description:" LINE API",implementation:`// LINE Response Handler
const { response, input } = $json;
const replyToken = input.replyToken;

if (!replyToken) {
  throw new Error('No reply token found');
}

//  LINE API
const lineResponse = await $http.request({
  method: 'POST',
  url: 'https://api.line.me/v2/bot/message/reply',
  headers: {
    'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
    'Content-Type': 'application/json'
  },
  body: {
    replyToken: replyToken,
    messages: [response]
  }
});

// Log 
await logActivity({
  userId: $json.userId,
  action: 'message_sent',
  response: response,
  timestamp: new Date().toISOString()
});

$json.messageSent = true;
$json.lineResponse = lineResponse.body;

return $input.all();`,connections:[],icon:ot,color:"bg-green-600"}],r=()=>{const h={name:"",nodes:n.map((f,l)=>({id:f.id,name:f.name,type:i(f.type),typeVersion:1,position:[100+l%3*300,100+Math.floor(l/3)*200],parameters:o(f)})),connections:c(),active:!0,settings:{timezone:"Asia/Bangkok"}};return JSON.stringify(h,null,2)},i=h=>{switch(h){case"trigger":return"n8n-nodes-base.webhook";case"logic":return"n8n-nodes-base.code";case"action":return"n8n-nodes-base.httpRequest";case"data":return"n8n-nodes-base.googleSheets";case"calendar":return"n8n-nodes-base.googleCalendar";default:return"n8n-nodes-base.code"}},o=h=>h.type==="trigger"?{httpMethod:"POST",path:"line-vaccine-bot",responseMode:"respondImmediately"}:h.type==="logic"||h.type==="action"?{mode:"runOnceForAllItems",jsCode:h.implementation}:{},c=()=>{const h={},f=n.reduce((l,u)=>(l[u.id]=u.name,l),{});return n.forEach(l=>{l.connections.length>0&&(h[l.name]={main:[l.connections.map(u=>({node:f[u]||u,type:"main",index:0}))]})}),h},d=h=>{navigator.clipboard.writeText(h),a({title:"",description:" clipboard "})},x=()=>{const h=r(),f=new Blob([h],{type:"application/json"}),l=URL.createObjectURL(f),u=document.createElement("a");u.href=l,u.download="vaccine-booking-workflow.json",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(l)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:" "}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Workflow  , , "})]}),e.jsxs(mt,{value:t,onValueChange:s,className:"space-y-4",children:[e.jsxs(qe,{className:"grid w-full grid-cols-5",children:[e.jsx(te,{value:"overview",children:""}),e.jsx(te,{value:"workflow",children:""}),e.jsx(te,{value:"features",children:""}),e.jsx(te,{value:"implementation",children:""}),e.jsx(te,{value:"export",children:"Export"})]}),e.jsxs(ne,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(ct,{className:"w-12 h-12 mx-auto mb-4 text-teal-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" LINE Profile"})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(Ce,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" Multi-dose "})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(Be,{className:"w-12 h-12 mx-auto mb-4 text-orange-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" 1 "})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(Gt,{className:"w-12 h-12 mx-auto mb-4 text-indigo-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" Google Sheets  Real-time"})]})})]}),e.jsxs(le,{children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:" 100%:"}),"  "]})]})]}),e.jsx(ne,{value:"workflow",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:n.map((h,f)=>{const l=h.icon;return e.jsxs(A,{className:"relative",children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${h.color} text-white`,children:e.jsx(l,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(z,{className:"text-lg",children:h.name}),e.jsx(ue,{children:h.description})]}),e.jsx(J,{variant:h.type==="trigger"?"default":h.type==="logic"?"secondary":h.type==="action"?"destructive":"outline",children:h.type.toUpperCase()})]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:":"}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>d(h.implementation),children:e.jsx(Ue,{className:"w-4 h-4"})})]}),e.jsxs("pre",{className:"text-xs overflow-x-auto whitespace-pre-wrap",children:[h.implementation.substring(0,200),"..."]})]}),h.connections.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ft,{className:"w-4 h-4"}),e.jsxs("span",{children:[": ",h.connections.join(", ")]})]})]})]},h.id)})})}),e.jsx(ne,{value:"features",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"w-5 h-5"}),"Rich Menu & UX"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Rich Menu 3 "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Carousel "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Quick Reply "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Datetime Picker "})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Gt,{className:"w-5 h-5"}),""]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Users Sheet - "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Appointments - "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Reminders - "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"VaccineHistory - "})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5"}),""]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"-19 (2 ,  21 )"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:" (1 )"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:" (3 )"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"HPV (2 ,  60 )"})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5"}),""]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:" 1 "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Cron Schedule "})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"/"})]})]})]})]})}),e.jsx(ne,{value:"implementation",className:"space-y-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:""}),e.jsx(ue,{children:""})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:" LINE Bot"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LINE Bot  LINE Developers Console  Channel Access Token"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:" Google Sheets"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Google Sheets  4 Sheets: Users, Appointments, Reminders, VaccineHistory"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Import Workflow"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Import  JSON  n8n  credentials"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:" Rich Menu"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Rich Menu  LINE Bot  API  Console"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" "})]})]})]}),e.jsx(Ae,{}),e.jsxs(le,{children:[e.jsx($e,{className:"w-4 h-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:":"}),"  credentials  LINE API, Google Sheets API  OpenAI API "]})]})]})]})}),e.jsxs(ne,{value:"export",className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:" Workflow"}),e.jsx(ue,{children:" JSON  workflow  import  n8n"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(I,{onClick:x,className:"flex-1",children:[e.jsx(We,{className:"w-4 h-4 mr-2"})," JSON"]}),e.jsxs(I,{variant:"outline",onClick:()=>d(r()),className:"flex-1",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"})," JSON"]})]}),e.jsxs(le,{children:[e.jsx(It,{className:"w-4 h-4"}),e.jsx(me,{children:" JSON    error handling"})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:""})}),e.jsx(R,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:" Performance"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" Async/Await pattern"}),e.jsx("li",{children:" Error handling "}),e.jsx("li",{children:" Connection pooling"}),e.jsx("li",{children:" Rate limiting support"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:" Security"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" Token validation"}),e.jsx("li",{children:" Data sanitization"}),e.jsx("li",{children:" API rate limiting"}),e.jsx("li",{children:" Access logging"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:" Analytics"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" User behavior tracking"}),e.jsx("li",{children:" Appointment statistics"}),e.jsx("li",{children:" Conversion metrics"}),e.jsx("li",{children:" Performance monitoring"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:" Maintenance"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:" Auto backup"}),e.jsx("li",{children:" Health checks"}),e.jsx("li",{children:" Log management"}),e.jsx("li",{children:" Update mechanisms"})]})]})]})})]})]})]})]})},ae=m.forwardRef(({className:t,type:s,...a},n)=>e.jsx("input",{type:s,className:V("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...a}));ae.displayName="Input";var bu="Label",Ji=m.forwardRef((t,s)=>e.jsx(Ke.label,{...t,ref:s,onMouseDown:a=>{var r;a.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));Ji.displayName=bu;var Xi=Ji;const ju=Mt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Q=m.forwardRef(({className:t,...s},a)=>e.jsx(Xi,{ref:a,className:V(ju(),t),...s}));Q.displayName=Xi.displayName;const _t=Dl,St=El,gt=m.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(fr,{ref:n,className:V("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(wl,{asChild:!0,children:e.jsx(Cr,{className:"h-4 w-4 opacity-50"})})]}));gt.displayName=fr.displayName;const Qi=m.forwardRef(({className:t,...s},a)=>e.jsx(gr,{ref:a,className:V("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(zl,{className:"h-4 w-4"})}));Qi.displayName=gr.displayName;const Zi=m.forwardRef(({className:t,...s},a)=>e.jsx(vr,{ref:a,className:V("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Cr,{className:"h-4 w-4"})}));Zi.displayName=vr.displayName;const vt=m.forwardRef(({className:t,children:s,position:a="popper",...n},r)=>e.jsx(_l,{children:e.jsxs(br,{ref:r,className:V("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[e.jsx(Qi,{}),e.jsx(Sl,{className:V("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Zi,{})]})}));vt.displayName=br.displayName;const yu=m.forwardRef(({className:t,...s},a)=>e.jsx(jr,{ref:a,className:V("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));yu.displayName=jr.displayName;const Ee=m.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(yr,{ref:n,className:V("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Cl,{children:e.jsx(kr,{className:"h-4 w-4"})})}),e.jsx(kl,{children:s})]}));Ee.displayName=yr.displayName;const Nu=m.forwardRef(({className:t,...s},a)=>e.jsx(Nr,{ref:a,className:V("-mx-1 my-1 h-px bg-muted",t),...s}));Nu.displayName=Nr.displayName;const eo=()=>{const[t,s]=m.useState("patients"),[a,n]=m.useState([]),[r,i]=m.useState([]),[o,c]=m.useState(""),[d,x]=m.useState(null),[h,f]=m.useState(!1),{toast:l}=xe(),u=[{id:"flu",name:"",doses:2,interval:365,description:" ",available:!0},{id:"hep_b",name:"",doses:3,interval:30,description:" 3 :  1,  2 (1 ),  3 (6 )",available:!0},{id:"tetanus",name:"",doses:3,interval:30,description:" 3 :  1,  2 (1 ),  3 ( 2  6 )",available:!0},{id:"shingles",name:"",doses:2,interval:90,description:" 2   3 ",available:!0},{id:"hpv",name:"",doses:3,interval:30,description:" 3 :  1,  2 (1 ),  3 (6 )",available:!0},{id:"pneumonia",name:"",doses:2,interval:60,description:" 2   2 ",available:!0},{id:"chickenpox",name:"",doses:2,interval:30,description:" 2   1 ",available:!0},{id:"rabies",name:"",doses:5,interval:3,description:" 5 : ,  3,  7,  14,  28",available:!0}];m.useEffect(()=>{const p=[{id:"1",lineUserId:"U1234567890",displayName:" ",firstName:"",lastName:"",phone:"081-234-5678",registeredAt:"2024-01-15T10:30:00",status:"pending"},{id:"2",lineUserId:"U2345678901",displayName:" ",firstName:"",lastName:"",phone:"082-345-6789",registeredAt:"2024-01-16T14:20:00",status:"pending"},{id:"3",lineUserId:"U3456789012",displayName:" ",firstName:"",lastName:"",registeredAt:"2024-01-17T09:15:00",status:"completed"}],y=[{id:"apt-1",patientId:"3",patientName:" ",vaccineId:"covid-19",vaccineName:"-19",doseNumber:1,totalDoses:2,appointmentDate:"2024-01-20",appointmentTime:"10:00",status:"completed",notes:" ",createdAt:"2024-01-17T09:30:00",staffId:"staff-001"}];n(p),i(y)},[]);const v=a.filter(p=>{var y;return p.displayName.toLowerCase().includes(o.toLowerCase())||((y=p.phone)==null?void 0:y.includes(o))}),b=p=>{var N,_;if(!d)return;const y={id:`apt-${Date.now()}`,patientId:d.id,patientName:d.displayName,vaccineId:p.vaccineId,vaccineName:((N=u.find(D=>D.id===p.vaccineId))==null?void 0:N.name)||"",doseNumber:1,totalDoses:((_=u.find(D=>D.id===p.vaccineId))==null?void 0:_.doses)||1,appointmentDate:p.date,appointmentTime:p.time,status:"scheduled",notes:p.notes,createdAt:new Date().toISOString(),staffId:"staff-001"};i(D=>[...D,y]),f(!1),x(null),g(d,y),l({title:"",description:` ${d.displayName} `})},g=(p,y)=>{console.log("Sending LINE notification:",{to:p.lineUserId,message:` !

 :
 : ${y.vaccineName}
 : ${y.appointmentDate}
 : ${y.appointmentTime}
 : ${y.doseNumber}/${y.totalDoses}

 
 : 02-xxx-xxxx`}),l({title:"",description:` LINE  ${p.displayName} `})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:" - "}),e.jsx("p",{className:"text-muted-foreground",children:"  "})]}),e.jsxs(mt,{value:t,onValueChange:s,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-4 max-w-2xl",children:[e.jsxs(te,{value:"patients",className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),""]}),e.jsxs(te,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),""]}),e.jsxs(te,{value:"vaccines",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),""]}),e.jsxs(te,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),""]})]}),e.jsx(ne,{value:"patients",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5"})," LINE"]}),e.jsx(ue,{children:"- LINE Bot "}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:o,onChange:p=>c(p.target.value),className:"pl-10"})]})})]}),e.jsx(R,{children:e.jsx("div",{className:"grid gap-4",children:v.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(Ul,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:p.displayName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.phone||""}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",new Date(p.registeredAt).toLocaleString("th-TH")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{variant:p.status==="completed"?"default":"secondary",children:p.status==="pending"?"":p.status==="completed"?"":""}),e.jsxs(I,{onClick:()=>{x(p),f(!0)},size:"sm",className:"flex items-center gap-2",children:[e.jsx(Dr,{className:"h-4 w-4"}),""]})]})]},p.id))})})]})}),e.jsx(ne,{value:"appointments",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:""})]}),e.jsx(R,{children:e.jsx("div",{className:"grid gap-4",children:r.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:p.patientName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[p.vaccineName," -  ",p.doseNumber,"/",p.totalDoses]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",p.appointmentDate,"  ",p.appointmentTime]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{variant:p.status==="completed"?"default":p.status==="scheduled"?"secondary":p.status==="cancelled"?"destructive":"outline",children:p.status==="scheduled"?"":p.status==="completed"?"":p.status==="cancelled"?"":""}),p.status==="scheduled"&&e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(Ua,{className:"h-4 w-4"})})]})]},p.id))})})]})}),e.jsx(ne,{value:"vaccines",className:"mt-6",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:u.map(p=>e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),p.name]}),e.jsx(ue,{children:p.description})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-semibold",children:[p.doses," "]})]}),p.interval>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-semibold",children:[p.interval," "]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:":"}),e.jsx(J,{variant:p.available?"default":"secondary",children:p.available?"":""})]})]})})]},p.id))})}),e.jsx(ne,{value:"notifications",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:" LINE "})]}),e.jsx(R,{children:e.jsxs(le,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(me,{children:"  1 "})]})})]})})]}),h&&d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs(W,{children:[e.jsxs(z,{children:[" ",d.displayName]}),e.jsx(ue,{children:""})]}),e.jsx(R,{children:e.jsxs("form",{onSubmit:p=>{p.preventDefault();const y=new FormData(p.target);b({vaccineId:y.get("vaccine"),date:y.get("date"),time:y.get("time"),notes:y.get("notes")})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"vaccine",children:""}),e.jsxs(_t,{name:"vaccine",required:!0,children:[e.jsx(gt,{children:e.jsx(St,{placeholder:""})}),e.jsx(vt,{children:u.filter(p=>p.available).map(p=>e.jsxs(Ee,{value:p.id,children:[p.name," (",p.doses," )"]},p.id))})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"date",children:""}),e.jsx(ae,{type:"date",name:"date",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"time",children:""}),e.jsx(ae,{type:"time",name:"time",required:!0})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"notes",children:" ()"}),e.jsx(Ot,{name:"notes",placeholder:"...",rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(I,{type:"submit",className:"flex-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),""]}),e.jsx(I,{type:"button",variant:"outline",onClick:()=>{f(!1),x(null)},children:""})]})]})})]})})]})})},wu=()=>{const[t,s]=m.useState(!1),[a,n]=m.useState(""),[r,i]=m.useState(!1),{toast:o}=xe(),c={name:"VaccineBot",id:"@vaccine-bot",webhook:"https://your-n8n.domain/webhook/line-bot"},d=()=>{const l=`// LINE Bot Webhook 
// URL: ${c.webhook}

// 
const welcomeMessage = {
  "type": "text",
  "text": " \\n\\n :\\n\\n1 - ()\\n2 \\n\\n"
};

// 
if (input.type === "message" && input.message.type === "text") {
  const userText = input.message.text.trim();
  const userId = input.source.userId;
  
  //  Profile  LINE
  const profileResponse = await this.helpers.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + process.env.LINE_CHANNEL_ACCESS_TOKEN
    }
  });
  
  const profile = profileResponse.body;
  
  // 
  const patterns = {
    fullName: /^[-a-zA-Z\\s]{4,50}$/,
    phone: /^(08|09|06|02)\\d{8}$/
  };
  
  let responseMessage = "";
  
  // 
  if (patterns.fullName.test(userText)) {
    // -
    responseMessage = \` : \${userText}\\n\\n \\n(: 081-234-5678)\`;
    
    //  Google Sheets
    await saveToGoogleSheets('Patients', [
      userId,
      profile.displayName,
      userText, // 
      '', //  - 
      new Date().toISOString(),
      'pending-phone'
    ]);
    
  } else if (patterns.phone.test(userText.replace(/-/g, ''))) {
    // 
    responseMessage = \` : \${userText}\\n\\n !\\n\\n \\n\\n  24 \`;
    
    //  Google Sheets
    await updatePatientPhone(userId, userText);
    
    // 
    await notifyStaff(userId, profile.displayName, userText);
    
  } else {
    // 
    responseMessage = \` \\n\\n :\\n\\n1 - ()\\n:  \\n\\n2  (10 )\\n: 081-234-5678\`;
  }
  
  // 
  return [{
    json: {
      to: userId,
      messages: [{
        type: "text",
        text: responseMessage
      }]
    }
  }];
}

// Helper Functions
async function saveToGoogleSheets(sheetName, data) {
  const response = await this.helpers.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/\${sheetName}:append\`,
    headers: {
      'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [data],
      valueInputOption: 'RAW'
    }
  });
  return response.body;
}

async function updatePatientPhone(userId, phone) {
  // 
  const getResponse = await this.helpers.request({
    method: 'GET',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/Patients:A:F\`,
    headers: {
      'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN
    }
  });
  
  const rows = getResponse.body.values || [];
  let updateRow = -1;
  
  for (let i = 0; i < rows.length; i++) {
    if (rows[i][0] === userId) {
      updateRow = i + 1;
      break;
    }
  }
  
  if (updateRow > 0) {
    // 
    await this.helpers.request({
      method: 'PUT',
      url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/Patients:D\${updateRow}:F\${updateRow}\`,
      headers: {
        'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN,
        'Content-Type': 'application/json'
      },
      body: {
        values: [[
          phone,
          new Date().toISOString(),
          'completed'
        ]],
        valueInputOption: 'RAW'
      }
    });
  }
}

async function notifyStaff(userId, displayName, phone) {
  // 
  // ( Webhook, Email,  Slack)
  console.log('New patient registered:', {
    userId,
    displayName,
    phone,
    timestamp: new Date().toISOString()
  });
}`;n(l)},x=l=>{navigator.clipboard.writeText(l),o({title:"",description:""})},h=async l=>{i(!0);try{await fetch("/functions/v1/secure-patient-webhook",{method:"POST",headers:{"Content-Type":"application/json","x-webhook-secret":"secure-patient-registration"},body:JSON.stringify({type:"patient_registration",patientName:l.fullName||l.displayName,registrationType:l.registrationType||"manual",timestamp:new Date().toISOString(),source:"frontend_registration"})}),o({title:"",description:""})}catch(u){console.error("Error sending to secure webhook:",u),o({title:"",description:"",variant:"destructive"})}finally{i(!1)}},f=()=>{h({LineUserID:"test-user-123",displayName:" ",fullName:"  ",registrationType:"manual"})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:" LINE Bot"}),e.jsx("p",{className:"text-muted-foreground",children:"- LINE Bot"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Er,{className:"h-5 w-5"})," n8n Workflow"]}),e.jsx(ue,{children:" n8n Webhook "})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(le,{children:[e.jsx($e,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:":"}),e.jsx("br",{}),"  Supabase",e.jsx("br",{})," ",e.jsx("br",{}),'  "" ']})]}),e.jsxs(I,{onClick:f,disabled:r,className:"w-full",children:[e.jsx(Tt,{className:"h-4 w-4 mr-2"}),r?"...":""]})]})]}),e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"})," LINE Bot"]}),e.jsx(ue,{children:" LINE Bot "})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{children:""}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ae,{value:c.name,readOnly:!0}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>x(c.name),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(Q,{children:"LINE Bot ID"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ae,{value:c.id,readOnly:!0}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>x(c.id),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{children:[e.jsx(Q,{children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ae,{value:c.webhook,readOnly:!0}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>x(c.webhook),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(I,{onClick:()=>s(!t),children:[e.jsx(bn,{className:"h-4 w-4 mr-2"}),t?" QR Code":" QR Code"]}),e.jsxs(I,{variant:"outline",onClick:d,children:[e.jsx(ct,{className:"h-4 w-4 mr-2"})," n8n"]})]}),t&&e.jsx("div",{className:"flex justify-center p-6 bg-muted rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-48 h-48 bg-white p-4 rounded-lg shadow-md mx-auto mb-4",children:e.jsx("div",{className:"w-full h-full bg-gray-200 rounded flex items-center justify-center",children:e.jsx(bn,{className:"h-20 w-20 text-gray-400"})})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"QR Code  LINE Bot"}),e.jsxs(I,{size:"sm",variant:"outline",className:"mt-2",children:[e.jsx(Bl,{className:"h-4 w-4 mr-2"})," LINE"]})]})})]})]}),e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:" LINE"})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:" LINE Bot"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" QR Code  ID: ",c.id]})]})]}),e.jsx(ft,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"-"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"- ()"}),e.jsx(J,{variant:"outline",className:"mt-1",children:":  "})]})]}),e.jsx(ft,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" 10 "}),e.jsx(J,{variant:"outline",className:"mt-1",children:": 081-234-5678"})]})]}),e.jsx(ft,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center",children:e.jsx(ee,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-600",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" 24 "})]})]})]})})]}),a&&e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:" n8n Webhook"}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>x(a),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),""]})]}),e.jsx(ue,{children:" Code Node  n8n "})]}),e.jsx(R,{children:e.jsx("pre",{className:"bg-muted p-4 rounded-lg text-sm overflow-x-auto",children:e.jsx("code",{children:a})})})]}),e.jsx(le,{children:e.jsx(me,{children:e.jsx("span",{className:"text-red-500 font-bold",children:" Webhook URL!"})})}),e.jsxs(le,{children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:":"}),"   Staff Dashboard "]})]})]})]})})},_u=()=>{const[t,s]=m.useState("overview"),[a,n]=m.useState(!1),r=(i,o)=>{navigator.clipboard.writeText(i),alert(` ${o} !`)};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-4",children:" "}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:" LINE Bot    "})]}),e.jsxs(mt,{value:t,onValueChange:s,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-6",children:[e.jsx(te,{value:"overview",children:""}),e.jsx(te,{value:"requirements",children:""}),e.jsx(te,{value:"line-setup",children:" LINE"}),e.jsx(te,{value:"n8n-setup",children:" n8n"}),e.jsx(te,{value:"calendar",children:"Google Calendar"}),e.jsx(te,{value:"usage",children:""})]}),e.jsx(ne,{value:"overview",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:"  3 "})]}),e.jsx(R,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Jt,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"LINE Bot"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"- LINE Bot  Rich Menu"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Me,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Staff Dashboard"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(he,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Auto Scheduling"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Google Calendar "})]})]})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:" "})}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(J,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"1"}),e.jsx(ft,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:" LINE Bot"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(J,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"2"}),e.jsx(ft,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(J,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"3"}),e.jsx(ft,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:" LINE  Google Calendar"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(J,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"4"}),e.jsx(ft,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:""})]})]})})]})]})}),e.jsx(ne,{value:"requirements",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),""]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"LINE Developers Account"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"n8n Self-hosted  Cloud"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Account"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Sheets"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Calendar"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ir,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Public URL  Webhook"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"SSL Certificate (HTTPS)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Internet Connection"})]})]})]})]})})]}),e.jsxs(le,{children:[e.jsx(We,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:":"}),"  n8n  Self-hosted  Server  Docker  Node.js  Public URL  Webhook  LINE"]})]})]})}),e.jsx(ne,{value:"line-setup",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"})," LINE Bot"]}),e.jsx(ue,{children:" LINE Bot "})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1.  LINE Bot"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:["  ",e.jsx("a",{href:"https://developers.line.biz",target:"_blank",className:"text-primary underline",children:"LINE Developers Console"})]}),e.jsx("p",{className:"text-sm",children:"  Provider  ()"}),e.jsx("p",{className:"text-sm",children:'  Channel  "Messaging API"'}),e.jsx("p",{className:"text-sm",children:'  Bot  ""'})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2.  Webhook"}),e.jsxs("div",{className:"pl-4 space-y-3",children:[e.jsx("p",{className:"text-sm",children:"  Channel Settings"}),e.jsx("p",{className:"text-sm",children:'  "Use webhook"'}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Webhook URL:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border",children:"https://your-n8n-domain.com/webhook/line-vaccine"}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>r("https://your-n8n-domain.com/webhook/line-vaccine","Webhook URL"),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3. "}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Channel Access Token:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border flex-1",children:a?"YOUR_CHANNEL_ACCESS_TOKEN_HERE":""}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>n(!a),children:a?e.jsx(Tr,{className:"h-4 w-4"}):e.jsx(Pr,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Channel Secret:"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border flex-1",children:a?"YOUR_CHANNEL_SECRET_HERE":""})})]})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"4.  Rich Menu"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"  LINE Official Account Manager"}),e.jsx("p",{className:"text-sm",children:"  2500x843 pixels"}),e.jsx("p",{className:"text-sm",children:"  3 :"}),e.jsxs("div",{className:"ml-4 space-y-1",children:[e.jsx("p",{className:"text-xs",children:"- "}),e.jsx("p",{className:"text-xs",children:"- "}),e.jsx("p",{className:"text-xs",children:"- "})]})]})]})]})]})})}),e.jsx(ne,{value:"n8n-setup",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Gt,{className:"h-5 w-5"})," n8n Workflow"]}),e.jsx(ue,{children:" n8n workflow "})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1.  n8n"}),e.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Docker ():"}),e.jsx("code",{className:"text-sm block bg-background p-2 rounded border",children:"docker run -it --rm --name n8n -p 5678:5678 -v ~/.n8n:/home/node/.n8n n8nio/n8n"})]}),e.jsxs("div",{className:"bg-muted p-4 rounded-md mt-3",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"NPM:"}),e.jsxs("code",{className:"text-sm block bg-background p-2 rounded border",children:["npm install n8n -g",e.jsx("br",{}),"n8n start"]})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2.  Environment Variables"}),e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsxs("code",{className:"text-sm block",children:["LINE_CHANNEL_ACCESS_TOKEN=your_line_access_token",e.jsx("br",{}),"LINE_CHANNEL_SECRET=your_line_channel_secret",e.jsx("br",{}),"GOOGLE_ACCESS_TOKEN=your_google_access_token",e.jsx("br",{}),"GOOGLE_SPREADSHEET_ID=your_spreadsheet_id",e.jsx("br",{}),"GOOGLE_CALENDAR_ID=your_calendar_id"]})})})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3.  Workflow Nodes"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Webhook Trigger"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:" LINE Bot"}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Method: POST",e.jsx("br",{}),"Path: /webhook/line-vaccine"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Code Node - Vaccine Mapping"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs(I,{size:"sm",variant:"outline",className:"w-full",children:[e.jsx(We,{className:"h-4 w-4 mr-2"})," Vaccine Mapping"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Google Sheets"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Operation: Append",e.jsx("br",{}),"Sheet: Patients, Appointments"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"LINE Message Reply"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Type: Reply Message",e.jsx("br",{}),"Format: Text, Flex Message"]})]})]})]})]})]})})}),e.jsx(ne,{value:"calendar",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"})," Google Calendar"]}),e.jsx(ue,{children:" Google Calendar "})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1.  Google Cloud Project"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:["  ",e.jsx("a",{href:"https://console.cloud.google.com",target:"_blank",className:"text-primary underline",children:"Google Cloud Console"})]}),e.jsx("p",{className:"text-sm",children:"  Project "}),e.jsx("p",{className:"text-sm",children:"  Google Calendar API"}),e.jsx("p",{className:"text-sm",children:"  Service Account"})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2.  Calendar "}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"  Google Calendar"}),e.jsx("p",{className:"text-sm",children:'  Calendar  ""'}),e.jsx("p",{className:"text-sm",children:"  Calendar  Service Account"}),e.jsx("p",{className:"text-sm",children:"  Calendar ID"})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3. "}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:":"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{children:" 1  -  LINE"}),e.jsx("p",{children:" 1  -  Calendar"}),e.jsx("p",{children:" 30  - Email reminder"})]})]})})]})]})]})})}),e.jsx(ne,{value:"usage",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:""})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:" ( LINE Bot)"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"1.  LINE Bot "}),e.jsx("p",{className:"text-sm",children:'2.  ""'}),e.jsx("p",{className:"text-sm",children:"3.  - "}),e.jsx("p",{className:"text-sm",children:"4. "}),e.jsx("p",{className:"text-sm",children:"5.  LINE"})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:""}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"1.  Staff Dashboard"}),e.jsx("p",{className:"text-sm",children:"2. "}),e.jsx("p",{className:"text-sm",children:'3.  ""'}),e.jsx("p",{className:"text-sm",children:"4. "}),e.jsx("p",{className:"text-sm",children:"5. "})]})]}),e.jsx(Ae,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:""}),e.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[e.jsx("p",{className:"text-sm mb-2",children:":"}),e.jsxs("div",{className:"text-sm space-y-1 ml-4",children:[e.jsx("p",{children:" : 3 "}),e.jsx("p",{children:" : 3 "}),e.jsx("p",{children:" : 5 "}),e.jsx("p",{children:" "})]})]})]})]})]}),e.jsxs(le,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:":"}),"  Staff Dashboard  "]})]})]})})]})]})})},to=()=>{const[t,s]=m.useState(""),[a,n]=m.useState(""),[r,i]=m.useState(""),[o,c]=m.useState(""),[d,x]=m.useState(!1),[h,f]=m.useState("disconnected"),{toast:l}=xe(),u=async()=>{if(!t){l({title:"",description:" Webhook URL",variant:"destructive"});return}x(!0);try{const g=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"test",message:"Connection test from web app",timestamp:new Date().toISOString()})});f("connected"),l({title:"",description:" n8n workflow "})}catch{f("error"),l({title:"",description:" n8n workflow ",variant:"destructive"})}finally{x(!1)}},v=async()=>{if(!(!t||!o)){x(!0);try{await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"message",data:{message:o,source:"web_app_test"}})}),l({title:"",description:" n8n "}),c("")}catch{l({title:"",description:"",variant:"destructive"})}finally{x(!1)}}},b=()=>{const g=`${t}/line-webhook`;navigator.clipboard.writeText(g),l({title:"",description:" LINE Webhook URL "})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"LINE Bot Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:" LINE Bot  n8n workflow"})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Er,{className:"h-5 w-5"})," n8n Workflow"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"webhook-url",children:"n8n Webhook URL"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(ae,{id:"webhook-url",placeholder:"https://your-n8n.render.com/webhook/...",value:t,onChange:g=>s(g.target.value)}),e.jsx(I,{onClick:u,disabled:d,variant:h==="connected"?"secondary":"default",children:h==="connected"?"":""})]})]}),h==="connected"&&e.jsxs(le,{children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsxs(me,{children:[" n8n workflow !  LINE Bot  URL:",e.jsxs("code",{className:"mx-1 p-1 bg-muted rounded",children:[t,"/line-webhook"]}),e.jsx(I,{variant:"ghost",size:"sm",className:"ml-2",onClick:b,children:e.jsx(Ue,{className:"h-3 w-3"})})]})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"})," LINE Bot"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"channel-access-token",children:"Channel Access Token"}),e.jsx(ae,{id:"channel-access-token",type:"password",placeholder:"Channel Access Token  LINE Developers",value:a,onChange:g=>n(g.target.value)})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"channel-secret",children:"Channel Secret"}),e.jsx(ae,{id:"channel-secret",type:"password",placeholder:"Channel Secret  LINE Developers",value:r,onChange:g=>i(g.target.value)})]}),e.jsx(le,{children:e.jsxs(me,{children:[e.jsx("strong",{children:" LINE Bot:"}),e.jsx("br",{}),"1.  LINE Developers Console",e.jsx("br",{}),"2.  Webhook URL  Messaging API",e.jsx("br",{}),"3.  Channel Access Token  Channel Secret ",e.jsx("br",{}),"4.  Webhook  LINE Developers"]})})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),""]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"test-message",children:""}),e.jsx(Ot,{id:"test-message",placeholder:"...",value:o,onChange:g=>c(g.target.value)})]}),e.jsxs(I,{onClick:v,disabled:!t||!o||d,className:"w-full",children:[e.jsx(Tt,{className:"h-4 w-4 mr-2"}),d?"...":""]})]})]})]})})},Su="",Cu="";throw new Error("Missing VITE_SUPABASE_URL or VITE_SUPABASE_ANON_KEY");const ku=globalThis,$=ku.__supabase??rc(Su,Cu,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),Du=()=>{const[t,s]=m.useState([]),[a,n]=m.useState([]),[r,i]=m.useState(!1),[o,c]=m.useState(""),{toast:d}=xe();m.useEffect(()=>{(async()=>{try{if(window.liff&&window.liff.isLoggedIn()){const g=await window.liff.getProfile();c(g.userId),x(g.userId),h(g.userId)}else console.log("LINE LIFF not available or not logged in")}catch(g){console.log("Error getting LINE profile:",g)}})()},[]);const x=async b=>{if(b){i(!0);try{console.log(" ...");const{data:g,error:p}=await $.from("appointments").select("*").eq("line_user_id",b).order("appointment_date",{ascending:!1});if(p)throw p;console.log(" :",(g==null?void 0:g.length)||0,"");const y=(g==null?void 0:g.filter(j=>j.status==="completed"))||[],N=(g==null?void 0:g.filter(j=>["scheduled","pending"].includes(j.status)))||[];console.log(" :",y.length,""),console.log(" :",N.length,"");const{data:_}=await $.from("vaccine_schedules").select("*").eq("active",!0);console.log(" :",(_==null?void 0:_.length)||0,"");const D=[];for(const j of N)if(new Date(j.appointment_date)>new Date){const w=y.filter(F=>F.vaccine_type.toLowerCase()===j.vaccine_type.toLowerCase()),M=_==null?void 0:_.find(F=>F.vaccine_type.toLowerCase()===j.vaccine_type.toLowerCase());M&&(D.push({id:`scheduled-${j.id}`,patient_id:b,patient_name:j.patient_name||"",vaccine_name:j.vaccine_name||M.vaccine_name,vaccine_type:j.vaccine_type,current_dose:w.length,total_doses:M.total_doses,next_dose_due:j.appointment_date,last_dose_date:w.length>0?w.reduce((F,U)=>new Date(U.appointment_date)>new Date(F.appointment_date)?U:F).appointment_date:"",completion_status:"scheduled"}),console.log(` : ${j.vaccine_type}  ${j.appointment_date}`))}const T=new Map;for(const j of y||[]){const w=j.vaccine_type;if(!T.has(w)){const M=y.filter(H=>H.vaccine_type.toLowerCase()===j.vaccine_type.toLowerCase());console.log(` : ${j.vaccine_type}, : ${M.length}`);const F=M.reduce((H,P)=>new Date(P.appointment_date)>new Date(H.appointment_date)?P:H),U=M.reduce((H,P)=>new Date(P.appointment_date)<new Date(H.appointment_date)?P:H);console.log(` : ${F.appointment_date}`),console.log(` : ${U.appointment_date}`),T.set(w,{vaccine_type:j.vaccine_type,doses_received:M.length,latest_date:F.appointment_date,first_dose_date:U.appointment_date,patient_name:j.patient_name})}}const O=Array.from(T.values()).map(async j=>{var w;try{const M=_==null?void 0:_.find(S=>S.vaccine_type.toLowerCase()===j.vaccine_type.toLowerCase());if(!M)return console.log(` : ${j.vaccine_type}`),null;if(j.doses_received>=M.total_doses)return console.log(`  ${j.vaccine_type} `),null;const F=N.find(S=>S.vaccine_type.toLowerCase()===j.vaccine_type.toLowerCase()&&new Date(S.appointment_date)>new Date);if(F)return console.log(`  ${j.vaccine_type}  ${F.appointment_date} - `),null;const U=Array.isArray(M.dose_intervals)?M.dose_intervals:JSON.parse(((w=M.dose_intervals)==null?void 0:w.toString())||"[]");console.log(`  vaccine_schedules  ${j.patient_name}:`,{vaccine_type:M.vaccine_type,total_doses:M.total_doses,dose_intervals:U,current_dose:j.doses_received,first_dose_date:j.first_dose_date});const H=new Date(j.first_dose_date),P=typeof U[j.doses_received]=="number"?U[j.doses_received]:0;console.log(`   ${j.doses_received+1}:  ${P} `);const L=new Date(H.getTime());L.setDate(H.getDate()+P);const Y=j.doses_received+1,X=U[j.doses_received]||0;return console.log(` ${j.patient_name}:  vaccine_schedules`),console.log(`   - : ${j.first_dose_date}`),console.log(`   - : ${P} `),console.log(`   - : ${Y}/${M.total_doses}`),console.log(`   - : ${L.toISOString().split("T")[0]}`),{id:`new-${b}-${j.vaccine_type}`,patient_id:b,patient_name:j.patient_name||"",vaccine_name:M.vaccine_name,vaccine_type:j.vaccine_type,current_dose:j.doses_received,total_doses:M.total_doses,next_dose_due:L.toISOString().split("T")[0],last_dose_date:j.latest_date,completion_status:"needs_appointment"}}catch(M){return console.error("Error processing vaccine:",j.vaccine_type,M),null}}),B=(await Promise.all(O)).filter(j=>j!==null),C=[...D,...B].sort((j,w)=>new Date(j.next_dose_due).getTime()-new Date(w.next_dose_due).getTime());console.log(" :",C.length,""),console.log(" :",D.length,""),console.log(" :",B.length,""),C.forEach(j=>{const w=j.completion_status==="scheduled"?"()":"()";console.log(`- : ${j.vaccine_name},  ${j.current_dose+1}/${j.total_doses}, : ${j.next_dose_due}, : ${j.last_dose_date||""} ${w}`)}),s(C)}catch(g){console.error("Error loading next appointments:",g),d({title:"",description:"",variant:"destructive"})}finally{i(!1)}}},h=async b=>{if(b)try{const{data:g,error:p}=await $.rpc("api_next_appointments",{_line_user_id:b,_limit:5});if(p)throw p;g&&n(g)}catch(g){console.error("Error loading upcoming appointments:",g)}},f=()=>{o&&(x(o),h(o))},l=b=>new Date(b).toLocaleDateString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),u=b=>{switch(b){case"scheduled":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},v=b=>{const g=new Date,y=new Date(b).getTime()-g.getTime();return Math.ceil(y/(1e3*60*60*24))};return o?e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]}),e.jsxs(I,{onClick:f,disabled:r,variant:"outline",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]})]}),a.length>0&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),""]})}),e.jsx(R,{className:"space-y-4",children:a.map((b,g)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:b.vaccine_name}),e.jsx(J,{className:u(b.status),children:b.status==="scheduled"?"":b.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-4 w-4"}),l(b.appointment_date)]}),b.appointment_time&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-4 w-4"}),b.appointment_time]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Hl,{className:"h-4 w-4"}),b.location]})]})]},g))})]}),t.length>0?e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),""]})}),e.jsx(R,{className:"space-y-4",children:t.map(b=>{const g=v(b.next_dose_due),p=g<0,y=g<=7&&g>=0;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:b.vaccine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",b.current_dose+1,"  ",b.total_doses," "]})]}),e.jsx(J,{variant:p?"destructive":y?"secondary":"outline",className:p?"bg-red-100 text-red-800":y?"bg-yellow-100 text-yellow-800":"",children:p?` ${Math.abs(g)} `:y?` ${g} `:` ${g} `})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:l(b.next_dose_due)})]}),b.last_dose_date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:l(b.last_dose_date)})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:b.completion_status==="scheduled"?"  - ":"  "})})]},b.id)})})]}):e.jsx(A,{children:e.jsxs(R,{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 mx-auto text-green-500 mb-4"}),e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:" "})]})}),e.jsx(A,{children:e.jsx(R,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("p",{children:" : 02-xxx-xxxx"}),e.jsx("p",{children:" : []"}),e.jsx("p",{children:" : - 08:00-17:00"})]})]})})})]}):e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx(le,{children:e.jsx(me,{children:" LINE "})})})},so=()=>{const[t,s]=m.useState({fullName:"",phone:""}),[a,n]=m.useState(!1),[r,i]=m.useState(!1),[o,c]=m.useState(0),{toast:d}=xe(),x=(l,u)=>{s(v=>({...v,[l]:u}))},h=async()=>{if(!t.fullName||!t.phone){d({title:"",description:"",variant:"destructive"});return}if(!/^[0-9]{9,10}$/.test(t.phone.replace(/[-\s]/g,""))){d({title:"",description:"",variant:"destructive"});return}n(!0);try{const u=`HOM-${Date.now()}`;let v=null;try{window.liff&&window.liff.isLoggedIn()&&(v=(await window.liff.getProfile()).userId,s(y=>({...y,lineUserId:v})))}catch(p){console.log("LINE profile not available:",p)}const{error:b}=await $.from("patient_registrations").insert({patient_name:t.fullName,phone_number:t.phone,line_user_id:v||`temp_${Date.now()}`,hospital:"",registration_id:u,source:v?"line_liff":"web_portal",status:"pending"});if(b)throw b;if(i(!0),d({title:"",description:""}),v)try{await $.functions.invoke("send-line-message",{body:{userId:v,message:` 

 :
 : ${t.fullName}
 : ${t.phone}
 : ${u}

 
`}})}catch(p){console.error("Error sending LINE message:",p)}const g=window.setTimeout(()=>{window.liff&&window.liff.isInClient()&&window.liff.closeWindow()},1e4);c(g)}catch(u){console.error("Registration error:",u),d({title:"",description:" ",variant:"destructive"})}finally{n(!1)}},f=()=>{o&&(window.clearTimeout(o),c(0)),s({fullName:"",phone:""}),i(!1)};return r?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx(A,{className:"border-green-200 bg-green-50",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"",className:"mx-auto h-16 w-auto object-contain mb-4"})}),e.jsx(ee,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"!"}),e.jsxs("p",{className:"text-green-700 mb-6",children:[" ",t.lineUserId&&e.jsx("span",{className:"block mt-2 text-sm",children:"  LINE "}),window.liff&&window.liff.isInClient()&&e.jsx("span",{className:"block mt-2 text-sm",children:"  10 "})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold mb-2",children:":"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",t.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",t.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," "]}),t.lineUserId&&e.jsxs("p",{children:[e.jsx("strong",{children:"LINE ID:"})," ",t.lineUserId]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{onClick:f,variant:"outline",className:"w-full",children:""}),window.liff&&window.liff.isInClient()&&e.jsx(I,{onClick:()=>window.liff.closeWindow(),className:"w-full",children:""})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"",className:"mx-auto h-24 w-auto object-contain"})}),e.jsx("h1",{className:"text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),e.jsxs(mt,{defaultValue:"appointments",className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsxs(te,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),""]}),e.jsxs(te,{value:"register",className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),""]})]}),e.jsx(ne,{value:"appointments",className:"mt-6",children:e.jsx(Du,{})}),e.jsx(ne,{value:"register",className:"mt-6",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:""})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),""]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"fullName",children:"-"}),e.jsx(ae,{id:"fullName",placeholder:"//  ",value:t.fullName,onChange:l=>{console.log("Name input changed:",l.target.value),x("fullName",l.target.value)},onFocus:()=>console.log("Name input focused"),onBlur:()=>console.log("Name input blurred"),className:"mt-1",autoComplete:"name"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"phone",children:""}),e.jsx(ae,{id:"phone",placeholder:"08x-xxx-xxxx",value:t.phone,onChange:l=>x("phone",l.target.value),className:"mt-1"})]})]})]}),e.jsx(I,{onClick:h,disabled:a,className:"w-full",size:"lg",children:a?"...":""}),e.jsx(le,{children:e.jsx(me,{children:"  "})})]})})]})]})})},ds=["domain:read","domain:write","domain:delete","vaccine:read","vaccine:write","appointments:read","appointments:write","system:settings"],Eu=[...ds,"users:manage","system:admin","domain:force_delete"],Iu=[{email:"admin@vchomehospital.co.th",password:"admin123",role:"admin",permissions:ds},{email:"superadmin@vchomehospital.co.th",password:"superadmin123",role:"superadmin",permissions:Eu}],Es=t=>t.endsWith("@vchomehospital.co.th")?!0:["admin@gmail.com","admin@example.com","test@admin.com"].includes(t.toLowerCase());function Qa(){const[t,s]=m.useState(null),[a,n]=m.useState(!0),[r,i]=m.useState(null);m.useEffect(()=>{(async()=>{var u;const{data:{session:f}}=await $.auth.getSession();if((u=f==null?void 0:f.user)!=null&&u.email&&Es(f.user.email)){const v={id:f.user.id,email:f.user.email,role:(f.user.email.endsWith("@vchomehospital.co.th"),"admin"),permissions:ds,isAdmin:!0,isSuperAdmin:f.user.email==="superadmin@vchomehospital.co.th"};s(v),localStorage.setItem("admin_user",JSON.stringify(v)),n(!1);return}const l=localStorage.getItem("admin_user");if(l)try{const v=JSON.parse(l);s(v)}catch{localStorage.removeItem("admin_user")}n(!1)})();const{data:{subscription:h}}=$.auth.onAuthStateChange(async(f,l)=>{var u;if((u=l==null?void 0:l.user)!=null&&u.email&&Es(l.user.email)){const v={id:l.user.id,email:l.user.email,role:(l.user.email.endsWith("@vchomehospital.co.th"),"admin"),permissions:ds,isAdmin:!0,isSuperAdmin:l.user.email==="superadmin@vchomehospital.co.th"};s(v),localStorage.setItem("admin_user",JSON.stringify(v))}else f==="SIGNED_OUT"&&(s(null),localStorage.removeItem("admin_user"))});return()=>h.unsubscribe()},[]);const o=async(x,h)=>{n(!0),i(null);try{const{data:f,error:l}=await $.auth.signInWithPassword({email:x,password:h});if(f.user&&Es(x)){const u={id:f.user.id,email:f.user.email,role:(x.endsWith("@vchomehospital.co.th"),"admin"),permissions:ds,isAdmin:!0,isSuperAdmin:x==="superadmin@vchomehospital.co.th"};s(u),localStorage.setItem("admin_user",JSON.stringify(u));return}if(l){const u=Iu.find(b=>b.email===x&&b.password===h);if(!u)throw new Error("Invalid credentials. Please check your email and password.");const v={id:`demo_admin_${Date.now()}`,email:u.email,role:u.role,permissions:u.permissions,isAdmin:!0,isSuperAdmin:u.role==="superadmin"};s(v),localStorage.setItem("admin_user",JSON.stringify(v));return}if(f.user&&!Es(x))throw await $.auth.signOut(),new Error("Access denied. Admin privileges required.")}catch(f){throw i(f instanceof Error?f.message:"Login failed"),f}finally{n(!1)}},c=async()=>{await $.auth.signOut(),s(null),localStorage.removeItem("admin_user")},d=x=>(t==null?void 0:t.permissions.includes(x))||!1;return{user:t,isLoading:a,isAdmin:(t==null?void 0:t.isAdmin)||!1,isSuperAdmin:(t==null?void 0:t.isSuperAdmin)||!1,hasPermission:d,login:o,logout:c,error:r}}function Tu({onSuccess:t}){const[s,a]=m.useState(""),[n,r]=m.useState(""),[i,o]=m.useState(!1),{login:c,isLoading:d,error:x}=Qa(),h=async f=>{f.preventDefault();try{await c(s,n),t==null||t()}catch{}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs(W,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Pe,{className:"h-6 w-6 text-blue-600"})}),e.jsx(z,{className:"text-2xl font-bold",children:"Admin Access"}),e.jsx(ue,{children:""})]}),e.jsxs(R,{children:[e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[x&&e.jsx(le,{variant:"destructive",children:e.jsx(me,{children:x})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"email",children:"Email"}),e.jsx(ae,{id:"email",type:"email",value:s,onChange:f=>a(f.target.value),placeholder:"admin@vchomehospital.co.th",required:!0,disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"password",type:i?"text":"password",value:n,onChange:f=>r(f.target.value),placeholder:"",required:!0,disabled:d}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>o(!i),disabled:d,children:i?e.jsx(Tr,{className:"h-4 w-4"}):e.jsx(Pr,{className:"h-4 w-4"})})]})]}),e.jsx(I,{type:"submit",className:"w-full",disabled:d||!s||!n,children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ar,{className:"h-4 w-4 animate-spin mr-2"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),""]})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Admin Access:"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Existing Users:"})," Use your regular login credentials"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Demo Admin:"})," admin@vchomehospital.co.th / admin123"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Super Admin:"})," superadmin@vchomehospital.co.th / superadmin123"]})]}),e.jsx("div",{className:"mt-2 text-xs text-blue-600",children:" Admin access is granted to @vchomehospital.co.th emails"})]})]})]})})}function ao({children:t,requiredPermission:s,fallback:a,showLoginForm:n=!0}){const{user:r,isLoading:i,isAdmin:o,hasPermission:c,logout:d}=Qa();return i?e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pe,{className:"h-8 w-8 animate-pulse text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})})}):o?s&&!c(s)?e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ba,{className:"h-12 w-12 text-orange-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-700",children:"Insufficient Permissions"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Required: ",s]})]})]})})}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Admin Mode: ",r==null?void 0:r.email]}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:r==null?void 0:r.role})]}),e.jsxs(I,{size:"sm",variant:"ghost",onClick:d,className:"text-blue-600 hover:text-blue-800",children:[e.jsx(Ms,{className:"h-3 w-3 mr-1"}),"Logout"]})]})}),t]}):n?e.jsx(Tu,{}):a||e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ba,{className:"h-12 w-12 text-red-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-700",children:"Access Restricted"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" Admin "})]})]})})})}function Pu(){const[t,s]=m.useState([]),[a,n]=m.useState(!0),[r,i]=m.useState(null),[o,c]=m.useState(!1),[d,x]=m.useState({vaccine_type:"",vaccine_name:"",total_doses:1}),{toast:h}=xe(),f=async()=>{try{const{data:p,error:y}=await $.from("vaccine_schedules").select("*").order("vaccine_name");if(y)throw y;s(p||[])}catch(p){console.error("Error loading vaccines:",p),h({title:"",description:"",variant:"destructive"})}finally{n(!1)}},l=async()=>{if(!d.vaccine_type||!d.vaccine_name||d.total_doses<1){h({title:"",description:"",variant:"destructive"});return}try{if(r){const{error:p}=await $.from("vaccine_schedules").update({vaccine_type:d.vaccine_type,vaccine_name:d.vaccine_name,total_doses:d.total_doses,updated_at:new Date().toISOString()}).eq("id",r);if(p)throw p;h({title:"",description:""})}else{const{error:p}=await $.from("vaccine_schedules").insert([{vaccine_type:d.vaccine_type,vaccine_name:d.vaccine_name,total_doses:d.total_doses,active:!0}]);if(p)throw p;h({title:"",description:""})}x({vaccine_type:"",vaccine_name:"",total_doses:1}),i(null),c(!1),f()}catch(p){console.error("Error saving vaccine:",p),h({title:"",description:"",variant:"destructive"})}},u=p=>{x({vaccine_type:p.vaccine_type,vaccine_name:p.vaccine_name,total_doses:p.total_doses}),i(p.id),c(!0)},v=async(p,y)=>{try{const{error:N}=await $.from("vaccine_schedules").update({active:!y,updated_at:new Date().toISOString()}).eq("id",p);if(N)throw N;h({title:"",description:`${y?"":""}`}),f()}catch(N){console.error("Error toggling vaccine status:",N),h({title:"",description:"",variant:"destructive"})}},b=async(p,y)=>{if(confirm(` "${y}" ?`))try{const{error:N}=await $.from("vaccine_schedules").delete().eq("id",p);if(N)throw N;h({title:"",description:""}),f()}catch(N){console.error("Error deleting vaccine:",N),h({title:"",description:"",variant:"destructive"})}},g=()=>{x({vaccine_type:"",vaccine_name:"",total_doses:1}),i(null),c(!1)};return m.useEffect(()=>{f()},[]),e.jsx(ao,{requiredPermission:"vaccine:write",children:e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:""})]}),e.jsxs(I,{onClick:()=>c(!0),disabled:o,children:[e.jsx(Dr,{className:"h-4 w-4 mr-2"}),""]})]})}),e.jsxs(R,{children:[o&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"mb-6",children:[e.jsx(W,{children:e.jsx(z,{className:"text-lg",children:r?"":""})}),e.jsxs(R,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"vaccine_type",children:""}),e.jsx(ae,{id:"vaccine_type",value:d.vaccine_type,onChange:p=>x({...d,vaccine_type:p.target.value}),placeholder:" COVID19, INFLUENZA"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"vaccine_name",children:""}),e.jsx(ae,{id:"vaccine_name",value:d.vaccine_name,onChange:p=>x({...d,vaccine_name:p.target.value}),placeholder:" -19"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"total_doses",children:""}),e.jsx(ae,{id:"total_doses",type:"number",min:"1",max:"10",value:d.total_doses,onChange:p=>x({...d,total_doses:parseInt(p.target.value)||1})})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(I,{onClick:l,children:[e.jsx(Rr,{className:"h-4 w-4 mr-2"}),r?"":""]}),e.jsxs(I,{variant:"outline",onClick:g,children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),""]})]})]})]}),e.jsx(Ae,{className:"mb-6"})]}),a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ar,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"space-y-4",children:[t.map(p=>e.jsx(A,{children:e.jsx(R,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ce,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:p.vaccine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",p.vaccine_type,"  ",p.total_doses," "]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{variant:p.active?"default":"secondary",children:p.active?"":""}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>u(p),children:e.jsx(Ua,{className:"h-3 w-3"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>v(p.id,p.active),children:p.active?"":""}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>b(p.id,p.vaccine_name),children:e.jsx(Mr,{className:"h-3 w-3"})})]})]})})},p.id)),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:' "" '})]})]})]})]})})}class Tg extends q.Component{constructor(a){super(a);ta(this,"retry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,n){console.error("Domain Management Error:",a,n)}render(){if(this.state.hasError&&this.state.error){const a=this.props.fallback;return e.jsx(a,{error:this.state.error,retry:this.retry})}return this.props.children}}const no=({isAdmin:t}={})=>{const[s,a]=m.useState([]),[n,r]=m.useState(!1),[i,o]=m.useState(new Date().toISOString().split("T")[0]),[c,d]=m.useState([]),[x,h]=m.useState([]),[f,l]=m.useState(""),[u,v]=m.useState(null),[b,g]=m.useState("appointments"),[p,y]=m.useState({vaccineType:"",doseNumber:"1",notes:""}),{toast:N}=xe(),{isAdmin:_}=Qa(),D=t!==void 0?t:_,T=async S=>{r(!0);try{const{data:E,error:G}=await $.from("appointments").select("*").eq("appointment_date",S).order("appointment_time",{ascending:!0});if(G)throw G;a(E||[])}catch(E){console.error("Error loading appointments:",E),N({title:"",description:` ${new Date(S).toLocaleDateString("th-TH")} `,variant:"destructive"})}finally{r(!1)}},O=()=>T(i),k=async()=>{try{const{data:S,error:E}=await $.from("vaccine_schedules").select("id, vaccine_type, vaccine_name, total_doses").eq("active",!0).order("vaccine_name");if(E)throw E;d(S||[])}catch(S){console.error("Error loading vaccine options:",S),N({title:"",description:"",variant:"destructive"})}},B=async()=>{try{const{data:S,error:E}=await $.from("patient_registrations").select("*").order("created_at",{ascending:!1});if(E)throw E;console.log("Patient registrations loaded:",(S==null?void 0:S.length)||0,"records"),console.log("Sample data:",S==null?void 0:S.slice(0,3)),h(S||[])}catch(S){console.error("Error loading patient registrations:",S),N({title:"",description:"",variant:"destructive"})}},C=async(S,E)=>{try{console.log("Updating appointment:",{appointmentId:S,status:E,updated_at:new Date().toISOString()});const{data:G,error:K}=await $.from("appointments").update({status:E,updated_at:new Date().toISOString()}).eq("appointment_id",S).select();if(K)throw console.error("Supabase error:",K),K;console.log("Update successful:",G),N({title:"",description:` ${M(E)} `}),O()}catch(G){console.error("Error updating appointment:",G);const K=(G==null?void 0:G.message)||(G==null?void 0:G.toString())||"";N({title:"",description:`: ${K}`,variant:"destructive"})}},j=async()=>{if(!u||!p.vaccineType||!p.doseNumber){N({title:"",description:"  ",variant:"destructive"});return}const S=c.find(G=>G.vaccine_type===p.vaccineType),E=parseInt(p.doseNumber);if(S&&E>S.total_doses){N({title:"",description:` ${S.vaccine_name}  ${S.total_doses} `,variant:"destructive"});return}try{const G=new Date().toISOString().split("T")[0],re=new Date().toTimeString().slice(0,5),Z=p.doseNumber==="1"?" 1":p.doseNumber==="2"?" 2":p.doseNumber==="3"?" 3":` ${p.doseNumber}`,ge={patient_name:u.patient_name,patient_phone:u.phone_number,patient_id_number:u.registration_id,line_user_id:u.line_user_id,vaccine_type:p.vaccineType,appointment_date:G,appointment_time:re,status:"completed",scheduled_by:"walk_in",notes:` Walk-in ${Z} (${S==null?void 0:S.vaccine_name}) ${p.notes?" - "+p.notes:""}`},{error:ve}=await $.from("appointments").insert([ge]);if(ve)throw ve;N({title:"",description:` ${S==null?void 0:S.vaccine_name} ${Z}  ${u.patient_name} `}),v(null),l(""),y({vaccineType:"",doseNumber:"1",notes:""}),O()}catch(G){console.error("Error creating walk-in vaccination:",G),N({title:"",description:"",variant:"destructive"})}};m.useEffect(()=>{T(i),k(),B()},[i]);const w=S=>{o(S)},M=S=>{switch(S){case"scheduled":return"";case"completed":return"";case"cancelled":return"";case"no_show":return"";default:return S}},F=S=>{switch(S){case"scheduled":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"no_show":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},U=S=>{switch(S){case"scheduled":return e.jsx(Ie,{className:"h-4 w-4"});case"completed":return e.jsx(ee,{className:"h-4 w-4"});case"cancelled":return e.jsx(Te,{className:"h-4 w-4"});case"no_show":return e.jsx(Te,{className:"h-4 w-4"});default:return e.jsx(Ie,{className:"h-4 w-4"})}},H=s.filter(S=>S.status==="completed").length,P=s.filter(S=>S.status==="scheduled").length,L=s.length,Y=i===new Date().toISOString().split("T")[0],X=Y?"":new Date(i).toLocaleDateString("th-TH");return e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Vl,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Staff Portal"}),D&&e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:"Admin"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsxs(mt,{value:b,onValueChange:g,className:"w-full",children:[e.jsxs(qe,{className:`grid w-full ${D?"grid-cols-2":"grid-cols-1"} lg:w-auto lg:${D?"grid-cols-2":"grid-cols-1"}`,children:[e.jsxs(te,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),D&&e.jsxs(te,{value:"settings",className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})]}),e.jsxs(ne,{value:"appointments",className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{htmlFor:"date-picker",className:"text-sm font-medium",children:":"}),e.jsx(ae,{id:"date-picker",type:"date",value:i,onChange:S=>w(S.target.value),className:"w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{onClick:()=>w(new Date().toISOString().split("T")[0]),variant:"outline",size:"sm",disabled:Y,children:""}),e.jsx(I,{onClick:()=>{const S=new Date;S.setDate(S.getDate()+1),w(S.toISOString().split("T")[0])},variant:"outline",size:"sm",children:""}),e.jsxs(I,{onClick:O,disabled:n,variant:"outline",size:"sm",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(he,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["",X]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:L})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ee,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:H})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(Ie,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:P})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ls,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[L>0?Math.round(H/L*100):0,"%"]})]})]})})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"h-5 w-5"})," Walk-in"]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"patientSearch",children:" *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"patientSearch",value:f,onChange:S=>l(S.target.value),placeholder:" ",className:"pr-10"}),f&&e.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 bg-background border rounded-b-md shadow-lg max-h-60 overflow-y-auto",children:[x.filter(S=>S.patient_name.toLowerCase().includes(f.toLowerCase())||S.phone_number.includes(f)||S.registration_id.includes(f)).slice(0,10).map(S=>e.jsxs("div",{className:"p-3 hover:bg-muted cursor-pointer border-b last:border-b-0 transition-colors",onClick:()=>{v(S),l("")},children:[e.jsx("div",{className:"font-medium text-foreground",children:S.patient_name}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center justify-between",children:[e.jsxs("span",{children:[": ",S.phone_number]}),e.jsxs("span",{className:"text-xs",children:["ID: ",S.registration_id]})]})]},S.id)),x.filter(S=>S.patient_name.toLowerCase().includes(f.toLowerCase())||S.phone_number.includes(f)||S.registration_id.includes(f)).length===0&&e.jsx("div",{className:"p-3 text-center text-muted-foreground",children:""})]})]})]}),u&&e.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.patient_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:u.phone_number}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",u.registration_id]})]}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>v(null),children:e.jsx(Te,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"vaccineType",children:" *"}),e.jsxs(_t,{value:p.vaccineType,onValueChange:S=>y({...p,vaccineType:S,doseNumber:"1"}),children:[e.jsx(gt,{children:e.jsx(St,{placeholder:""})}),e.jsx(vt,{children:c.filter(S=>S.vaccine_type&&S.vaccine_type.trim()!=="").map(S=>e.jsx(Ee,{value:S.vaccine_type,children:S.vaccine_name},S.id))})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"doseNumber",children:" *"}),e.jsxs(_t,{value:p.doseNumber,onValueChange:S=>y({...p,doseNumber:S}),disabled:!p.vaccineType,children:[e.jsx(gt,{children:e.jsx(St,{placeholder:p.vaccineType?"":""})}),e.jsx(vt,{children:p.vaccineType&&(()=>{const S=c.find(K=>K.vaccine_type===p.vaccineType),E=(S==null?void 0:S.total_doses)||1,G=[];for(let K=1;K<=E;K++){let re=` ${K}`;K===1?re+=" ()":K===E&&E>2?re+=" ()":K>2&&(re+=" ()"),G.push(e.jsx(Ee,{value:K.toString(),children:re},K))}return G})()})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:p.vaccineType?(()=>{const S=c.find(E=>E.vaccine_type===p.vaccineType);return` ${(S==null?void 0:S.total_doses)||1}  - `})():""})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"notes",children:""}),e.jsx(ae,{id:"notes",value:p.notes,onChange:S=>y({...p,notes:S.target.value}),placeholder:""})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(I,{onClick:j,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),""]})})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"",X]}),e.jsxs(J,{variant:"secondary",children:[s.length," "]})]})}),e.jsxs(R,{children:[e.jsx("div",{className:"space-y-4",children:s.map(S=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:S.patient_name}),e.jsxs(J,{className:F(S.status),children:[U(S.status),e.jsx("span",{className:"ml-1",children:M(S.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),S.vaccine_type]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),S.appointment_time||""]}),S.patient_phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),S.patient_phone]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),S.appointment_id]})]}),S.notes&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:S.notes})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[S.status==="scheduled"&&e.jsxs(e.Fragment,{children:[e.jsxs(I,{size:"sm",onClick:()=>C(S.appointment_id,"completed"),className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>C(S.appointment_id,"no_show"),className:"flex-1 sm:flex-none",children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),""]})]}),S.status==="scheduled"&&new Date(S.appointment_date)<new Date(new Date().toISOString().split("T")[0])&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-yellow-50 border border-yellow-200 rounded-md",children:[e.jsx(Ie,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-xs text-yellow-700",children:""})]})]})]})},S.id))}),s.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(he,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsxs("p",{className:"text-muted-foreground",children:["",X]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:Y?" Walk-in":""})]})]})]})]}),D&&e.jsx(ne,{value:"settings",className:"space-y-6 mt-6",children:e.jsx(ao,{requiredPermission:"system:settings",showLoginForm:!1,fallback:e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ba,{className:"h-12 w-12 text-orange-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-700",children:"Admin Access Required"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" Admin "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})})}),children:e.jsx(Pu,{})})})]})]})},ro=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(!1),[r,i]=m.useState({patientId:"",patientName:"",date:"",time:"",vaccine:"",hospital:"",notes:"",notificationDate:""}),{toast:o}=xe(),c=async()=>{n(!0);try{const{data:u,error:v}=await $.from("patient_registrations").select("id, patient_name, phone_number, line_user_id, registration_id, created_at").order("created_at",{ascending:!1});if(v)throw v;const b=(u==null?void 0:u.map(g=>({id:g.registration_id||g.id,name:g.patient_name,phone:g.phone_number,lineId:g.line_user_id,createdAt:g.created_at})))||[];s(b),o({title:"",description:` ${b.length}   Supabase`})}catch(u){o({title:"",description:u.message||"",variant:"destructive"})}finally{n(!1)}},d=async()=>{if(t.length===0){o({title:"",description:"",variant:"destructive"});return}n(!0);try{const{data:u,error:v}=await $.functions.invoke("google-sheets-integration",{body:{action:"syncPatients",data:t}});if(v)throw v;o({title:"Sync ",description:`Sync  ${t.length}   Google Sheets `})}catch(u){o({title:"Sync ",description:u.message||" sync ",variant:"destructive"})}finally{n(!1)}},x=async()=>{if(!r.patientId||!r.date||!r.time||!r.vaccine){o({title:"",description:"",variant:"destructive"});return}n(!0);try{const u=t.find(g=>g.id===r.patientId);if(!u)throw new Error("");const v={patient_name:u.name,patient_phone:u.phone,patient_id_number:r.patientId,line_user_id:u.lineId,vaccine_type:r.vaccine,appointment_date:r.date,appointment_time:r.time,status:"scheduled",notes:r.notes||` ${r.hospital}`,scheduled_by:"staff_manual"},{error:b}=await $.from("appointments").insert([v]);if(b)throw b;try{await $.functions.invoke("google-sheets-integration",{body:{action:"saveAppointment",data:{...r,patientName:u.name,patientPhone:u.phone,lineId:u.lineId,timestamp:new Date().toISOString()}}}),console.log(" Synced to Google Sheets successfully")}catch(g){console.warn(" Failed to sync to Google Sheets:",g)}o({title:"",description:` ${u.name}  ( sync )`}),i({patientId:"",patientName:"",date:"",time:"",vaccine:"",hospital:"",notes:"",notificationDate:""})}catch(u){o({title:"",description:u.message||"",variant:"destructive"})}finally{n(!1)}},h=async()=>{if(!r.patientId||!r.date){o({title:"",description:"",variant:"destructive"});return}n(!0);try{const u=t.find(g=>g.id===r.patientId);if(!u||!u.lineId)throw new Error(" LINE ID ");const v=` 

 ${u.name}

 : ${r.date}
 : ${r.time}
 : ${r.vaccine}
 : ${r.hospital}

${r.notes?` : ${r.notes}`:""}

`,{error:b}=await $.functions.invoke("send-line-message",{body:{userId:u.lineId,message:v}});if(b)throw b;o({title:"",description:` ${u.name} `})}catch(u){o({title:"",description:u.message||"",variant:"destructive"})}finally{n(!1)}},f=u=>{const v=t.find(b=>b.id===u);v&&i(b=>({...b,patientId:u,patientName:v.name}))},l=async()=>{n(!0);try{const{data:u,error:v}=await $.from("appointments").select("*").order("created_at",{ascending:!1}).limit(100);if(v)throw v;if(!u||u.length===0){o({title:"",description:" sync",variant:"destructive"});return}const{error:b}=await $.functions.invoke("google-sheets-integration",{body:{action:"syncAppointments",data:u}});if(b)throw b;o({title:"Sync ",description:`Sync  ${u.length}   Google Sheets `})}catch(u){o({title:"Sync ",description:u.message||" sync ",variant:"destructive"})}finally{n(!1)}};return m.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs(A,{children:[e.jsx(W,{className:"pb-3 md:pb-4",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"})," Supabase"]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs(I,{onClick:c,disabled:a,className:"h-10 md:h-11",children:[e.jsx(_s,{className:"h-4 w-4 mr-2"}),a?"...":""]}),e.jsxs(I,{onClick:d,disabled:a||t.length===0,variant:"outline",className:"h-10 md:h-11",children:[e.jsx(_s,{className:"h-4 w-4 mr-2"}),a?" Sync...":"Sync  Google Sheets"]})]}),e.jsxs(le,{children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsx("strong",{children:" Dual Backup:"}),"  Supabase ()  sync  Google Sheets () "]})]}),t.length>0&&e.jsxs("div",{className:"bg-muted/50 p-3 md:p-4 rounded-lg border",children:[e.jsxs("p",{className:"text-sm md:text-base font-medium mb-3",children:[": ",t.length," "]}),e.jsx("div",{className:"max-h-32 md:max-h-40 overflow-y-auto space-y-2",children:t.map(u=>e.jsxs("div",{className:"text-xs md:text-sm bg-background p-2 md:p-3 rounded border border-border/30",children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-muted-foreground",children:u.phone})]},u.id))})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-3 md:pb-4",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(he,{className:"h-5 w-5 text-primary"}),""]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"patient",className:"text-sm md:text-base font-medium",children:""}),e.jsxs(_t,{value:r.patientId,onValueChange:f,children:[e.jsx(gt,{className:"mt-1",children:e.jsx(St,{placeholder:""})}),e.jsx(vt,{children:t.filter(u=>u.id&&u.id.trim()!=="").map(u=>e.jsxs(Ee,{value:u.id,children:[u.name," - ",u.phone]},u.id))})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"vaccine",className:"text-sm md:text-base font-medium",children:""}),e.jsxs(_t,{value:r.vaccine,onValueChange:u=>i(v=>({...v,vaccine:u})),children:[e.jsx(gt,{className:"mt-1",children:e.jsx(St,{placeholder:""})}),e.jsxs(vt,{children:[e.jsx(Ee,{value:"COVID-19",children:"COVID-19"}),e.jsx(Ee,{value:"",children:""}),e.jsx(Ee,{value:" + ",children:" + "}),e.jsx(Ee,{value:"HPV",children:"HPV"}),e.jsx(Ee,{value:"MMR",children:"MMR"})]})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"date",className:"text-sm md:text-base font-medium",children:""}),e.jsx(ae,{id:"date",type:"date",value:r.date,onChange:u=>i(v=>({...v,date:u.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"time",className:"text-sm md:text-base font-medium",children:""}),e.jsx(ae,{id:"time",type:"time",value:r.time,onChange:u=>i(v=>({...v,time:u.target.value})),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"notes",className:"text-sm md:text-base font-medium",children:""}),e.jsx(Ot,{id:"notes",placeholder:"",value:r.notes,onChange:u=>i(v=>({...v,notes:u.target.value})),className:"mt-1 min-h-[80px] md:min-h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs(I,{onClick:x,disabled:a,className:"h-10 md:h-11",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),a?"...":""]}),e.jsxs(I,{onClick:l,disabled:a,variant:"outline",className:"h-10 md:h-11",children:[e.jsx(_s,{className:"h-4 w-4 mr-2"}),a?" Sync...":"Sync "]})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-3 md:pb-4",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(Be,{className:"h-5 w-5 text-primary"}),""]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"notificationDate",className:"text-sm md:text-base font-medium",children:""}),e.jsx(ae,{id:"notificationDate",type:"date",value:r.notificationDate,onChange:u=>i(v=>({...v,notificationDate:u.target.value})),className:"mt-1"})]}),e.jsxs(le,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(me,{className:"text-sm md:text-base",children:" LINE  "})]}),e.jsxs(I,{onClick:h,disabled:a,className:"w-full h-10 md:h-11",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),a?"...":""]})]})]})]})},la=768;function Au(){const[t,s]=m.useState(void 0);return m.useEffect(()=>{const a=window.matchMedia(`(max-width: ${la-1}px)`),n=()=>{s(window.innerWidth<la)};return a.addEventListener("change",n),s(window.innerWidth<la),()=>a.removeEventListener("change",n)},[]),!!t}const Ru=ur,Mu=dr,io=m.forwardRef(({className:t,...s},a)=>e.jsx(zs,{className:V("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));io.displayName=zs.displayName;const Lu=Mt("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),oo=m.forwardRef(({side:t="right",className:s,children:a,...n},r)=>e.jsxs(Mu,{children:[e.jsx(io,{}),e.jsxs(Us,{ref:r,className:V(Lu({side:t}),s),...n,children:[a,e.jsxs(mr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));oo.displayName=Us.displayName;const $u=m.forwardRef(({className:t,...s},a)=>e.jsx(Bs,{ref:a,className:V("text-lg font-semibold text-foreground",t),...s}));$u.displayName=Bs.displayName;const Ou=m.forwardRef(({className:t,...s},a)=>e.jsx(Hs,{ref:a,className:V("text-sm text-muted-foreground",t),...s}));Ou.displayName=Hs.displayName;function zn({className:t,...s}){return e.jsx("div",{className:V("animate-pulse rounded-md bg-muted",t),...s})}const Fu="sidebar:state",Wu=60*60*24*7,zu="16rem",Uu="18rem",Bu="3rem",Hu="b",lo=m.createContext(null);function Xs(){const t=m.useContext(lo);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}const co=m.forwardRef(({defaultOpen:t=!0,open:s,onOpenChange:a,className:n,style:r,children:i,...o},c)=>{const d=Au(),[x,h]=m.useState(!1),[f,l]=m.useState(t),u=s??f,v=m.useCallback(y=>{const N=typeof y=="function"?y(u):y;a?a(N):l(N),document.cookie=`${Fu}=${N}; path=/; max-age=${Wu}`},[a,u]),b=m.useCallback(()=>d?h(y=>!y):v(y=>!y),[d,v,h]);m.useEffect(()=>{const y=N=>{N.key===Hu&&(N.metaKey||N.ctrlKey)&&(N.preventDefault(),b())};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[b]);const g=u?"expanded":"collapsed",p=m.useMemo(()=>({state:g,open:u,setOpen:v,isMobile:d,openMobile:x,setOpenMobile:h,toggleSidebar:b}),[g,u,v,d,x,h,b]);return e.jsx(lo.Provider,{value:p,children:e.jsx(Ea,{delayDuration:0,children:e.jsx("div",{style:{"--sidebar-width":zu,"--sidebar-width-icon":Bu,...r},className:V("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:c,...o,children:i})})})});co.displayName="SidebarProvider";const mo=m.forwardRef(({side:t="left",variant:s="sidebar",collapsible:a="offcanvas",className:n,children:r,...i},o)=>{const{isMobile:c,state:d,openMobile:x,setOpenMobile:h}=Xs();return a==="none"?e.jsx("div",{className:V("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:o,...i,children:r}):c?e.jsx(Ru,{open:x,onOpenChange:h,...i,children:e.jsx(oo,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":Uu},side:t,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:r})})}):e.jsxs("div",{ref:o,className:"group peer hidden md:block text-sidebar-foreground","data-state":d,"data-collapsible":d==="collapsed"?a:"","data-variant":s,"data-side":t,children:[e.jsx("div",{className:V("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",s==="floating"||s==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),e.jsx("div",{className:V("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",s==="floating"||s==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...i,children:e.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:r})})]})});mo.displayName="Sidebar";const uo=m.forwardRef(({className:t,onClick:s,...a},n)=>{const{toggleSidebar:r}=Xs();return e.jsxs(I,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:V("h-7 w-7",t),onClick:i=>{s==null||s(i),r()},...a,children:[e.jsx(Yl,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});uo.displayName="SidebarTrigger";const Vu=m.forwardRef(({className:t,...s},a)=>{const{toggleSidebar:n}=Xs();return e.jsx("button",{ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:V("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...s})});Vu.displayName="SidebarRail";const Yu=m.forwardRef(({className:t,...s},a)=>e.jsx("main",{ref:a,className:V("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",t),...s}));Yu.displayName="SidebarInset";const Gu=m.forwardRef(({className:t,...s},a)=>e.jsx(ae,{ref:a,"data-sidebar":"input",className:V("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",t),...s}));Gu.displayName="SidebarInput";const qu=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"header",className:V("flex flex-col gap-2 p-2",t),...s}));qu.displayName="SidebarHeader";const Ku=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"footer",className:V("flex flex-col gap-2 p-2",t),...s}));Ku.displayName="SidebarFooter";const Ju=m.forwardRef(({className:t,...s},a)=>e.jsx(Ae,{ref:a,"data-sidebar":"separator",className:V("mx-2 w-auto bg-sidebar-border",t),...s}));Ju.displayName="SidebarSeparator";const ho=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"content",className:V("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...s}));ho.displayName="SidebarContent";const Ta=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"group",className:V("relative flex w-full min-w-0 flex-col p-2",t),...s}));Ta.displayName="SidebarGroup";const Pa=m.forwardRef(({className:t,asChild:s=!1,...a},n)=>{const r=s?Zt:"div";return e.jsx(r,{ref:n,"data-sidebar":"group-label",className:V("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...a})});Pa.displayName="SidebarGroupLabel";const Xu=m.forwardRef(({className:t,asChild:s=!1,...a},n)=>{const r=s?Zt:"button";return e.jsx(r,{ref:n,"data-sidebar":"group-action",className:V("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",t),...a})});Xu.displayName="SidebarGroupAction";const Aa=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"group-content",className:V("w-full text-sm",t),...s}));Aa.displayName="SidebarGroupContent";const Ra=m.forwardRef(({className:t,...s},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu",className:V("flex w-full min-w-0 flex-col gap-1",t),...s}));Ra.displayName="SidebarMenu";const Ma=m.forwardRef(({className:t,...s},a)=>e.jsx("li",{ref:a,"data-sidebar":"menu-item",className:V("group/menu-item relative",t),...s}));Ma.displayName="SidebarMenuItem";const Qu=Mt("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),La=m.forwardRef(({asChild:t=!1,isActive:s=!1,variant:a="default",size:n="default",tooltip:r,className:i,...o},c)=>{const d=t?Zt:"button",{isMobile:x,state:h}=Xs(),f=e.jsx(d,{ref:c,"data-sidebar":"menu-button","data-size":n,"data-active":s,className:V(Qu({variant:a,size:n}),i),...o});return r?(typeof r=="string"&&(r={children:r}),e.jsxs(Gm,{children:[e.jsx(qm,{asChild:!0,children:f}),e.jsx(Wi,{side:"right",align:"center",hidden:h!=="collapsed"||x,...r})]})):f});La.displayName="SidebarMenuButton";const Zu=m.forwardRef(({className:t,asChild:s=!1,showOnHover:a=!1,...n},r)=>{const i=s?Zt:"button";return e.jsx(i,{ref:r,"data-sidebar":"menu-action",className:V("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",t),...n})});Zu.displayName="SidebarMenuAction";const eh=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"menu-badge",className:V("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t),...s}));eh.displayName="SidebarMenuBadge";const th=m.forwardRef(({className:t,showIcon:s=!1,...a},n)=>{const r=m.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return e.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:V("rounded-md h-8 flex gap-2 px-2 items-center",t),...a,children:[s&&e.jsx(zn,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),e.jsx(zn,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":r}})]})});th.displayName="SidebarMenuSkeleton";const sh=m.forwardRef(({className:t,...s},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu-sub",className:V("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",t),...s}));sh.displayName="SidebarMenuSub";const ah=m.forwardRef(({...t},s)=>e.jsx("li",{ref:s,...t}));ah.displayName="SidebarMenuSubItem";const nh=m.forwardRef(({asChild:t=!1,size:s="md",isActive:a,className:n,...r},i)=>{const o=t?Zt:"a";return e.jsx(o,{ref:i,"data-sidebar":"menu-sub-button","data-size":s,"data-active":a,className:V("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",s==="sm"&&"text-xs",s==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...r})});nh.displayName="SidebarMenuSubButton";const rh=[{title:"",url:"/",icon:Lr,roles:["admin"]},{title:"",url:"/staff-portal",icon:he,roles:["admin","healthcare_staff"]},{title:"",url:"/patient-registrations",icon:Gl,roles:["admin","healthcare_staff"]},{title:"",url:"/next-appointments",icon:he,roles:["admin","healthcare_staff"]},{title:"",url:"/edit-appointments",icon:It,roles:["admin","healthcare_staff"]},{title:"",url:"/past-vaccinations",icon:ja,roles:["admin","healthcare_staff"]},{title:"",url:"/manage-staff",icon:Me,roles:["admin"]},{title:"LINE Bot",url:"/LineBot",icon:us,roles:["admin"]},{title:" LIFF",url:"/liff-checker",icon:Ge,roles:["admin"]}],ih=[{title:"",url:"/admin",icon:Pe,roles:["admin"]}];function oh(){const s=_r().pathname,[a,n]=m.useState("admin");m.useEffect(()=>{const d=async()=>{const{data:{session:h}}=await $.auth.getSession();if(h!=null&&h.user)try{const{data:f}=await $.rpc("has_role",{_user_id:h.user.id,_role:"admin"}),{data:l}=await $.rpc("is_healthcare_staff",{_user_id:h.user.id});n(f?"admin":l?"healthcare_staff":"guest")}catch(f){console.error("Error checking user role:",f),n("admin")}};d();const{data:{subscription:x}}=$.auth.onAuthStateChange(()=>{d()});return()=>x.unsubscribe()},[]);const r=rh.filter(d=>d.roles.includes(a)),i=ih.filter(d=>d.roles.includes(a)),o=d=>d==="/"?s==="/":s.startsWith(d),c=d=>o(d)?"nav-link-active":"nav-link";return e.jsx(mo,{className:"glass-sidebar border-r border-border/20",children:e.jsxs(ho,{className:"bg-gradient-sidebar",children:[e.jsx("div",{className:"p-6 border-b border-border/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden shadow-md",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"",className:"w-full h-full object-contain object-center"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg text-foreground",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}),r.length>0&&e.jsxs(Ta,{children:[e.jsx(Pa,{className:"text-primary font-semibold",children:""}),e.jsx(Aa,{children:e.jsx(Ra,{children:r.map(d=>e.jsx(Ma,{children:e.jsx(La,{asChild:!0,children:e.jsxs(vn,{to:d.url,className:c(d.url),children:[e.jsx(d.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:d.title})]})})},d.title))})})]}),i.length>0&&e.jsxs(Ta,{children:[e.jsx(Pa,{className:"text-medical-error font-semibold",children:""}),e.jsx(Aa,{children:e.jsx(Ra,{children:i.map(d=>e.jsx(Ma,{children:e.jsx(La,{asChild:!0,children:e.jsxs(vn,{to:d.url,className:c(d.url),children:[e.jsx(d.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:d.title})]})})},d.title))})})]}),e.jsx("div",{className:"mt-auto p-6",children:e.jsx("div",{className:"card-glass",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ls,{className:"h-8 w-8 mx-auto text-primary mb-2"}),e.jsx("h3",{className:"font-semibold text-sm text-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": "})]})})})]})})}function Je({children:t,user:s,showSidebar:a=!0,title:n}){const{toast:r}=xe(),i=Rt(),o=async()=>{const{error:c}=await $.auth.signOut();c?r({title:"",description:"",variant:"destructive"}):(i("/auth"),r({title:"",description:""}))};return a?e.jsx(co,{children:e.jsxs("div",{className:"min-h-screen flex w-full bg-gradient-hero",children:[e.jsx(oh,{}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"h-14 md:h-16 bg-white/80 backdrop-blur-xl border-b border-border/50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-full px-3 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(uo,{className:"text-primary hover:bg-primary/10 transition-colors p-1 md:p-2"}),n&&e.jsx("div",{children:e.jsx("h1",{className:"text-lg md:text-xl font-semibold text-foreground truncate",children:n})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-3 px-3 md:px-4 py-1.5 md:py-2 rounded-lg md:rounded-xl bg-accent/50 border border-border/30",children:[e.jsx(Qe,{className:"h-4 w-4 text-primary"}),e.jsx("div",{className:"text-sm",children:e.jsx("p",{className:"font-medium text-foreground truncate max-w-[120px] md:max-w-none",children:s.email})})]}),e.jsxs(I,{onClick:o,variant:"outline",size:"sm",className:"h-8 md:h-9 px-2 md:px-3 border-destructive/20 hover:bg-destructive/10 hover:text-destructive",children:[e.jsx(Ms,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:""})]})]})]})}),e.jsx("main",{className:"flex-1 p-3 md:p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:t})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-hero",children:t})}const lh=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:" - Admin Dashboard",children:e.jsxs(mt,{defaultValue:"designer",className:"w-full",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(qe,{className:"grid w-full grid-cols-8",children:[e.jsx(te,{value:"setup",children:""}),e.jsx(te,{value:"designer",children:"Workflow Designer"}),e.jsx(te,{value:"analyzer",children:"Analyzer"}),e.jsx(te,{value:"LineBot",children:"LINE Bot"}),e.jsx(te,{value:"PatientPortal",children:""}),e.jsx(te,{value:"StaffPortal",children:""}),e.jsx(te,{value:"googlesheets",children:"Google Sheets"}),e.jsx(te,{value:"staff",children:"Dashboard "})]})}),e.jsx(ne,{value:"designer",className:"mt-0",children:e.jsx(vu,{})}),e.jsx(ne,{value:"analyzer",className:"mt-0",children:e.jsx(gu,{})}),e.jsx(ne,{value:"staff",className:"mt-0",children:e.jsx(eo,{})}),e.jsx(ne,{value:"patient",className:"mt-0",children:e.jsx(wu,{})}),e.jsx(ne,{value:"setup",className:"mt-0",children:e.jsx(_u,{})}),e.jsx(ne,{value:"LineBot",className:"mt-0",children:e.jsx(to,{})}),e.jsx(ne,{value:"PatientPortal",className:"mt-0",children:e.jsx(so,{})}),e.jsx(ne,{value:"StaffPortal",className:"mt-0",children:e.jsx(no,{})}),e.jsx(ne,{value:"googlesheets",className:"mt-0",children:e.jsx(ro,{})})]})})},ch=()=>{const t=_r();return m.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Un=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"LINE Bot Management",children:e.jsx(to,{})})},Bn=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:" - Patient Portal",children:e.jsx(so,{})})};var Za="Checkbox",[dh]=ir(Za),[mh,uh]=dh(Za),xo=m.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:n,checked:r,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:x,form:h,...f}=t,[l,u]=m.useState(null),v=Wa(s,_=>u(_)),b=m.useRef(!1),g=l?h||!!l.closest("form"):!0,[p=!1,y]=or({prop:r,defaultProp:i,onChange:x}),N=m.useRef(p);return m.useEffect(()=>{const _=l==null?void 0:l.form;if(_){const D=()=>y(N.current);return _.addEventListener("reset",D),()=>_.removeEventListener("reset",D)}},[l,y]),e.jsxs(mh,{scope:a,state:p,disabled:c,children:[e.jsx(Ke.button,{type:"button",role:"checkbox","aria-checked":wt(p)?"mixed":p,"aria-required":o,"data-state":go(p),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:v,onKeyDown:Ve(t.onKeyDown,_=>{_.key==="Enter"&&_.preventDefault()}),onClick:Ve(t.onClick,_=>{y(D=>wt(D)?!0:!D),g&&(b.current=_.isPropagationStopped(),b.current||_.stopPropagation())})}),g&&e.jsx(hh,{control:l,bubbles:!b.current,name:n,value:d,checked:p,required:o,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:wt(i)?!1:i})]})});xo.displayName=Za;var po="CheckboxIndicator",fo=m.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:n,...r}=t,i=uh(po,a);return e.jsx(lr,{present:n||wt(i.state)||i.state===!0,children:e.jsx(Ke.span,{"data-state":go(i.state),"data-disabled":i.disabled?"":void 0,...r,ref:s,style:{pointerEvents:"none",...t.style}})})});fo.displayName=po;var hh=t=>{const{control:s,checked:a,bubbles:n=!0,defaultChecked:r,...i}=t,o=m.useRef(null),c=Il(a),d=Tl(s);m.useEffect(()=>{const h=o.current,f=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==a&&u){const v=new Event("click",{bubbles:n});h.indeterminate=wt(a),u.call(h,wt(a)?!1:a),h.dispatchEvent(v)}},[c,a,n]);const x=m.useRef(wt(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r??x.current,...i,tabIndex:-1,ref:o,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function wt(t){return t==="indeterminate"}function go(t){return wt(t)?"indeterminate":t?"checked":"unchecked"}var vo=xo,xh=fo;const Os=m.forwardRef(({className:t,...s},a)=>e.jsx(vo,{ref:a,className:V("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(xh,{className:V("flex items-center justify-center text-current"),children:e.jsx(kr,{className:"h-4 w-4"})})}));Os.displayName=vo.displayName;function ce(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function He(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}function Se(t,s){const a=ce(t);return isNaN(s)?He(t,NaN):(s&&a.setDate(a.getDate()+s),a)}function Ze(t,s){const a=ce(t);if(isNaN(s))return He(t,NaN);if(!s)return a;const n=a.getDate(),r=He(t,a.getTime());r.setMonth(a.getMonth()+s+1,0);const i=r.getDate();return n>=i?r:(a.setFullYear(r.getFullYear(),r.getMonth(),n),a)}const en=6048e5,ph=864e5,bo=6e4,jo=36e5;let fh={};function vs(){return fh}function dt(t,s){var c,d,x,h;const a=vs(),n=(s==null?void 0:s.weekStartsOn)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??a.weekStartsOn??((h=(x=a.locale)==null?void 0:x.options)==null?void 0:h.weekStartsOn)??0,r=ce(t),i=r.getDay(),o=(i<n?7:0)+i-n;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function At(t){return dt(t,{weekStartsOn:1})}function yo(t){const s=ce(t),a=s.getFullYear(),n=He(t,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const r=At(n),i=He(t,0);i.setFullYear(a,0,4),i.setHours(0,0,0,0);const o=At(i);return s.getTime()>=r.getTime()?a+1:s.getTime()>=o.getTime()?a:a-1}function Qt(t){const s=ce(t);return s.setHours(0,0,0,0),s}function Fs(t){const s=ce(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function Xe(t,s){const a=Qt(t),n=Qt(s),r=+a-Fs(a),i=+n-Fs(n);return Math.round((r-i)/ph)}function gh(t){const s=yo(t),a=He(t,0);return a.setFullYear(s,0,4),a.setHours(0,0,0,0),At(a)}function $a(t,s){const a=s*7;return Se(t,a)}function vh(t,s){return Ze(t,s*12)}function bh(t){let s;return t.forEach(function(a){const n=ce(a);(s===void 0||s<n||isNaN(Number(n)))&&(s=n)}),s||new Date(NaN)}function jh(t){let s;return t.forEach(a=>{const n=ce(a);(!s||s>n||isNaN(+n))&&(s=n)}),s||new Date(NaN)}function Oe(t,s){const a=Qt(t),n=Qt(s);return+a==+n}function tn(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function yh(t){if(!tn(t)&&typeof t!="number")return!1;const s=ce(t);return!isNaN(Number(s))}function xs(t,s){const a=ce(t),n=ce(s),r=a.getFullYear()-n.getFullYear(),i=a.getMonth()-n.getMonth();return r*12+i}function Nh(t,s,a){const n=dt(t,a),r=dt(s,a),i=+n-Fs(n),o=+r-Fs(r);return Math.round((i-o)/en)}function ca(t,s){const a=ce(t),n=ce(s),r=Hn(a,n),i=Math.abs(Xe(a,n));a.setDate(a.getDate()-r*i);const o=+(Hn(a,n)===-r),c=r*(i-o);return c===0?0:c}function Hn(t,s){const a=t.getFullYear()-s.getFullYear()||t.getMonth()-s.getMonth()||t.getDate()-s.getDate()||t.getHours()-s.getHours()||t.getMinutes()-s.getMinutes()||t.getSeconds()-s.getSeconds()||t.getMilliseconds()-s.getMilliseconds();return a<0?-1:a>0?1:a}function sn(t){const s=ce(t),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(23,59,59,999),s}function Fe(t){const s=ce(t);return s.setDate(1),s.setHours(0,0,0,0),s}function No(t){const s=ce(t),a=He(t,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}function an(t,s){var c,d,x,h;const a=vs(),n=(s==null?void 0:s.weekStartsOn)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??a.weekStartsOn??((h=(x=a.locale)==null?void 0:x.options)==null?void 0:h.weekStartsOn)??0,r=ce(t),i=r.getDay(),o=(i<n?-7:0)+6-(i-n);return r.setDate(r.getDate()+o),r.setHours(23,59,59,999),r}function wo(t){return an(t,{weekStartsOn:1})}const wh={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_h=(t,s,a)=>{let n;const r=wh[t];return typeof r=="string"?n=r:s===1?n=r.one:n=r.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+n:n+" ago":n};function Kt(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const Sh={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ch={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},kh={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Dh={date:Kt({formats:Sh,defaultWidth:"full"}),time:Kt({formats:Ch,defaultWidth:"full"}),dateTime:Kt({formats:kh,defaultWidth:"full"})},Eh={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ih=(t,s,a,n)=>Eh[t];function rt(t){return(s,a)=>{const n=a!=null&&a.context?String(a.context):"standalone";let r;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=a!=null&&a.width?String(a.width):o;r=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=a!=null&&a.width?String(a.width):t.defaultWidth;r=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return r[i]}}const Th={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ph={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ah={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Rh={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Mh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Lh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$h=(t,s)=>{const a=Number(t),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},Oh={ordinalNumber:$h,era:rt({values:Th,defaultWidth:"wide"}),quarter:rt({values:Ph,defaultWidth:"wide",argumentCallback:t=>t-1}),month:rt({values:Ah,defaultWidth:"wide"}),day:rt({values:Rh,defaultWidth:"wide"}),dayPeriod:rt({values:Mh,defaultWidth:"wide",formattingValues:Lh,defaultFormattingWidth:"wide"})};function it(t){return(s,a={})=>{const n=a.width,r=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=s.match(r);if(!i)return null;const o=i[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?Wh(c,f=>f.test(o)):Fh(c,f=>f.test(o));let x;x=t.valueCallback?t.valueCallback(d):d,x=a.valueCallback?a.valueCallback(x):x;const h=s.slice(o.length);return{value:x,rest:h}}}function Fh(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function Wh(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function _o(t){return(s,a={})=>{const n=s.match(t.matchPattern);if(!n)return null;const r=n[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=a.valueCallback?a.valueCallback(o):o;const c=s.slice(r.length);return{value:o,rest:c}}}const zh=/^(\d+)(th|st|nd|rd)?/i,Uh=/\d+/i,Bh={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Hh={any:[/^b/i,/^(a|c)/i]},Vh={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Yh={any:[/1/i,/2/i,/3/i,/4/i]},Gh={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},qh={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Kh={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Jh={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Xh={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Qh={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Zh={ordinalNumber:_o({matchPattern:zh,parsePattern:Uh,valueCallback:t=>parseInt(t,10)}),era:it({matchPatterns:Bh,defaultMatchWidth:"wide",parsePatterns:Hh,defaultParseWidth:"any"}),quarter:it({matchPatterns:Vh,defaultMatchWidth:"wide",parsePatterns:Yh,defaultParseWidth:"any",valueCallback:t=>t+1}),month:it({matchPatterns:Gh,defaultMatchWidth:"wide",parsePatterns:qh,defaultParseWidth:"any"}),day:it({matchPatterns:Kh,defaultMatchWidth:"wide",parsePatterns:Jh,defaultParseWidth:"any"}),dayPeriod:it({matchPatterns:Xh,defaultMatchWidth:"any",parsePatterns:Qh,defaultParseWidth:"any"})},So={code:"en-US",formatDistance:_h,formatLong:Dh,formatRelative:Ih,localize:Oh,match:Zh,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ex(t){const s=ce(t);return Xe(s,No(s))+1}function Co(t){const s=ce(t),a=+At(s)-+gh(s);return Math.round(a/en)+1}function ko(t,s){var h,f,l,u;const a=ce(t),n=a.getFullYear(),r=vs(),i=(s==null?void 0:s.firstWeekContainsDate)??((f=(h=s==null?void 0:s.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(l=r.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??1,o=He(t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const c=dt(o,s),d=He(t,0);d.setFullYear(n,0,i),d.setHours(0,0,0,0);const x=dt(d,s);return a.getTime()>=c.getTime()?n+1:a.getTime()>=x.getTime()?n:n-1}function tx(t,s){var c,d,x,h;const a=vs(),n=(s==null?void 0:s.firstWeekContainsDate)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(x=a.locale)==null?void 0:x.options)==null?void 0:h.firstWeekContainsDate)??1,r=ko(t,s),i=He(t,0);return i.setFullYear(r,0,n),i.setHours(0,0,0,0),dt(i,s)}function Do(t,s){const a=ce(t),n=+dt(a,s)-+tx(a,s);return Math.round(n/en)+1}function fe(t,s){const a=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return a+n}const Nt={y(t,s){const a=t.getFullYear(),n=a>0?a:1-a;return fe(s==="yy"?n%100:n,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):fe(a+1,2)},d(t,s){return fe(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return fe(t.getHours()%12||12,s.length)},H(t,s){return fe(t.getHours(),s.length)},m(t,s){return fe(t.getMinutes(),s.length)},s(t,s){return fe(t.getSeconds(),s.length)},S(t,s){const a=s.length,n=t.getMilliseconds(),r=Math.trunc(n*Math.pow(10,a-3));return fe(r,s.length)}},Bt={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vn={G:function(t,s,a){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(n,{width:"abbreviated"});case"GGGGG":return a.era(n,{width:"narrow"});case"GGGG":default:return a.era(n,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const n=t.getFullYear(),r=n>0?n:1-n;return a.ordinalNumber(r,{unit:"year"})}return Nt.y(t,s)},Y:function(t,s,a,n){const r=ko(t,n),i=r>0?r:1-r;if(s==="YY"){const o=i%100;return fe(o,2)}return s==="Yo"?a.ordinalNumber(i,{unit:"year"}):fe(i,s.length)},R:function(t,s){const a=yo(t);return fe(a,s.length)},u:function(t,s){const a=t.getFullYear();return fe(a,s.length)},Q:function(t,s,a){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return fe(n,2);case"Qo":return a.ordinalNumber(n,{unit:"quarter"});case"QQQ":return a.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,a){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return fe(n,2);case"qo":return a.ordinalNumber(n,{unit:"quarter"});case"qqq":return a.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,a){const n=t.getMonth();switch(s){case"M":case"MM":return Nt.M(t,s);case"Mo":return a.ordinalNumber(n+1,{unit:"month"});case"MMM":return a.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,a){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return fe(n+1,2);case"Lo":return a.ordinalNumber(n+1,{unit:"month"});case"LLL":return a.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,a,n){const r=Do(t,n);return s==="wo"?a.ordinalNumber(r,{unit:"week"}):fe(r,s.length)},I:function(t,s,a){const n=Co(t);return s==="Io"?a.ordinalNumber(n,{unit:"week"}):fe(n,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):Nt.d(t,s)},D:function(t,s,a){const n=ex(t);return s==="Do"?a.ordinalNumber(n,{unit:"dayOfYear"}):fe(n,s.length)},E:function(t,s,a){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(n,{width:"short",context:"formatting"});case"EEEE":default:return a.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,a,n){const r=t.getDay(),i=(r-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return fe(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})}},c:function(t,s,a,n){const r=t.getDay(),i=(r-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return fe(i,s.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})}},i:function(t,s,a){const n=t.getDay(),r=n===0?7:n;switch(s){case"i":return String(r);case"ii":return fe(r,s.length);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return a.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(n,{width:"short",context:"formatting"});case"iiii":default:return a.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,a){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,s,a){const n=t.getHours();let r;switch(n===12?r=Bt.noon:n===0?r=Bt.midnight:r=n/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,s,a){const n=t.getHours();let r;switch(n>=17?r=Bt.evening:n>=12?r=Bt.afternoon:n>=4?r=Bt.morning:r=Bt.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),a.ordinalNumber(n,{unit:"hour"})}return Nt.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):Nt.H(t,s)},K:function(t,s,a){const n=t.getHours()%12;return s==="Ko"?a.ordinalNumber(n,{unit:"hour"}):fe(n,s.length)},k:function(t,s,a){let n=t.getHours();return n===0&&(n=24),s==="ko"?a.ordinalNumber(n,{unit:"hour"}):fe(n,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):Nt.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):Nt.s(t,s)},S:function(t,s){return Nt.S(t,s)},X:function(t,s,a){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return Gn(n);case"XXXX":case"XX":return Dt(n);case"XXXXX":case"XXX":default:return Dt(n,":")}},x:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"x":return Gn(n);case"xxxx":case"xx":return Dt(n);case"xxxxx":case"xxx":default:return Dt(n,":")}},O:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Yn(n,":");case"OOOO":default:return"GMT"+Dt(n,":")}},z:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Yn(n,":");case"zzzz":default:return"GMT"+Dt(n,":")}},t:function(t,s,a){const n=Math.trunc(t.getTime()/1e3);return fe(n,s.length)},T:function(t,s,a){const n=t.getTime();return fe(n,s.length)}};function Yn(t,s=""){const a=t>0?"-":"+",n=Math.abs(t),r=Math.trunc(n/60),i=n%60;return i===0?a+String(r):a+String(r)+s+fe(i,2)}function Gn(t,s){return t%60===0?(t>0?"-":"+")+fe(Math.abs(t)/60,2):Dt(t,s)}function Dt(t,s=""){const a=t>0?"-":"+",n=Math.abs(t),r=fe(Math.trunc(n/60),2),i=fe(n%60,2);return a+r+s+i}const qn=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Eo=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},sx=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],n=a[1],r=a[2];if(!r)return qn(t,s);let i;switch(n){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",qn(n,s)).replace("{{time}}",Eo(r,s))},ax={p:Eo,P:sx},nx=/^D+$/,rx=/^Y+$/,ix=["D","DD","YY","YYYY"];function ox(t){return nx.test(t)}function lx(t){return rx.test(t)}function cx(t,s,a){const n=dx(t,s,a);if(console.warn(n),ix.includes(t))throw new RangeError(n)}function dx(t,s,a){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const mx=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ux=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hx=/^'([^]*?)'?$/,xx=/''/g,px=/[a-zA-Z]/;function Re(t,s,a){var h,f,l,u,v,b,g,p;const n=vs(),r=(a==null?void 0:a.locale)??n.locale??So,i=(a==null?void 0:a.firstWeekContainsDate)??((f=(h=a==null?void 0:a.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(l=n.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??1,o=(a==null?void 0:a.weekStartsOn)??((b=(v=a==null?void 0:a.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((p=(g=n.locale)==null?void 0:g.options)==null?void 0:p.weekStartsOn)??0,c=ce(t);if(!yh(c))throw new RangeError("Invalid time value");let d=s.match(ux).map(y=>{const N=y[0];if(N==="p"||N==="P"){const _=ax[N];return _(y,r.formatLong)}return y}).join("").match(mx).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const N=y[0];if(N==="'")return{isToken:!1,value:fx(y)};if(Vn[N])return{isToken:!0,value:y};if(N.match(px))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:y}});r.localize.preprocessor&&(d=r.localize.preprocessor(c,d));const x={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return d.map(y=>{if(!y.isToken)return y.value;const N=y.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&lx(N)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&ox(N))&&cx(N,s,String(t));const _=Vn[N[0]];return _(c,N,r.localize,x)}).join("")}function fx(t){const s=t.match(hx);return s?s[1].replace(xx,"'"):t}function gx(t){const s=ce(t),a=s.getFullYear(),n=s.getMonth(),r=He(t,0);return r.setFullYear(a,n+1,0),r.setHours(0,0,0,0),r.getDate()}function vx(t){return Math.trunc(+ce(t)/1e3)}function bx(t){const s=ce(t),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(0,0,0,0),s}function jx(t,s){return Nh(bx(t),Fe(t),s)+1}function Oa(t,s){const a=ce(t),n=ce(s);return a.getTime()>n.getTime()}function Io(t,s){const a=ce(t),n=ce(s);return+a<+n}function nn(t,s){const a=ce(t),n=ce(s);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}function yx(t,s){const a=ce(t),n=ce(s);return a.getFullYear()===n.getFullYear()}function da(t,s){return Se(t,-s)}function ma(t,s){const n=Sx(t);let r;if(n.date){const d=Cx(n.date,2);r=kx(d.restDateString,d.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const i=r.getTime();let o=0,c;if(n.time&&(o=Dx(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(c=Ex(n.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+o),x=new Date(0);return x.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),x.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),x}return new Date(i+o+c)}const Is={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Nx=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,wx=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_x=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Sx(t){const s={},a=t.split(Is.dateTimeDelimiter);let n;if(a.length>2)return s;if(/:/.test(a[0])?n=a[0]:(s.date=a[0],n=a[1],Is.timeZoneDelimiter.test(s.date)&&(s.date=t.split(Is.timeZoneDelimiter)[0],n=t.substr(s.date.length,t.length))),n){const r=Is.timezone.exec(n);r?(s.time=n.replace(r[1],""),s.timezone=r[1]):s.time=n}return s}function Cx(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),n=t.match(a);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?r:i*100,restDateString:t.slice((n[1]||n[2]).length)}}function kx(t,s){if(s===null)return new Date(NaN);const a=t.match(Nx);if(!a)return new Date(NaN);const n=!!a[4],r=os(a[1]),i=os(a[2])-1,o=os(a[3]),c=os(a[4]),d=os(a[5])-1;if(n)return Rx(s,c,d)?Ix(s,c,d):new Date(NaN);{const x=new Date(0);return!Px(s,i,o)||!Ax(s,r)?new Date(NaN):(x.setUTCFullYear(s,i,Math.max(r,o)),x)}}function os(t){return t?parseInt(t):1}function Dx(t){const s=t.match(wx);if(!s)return NaN;const a=ua(s[1]),n=ua(s[2]),r=ua(s[3]);return Mx(a,n,r)?a*jo+n*bo+r*1e3:NaN}function ua(t){return t&&parseFloat(t.replace(",","."))||0}function Ex(t){if(t==="Z")return 0;const s=t.match(_x);if(!s)return 0;const a=s[1]==="+"?-1:1,n=parseInt(s[2]),r=s[3]&&parseInt(s[3])||0;return Lx(n,r)?a*(n*jo+r*bo):NaN}function Ix(t,s,a){const n=new Date(0);n.setUTCFullYear(t,0,4);const r=n.getUTCDay()||7,i=(s-1)*7+a+1-r;return n.setUTCDate(n.getUTCDate()+i),n}const Tx=[31,null,31,30,31,30,31,31,30,31,30,31];function To(t){return t%400===0||t%4===0&&t%100!==0}function Px(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(Tx[s]||(To(t)?29:28))}function Ax(t,s){return s>=1&&s<=(To(t)?366:365)}function Rx(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function Mx(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function Lx(t,s){return s>=0&&s<=59}function ha(t,s){const a=ce(t),n=a.getFullYear(),r=a.getDate(),i=He(t,0);i.setFullYear(n,s,15),i.setHours(0,0,0,0);const o=gx(i);return a.setMonth(s,Math.min(r,o)),a}function Kn(t,s){const a=ce(t);return isNaN(+a)?He(t,NaN):(a.setFullYear(s),a)}const $x={lessThanXSeconds:{one:" 1 ",other:" {{count}} "},xSeconds:{one:"1 ",other:"{{count}} "},halfAMinute:"",lessThanXMinutes:{one:" 1 ",other:" {{count}} "},xMinutes:{one:"1 ",other:"{{count}} "},aboutXHours:{one:" 1 ",other:" {{count}} "},xHours:{one:"1 ",other:"{{count}} "},xDays:{one:"1 ",other:"{{count}} "},aboutXWeeks:{one:" 1 ",other:" {{count}} "},xWeeks:{one:"1 ",other:"{{count}} "},aboutXMonths:{one:" 1 ",other:" {{count}} "},xMonths:{one:"1 ",other:"{{count}} "},aboutXYears:{one:" 1 ",other:" {{count}} "},xYears:{one:"1 ",other:"{{count}} "},overXYears:{one:" 1 ",other:" {{count}} "},almostXYears:{one:" 1 ",other:" {{count}} "}},Ox=(t,s,a)=>{let n;const r=$x[t];return typeof r=="string"?n=r:s===1?n=r.one:n=r.other.replace("{{count}}",String(s)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?t==="halfAMinute"?""+n:" "+n:n+"":n},Fx={full:"EEEE do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},Wx={full:"H:mm:ss . zzzz",long:"H:mm:ss . z",medium:"H:mm:ss .",short:"H:mm ."},zx={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ux={date:Kt({formats:Fx,defaultWidth:"full"}),time:Kt({formats:Wx,defaultWidth:"medium"}),dateTime:Kt({formats:zx,defaultWidth:"full"})},Bx={lastWeek:"eeee'' p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"eeee '' p",other:"P"},Hx=(t,s,a,n)=>Bx[t],Vx={narrow:["B",""],abbreviated:["BC",".."],wide:["",""]},Yx={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["","","",""]},Gx={narrow:[".",".",".",".",".",".","."],short:[".",".",".",".",".",".","."],abbreviated:[".",".",".",".",".",".","."],wide:["","","","","","",""]},qx={narrow:["..","..","..","..","..","..","..","..","..","..","..",".."],abbreviated:["..","..","..","..","..","..","..","..","..","..","..",".."],wide:["","","","","","","","","","","",""]},Kx={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},Jx={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},Xx=(t,s)=>String(t),Qx={ordinalNumber:Xx,era:rt({values:Vx,defaultWidth:"wide"}),quarter:rt({values:Yx,defaultWidth:"wide",argumentCallback:t=>t-1}),month:rt({values:qx,defaultWidth:"wide"}),day:rt({values:Gx,defaultWidth:"wide"}),dayPeriod:rt({values:Kx,defaultWidth:"wide",formattingValues:Jx,defaultFormattingWidth:"wide"})},Zx=/^\d+/i,ep=/\d+/i,tp={narrow:/^([bB]|[aA]|)/i,abbreviated:/^([bB]\.?\s?[cC]\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?|\.?\.?)/i,wide:/^(||)/i},sp={any:[/^[bB]/i,/^(^[aA]|\.?\.?|||)/i]},ap={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^()? ?[1234]/i},np={any:[/(1||)/i,/(2|)/i,/(3|)/i,/(4|)/i]},rp={narrow:/^(\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?)/i,abbreviated:/^(\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?|\.?\.?')/i,wide:/^(|||||||||||)/i},ip={wide:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i,/^\.?\.?/i]},op={narrow:/^(\.?|\.?|\.?|\.?|\.?|\.?|\.?)/i,short:/^(\.?|\.?|\.?|\.?|\.?|\.?|\.?)/i,abbreviated:/^(\.?|\.?|\.?|\.?|\.?|\.?|\.?)/i,wide:/^(||||||)/i},lp={wide:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^(?!)/i,/^/i,/^/i,/^/i]},cp={any:/^(||||(.*?)?.*(||||))/i},dp={any:{am:/^/i,pm:/^/i,midnight:/^/i,noon:/^/i,morning://i,afternoon://i,evening://i,night://i}},mp={ordinalNumber:_o({matchPattern:Zx,parsePattern:ep,valueCallback:t=>parseInt(t,10)}),era:it({matchPatterns:tp,defaultMatchWidth:"wide",parsePatterns:sp,defaultParseWidth:"any"}),quarter:it({matchPatterns:ap,defaultMatchWidth:"wide",parsePatterns:np,defaultParseWidth:"any",valueCallback:t=>t+1}),month:it({matchPatterns:rp,defaultMatchWidth:"wide",parsePatterns:ip,defaultParseWidth:"any"}),day:it({matchPatterns:op,defaultMatchWidth:"wide",parsePatterns:lp,defaultParseWidth:"any"}),dayPeriod:it({matchPatterns:cp,defaultMatchWidth:"any",parsePatterns:dp,defaultParseWidth:"any"})},ms={code:"th",formatDistance:Ox,formatLong:Ux,formatRelative:Hx,localize:Qx,match:mp,options:{weekStartsOn:0,firstWeekContainsDate:1}};var se=function(){return se=Object.assign||function(s){for(var a,n=1,r=arguments.length;n<r;n++){a=arguments[n];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])}return s},se.apply(this,arguments)};function up(t,s){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)s.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(a[n[r]]=t[n[r]]);return a}function Po(t,s,a){for(var n=0,r=s.length,i;n<r;n++)(i||!(n in s))&&(i||(i=Array.prototype.slice.call(s,0,n)),i[n]=s[n]);return t.concat(i||Array.prototype.slice.call(s))}function bs(t){return t.mode==="multiple"}function js(t){return t.mode==="range"}function Qs(t){return t.mode==="single"}var hp={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function xp(t,s){return Re(t,"LLLL y",s)}function pp(t,s){return Re(t,"d",s)}function fp(t,s){return Re(t,"LLLL",s)}function gp(t){return"".concat(t)}function vp(t,s){return Re(t,"cccccc",s)}function bp(t,s){return Re(t,"yyyy",s)}var jp=Object.freeze({__proto__:null,formatCaption:xp,formatDay:pp,formatMonthCaption:fp,formatWeekNumber:gp,formatWeekdayName:vp,formatYearCaption:bp}),yp=function(t,s,a){return Re(t,"do MMMM (EEEE)",a)},Np=function(){return"Month: "},wp=function(){return"Go to next month"},_p=function(){return"Go to previous month"},Sp=function(t,s){return Re(t,"cccc",s)},Cp=function(t){return"Week n. ".concat(t)},kp=function(){return"Year: "},Dp=Object.freeze({__proto__:null,labelDay:yp,labelMonthDropdown:Np,labelNext:wp,labelPrevious:_p,labelWeekNumber:Cp,labelWeekday:Sp,labelYearDropdown:kp});function Ep(){var t="buttons",s=hp,a=So,n={},r={},i=1,o={},c=new Date;return{captionLayout:t,classNames:s,formatters:jp,labels:Dp,locale:a,modifiersClassNames:n,modifiers:r,numberOfMonths:i,styles:o,today:c,mode:"default"}}function Ip(t){var s=t.fromYear,a=t.toYear,n=t.fromMonth,r=t.toMonth,i=t.fromDate,o=t.toDate;return n?i=Fe(n):s&&(i=new Date(s,0,1)),r?o=sn(r):a&&(o=new Date(a,11,31)),{fromDate:i?Qt(i):void 0,toDate:o?Qt(o):void 0}}var Ao=m.createContext(void 0);function Tp(t){var s,a=t.initialProps,n=Ep(),r=Ip(a),i=r.fromDate,o=r.toDate,c=(s=a.captionLayout)!==null&&s!==void 0?s:n.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(Qs(a)||bs(a)||js(a))&&(d=a.onSelect);var x=se(se(se({},n),a),{captionLayout:c,classNames:se(se({},n.classNames),a.classNames),components:se({},a.components),formatters:se(se({},n.formatters),a.formatters),fromDate:i,labels:se(se({},n.labels),a.labels),mode:a.mode||n.mode,modifiers:se(se({},n.modifiers),a.modifiers),modifiersClassNames:se(se({},n.modifiersClassNames),a.modifiersClassNames),onSelect:d,styles:se(se({},n.styles),a.styles),toDate:o});return e.jsx(Ao.Provider,{value:x,children:t.children})}function ye(){var t=m.useContext(Ao);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function Ro(t){var s=ye(),a=s.locale,n=s.classNames,r=s.styles,i=s.formatters.formatCaption;return e.jsx("div",{className:n.caption_label,style:r.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:i(t.displayMonth,{locale:a})})}function Pp(t){return e.jsx("svg",se({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Mo(t){var s,a,n=t.onChange,r=t.value,i=t.children,o=t.caption,c=t.className,d=t.style,x=ye(),h=(a=(s=x.components)===null||s===void 0?void 0:s.IconDropdown)!==null&&a!==void 0?a:Pp;return e.jsxs("div",{className:c,style:d,children:[e.jsx("span",{className:x.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:x.classNames.dropdown,style:x.styles.dropdown,value:r,onChange:n,children:i}),e.jsxs("div",{className:x.classNames.caption_label,style:x.styles.caption_label,"aria-hidden":"true",children:[o,e.jsx(h,{className:x.classNames.dropdown_icon,style:x.styles.dropdown_icon})]})]})}function Ap(t){var s,a=ye(),n=a.fromDate,r=a.toDate,i=a.styles,o=a.locale,c=a.formatters.formatMonthCaption,d=a.classNames,x=a.components,h=a.labels.labelMonthDropdown;if(!n)return e.jsx(e.Fragment,{});if(!r)return e.jsx(e.Fragment,{});var f=[];if(yx(n,r))for(var l=Fe(n),u=n.getMonth();u<=r.getMonth();u++)f.push(ha(l,u));else for(var l=Fe(new Date),u=0;u<=11;u++)f.push(ha(l,u));var v=function(g){var p=Number(g.target.value),y=ha(Fe(t.displayMonth),p);t.onChange(y)},b=(s=x==null?void 0:x.Dropdown)!==null&&s!==void 0?s:Mo;return e.jsx(b,{name:"months","aria-label":h(),className:d.dropdown_month,style:i.dropdown_month,onChange:v,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:o}),children:f.map(function(g){return e.jsx("option",{value:g.getMonth(),children:c(g,{locale:o})},g.getMonth())})})}function Rp(t){var s,a=t.displayMonth,n=ye(),r=n.fromDate,i=n.toDate,o=n.locale,c=n.styles,d=n.classNames,x=n.components,h=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,l=[];if(!r)return e.jsx(e.Fragment,{});if(!i)return e.jsx(e.Fragment,{});for(var u=r.getFullYear(),v=i.getFullYear(),b=u;b<=v;b++)l.push(Kn(No(new Date),b));var g=function(y){var N=Kn(Fe(a),Number(y.target.value));t.onChange(N)},p=(s=x==null?void 0:x.Dropdown)!==null&&s!==void 0?s:Mo;return e.jsx(p,{name:"years","aria-label":f(),className:d.dropdown_year,style:c.dropdown_year,onChange:g,value:a.getFullYear(),caption:h(a,{locale:o}),children:l.map(function(y){return e.jsx("option",{value:y.getFullYear(),children:h(y,{locale:o})},y.getFullYear())})})}function Mp(t,s){var a=m.useState(t),n=a[0],r=a[1],i=s===void 0?n:s;return[i,r]}function Lp(t){var s=t.month,a=t.defaultMonth,n=t.today,r=s||a||n||new Date,i=t.toDate,o=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(i&&xs(i,r)<0){var x=-1*(d-1);r=Ze(i,x)}return o&&xs(r,o)<0&&(r=o),Fe(r)}function $p(){var t=ye(),s=Lp(t),a=Mp(s,t.month),n=a[0],r=a[1],i=function(o){var c;if(!t.disableNavigation){var d=Fe(o);r(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[n,i]}function Op(t,s){for(var a=s.reverseMonths,n=s.numberOfMonths,r=Fe(t),i=Fe(Ze(r,n)),o=xs(i,r),c=[],d=0;d<o;d++){var x=Ze(r,d);c.push(x)}return a&&(c=c.reverse()),c}function Fp(t,s){if(!s.disableNavigation){var a=s.toDate,n=s.pagedNavigation,r=s.numberOfMonths,i=r===void 0?1:r,o=n?i:1,c=Fe(t);if(!a)return Ze(c,o);var d=xs(a,t);if(!(d<i))return Ze(c,o)}}function Wp(t,s){if(!s.disableNavigation){var a=s.fromDate,n=s.pagedNavigation,r=s.numberOfMonths,i=r===void 0?1:r,o=n?i:1,c=Fe(t);if(!a)return Ze(c,-o);var d=xs(c,a);if(!(d<=0))return Ze(c,-o)}}var Lo=m.createContext(void 0);function zp(t){var s=ye(),a=$p(),n=a[0],r=a[1],i=Op(n,s),o=Fp(n,s),c=Wp(n,s),d=function(f){return i.some(function(l){return nn(f,l)})},x=function(f,l){d(f)||(l&&Io(f,l)?r(Ze(f,1+s.numberOfMonths*-1)):r(f))},h={currentMonth:n,displayMonths:i,goToMonth:r,goToDate:x,previousMonth:c,nextMonth:o,isDateDisplayed:d};return e.jsx(Lo.Provider,{value:h,children:t.children})}function ys(){var t=m.useContext(Lo);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function Jn(t){var s,a=ye(),n=a.classNames,r=a.styles,i=a.components,o=ys().goToMonth,c=function(h){o(Ze(h,t.displayIndex?-t.displayIndex:0))},d=(s=i==null?void 0:i.CaptionLabel)!==null&&s!==void 0?s:Ro,x=e.jsx(d,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:n.caption_dropdowns,style:r.caption_dropdowns,children:[e.jsx("div",{className:n.vhidden,children:x}),e.jsx(Ap,{onChange:c,displayMonth:t.displayMonth}),e.jsx(Rp,{onChange:c,displayMonth:t.displayMonth})]})}function Up(t){return e.jsx("svg",se({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Bp(t){return e.jsx("svg",se({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Ws=m.forwardRef(function(t,s){var a=ye(),n=a.classNames,r=a.styles,i=[n.button_reset,n.button];t.className&&i.push(t.className);var o=i.join(" "),c=se(se({},r.button_reset),r.button);return t.style&&Object.assign(c,t.style),e.jsx("button",se({},t,{ref:s,type:"button",className:o,style:c}))});function Hp(t){var s,a,n=ye(),r=n.dir,i=n.locale,o=n.classNames,c=n.styles,d=n.labels,x=d.labelPrevious,h=d.labelNext,f=n.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var l=x(t.previousMonth,{locale:i}),u=[o.nav_button,o.nav_button_previous].join(" "),v=h(t.nextMonth,{locale:i}),b=[o.nav_button,o.nav_button_next].join(" "),g=(s=f==null?void 0:f.IconRight)!==null&&s!==void 0?s:Bp,p=(a=f==null?void 0:f.IconLeft)!==null&&a!==void 0?a:Up;return e.jsxs("div",{className:o.nav,style:c.nav,children:[!t.hidePrevious&&e.jsx(Ws,{name:"previous-month","aria-label":l,className:u,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:r==="rtl"?e.jsx(g,{className:o.nav_icon,style:c.nav_icon}):e.jsx(p,{className:o.nav_icon,style:c.nav_icon})}),!t.hideNext&&e.jsx(Ws,{name:"next-month","aria-label":v,className:b,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:r==="rtl"?e.jsx(p,{className:o.nav_icon,style:c.nav_icon}):e.jsx(g,{className:o.nav_icon,style:c.nav_icon})})]})}function Xn(t){var s=ye().numberOfMonths,a=ys(),n=a.previousMonth,r=a.nextMonth,i=a.goToMonth,o=a.displayMonths,c=o.findIndex(function(v){return nn(t.displayMonth,v)}),d=c===0,x=c===o.length-1,h=s>1&&(d||!x),f=s>1&&(x||!d),l=function(){n&&i(n)},u=function(){r&&i(r)};return e.jsx(Hp,{displayMonth:t.displayMonth,hideNext:h,hidePrevious:f,nextMonth:r,previousMonth:n,onPreviousClick:l,onNextClick:u})}function Vp(t){var s,a=ye(),n=a.classNames,r=a.disableNavigation,i=a.styles,o=a.captionLayout,c=a.components,d=(s=c==null?void 0:c.CaptionLabel)!==null&&s!==void 0?s:Ro,x;return r?x=e.jsx(d,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?x=e.jsx(Jn,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?x=e.jsxs(e.Fragment,{children:[e.jsx(Jn,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(Xn,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):x=e.jsxs(e.Fragment,{children:[e.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(Xn,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:n.caption,style:i.caption,children:x})}function Yp(t){var s=ye(),a=s.footer,n=s.styles,r=s.classNames.tfoot;return a?e.jsx("tfoot",{className:r,style:n.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:a})})}):e.jsx(e.Fragment,{})}function Gp(t,s,a){for(var n=a?At(new Date):dt(new Date,{locale:t,weekStartsOn:s}),r=[],i=0;i<7;i++){var o=Se(n,i);r.push(o)}return r}function qp(){var t=ye(),s=t.classNames,a=t.styles,n=t.showWeekNumber,r=t.locale,i=t.weekStartsOn,o=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,x=Gp(r,i,o);return e.jsxs("tr",{style:a.head_row,className:s.head_row,children:[n&&e.jsx("td",{style:a.head_cell,className:s.head_cell}),x.map(function(h,f){return e.jsx("th",{scope:"col",className:s.head_cell,style:a.head_cell,"aria-label":d(h,{locale:r}),children:c(h,{locale:r})},f)})]})}function Kp(){var t,s=ye(),a=s.classNames,n=s.styles,r=s.components,i=(t=r==null?void 0:r.HeadRow)!==null&&t!==void 0?t:qp;return e.jsx("thead",{style:n.head,className:a.head,children:e.jsx(i,{})})}function Jp(t){var s=ye(),a=s.locale,n=s.formatters.formatDay;return e.jsx(e.Fragment,{children:n(t.date,{locale:a})})}var rn=m.createContext(void 0);function Xp(t){if(!bs(t.initialProps)){var s={selected:void 0,modifiers:{disabled:[]}};return e.jsx(rn.Provider,{value:s,children:t.children})}return e.jsx(Qp,{initialProps:t.initialProps,children:t.children})}function Qp(t){var s=t.initialProps,a=t.children,n=s.selected,r=s.min,i=s.max,o=function(x,h,f){var l,u;(l=s.onDayClick)===null||l===void 0||l.call(s,x,h,f);var v=!!(h.selected&&r&&(n==null?void 0:n.length)===r);if(!v){var b=!!(!h.selected&&i&&(n==null?void 0:n.length)===i);if(!b){var g=n?Po([],n):[];if(h.selected){var p=g.findIndex(function(y){return Oe(x,y)});g.splice(p,1)}else g.push(x);(u=s.onSelect)===null||u===void 0||u.call(s,g,x,h,f)}}},c={disabled:[]};n&&c.disabled.push(function(x){var h=i&&n.length>i-1,f=n.some(function(l){return Oe(l,x)});return!!(h&&!f)});var d={selected:n,onDayClick:o,modifiers:c};return e.jsx(rn.Provider,{value:d,children:a})}function on(){var t=m.useContext(rn);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function Zp(t,s){var a=s||{},n=a.from,r=a.to;return n&&r?Oe(r,t)&&Oe(n,t)?void 0:Oe(r,t)?{from:r,to:void 0}:Oe(n,t)?void 0:Oa(n,t)?{from:t,to:r}:{from:n,to:t}:r?Oa(t,r)?{from:r,to:t}:{from:t,to:r}:n?Io(t,n)?{from:t,to:n}:{from:n,to:t}:{from:t,to:void 0}}var ln=m.createContext(void 0);function ef(t){if(!js(t.initialProps)){var s={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(ln.Provider,{value:s,children:t.children})}return e.jsx(tf,{initialProps:t.initialProps,children:t.children})}function tf(t){var s=t.initialProps,a=t.children,n=s.selected,r=n||{},i=r.from,o=r.to,c=s.min,d=s.max,x=function(u,v,b){var g,p;(g=s.onDayClick)===null||g===void 0||g.call(s,u,v,b);var y=Zp(u,n);(p=s.onSelect)===null||p===void 0||p.call(s,y,u,v,b)},h={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(h.range_start=[i],o?(h.range_end=[o],Oe(i,o)||(h.range_middle=[{after:i,before:o}])):h.range_end=[i]):o&&(h.range_start=[o],h.range_end=[o]),c&&(i&&!o&&h.disabled.push({after:da(i,c-1),before:Se(i,c-1)}),i&&o&&h.disabled.push({after:i,before:Se(i,c-1)}),!i&&o&&h.disabled.push({after:da(o,c-1),before:Se(o,c-1)})),d){if(i&&!o&&(h.disabled.push({before:Se(i,-d+1)}),h.disabled.push({after:Se(i,d-1)})),i&&o){var f=Xe(o,i)+1,l=d-f;h.disabled.push({before:da(i,l)}),h.disabled.push({after:Se(o,l)})}!i&&o&&(h.disabled.push({before:Se(o,-d+1)}),h.disabled.push({after:Se(o,d-1)}))}return e.jsx(ln.Provider,{value:{selected:n,onDayClick:x,modifiers:h},children:a})}function cn(){var t=m.useContext(ln);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function As(t){return Array.isArray(t)?Po([],t):t!==void 0?[t]:[]}function sf(t){var s={};return Object.entries(t).forEach(function(a){var n=a[0],r=a[1];s[n]=As(r)}),s}var et;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(et||(et={}));var af=et.Selected,xt=et.Disabled,nf=et.Hidden,rf=et.Today,xa=et.RangeEnd,pa=et.RangeMiddle,fa=et.RangeStart,of=et.Outside;function lf(t,s,a){var n,r=(n={},n[af]=As(t.selected),n[xt]=As(t.disabled),n[nf]=As(t.hidden),n[rf]=[t.today],n[xa]=[],n[pa]=[],n[fa]=[],n[of]=[],n);return t.fromDate&&r[xt].push({before:t.fromDate}),t.toDate&&r[xt].push({after:t.toDate}),bs(t)?r[xt]=r[xt].concat(s.modifiers[xt]):js(t)&&(r[xt]=r[xt].concat(a.modifiers[xt]),r[fa]=a.modifiers[fa],r[pa]=a.modifiers[pa],r[xa]=a.modifiers[xa]),r}var $o=m.createContext(void 0);function cf(t){var s=ye(),a=on(),n=cn(),r=lf(s,a,n),i=sf(s.modifiers),o=se(se({},r),i);return e.jsx($o.Provider,{value:o,children:t.children})}function Oo(){var t=m.useContext($o);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function df(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function mf(t){return!!(t&&typeof t=="object"&&"from"in t)}function uf(t){return!!(t&&typeof t=="object"&&"after"in t)}function hf(t){return!!(t&&typeof t=="object"&&"before"in t)}function xf(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function pf(t,s){var a,n=s.from,r=s.to;if(n&&r){var i=Xe(r,n)<0;i&&(a=[r,n],n=a[0],r=a[1]);var o=Xe(t,n)>=0&&Xe(r,t)>=0;return o}return r?Oe(r,t):n?Oe(n,t):!1}function ff(t){return tn(t)}function gf(t){return Array.isArray(t)&&t.every(tn)}function vf(t,s){return s.some(function(a){if(typeof a=="boolean")return a;if(ff(a))return Oe(t,a);if(gf(a))return a.includes(t);if(mf(a))return pf(t,a);if(xf(a))return a.dayOfWeek.includes(t.getDay());if(df(a)){var n=Xe(a.before,t),r=Xe(a.after,t),i=n>0,o=r<0,c=Oa(a.before,a.after);return c?o&&i:i||o}return uf(a)?Xe(t,a.after)>0:hf(a)?Xe(a.before,t)>0:typeof a=="function"?a(t):!1})}function dn(t,s,a){var n=Object.keys(s).reduce(function(i,o){var c=s[o];return vf(t,c)&&i.push(o),i},[]),r={};return n.forEach(function(i){return r[i]=!0}),a&&!nn(t,a)&&(r.outside=!0),r}function bf(t,s){for(var a=Fe(t[0]),n=sn(t[t.length-1]),r,i,o=a;o<=n;){var c=dn(o,s),d=!c.disabled&&!c.hidden;if(!d){o=Se(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),r||(r=o),o=Se(o,1)}return i||r}var jf=365;function Fo(t,s){var a=s.moveBy,n=s.direction,r=s.context,i=s.modifiers,o=s.retry,c=o===void 0?{count:0,lastFocused:t}:o,d=r.weekStartsOn,x=r.fromDate,h=r.toDate,f=r.locale,l={day:Se,week:$a,month:Ze,year:vh,startOfWeek:function(g){return r.ISOWeek?At(g):dt(g,{locale:f,weekStartsOn:d})},endOfWeek:function(g){return r.ISOWeek?wo(g):an(g,{locale:f,weekStartsOn:d})}},u=l[a](t,n==="after"?1:-1);n==="before"&&x?u=bh([x,u]):n==="after"&&h&&(u=jh([h,u]));var v=!0;if(i){var b=dn(u,i);v=!b.disabled&&!b.hidden}return v?u:c.count>jf?c.lastFocused:Fo(u,{moveBy:a,direction:n,context:r,modifiers:i,retry:se(se({},c),{count:c.count+1})})}var Wo=m.createContext(void 0);function yf(t){var s=ys(),a=Oo(),n=m.useState(),r=n[0],i=n[1],o=m.useState(),c=o[0],d=o[1],x=bf(s.displayMonths,a),h=r??(c&&s.isDateDisplayed(c))?c:x,f=function(){d(r),i(void 0)},l=function(g){i(g)},u=ye(),v=function(g,p){if(r){var y=Fo(r,{moveBy:g,direction:p,context:u,modifiers:a});Oe(r,y)||(s.goToDate(y,r),l(y))}},b={focusedDay:r,focusTarget:h,blur:f,focus:l,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return e.jsx(Wo.Provider,{value:b,children:t.children})}function mn(){var t=m.useContext(Wo);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function Nf(t,s){var a=Oo(),n=dn(t,a,s);return n}var un=m.createContext(void 0);function wf(t){if(!Qs(t.initialProps)){var s={selected:void 0};return e.jsx(un.Provider,{value:s,children:t.children})}return e.jsx(_f,{initialProps:t.initialProps,children:t.children})}function _f(t){var s=t.initialProps,a=t.children,n=function(i,o,c){var d,x,h;if((d=s.onDayClick)===null||d===void 0||d.call(s,i,o,c),o.selected&&!s.required){(x=s.onSelect)===null||x===void 0||x.call(s,void 0,i,o,c);return}(h=s.onSelect)===null||h===void 0||h.call(s,i,i,o,c)},r={selected:s.selected,onDayClick:n};return e.jsx(un.Provider,{value:r,children:a})}function zo(){var t=m.useContext(un);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function Sf(t,s){var a=ye(),n=zo(),r=on(),i=cn(),o=mn(),c=o.focusDayAfter,d=o.focusDayBefore,x=o.focusWeekAfter,h=o.focusWeekBefore,f=o.blur,l=o.focus,u=o.focusMonthBefore,v=o.focusMonthAfter,b=o.focusYearBefore,g=o.focusYearAfter,p=o.focusStartOfWeek,y=o.focusEndOfWeek,N=function(P){var L,Y,X,S;Qs(a)?(L=n.onDayClick)===null||L===void 0||L.call(n,t,s,P):bs(a)?(Y=r.onDayClick)===null||Y===void 0||Y.call(r,t,s,P):js(a)?(X=i.onDayClick)===null||X===void 0||X.call(i,t,s,P):(S=a.onDayClick)===null||S===void 0||S.call(a,t,s,P)},_=function(P){var L;l(t),(L=a.onDayFocus)===null||L===void 0||L.call(a,t,s,P)},D=function(P){var L;f(),(L=a.onDayBlur)===null||L===void 0||L.call(a,t,s,P)},T=function(P){var L;(L=a.onDayMouseEnter)===null||L===void 0||L.call(a,t,s,P)},O=function(P){var L;(L=a.onDayMouseLeave)===null||L===void 0||L.call(a,t,s,P)},k=function(P){var L;(L=a.onDayPointerEnter)===null||L===void 0||L.call(a,t,s,P)},B=function(P){var L;(L=a.onDayPointerLeave)===null||L===void 0||L.call(a,t,s,P)},C=function(P){var L;(L=a.onDayTouchCancel)===null||L===void 0||L.call(a,t,s,P)},j=function(P){var L;(L=a.onDayTouchEnd)===null||L===void 0||L.call(a,t,s,P)},w=function(P){var L;(L=a.onDayTouchMove)===null||L===void 0||L.call(a,t,s,P)},M=function(P){var L;(L=a.onDayTouchStart)===null||L===void 0||L.call(a,t,s,P)},F=function(P){var L;(L=a.onDayKeyUp)===null||L===void 0||L.call(a,t,s,P)},U=function(P){var L;switch(P.key){case"ArrowLeft":P.preventDefault(),P.stopPropagation(),a.dir==="rtl"?c():d();break;case"ArrowRight":P.preventDefault(),P.stopPropagation(),a.dir==="rtl"?d():c();break;case"ArrowDown":P.preventDefault(),P.stopPropagation(),x();break;case"ArrowUp":P.preventDefault(),P.stopPropagation(),h();break;case"PageUp":P.preventDefault(),P.stopPropagation(),P.shiftKey?b():u();break;case"PageDown":P.preventDefault(),P.stopPropagation(),P.shiftKey?g():v();break;case"Home":P.preventDefault(),P.stopPropagation(),p();break;case"End":P.preventDefault(),P.stopPropagation(),y();break}(L=a.onDayKeyDown)===null||L===void 0||L.call(a,t,s,P)},H={onClick:N,onFocus:_,onBlur:D,onKeyDown:U,onKeyUp:F,onMouseEnter:T,onMouseLeave:O,onPointerEnter:k,onPointerLeave:B,onTouchCancel:C,onTouchEnd:j,onTouchMove:w,onTouchStart:M};return H}function Cf(){var t=ye(),s=zo(),a=on(),n=cn(),r=Qs(t)?s.selected:bs(t)?a.selected:js(t)?n.selected:void 0;return r}function kf(t){return Object.values(et).includes(t)}function Df(t,s){var a=[t.classNames.day];return Object.keys(s).forEach(function(n){var r=t.modifiersClassNames[n];if(r)a.push(r);else if(kf(n)){var i=t.classNames["day_".concat(n)];i&&a.push(i)}}),a}function Ef(t,s){var a=se({},t.styles.day);return Object.keys(s).forEach(function(n){var r;a=se(se({},a),(r=t.modifiersStyles)===null||r===void 0?void 0:r[n])}),a}function If(t,s,a){var n,r,i,o=ye(),c=mn(),d=Nf(t,s),x=Sf(t,d),h=Cf(),f=!!(o.onDayClick||o.mode!=="default");m.useEffect(function(){var T;d.outside||c.focusedDay&&f&&Oe(c.focusedDay,t)&&((T=a.current)===null||T===void 0||T.focus())},[c.focusedDay,t,a,f,d.outside]);var l=Df(o,d).join(" "),u=Ef(o,d),v=!!(d.outside&&!o.showOutsideDays||d.hidden),b=(i=(r=o.components)===null||r===void 0?void 0:r.DayContent)!==null&&i!==void 0?i:Jp,g=e.jsx(b,{date:t,displayMonth:s,activeModifiers:d}),p={style:u,className:l,children:g,role:"gridcell"},y=c.focusTarget&&Oe(c.focusTarget,t)&&!d.outside,N=c.focusedDay&&Oe(c.focusedDay,t),_=se(se(se({},p),(n={disabled:d.disabled,role:"gridcell"},n["aria-selected"]=d.selected,n.tabIndex=N||y?0:-1,n)),x),D={isButton:f,isHidden:v,activeModifiers:d,selectedDays:h,buttonProps:_,divProps:p};return D}function Tf(t){var s=m.useRef(null),a=If(t.date,t.displayMonth,s);return a.isHidden?e.jsx("div",{role:"gridcell"}):a.isButton?e.jsx(Ws,se({name:"day",ref:s},a.buttonProps)):e.jsx("div",se({},a.divProps))}function Pf(t){var s=t.number,a=t.dates,n=ye(),r=n.onWeekNumberClick,i=n.styles,o=n.classNames,c=n.locale,d=n.labels.labelWeekNumber,x=n.formatters.formatWeekNumber,h=x(Number(s),{locale:c});if(!r)return e.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:h});var f=d(Number(s),{locale:c}),l=function(u){r(s,a,u)};return e.jsx(Ws,{name:"week-number","aria-label":f,className:o.weeknumber,style:i.weeknumber,onClick:l,children:h})}function Af(t){var s,a,n=ye(),r=n.styles,i=n.classNames,o=n.showWeekNumber,c=n.components,d=(s=c==null?void 0:c.Day)!==null&&s!==void 0?s:Tf,x=(a=c==null?void 0:c.WeekNumber)!==null&&a!==void 0?a:Pf,h;return o&&(h=e.jsx("td",{className:i.cell,style:r.cell,children:e.jsx(x,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:i.row,style:r.row,children:[h,t.dates.map(function(f){return e.jsx("td",{className:i.cell,style:r.cell,role:"presentation",children:e.jsx(d,{displayMonth:t.displayMonth,date:f})},vx(f))})]})}function Qn(t,s,a){for(var n=a!=null&&a.ISOWeek?wo(s):an(s,a),r=a!=null&&a.ISOWeek?At(t):dt(t,a),i=Xe(n,r),o=[],c=0;c<=i;c++)o.push(Se(r,c));var d=o.reduce(function(x,h){var f=a!=null&&a.ISOWeek?Co(h):Do(h,a),l=x.find(function(u){return u.weekNumber===f});return l?(l.dates.push(h),x):(x.push({weekNumber:f,dates:[h]}),x)},[]);return d}function Rf(t,s){var a=Qn(Fe(t),sn(t),s);if(s!=null&&s.useFixedWeeks){var n=jx(t,s);if(n<6){var r=a[a.length-1],i=r.dates[r.dates.length-1],o=$a(i,6-n),c=Qn($a(i,1),o,s);a.push.apply(a,c)}}return a}function Mf(t){var s,a,n,r=ye(),i=r.locale,o=r.classNames,c=r.styles,d=r.hideHead,x=r.fixedWeeks,h=r.components,f=r.weekStartsOn,l=r.firstWeekContainsDate,u=r.ISOWeek,v=Rf(t.displayMonth,{useFixedWeeks:!!x,ISOWeek:u,locale:i,weekStartsOn:f,firstWeekContainsDate:l}),b=(s=h==null?void 0:h.Head)!==null&&s!==void 0?s:Kp,g=(a=h==null?void 0:h.Row)!==null&&a!==void 0?a:Af,p=(n=h==null?void 0:h.Footer)!==null&&n!==void 0?n:Yp;return e.jsxs("table",{id:t.id,className:o.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&e.jsx(b,{}),e.jsx("tbody",{className:o.tbody,style:c.tbody,children:v.map(function(y){return e.jsx(g,{displayMonth:t.displayMonth,dates:y.dates,weekNumber:y.weekNumber},y.weekNumber)})}),e.jsx(p,{displayMonth:t.displayMonth})]})}function Lf(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var $f=Lf()?m.useLayoutEffect:m.useEffect,ga=!1,Of=0;function Zn(){return"react-day-picker-".concat(++Of)}function Ff(t){var s,a=t??(ga?Zn():null),n=m.useState(a),r=n[0],i=n[1];return $f(function(){r===null&&i(Zn())},[]),m.useEffect(function(){ga===!1&&(ga=!0)},[]),(s=t??r)!==null&&s!==void 0?s:void 0}function Wf(t){var s,a,n=ye(),r=n.dir,i=n.classNames,o=n.styles,c=n.components,d=ys().displayMonths,x=Ff(n.id?"".concat(n.id,"-").concat(t.displayIndex):void 0),h=n.id?"".concat(n.id,"-grid-").concat(t.displayIndex):void 0,f=[i.month],l=o.month,u=t.displayIndex===0,v=t.displayIndex===d.length-1,b=!u&&!v;r==="rtl"&&(s=[u,v],v=s[0],u=s[1]),u&&(f.push(i.caption_start),l=se(se({},l),o.caption_start)),v&&(f.push(i.caption_end),l=se(se({},l),o.caption_end)),b&&(f.push(i.caption_between),l=se(se({},l),o.caption_between));var g=(a=c==null?void 0:c.Caption)!==null&&a!==void 0?a:Vp;return e.jsxs("div",{className:f.join(" "),style:l,children:[e.jsx(g,{id:x,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(Mf,{id:h,"aria-labelledby":x,displayMonth:t.displayMonth})]},t.displayIndex)}function zf(t){var s=ye(),a=s.classNames,n=s.styles;return e.jsx("div",{className:a.months,style:n.months,children:t.children})}function Uf(t){var s,a,n=t.initialProps,r=ye(),i=mn(),o=ys(),c=m.useState(!1),d=c[0],x=c[1];m.useEffect(function(){r.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),x(!0)))},[r.initialFocus,d,i.focus,i.focusTarget,i]);var h=[r.classNames.root,r.className];r.numberOfMonths>1&&h.push(r.classNames.multiple_months),r.showWeekNumber&&h.push(r.classNames.with_weeknumber);var f=se(se({},r.styles.root),r.style),l=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,b){var g;return se(se({},v),(g={},g[b]=n[b],g))},{}),u=(a=(s=n.components)===null||s===void 0?void 0:s.Months)!==null&&a!==void 0?a:zf;return e.jsx("div",se({className:h.join(" "),style:f,dir:r.dir,id:r.id,nonce:n.nonce,title:n.title,lang:n.lang},l,{children:e.jsx(u,{children:o.displayMonths.map(function(v,b){return e.jsx(Wf,{displayIndex:b,displayMonth:v},b)})})}))}function Bf(t){var s=t.children,a=up(t,["children"]);return e.jsx(Tp,{initialProps:a,children:e.jsx(zp,{children:e.jsx(wf,{initialProps:a,children:e.jsx(Xp,{initialProps:a,children:e.jsx(ef,{initialProps:a,children:e.jsx(cf,{children:e.jsx(yf,{children:s})})})})})})})}function Hf(t){return e.jsx(Bf,se({},t,{children:e.jsx(Uf,{initialProps:t})}))}function Uo({className:t,classNames:s,showOutsideDays:a=!0,...n}){return e.jsx(Hf,{showOutsideDays:a,className:V("p-3 select-none",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium leading-none",nav:"space-x-1 flex items-center",nav_button:V(Ia({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1 table-fixed",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem] flex items-center justify-center",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative overflow-hidden [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:V(Ia({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100 flex items-center justify-center text-center leading-none"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground font-medium",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...r})=>e.jsx(Kl,{className:"h-4 w-4"}),IconRight:({...r})=>e.jsx(ql,{className:"h-4 w-4"})},...n})}Uo.displayName="Calendar";const Vf=()=>{const[t,s]=m.useState([]),[a,n]=m.useState([]),[r,i]=m.useState(null),[o,c]=m.useState(""),[d,x]=m.useState(""),[h,f]=m.useState({}),[l,u]=m.useState(null),[v,b]=m.useState([]),[g,p]=m.useState(!1),{toast:y}=xe();m.useEffect(()=>{N(),_()},[]);const N=async()=>{try{const{data:j,error:w}=await $.from("vaccine_schedules").select("*").eq("active",!0).order("vaccine_name");if(w)throw w;s(j||[])}catch{y({title:"",description:"",variant:"destructive"})}},_=async()=>{var j;try{console.log(" ...");const{data:w,error:M}=await $.from("appointments").select("*").order("appointment_date",{ascending:!1});if(M)throw M;console.log(" :",(w==null?void 0:w.length)||0,"");const F=(w==null?void 0:w.filter(Y=>Y.status==="completed"))||[],U=(w==null?void 0:w.filter(Y=>["scheduled","pending"].includes(Y.status)))||[];console.log(" :",F.length,""),console.log(" :",U.length,"");const H=new Map;for(const Y of F||[]){const X=Y.patient_id_number||Y.line_user_id,S=`${X}-${Y.vaccine_type}`;if(!H.has(S)){const E=F.filter(re=>(re.patient_id_number||re.line_user_id)===X&&re.vaccine_type===Y.vaccine_type&&re.status==="completed");console.log(` : ${Y.patient_name}, : ${Y.vaccine_type}, : ${E.length}`);const G=E.reduce((re,Z)=>new Date(Z.appointment_date)>new Date(re.appointment_date)?Z:re),K=E.reduce((re,Z)=>new Date(Z.appointment_date)<new Date(re.appointment_date)?Z:re);console.log(` : ${G.appointment_date}, : ${K.appointment_date}`),H.set(S,{patient_id:X,patient_name:Y.patient_name,vaccine_type:Y.vaccine_type,doses_received:E.length,latest_date:G.appointment_date,first_dose_date:K.appointment_date})}}const{data:P}=await $.from("vaccine_schedules").select("*").eq("active",!0);console.log(" :",(P==null?void 0:P.length)||0,"");const L=[];for(const Y of H.values())try{const X=P==null?void 0:P.find(G=>G.vaccine_type.toLowerCase()===Y.vaccine_type.toLowerCase());if(!X){console.log(` : ${Y.vaccine_type}`);continue}let S="in_progress",E=null;if(Y.doses_received>=X.total_doses)S="completed",console.log(`  ${Y.patient_name}  ${Y.vaccine_type} `);else{const G=U.find(de=>(de.patient_id_number||de.line_user_id)===Y.patient_id&&de.vaccine_type.toLowerCase()===Y.vaccine_type.toLowerCase()&&new Date(de.appointment_date)>new Date),K=Array.isArray(X.dose_intervals)?X.dose_intervals:JSON.parse(((j=X.dose_intervals)==null?void 0:j.toString())||"[]");console.log("  vaccine_schedules:",{vaccine_type:X.vaccine_type,total_doses:X.total_doses,dose_intervals:K,current_dose:Y.doses_received,next_dose_index:Y.doses_received});let re=new Date(Y.first_dose_date),Z=0;for(let de=0;de<Y.doses_received;de++){const ke=typeof K[de]=="number"?K[de]:0;Z+=ke,console.log(`   ${de+1} -> ${de+2}: +${ke}  (: ${Z} )`)}const ge=new Date(re);ge.setDate(ge.getDate()+Z),E=ge.toISOString().split("T")[0];const ve=K[Y.doses_received]||0;if(console.log(`  ${Y.vaccine_type}:  vaccine_schedules`),console.log(`   - : ${Y.first_dose_date}`),console.log(`   - : ${Z} `),console.log(`   -  ${Y.doses_received+1}: ${E}`),console.log(`   -  vaccine_schedules: ${ve} `),G){const de=G.appointment_date,ke=E;console.log(`  ${Y.vaccine_type}: `),console.log(`   - : ${de}`),console.log(`   -  vaccine_schedules: ${ke}`),E=de}}L.push({id:`${Y.patient_id}-${Y.vaccine_type}`,patient_id:Y.patient_id,patient_name:Y.patient_name,vaccine_schedule_id:X.id,current_dose:Y.doses_received,total_doses:X.total_doses,last_dose_date:Y.latest_date,next_dose_due:E,completion_status:S,auto_reminder_enabled:!0,reminder_days_before:1,contraindication_checked:!1,contraindication_notes:null,vaccine_schedules:{vaccine_name:X.vaccine_name,vaccine_type:X.vaccine_type,dose_intervals:X.dose_intervals,total_doses:X.total_doses},existing_appointment:!!U.find(G=>(G.patient_id_number||G.line_user_id)===Y.patient_id&&G.vaccine_type.toLowerCase()===Y.vaccine_type.toLowerCase()&&new Date(G.appointment_date)>new Date)})}catch(X){console.error("Error processing patient:",Y.patient_id,X)}console.log(" :",L.length,""),n(L)}catch(w){console.error("Error loading patient tracking:",w),y({title:"",description:"",variant:"destructive"})}},D=async j=>{if(j)try{p(!0);const{data:w,error:M}=await $.rpc("check_contraindications",{_vaccine_schedule_id:j,_patient_conditions:h});if(M)throw M;u(w)}catch{y({title:"",description:"",variant:"destructive"})}finally{p(!1)}},T=()=>{if(!r)return;const j=r,w=new Date,M=[];M.push({dose:1,date:w,dueDays:0,status:"due",description:` ${j.vaccine_name}`});let F=w;for(let U=1;U<j.total_doses;U++){const H=j.dose_intervals[U-1]||30;F=Se(F,H),M.push({dose:U+1,date:F,dueDays:ca(F,w),status:"scheduled",description:` ${U+1}  ${j.vaccine_name} ( ${H} )`})}if(j.booster_required&&j.booster_interval){const U=Se(F,j.booster_interval);M.push({dose:"booster",date:U,dueDays:ca(U,w),status:"booster",description:` ( ${j.booster_interval} )`})}b(M)},O=async()=>{var j;if(!r||!o||!d){y({title:"",description:"",variant:"destructive"});return}if(l!=null&&l.has_contraindications){y({title:"",description:"",variant:"destructive"});return}try{p(!0);const w=Se(new Date,0),{error:M}=await $.from("patient_vaccine_tracking").insert({patient_id:o,patient_name:d,vaccine_schedule_id:r.id,current_dose:1,total_doses:r.total_doses,next_dose_due:Re(w,"yyyy-MM-dd"),completion_status:"in_progress",auto_reminder_enabled:!0,reminder_days_before:1,contraindication_checked:!0,contraindication_notes:((j=l==null?void 0:l.contraindications)==null?void 0:j.length)>0?`: ${l.contraindications.join(", ")}`:null});if(M)throw M;await k(o,w),y({title:"",description:"",variant:"default"}),c(""),x(""),f({}),u(null),b([]),_()}catch{y({title:"",description:"",variant:"destructive"})}finally{p(!1)}},k=async(j,w)=>{const M=Se(w,-1);await $.from("notification_schedules").insert({patient_tracking_id:null,notification_type:"reminder",scheduled_date:Re(M,"yyyy-MM-dd"),message_content:` 

 (${Re(w,"dd/MM/yyyy")})  ${r==null?void 0:r.vaccine_name}

`,line_user_id:j,sent:!1})},B=(j,w)=>{f(M=>({...M,[j]:w}))},C=j=>{const w={due:{color:"bg-green-500",text:""},scheduled:{color:"bg-blue-500",text:""},booster:{color:"bg-purple-500",text:""},overdue:{color:"bg-red-500",text:""},completed:{color:"bg-gray-500",text:""}},M=w[j]||w.scheduled;return e.jsx(J,{className:M.color,children:M.text})};return e.jsx("div",{className:"space-y-4 md:space-y-6",children:e.jsxs(mt,{defaultValue:"calculator",className:"space-y-4",children:[e.jsxs(qe,{className:"grid w-full grid-cols-1 md:grid-cols-3 gap-1 md:gap-0 h-auto md:h-10",children:[e.jsxs(te,{value:"calculator",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(Jl,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}),e.jsxs(te,{value:"tracking",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}),e.jsxs(te,{value:"schedules",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{children:""})]})]}),e.jsx(ne,{value:"calculator",className:"space-y-4 md:space-y-6",children:e.jsxs(A,{children:[e.jsxs(W,{className:"pb-3 md:pb-4",children:[e.jsxs(z,{className:"flex items-center space-x-2 text-lg md:text-xl",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:""})]}),e.jsx(ue,{className:"text-sm md:text-base",children:""})]}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"patient-id",className:"text-sm md:text-base font-medium",children:"/LINE User ID"}),e.jsx(ae,{id:"patient-id",value:o,onChange:j=>c(j.target.value),placeholder:"",className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"patient-name",className:"text-sm md:text-base font-medium",children:""}),e.jsx(ae,{id:"patient-name",value:d,onChange:j=>x(j.target.value),placeholder:"",className:"text-sm md:text-base"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"vaccine-select",className:"text-sm md:text-base font-medium",children:""}),e.jsxs(_t,{value:(r==null?void 0:r.id)||"",onValueChange:j=>{const w=t.find(M=>M.id===j);i(w||null),u(null)},children:[e.jsx(gt,{className:"text-sm md:text-base",children:e.jsx(St,{placeholder:""})}),e.jsx(vt,{children:t.map(j=>e.jsxs(Ee,{value:j.id,className:"text-sm md:text-base",children:[j.vaccine_name," (",j.total_doses," )"]},j.id))})]})]}),r&&e.jsxs(A,{className:"border-primary/20 mt-4",children:[e.jsx(W,{className:"pb-3",children:e.jsxs(z,{className:"text-base md:text-lg text-primary",children:[": ",r.vaccine_name]})}),e.jsxs(R,{className:"space-y-3 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm md:text-base",children:[e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:":"}),e.jsxs("p",{className:"font-semibold",children:[r.total_doses," "]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:":"}),e.jsxs("p",{className:"font-semibold",children:[r.dose_intervals.join(", ")," "]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:":"}),e.jsxs("p",{className:"font-semibold",children:[Math.round(r.efficacy_duration/365)," "]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:":"}),e.jsx("p",{className:"font-semibold",children:r.booster_required?"":""})]})]}),r.age_restrictions&&e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-2",children:":"}),e.jsxs("p",{className:"text-sm md:text-base",children:[r.age_restrictions.min_age&&` ${r.age_restrictions.min_age} `,r.age_restrictions.min_age&&r.age_restrictions.max_age&&" - ",r.age_restrictions.max_age&&` ${r.age_restrictions.max_age} `]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.indications.map((j,w)=>e.jsx(J,{variant:"secondary",className:"text-xs md:text-sm",children:j},w))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.contraindications.map((j,w)=>e.jsx(J,{variant:"destructive",className:"text-xs md:text-sm",children:j},w))})]})]})]}),r&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{className:"text-lg",children:""})}),e.jsxs(R,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"age",children:" ()"}),e.jsx(ae,{id:"age",type:"number",value:h.age||"",onChange:j=>B("age",parseInt(j.target.value)||0),placeholder:""})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{children:":"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{key:"pregnancy",label:""},{key:"immunocompromised",label:""},{key:"severe_allergic_reaction",label:""},{key:"myocarditis_history",label:""},{key:"guillain_barre_syndrome",label:"- "},{key:"chronic_disease",label:""}].map(({key:j,label:w})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Os,{id:j,checked:!!h[j],onCheckedChange:M=>B(j,!!M)}),e.jsx(Q,{htmlFor:j,className:"text-sm",children:w})]},j))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{onClick:()=>D(r.id),disabled:g,children:g?"...":""}),e.jsx(I,{onClick:T,variant:"outline",children:""})]}),l&&e.jsxs(le,{className:l.has_contraindications?"border-red-200":"border-green-200",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx(me,{children:l.has_contraindications?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-600",children:":"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:l.contraindications.map((j,w)=>e.jsx("li",{children:j},w))})]}):e.jsx("p",{className:"text-green-600",children:" "})})]})]})]}),v.length>0&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Uo,{className:"h-5 w-5"}),e.jsx("span",{children:""})]})}),e.jsxs(R,{children:[e.jsx("div",{className:"space-y-3",children:v.map((j,w)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-lg font-medium",children:typeof j.dose=="number"?` ${j.dose}`:""}),e.jsx("div",{className:"text-sm text-muted-foreground",children:Re(j.date,"dd MMMM yyyy",{locale:ms})}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",j.dueDays===0?"":` ${j.dueDays} `,")"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:C(j.status)})]},w))}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx(I,{onClick:O,disabled:g||(l==null?void 0:l.has_contraindications),className:"w-full",children:g?"...":""})})]})]})]})]})}),e.jsx(ne,{value:"tracking",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Ls,{className:"h-5 w-5"}),e.jsx("span",{children:""})]}),e.jsx(ue,{children:""})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[a.map(j=>{var w,M,F;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:j.patient_name}),e.jsx(J,{variant:"outline",children:j.patient_id})]}),e.jsx(J,{className:j.completion_status==="completed"?"bg-green-500":j.completion_status==="overdue"?"bg-red-500":j.completion_status==="cancelled"?"bg-gray-500":"bg-blue-500",children:j.completion_status==="completed"?"":j.completion_status==="overdue"?"":j.completion_status==="cancelled"?"":""})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:(w=j.vaccine_schedules)==null?void 0:w.vaccine_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",(M=j.vaccine_schedules)==null?void 0:M.vaccine_type]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:j.current_dose>0?` ${j.current_dose}   ${j.total_doses} `:""}),j.current_dose>0&&j.current_dose<j.total_doses&&e.jsxs("p",{className:"text-xs text-green-600",children:[":  ",j.current_dose+1]}),j.current_dose>=j.total_doses&&e.jsx("p",{className:"text-xs text-green-600",children:" "})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:j.last_dose_date&&j.current_dose>0?Re(ma(j.last_dose_date),"dd MMM yyyy",{locale:ms}):""}),j.last_dose_date&&j.current_dose>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",j.current_dose," "]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),j.next_dose_due?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-600",children:Re(ma(j.next_dose_due),"dd MMM yyyy",{locale:ms})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",j.current_dose+1," ",(()=>{const U=ca(ma(j.next_dose_due),new Date);return U<0?`  ${Math.abs(U)} `:U===0?" ":`  ${U} `})()]}),j.existing_appointment&&e.jsx("p",{className:"text-xs text-green-600",children:" "}),((F=j.vaccine_schedules)==null?void 0:F.dose_intervals)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",j.vaccine_schedules.dose_intervals[j.current_dose]||"N/A"," "]})]}):j.completion_status==="completed"?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-600",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}):j.current_dose<j.total_doses?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-orange-600",children:""}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",j.current_dose+1]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-500",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),j.contraindication_notes&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ye,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:":"})]}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:j.contraindication_notes})]}),e.jsx("div",{className:"mt-3 flex items-center space-x-2",children:j.auto_reminder_enabled&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[e.jsx(Be,{className:"h-3 w-3"}),e.jsxs("span",{children:[" ",j.reminder_days_before," "]})]})})]},j.id)}),a.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(It,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:""})]})]})})]})}),e.jsx(ne,{value:"schedules",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:""}),e.jsx(ue,{children:""})]}),e.jsx(R,{children:e.jsx("div",{className:"space-y-4",children:t.map(j=>e.jsxs(A,{className:"border-muted",children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{className:"text-lg",children:j.vaccine_name}),e.jsx(J,{className:"bg-primary",children:j.vaccine_type})]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"}),e.jsxs("p",{children:[j.total_doses," "]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"}),e.jsx("p",{children:j.dose_intervals.length>0?j.dose_intervals.join(", ")+" ":""})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"}),e.jsxs("p",{children:[Math.round(j.efficacy_duration/365)," "]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:":"}),e.jsx("p",{children:j.booster_required?` ( ${Math.round((j.booster_interval||0)/365)} )`:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.indications.map((w,M)=>e.jsx(J,{variant:"secondary",className:"text-xs",children:w},M))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.contraindications.map((w,M)=>e.jsx(J,{variant:"destructive",className:"text-xs",children:w},M))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:":"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.side_effects.map((w,M)=>e.jsx(J,{variant:"outline",className:"text-xs",children:w},M))})]})]})]})]},j.id))})})]})})]})})},Bo=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(""),[r,i]=m.useState(!1),{toast:o}=xe(),c=async()=>{i(!0);try{const{data:l,error:u}=await $.from("patient_registrations").select("*").order("created_at",{ascending:!1});if(u)throw u;s(l||[])}catch(l){console.error("Error loading registrations:",l),o({title:"",description:"",variant:"destructive"})}finally{i(!1)}},d=async(l,u)=>{try{const{error:v}=await $.from("patient_registrations").update({status:u,updated_at:new Date().toISOString()}).eq("id",l);if(v)throw v;o({title:"",description:""}),c()}catch(v){console.error("Error updating registration:",v),o({title:"",description:"",variant:"destructive"})}};m.useEffect(()=>{c()},[]);const x=t.filter(l=>l.patient_name.toLowerCase().includes(a.toLowerCase())||l.phone_number.includes(a)||l.registration_id.toLowerCase().includes(a.toLowerCase())),h=l=>{switch(l){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},f=l=>{switch(l){case"pending":return"";case"confirmed":return"";case"completed":return"";case"cancelled":return"";default:return l}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Me,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs(I,{onClick:c,disabled:r,variant:"outline",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),""]}),e.jsxs(J,{variant:"secondary",children:[" ",x.length," "]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(ae,{placeholder:", ,  ID",value:a,onChange:l=>n(l.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:x.map(l=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:l.patient_name}),e.jsx(J,{className:h(l.status),children:f(l.status)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xl,{className:"h-4 w-4"}),l.phone_number]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"ID: ",l.registration_id]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),new Date(l.created_at).toLocaleDateString("th-TH")]})]}),l.notes&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:l.notes})]}),e.jsx("div",{className:"flex gap-2 ml-4",children:l.status==="pending"&&e.jsxs(I,{size:"sm",onClick:()=>d(l.id,"confirmed"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),""]})})]})},l.id))}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Me,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"":""})]})]})]})]})},Yf=({appointment:t,isOpen:s,onClose:a})=>{const[n,r]=m.useState([]),[i,o]=m.useState(!1),c=async x=>{var h,f;try{console.log("  :",x.patient_name);const{data:l}=await $.from("vaccine_schedules").select("*").eq("id",x.vaccine_schedule_id).single();if(!l)return console.log("  vaccine schedule"),[];console.log(" :",{vaccine_type:l.vaccine_type,total_doses:l.total_doses,dose_intervals:l.dose_intervals});const{data:u}=await $.from("appointments").select("*").eq("patient_id_number",x.patient_id).eq("vaccine_type",x.vaccine_type).order("appointment_date",{ascending:!0});console.log(" :",(u==null?void 0:u.length)||0,"");const v=(u==null?void 0:u.filter(_=>_.status==="completed"))||[],b=(u==null?void 0:u.filter(_=>["scheduled","pending"].includes(_.status)))||[];console.log(" :",v.length,""),console.log(" :",b.length,"");const g=Array.isArray(l.dose_intervals)?l.dose_intervals:JSON.parse(((h=l.dose_intervals)==null?void 0:h.toString())||"[]");console.log(" :",g);const p=[],y=x.first_dose_date||((f=v[0])==null?void 0:f.appointment_date)||new Date().toISOString().split("T")[0];console.log(" :",y);const N=new Date(y);for(let _=0;_<l.total_doses;_++){const D=_+1,T=_===0?0:g[_-1]||0,O=new Date(N.getTime());O.setDate(N.getDate()+T);let k=O.toISOString().split("T")[0],B="upcoming";const C=v[_];if(C)B="completed",k=C.appointment_date,console.log(`  ${D}:   ${k}`);else{const j=b.find(w=>v.length+1===D);j?(B="scheduled",k=j.appointment_date,console.log(`  ${D}:   ${k}`)):console.log(`  ${D}:  + ${T}  = ${k}`)}p.push({dose_number:D,appointment_date:k,interval_from_previous:T,status:B})}return console.log(" :",p.length,""),p.forEach(_=>{console.log(`  -  ${_.dose_number}: ${_.appointment_date} (${_.status}),  ${_.interval_from_previous} `)}),p}catch(l){return console.error("Error calculating full dose schedule:",l),[]}};m.useEffect(()=>{t&&s&&(o(!0),c(t).then(x=>{r(x),o(!1)}).catch(()=>o(!1)))},[t,s]);const d=()=>{window.print()};return!s||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:x=>x.stopPropagation(),children:[e.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            .print-area, .print-area * {
              visibility: visible;
            }
            .print-area {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
          }
        `}),e.jsxs("div",{className:"print-area",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 text-white p-6 rounded-t-xl no-print",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(It,{className:"h-8 w-8"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"text-purple-100 text-sm mt-1",children:""})]})]}),e.jsx(I,{variant:"secondary",size:"sm",onClick:a,className:"bg-white/20 hover:bg-white/30 text-white border-0",children:e.jsx(Ct,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"p-6 border-b-2 border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:":"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:t.patient_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:":"}),e.jsx("p",{className:"text-lg font-bold text-purple-700",children:t.vaccine_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:":"}),e.jsxs("p",{className:"text-lg font-bold text-purple-700",children:[t.total_doses," "]})]})]})}),e.jsxs("div",{className:"p-6",children:[i?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(pe,{className:"h-8 w-8 animate-spin text-purple-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"..."})]}):e.jsx("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-bold",children:""}),e.jsx("th",{className:"px-4 py-3 text-left font-bold",children:""}),e.jsx("th",{className:"px-4 py-3 text-left font-bold",children:" ()"}),e.jsx("th",{className:"px-4 py-3 text-left font-bold",children:""}),e.jsx("th",{className:"px-4 py-3 text-left font-bold no-print",children:""})]})}),e.jsx("tbody",{children:n.map((x,h)=>e.jsxs("tr",{className:`border-b ${x.status==="completed"?"bg-green-50":x.status==="scheduled"?"bg-blue-50":"bg-white"}`,children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-purple-600"})," ",x.dose_number]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-purple-600"}),new Date(x.appointment_date).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:x.interval_from_previous===0?"-":`${x.interval_from_previous} `}),e.jsxs("td",{className:"px-4 py-3",children:[x.status==="completed"&&e.jsx(J,{className:"bg-green-500 text-white border-0",children:" "}),x.status==="scheduled"&&e.jsx(J,{className:"bg-blue-500 text-white border-0",children:" "}),x.status==="upcoming"&&e.jsx(J,{variant:"outline",className:"border-purple-300 text-purple-700",children:" "})]}),e.jsx("td",{className:"px-4 py-3 no-print",children:e.jsx("div",{className:"h-8 border-l-2 border-dashed border-gray-300"})})]},h))})]})}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg",children:[e.jsxs("h3",{className:"font-bold text-yellow-800 mb-2 flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5"}),":"]}),e.jsxs("ul",{className:"text-sm text-yellow-900 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:' ""'}),e.jsx("li",{children:""}),e.jsx("li",{children:" "})]})]})]}),e.jsxs("div",{className:"p-6 border-t-2 border-gray-200 bg-gray-50 flex gap-3 no-print",children:[e.jsxs(I,{onClick:d,className:"flex-1 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 shadow-md",children:[e.jsx(Ql,{className:"h-5 w-5 mr-2"}),""]}),e.jsx(I,{onClick:a,variant:"outline",className:"border-2",children:""})]})]})]})})},Ho=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(""),[r,i]=m.useState(!1),[o,c]=m.useState(null),[d,x]=m.useState(null),[h,f]=m.useState(null),[l,u]=m.useState(null),[v,b]=m.useState(!1),{toast:g}=xe(),p=async()=>{i(!0);try{console.log(" ...");const{data:C,error:j}=await $.from("appointments").select("*").order("appointment_date",{ascending:!1});if(j)throw j;console.log(" :",(C==null?void 0:C.length)||0,"");const w=(C==null?void 0:C.filter(E=>E.status==="completed"))||[],M=new Date().toISOString().split("T")[0],F=(C==null?void 0:C.filter(E=>["scheduled","pending"].includes(E.status)))||[];console.log(" :",w.length,""),console.log("  (scheduled/pending):",F.length,""),console.log(" :",M),F.forEach(E=>{console.log(`   - ${E.patient_name}: ${E.vaccine_type}  ${E.appointment_date} (${E.status})`)});const U=new Map;for(const E of w||[]){const G=E.patient_id_number||E.line_user_id,K=`${G}-${E.vaccine_type}`;if(!U.has(K)){const re=w.filter(ve=>(ve.patient_id_number||ve.line_user_id)===G&&ve.vaccine_type===E.vaccine_type&&ve.status==="completed");console.log(` : ${E.patient_name}, : ${E.vaccine_type}, : ${re.length}`);const Z=re.reduce((ve,de)=>new Date(de.appointment_date)>new Date(ve.appointment_date)?de:ve),ge=re.reduce((ve,de)=>new Date(de.appointment_date)<new Date(ve.appointment_date)?de:ve);console.log(` : ${Z.appointment_date}, : ${ge.appointment_date}`),U.set(K,{patient_id:G,patient_name:E.patient_name,line_user_id:E.line_user_id,vaccine_type:E.vaccine_type,doses_received:re.length,latest_date:Z.appointment_date,first_dose_date:ge.appointment_date})}}const{data:H}=await $.from("vaccine_schedules").select("*").eq("active",!0);console.log(" :",(H==null?void 0:H.length)||0,"");const P=[];for(const E of F)if(["scheduled","pending"].includes(E.status)){const G=E.patient_id_number||E.line_user_id,K=w.filter(Z=>(Z.patient_id_number||Z.line_user_id)===G&&Z.vaccine_type.toLowerCase()===E.vaccine_type.toLowerCase()),re=H==null?void 0:H.find(Z=>Z.vaccine_type.toLowerCase()===E.vaccine_type.toLowerCase());re&&(P.push({id:`scheduled-${E.id}`,patient_id:G,patient_name:E.patient_name,vaccine_name:E.vaccine_name||re.vaccine_name,vaccine_type:E.vaccine_type,current_dose:K.length,total_doses:re.total_doses,next_dose_due:E.appointment_date,last_dose_date:K.length>0?K.reduce((Z,ge)=>new Date(ge.appointment_date)>new Date(Z.appointment_date)?ge:Z).appointment_date:null,first_dose_date:K.length>0?K.reduce((Z,ge)=>new Date(ge.appointment_date)<new Date(Z.appointment_date)?ge:Z).appointment_date:null,completion_status:"scheduled",line_user_id:E.line_user_id,vaccine_schedule_id:re.id,is_existing_appointment:!0}),console.log(` : ${E.patient_name} - ${E.vaccine_type}  ${E.appointment_date}`))}const L=Array.from(U.values()).map(async E=>{var G;try{const K=H==null?void 0:H.find(_e=>_e.vaccine_type.toLowerCase()===E.vaccine_type.toLowerCase());if(!K)return console.log(` : ${E.vaccine_type}`),null;if(E.doses_received>=K.total_doses)return console.log(`  ${E.patient_name}  ${E.vaccine_type} `),null;console.log(`  ${E.patient_name} (${E.patient_id}), : ${E.vaccine_type}`);const re=F.find(_e=>{const tt=_e.patient_id_number||_e.line_user_id,st=tt===E.patient_id,Le=_e.vaccine_type.toLowerCase()===E.vaccine_type.toLowerCase(),ut=["scheduled","pending"].includes(_e.status);return console.log(`    : ${_e.patient_name} (${tt})`,{matchesPatient:`${st} (${tt} === ${E.patient_id})`,matchesVaccine:`${Le} (${_e.vaccine_type} === ${E.vaccine_type})`,appointment_date:_e.appointment_date,isActive:`${ut} (${_e.status})`,result:st&&Le&&ut}),st&&Le&&ut});if(re)return console.log(`  ${E.patient_name}  ${E.vaccine_type}  ${re.appointment_date} (${re.status}) - `),null;const Z=C==null?void 0:C.find(_e=>{const st=(_e.patient_id_number||_e.line_user_id)===E.patient_id,Le=_e.vaccine_type.toLowerCase()===E.vaccine_type.toLowerCase(),ut=_e.status==="cancelled",ns=_e.appointment_date<M;return st&&Le&&ut&&ns});if(Z)return console.log(`  ${E.patient_name}  (${Z.appointment_date}) - `),null;console.log(`  ${E.patient_name}  ${E.vaccine_type} - `);const ge=Array.isArray(K.dose_intervals)?K.dose_intervals:JSON.parse(((G=K.dose_intervals)==null?void 0:G.toString())||"[]");console.log(`  vaccine_schedules  ${E.patient_name}:`,{vaccine_type:K.vaccine_type,total_doses:K.total_doses,dose_intervals:ge,current_dose:E.doses_received,first_dose_date:E.first_dose_date});const ve=new Date(E.first_dose_date),de=typeof ge[E.doses_received]=="number"?ge[E.doses_received]:0;console.log(`   ${E.doses_received+1}:  ${de} `);const ke=new Date(ve.getTime());ke.setDate(ve.getDate()+de);const Ft=E.doses_received+1,kt=ge[E.doses_received]||0;return console.log(` ${E.patient_name}:  vaccine_schedules`),console.log(`   - : ${E.first_dose_date}`),console.log(`   - : ${de} `),console.log(`   - : ${Ft}/${K.total_doses}`),console.log(`   - : ${ke.toISOString().split("T")[0]}`),{id:`new-${E.patient_id}-${E.vaccine_type}`,patient_id:E.patient_id,patient_name:E.patient_name,vaccine_name:K.vaccine_name,vaccine_type:E.vaccine_type,current_dose:E.doses_received,total_doses:K.total_doses,next_dose_due:ke.toISOString().split("T")[0],last_dose_date:E.latest_date,first_dose_date:E.first_dose_date,completion_status:"needs_appointment",line_user_id:E.line_user_id,vaccine_schedule_id:K.id,is_existing_appointment:!1}}catch(K){return console.error("Error processing patient:",E.patient_id,K),null}}),X=(await Promise.all(L)).filter(E=>E!==null),S=[...P,...X].sort((E,G)=>new Date(E.next_dose_due).getTime()-new Date(G.next_dose_due).getTime());console.log(" :",S.length,""),console.log(" :",P.length,""),console.log(" :",X.length,""),S.forEach(E=>{const G=E.is_existing_appointment?"()":"()";console.log(`- ${E.patient_name}:  ${E.current_dose+1}/${E.total_doses}, : ${E.next_dose_due}, : ${E.last_dose_date||""} ${G}`)}),s(S)}catch(C){console.error("Error loading next appointments:",C),g({title:"",description:"",variant:"destructive"})}finally{i(!1)}},y=async C=>{if(o!==null){console.log("  - ");return}console.log(" :",C.patient_name,C.vaccine_type),c(C.id);try{console.log(" ...");const{data:j,error:w}=await $.from("appointments").select("*").eq("patient_id_number",C.patient_id).eq("vaccine_type",C.vaccine_type).in("status",["scheduled","pending"]);if(w)throw console.error(" Error checking existing appointments:",w),w;if(console.log(" :",(j==null?void 0:j.length)||0,""),j&&j.length>0){console.log(" :",j),g({title:"",description:`${C.patient_name} `,variant:"destructive"}),console.log(" ..."),await p();return}const M={patient_id_number:C.patient_id,patient_name:C.patient_name,vaccine_type:C.vaccine_type,appointment_date:C.next_dose_due,status:"scheduled",line_user_id:C.line_user_id,notes:` ${C.current_dose+1}  ${C.total_doses} `};console.log(" :",M);const{data:F,error:U}=await $.from("appointments").insert([M]).select();if(U)throw console.error(" Error inserting appointment:",U),U;console.log(" :",F),g({title:"",description:` ${C.patient_name} `}),console.log("  500ms ..."),await new Promise(H=>setTimeout(H,500)),console.log(" ..."),await p(),console.log(" ")}catch(j){console.error(" Error scheduling appointment:",j),g({title:"",description:"",variant:"destructive"})}finally{c(null),console.log(" ")}},N=async C=>{if(!C.line_user_id){g({title:"",description:" LINE User ID ",variant:"destructive"});return}x(C.id);try{const{data:{session:j},error:w}=await $.auth.getSession();if(w||!j){console.error("Authentication error:",w),g({title:"",description:"",variant:"destructive"});return}const{data:M,error:F}=await $.rpc("is_healthcare_staff",{_user_id:j.user.id});if(F&&console.error("Role check error:",F),!M){g({title:"",description:" ( healthcare staff)",variant:"destructive"});return}const{error:U}=await $.functions.invoke("send-line-message",{body:{userId:C.line_user_id,message:` 

 ${C.patient_name}
 ${C.current_dose+1} 
: ${C.vaccine_name}
: ${new Date(C.next_dose_due).toLocaleDateString("th-TH")}



 `}});if(U)throw console.error("Edge function error:",U),U;g({title:"",description:` ${C.patient_name} `})}catch(j){console.error("Error sending reminder:",j);let w="";j!=null&&j.message&&(j.message.includes("LINE")?w=" LINE API  ":j.message.includes("authentication")||j.message.includes("auth")?w=" ":j.message.includes("Access denied")||j.message.includes("role")?w="":w=`: ${j.message}`),g({title:"",description:w,variant:"destructive"})}finally{x(null)}},_=async C=>{if(!C.is_existing_appointment){g({title:"",description:"",variant:"destructive"});return}f(C.id);try{console.log(" :",C.patient_name);const j=C.id.replace("scheduled-",""),{error:w}=await $.from("appointments").update({status:"cancelled"}).eq("id",j);if(w)throw w;console.log(" "),g({title:"",description:` ${C.patient_name} `}),await p()}catch(j){console.error(" Error canceling appointment:",j),g({title:"",description:"",variant:"destructive"})}finally{f(null)}};m.useEffect(()=>{p();const C=setInterval(()=>{p()},3e4);return()=>clearInterval(C)},[]);const D=C=>{const j=new Date,M=new Date(C).getTime()-j.getTime();return Math.ceil(M/(1e3*60*60*24))},T=t.filter(C=>C.patient_name.toLowerCase().includes(a.toLowerCase())||C.vaccine_type.toLowerCase().includes(a.toLowerCase())||C.patient_id.toLowerCase().includes(a.toLowerCase())),O=T.filter(C=>D(C.next_dose_due)<0&&C.is_existing_appointment),k=T.filter(C=>D(C.next_dose_due)>=0||!C.is_existing_appointment),B=C=>C<0?e.jsxs(J,{className:"bg-red-100 text-red-800 border-red-200",children:[" ",Math.abs(C)," "]}):C===0?e.jsx(J,{className:"bg-orange-100 text-orange-800 border-orange-200",children:""}):C<=7?e.jsxs(J,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[" ",C," "]}):e.jsxs(J,{className:"bg-green-100 text-green-800 border-green-200",children:[" ",C," "]});return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-primary/10 to-primary/5 p-6 rounded-xl border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-primary rounded-xl shadow-lg",children:e.jsx(aa,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:""}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(Ie,{className:"h-3.5 w-3.5"}),": ",new Date().toLocaleTimeString("th-TH")]})]})]}),e.jsxs(I,{onClick:p,disabled:r,variant:"outline",size:"lg",className:"shadow-sm",children:[e.jsx(pe,{className:`h-5 w-5 mr-2 ${r?"animate-spin":""}`}),""]})]}),e.jsx(A,{className:"shadow-md",children:e.jsx(R,{className:"pt-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-muted-foreground h-5 w-5"}),e.jsx(ae,{placeholder:" , ,  ID",value:a,onChange:C=>n(C.target.value),className:"pl-12 h-12 text-base border-2 focus:border-primary transition-all"})]})})}),O.length>0&&e.jsxs(A,{className:"border-2 border-red-200 bg-red-50/50 shadow-lg",children:[e.jsx(W,{className:"bg-red-100/80 border-b-2 border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-3 text-red-800",children:[e.jsx("div",{className:"p-2 bg-red-500 rounded-lg",children:e.jsx(lt,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl",children:""}),e.jsx("p",{className:"text-sm font-normal text-red-600 mt-1",children:"!"})]})]}),e.jsxs(J,{variant:"destructive",className:"text-lg px-4 py-2 shadow-sm",children:[O.length," "]})]})}),e.jsx(R,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:O.map(C=>{const j=D(C.next_dose_due);return e.jsx("div",{className:"p-5 bg-white border-2 border-red-200 rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"font-bold text-xl text-red-900",children:C.patient_name}),e.jsxs(J,{className:"bg-red-500 text-white border-0 text-sm px-3 py-1 shadow-sm",children:[" ",Math.abs(j)," "]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Ce,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-medium",children:C.vaccine_name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(he,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{children:[" ",C.current_dose+1,"/",C.total_doses]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Ie,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{children:[": ",new Date(C.next_dose_due).toLocaleDateString("th-TH")]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[e.jsxs(I,{size:"sm",variant:"destructive",onClick:()=>_(C),disabled:h===C.id,className:"shadow-md hover:shadow-lg transition-all",children:[h===C.id?e.jsx(pe,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ct,{className:"h-4 w-4 mr-1"}),h===C.id?"...":""]}),C.line_user_id&&e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>N(C),disabled:d===C.id,className:"border-red-300 text-red-600 hover:bg-red-50",children:[d===C.id?e.jsx(pe,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Tt,{className:"h-4 w-4 mr-1"}),""]})]})]})},C.id)})})})]}),e.jsxs(A,{className:"shadow-md",children:[e.jsx(W,{className:"bg-gradient-to-r from-primary/5 to-blue-50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(he,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl",children:" & "}),e.jsx("p",{className:"text-sm font-normal text-muted-foreground mt-1",children:""})]})]}),e.jsxs(J,{variant:"secondary",className:"text-lg px-4 py-2",children:[k.length," "]})]})}),e.jsxs(R,{className:"pt-6",children:[e.jsx("div",{className:"space-y-4",children:k.map(C=>{const j=D(C.next_dose_due);return e.jsx("div",{className:"p-5 bg-gradient-to-br from-white to-gray-50 border-2 border-gray-200 rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-[1.01] hover:border-primary/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"font-bold text-lg",children:C.patient_name}),B(j)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Ce,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:C.vaccine_name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(he,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{children:[" ",C.current_dose+1,"/",C.total_doses]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Ie,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{children:[": ",new Date(C.next_dose_due).toLocaleDateString("th-TH")]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 bg-gray-100/80 p-2.5 rounded-lg flex justify-center items-center",children:C.is_existing_appointment?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-medium",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),""]}):e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 font-medium",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),""]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[C.is_existing_appointment?e.jsx(J,{className:"bg-green-500 text-white border-0 px-4 py-2 shadow-sm",children:" "}):e.jsxs(I,{size:"sm",onClick:()=>y(C),disabled:o===C.id||o!==null,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-md hover:shadow-lg transition-all",children:[o===C.id?e.jsx(pe,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(aa,{className:"h-4 w-4 mr-1"}),o===C.id?"...":""]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>{u(C),b(!0)},className:"border-2 hover:bg-purple-50 border-purple-300 text-purple-700 shadow-sm",children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),""]}),C.line_user_id&&e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>N(C),disabled:d===C.id,className:"border-2 hover:bg-primary/5 shadow-sm",children:[d===C.id?e.jsx(pe,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Tt,{className:"h-4 w-4 mr-1"}),d===C.id?"...":""]})]})]})},C.id)})}),k.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(aa,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"":""})]})]})]}),e.jsx(Yf,{appointment:l,isOpen:v,onClose:()=>{b(!1),u(null)}})]})},Vo=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(""),[r,i]=m.useState(!1),{toast:o}=xe(),c=async()=>{i(!0);try{const{data:h,error:f}=await $.from("appointments").select("*").eq("status","completed").order("appointment_date",{ascending:!1});if(f)throw f;s(h||[])}catch(h){console.error("Error loading vaccinations:",h),o({title:"",description:"",variant:"destructive"})}finally{i(!1)}};m.useEffect(()=>{c()},[]);const d=t.filter(h=>h.patient_name.toLowerCase().includes(a.toLowerCase())||h.vaccine_type.toLowerCase().includes(a.toLowerCase())||h.patient_phone&&h.patient_phone.includes(a)||h.patient_id_number&&h.patient_id_number.toLowerCase().includes(a.toLowerCase())),x=()=>{const h=[["","","","",""].join(","),...d.map(v=>[new Date(v.appointment_date).toLocaleDateString("th-TH"),v.patient_name,v.patient_phone||"",v.vaccine_type,v.notes||""].join(","))].join(`
`),f=new Blob([h],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),u=URL.createObjectURL(f);l.setAttribute("href",u),l.setAttribute("download",`vaccination_history_${new Date().toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(ja,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:x,variant:"outline",size:"sm",children:[e.jsx(It,{className:"h-4 w-4 mr-2"})," CSV"]}),e.jsxs(I,{onClick:c,disabled:r,variant:"outline",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),""]}),e.jsxs(J,{variant:"secondary",children:[" ",d.length," "]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(ae,{placeholder:", , ",value:a,onChange:h=>n(h.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:d.map(h=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:h.patient_name}),e.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:""})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),new Date(h.appointment_date).toLocaleDateString("th-TH"),h.appointment_time&&`  ${h.appointment_time}`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),h.vaccine_type]}),h.patient_phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),h.patient_phone]}),h.patient_id_number&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),h.patient_id_number]})]}),h.notes&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:[": ",h.notes]})]})})},h.id))}),d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ja,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"":""})]})]})]})]})},Gf=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(!1),[r,i]=m.useState(null),{toast:o}=xe(),c=async()=>{try{const{data:l,error:u}=await $.from("appointment_notifications").select("*").order("created_at",{ascending:!1}).limit(50);if(u)throw u;s(l||[])}catch(l){console.error("Error loading notification history:",l),o({title:"",description:"",variant:"destructive"})}},d=async()=>{var l,u;n(!0);try{const{data:v,error:b}=await $.functions.invoke("manual-notification-trigger",{body:{}});if(b)throw b;i(v.result),o({title:"",description:` ${((u=(l=v.result)==null?void 0:l.statistics)==null?void 0:u.notificationsSent)||0} `}),setTimeout(()=>{c()},2e3)}catch(v){console.error("Error running auto notifications:",v),o({title:"",description:v.message||"",variant:"destructive"})}finally{n(!1)}},x=l=>{switch(l){case"sent":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},h=l=>{switch(l){case"reminder":return e.jsx(Ie,{className:"h-4 w-4"});case"overdue":return e.jsx(Ye,{className:"h-4 w-4"});default:return e.jsx(Be,{className:"h-4 w-4"})}},f=l=>{switch(l){case"reminder":return"";case"overdue":return"";default:return l}};return m.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs(A,{children:[e.jsx(W,{className:"pb-3 md:pb-4",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(ls,{className:"h-5 w-5 text-primary"}),""]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs(le,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs(me,{className:"text-sm md:text-base",children:[":",e.jsx("br",{}),"  1   8 ",e.jsx("br",{})," "]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(I,{onClick:d,disabled:a,className:"flex-1 h-11",children:[e.jsx(Tt,{className:"h-4 w-4 mr-2"}),a?"...":""]}),e.jsxs(I,{onClick:c,variant:"outline",className:"h-11",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),""]})]}),(r==null?void 0:r.statistics)&&e.jsxs("div",{className:"mt-4 p-3 md:p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("h3",{className:"font-medium text-sm md:text-base mb-3 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-600"}),""]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg",children:r.statistics.appointmentsChecked}),e.jsx("div",{className:"text-muted-foreground",children:""})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg",children:r.statistics.overdueAppointmentsChecked}),e.jsx("div",{className:"text-muted-foreground",children:""})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg text-green-600",children:r.statistics.notificationsSent}),e.jsx("div",{className:"text-muted-foreground",children:""})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg text-red-600",children:r.statistics.errors}),e.jsx("div",{className:"text-muted-foreground",children:""})]})]}),r.timestamp&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:[": ",new Date(r.timestamp).toLocaleString("th-TH")]})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{className:"pb-3 md:pb-4",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(he,{className:"h-5 w-5 text-primary"})," (",t.length,")"]})}),e.jsx(R,{className:"p-4 md:p-6",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Me,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:""})]}):e.jsx("div",{className:"space-y-3",children:t.map(l=>e.jsxs("div",{className:"border rounded-lg p-3 md:p-4 hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h(l.notification_type),e.jsx("span",{className:"font-medium text-sm md:text-base",children:f(l.notification_type)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:x(l.status)+" text-xs",children:l.status==="sent"?"":l.status==="failed"?"":l.status}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(l.created_at).toLocaleString("th-TH")})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[": ",l.sent_to]}),e.jsx("div",{className:"text-xs md:text-sm bg-background p-2 rounded border border-border/30 max-h-20 overflow-y-auto",children:l.message_content})]},l.id))})})]})]})},Yo=()=>{const[t,s]=m.useState([]),[a,n]=m.useState(""),[r,i]=m.useState(!1),[o,c]=m.useState(null),[d,x]=m.useState(!1),[h,f]=m.useState(null),{toast:l}=xe(),u=async()=>{i(!0);try{const{data:_,error:D}=await $.from("appointments").select("*").in("status",["scheduled","pending"]).gte("appointment_date",new Date().toISOString().split("T")[0]).order("appointment_date",{ascending:!0});if(D)throw D;s(_||[])}catch(_){console.error("Error loading appointments:",_),l({title:"",description:"",variant:"destructive"})}finally{i(!1)}};m.useEffect(()=>{u()},[]);const v=t.filter(_=>_.patient_name.toLowerCase().includes(a.toLowerCase())||_.vaccine_type.toLowerCase().includes(a.toLowerCase())||_.patient_id_number.toLowerCase().includes(a.toLowerCase())),b=_=>{c({..._}),x(!0)},g=async()=>{if(o)try{const{error:_}=await $.from("appointments").update({appointment_date:o.appointment_date,status:o.status,notes:o.notes}).eq("id",o.id);if(_)throw _;l({title:"",description:""}),x(!1),c(null),u()}catch(_){console.error("Error updating appointment:",_),l({title:"",description:"",variant:"destructive"})}},p=async _=>{if(confirm("?")){f(_);try{const{error:D}=await $.from("appointments").update({status:"cancelled"}).eq("id",_);if(D)throw D;l({title:"",description:""}),u()}catch(D){console.error("Error deleting appointment:",D),l({title:"",description:"",variant:"destructive"})}finally{f(null)}}},y=_=>{const D=new Date,O=new Date(_).getTime()-D.getTime();return Math.ceil(O/(1e3*60*60*24))},N=_=>{switch(_){case"scheduled":return e.jsx(J,{className:"bg-blue-100 text-blue-800",children:""});case"pending":return e.jsx(J,{className:"bg-yellow-100 text-yellow-800",children:""});default:return e.jsx(J,{variant:"secondary",children:_})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(he,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs(I,{onClick:u,disabled:r,variant:"outline",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),""]}),e.jsxs(J,{variant:"secondary",children:[" ",v.length," "]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(ae,{placeholder:", ,  ID",value:a,onChange:_=>n(_.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:v.map(_=>{const D=y(_.appointment_date);return e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:_.patient_name}),N(_.status)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),new Date(_.appointment_date).toLocaleDateString("th-TH")]}),e.jsxs("div",{children:[": ",_.vaccine_name]}),e.jsx("div",{children:D>0?` ${D} `:D===0?"":` ${Math.abs(D)} `})]}),_.notes&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-2 rounded",children:[": ",_.notes]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>b(_),children:[e.jsx(Ua,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(I,{size:"sm",variant:"destructive",onClick:()=>p(_.id),disabled:h===_.id,children:[h===_.id?e.jsx(pe,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Mr,{className:"h-4 w-4 mr-1"}),""]})]})]})},_.id)})}),v.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(he,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"":""})]})]})]}),e.jsx(ps,{open:d,onOpenChange:x,children:e.jsxs(ts,{children:[e.jsx(ss,{children:e.jsx(as,{children:""})}),o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{children:""}),e.jsx(ae,{value:o.patient_name,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(Q,{children:""}),e.jsx(ae,{type:"date",value:o.appointment_date,onChange:_=>c({...o,appointment_date:_.target.value})})]}),e.jsxs("div",{children:[e.jsx(Q,{children:""}),e.jsxs(_t,{value:o.status,onValueChange:_=>c({...o,status:_}),children:[e.jsx(gt,{children:e.jsx(St,{})}),e.jsxs(vt,{children:[e.jsx(Ee,{value:"scheduled",children:""}),e.jsx(Ee,{value:"pending",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(Q,{children:""}),e.jsx(ae,{value:o.notes||"",onChange:_=>c({...o,notes:_.target.value}),placeholder:"..."})]})]}),e.jsxs(fs,{children:[e.jsxs(I,{variant:"outline",onClick:()=>x(!1),children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(I,{onClick:g,children:[e.jsx(Rr,{className:"h-4 w-4 mr-1"}),""]})]})]})})]})},qf=()=>{const[t,s]=m.useState(!1),[a,n]=m.useState([]),{toast:r}=xe(),i=async()=>{s(!0),n([]);const d=[];try{d.push({test:"Database Connection",status:"success",message:""});try{const{data:l,error:u}=await $.from("appointment_notifications").select("count").limit(1);if(u)throw u;d.push({test:"Notifications Table",status:"success",message:" appointment_notifications "})}catch(l){d.push({test:"Notifications Table",status:"error",message:` appointment_notifications : ${l.message}`})}try{const l=new Date;l.setDate(l.getDate()+1);const u=l.toISOString().split("T")[0],{data:v,error:b}=await $.from("appointments").select("*").eq("appointment_date",u).eq("status","scheduled");if(b)throw b;d.push({test:"Tomorrow Appointments",status:v&&v.length>0?"success":"warning",message:` ${(v==null?void 0:v.length)||0} `,details:v})}catch(l){d.push({test:"Tomorrow Appointments",status:"error",message:`: ${l.message}`})}try{const l=new Date().toISOString().split("T")[0],{data:u,error:v}=await $.from("appointments").select("*").lt("appointment_date",l).eq("status","scheduled");if(v)throw v;d.push({test:"Overdue Appointments",status:u&&u.length>0?"warning":"success",message:` ${(u==null?void 0:u.length)||0} `,details:u})}catch(l){d.push({test:"Overdue Appointments",status:"error",message:`: ${l.message}`})}try{const{data:l,error:u}=await $.functions.invoke("manual-notification-trigger",{body:{test:!0}});if(u)throw u;d.push({test:"Notification Function",status:"success",message:"",details:l})}catch(l){d.push({test:"Notification Function",status:"error",message:`: ${l.message}`})}try{d.push({test:"CRON Job Status",status:"warning",message:" CRON job  ( admin  server-side)"})}catch{d.push({test:"CRON Job Status",status:"warning",message:" CRON job "})}try{const{data:l,error:u}=await $.from("appointment_notifications").select("*").order("created_at",{ascending:!1}).limit(5);if(u)throw u;d.push({test:"Recent Notifications",status:"success",message:` ${(l==null?void 0:l.length)||0} `,details:l})}catch(l){d.push({test:"Recent Notifications",status:"error",message:`: ${l.message}`})}try{const{data:l,error:u}=await $.from("notification_jobs").select("*").order("created_at",{ascending:!1}).limit(5);if(u)throw u;const v=(l==null?void 0:l.filter(b=>b.status==="pending"))||[];d.push({test:"Notification Jobs Queue",status:"success",message:` ${(l==null?void 0:l.length)||0}  (: ${v.length})`,details:{total:l==null?void 0:l.length,pending:v.length,jobs:l}})}catch(l){d.push({test:"Notification Jobs Queue",status:"warning",message:` notification_jobs : ${l.message}`})}}catch(l){d.push({test:"General Error",status:"error",message:`: ${l.message}`})}n(d),s(!1);const x=d.filter(l=>l.status==="success").length,h=d.filter(l=>l.status==="error").length,f=d.filter(l=>l.status==="warning").length;r({title:"",description:`: ${x}, : ${f}, : ${h}`,variant:h>0?"destructive":"default"})},o=d=>{switch(d){case"success":return e.jsx(ee,{className:"h-4 w-4 text-green-600"});case"warning":return e.jsx(Ye,{className:"h-4 w-4 text-yellow-600"});case"error":return e.jsx(Ye,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Ie,{className:"h-4 w-4 text-gray-600"})}},c=d=>{switch(d){case"success":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(jn,{className:"h-5 w-5 text-primary"}),""]})}),e.jsxs(R,{children:[e.jsxs(le,{className:"mb-4",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsx(me,{children:" , , "})]}),e.jsxs(I,{onClick:i,disabled:t,className:"w-full mb-6",children:[t?e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(jn,{className:"h-4 w-4 mr-2"}),t?"...":""]}),a.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-lg mb-3",children:":"}),a.map((d,x)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o(d.status),e.jsx("span",{className:"font-medium",children:d.test})]}),e.jsx(J,{className:c(d.status),children:d.status==="success"?"":d.status==="warning"?"":""})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:d.message}),d.details&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-800",children:""}),e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(d.details,null,2)})]})]},x))]})]})]})})};function Kf(){const[t,s]=m.useState([]),[a,n]=m.useState(!0),[r,i]=m.useState(""),[o,c]=m.useState(""),[d,x]=m.useState("healthcare_staff"),{toast:h}=xe(),f=async()=>{n(!0);try{const{data:p,error:y}=await $.from("user_roles").select("user_id, role");if(y)throw y;const{data:{session:N}}=await $.auth.getSession();if(!N)throw new Error("");const _=new Map;p==null||p.forEach(T=>{var O;_.has(T.user_id)||_.set(T.user_id,[]),(O=_.get(T.user_id))==null||O.push(T.role)});const D=Array.from(_.entries()).map(([T,O])=>({id:T,email:`user-${T.slice(0,8)}@example.com`,user_created_at:new Date().toISOString(),last_sign_in_at:new Date().toISOString(),roles:O,is_admin:O.includes("admin"),is_healthcare_staff:O.includes("admin")||O.includes("healthcare_staff")}));N.user&&!_.has(N.user.id)&&D.unshift({id:N.user.id,email:N.user.email||"unknown@example.com",user_created_at:N.user.created_at,last_sign_in_at:N.user.last_sign_in_at||null,roles:[],is_admin:!1,is_healthcare_staff:!1}),s(D)}catch(p){console.error("Error loading users:",p),h({title:"",description:"",variant:"destructive"})}finally{n(!1)}},l=async(p,y)=>{try{const{data:{user:N}}=await $.auth.getUser();if(!N)throw new Error("");let _=N.id;p!==N.email&&console.warn("Cannot assign role to different user in demo mode");const{error:D}=await $.from("user_roles").insert({user_id:_,role:y,created_by:N.id});if(D&&!D.message.includes("duplicate"))throw D;h({title:"",description:` ${g(y)}  ${p} `}),f()}catch(N){console.error("Error assigning role:",N),h({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}},u=async()=>{if(!o.trim()){h({title:"",description:"",variant:"destructive"});return}await l(o,d),c("")};m.useEffect(()=>{f()},[]);const v=t.filter(p=>p.email.toLowerCase().includes(r.toLowerCase())),b=p=>{switch(p){case"admin":return"bg-red-100 text-red-800 border-red-200";case"healthcare_staff":return"bg-blue-100 text-blue-800 border-blue-200";case"patient":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},g=p=>{switch(p){case"admin":return"";case"healthcare_staff":return"";case"patient":return"";default:return p}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5"}),""]})}),e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(Q,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),e.jsx(ae,{id:"search",value:r,onChange:p=>i(p.target.value),placeholder:"...",className:"pl-10 cursor-text"})]})]}),e.jsxs("div",{className:"space-y-2 sm:w-auto w-full",children:[e.jsx(Q,{className:"hidden sm:block",children:""}),e.jsxs(I,{onClick:f,disabled:a,className:"w-full sm:w-auto cursor-pointer disabled:cursor-not-allowed",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),""]})]})]})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"h-5 w-5"}),""]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"userEmail",children:""}),e.jsx(ae,{id:"userEmail",value:o,onChange:p=>c(p.target.value),placeholder:"user@example.com",type:"email",className:"cursor-text"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"userRole",children:""}),e.jsxs(_t,{value:d,onValueChange:p=>x(p),children:[e.jsx(gt,{className:"cursor-pointer",children:e.jsx(St,{})}),e.jsxs(vt,{children:[e.jsx(Ee,{value:"healthcare_staff",className:"cursor-pointer",children:""}),e.jsx(Ee,{value:"admin",className:"cursor-pointer",children:""}),e.jsx(Ee,{value:"patient",className:"cursor-pointer",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(Q,{className:"hidden lg:block",children:""}),e.jsxs(I,{onClick:u,className:"w-full cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),""]})]})]})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{children:[" (",v.length," )"]})}),e.jsx(R,{children:a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pe,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]}):v.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Me,{className:"h-8 w-8 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""})]}):e.jsx("div",{className:"space-y-4",children:v.map(p=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow cursor-default",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium truncate select-text",title:p.email,children:p.email}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.roles.length>0?p.roles.map(y=>e.jsx(J,{className:`${b(y)} text-xs`,children:g(y)},y)):e.jsx(J,{variant:"outline",className:"text-xs",children:""})})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{className:"select-text",children:[": ",new Date(p.user_created_at).toLocaleDateString("th-TH")]}),p.last_sign_in_at&&e.jsxs("p",{className:"select-text",children:[": ",new Date(p.last_sign_in_at).toLocaleDateString("th-TH")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2 lg:flex-shrink-0",children:[!p.is_healthcare_staff&&e.jsxs(I,{size:"sm",onClick:()=>l(p.email,"healthcare_staff"),className:"cursor-pointer hover:shadow-sm transition-shadow text-xs sm:text-sm",children:[e.jsx(Pe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),!p.is_admin&&e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>l(p.email,"admin"),className:"cursor-pointer hover:shadow-sm transition-shadow text-xs sm:text-sm",children:[e.jsx(Pe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:" Admin"}),e.jsx("span",{className:"sm:hidden",children:"Admin"})]})]})]})},p.id))})})]})]})}const Jf=()=>{const[t,s]=m.useState(""),[a,n]=m.useState(!1),[r,i]=m.useState("idle"),[o,c]=m.useState(null),[d,x]=m.useState(""),{toast:h}=xe();m.useEffect(()=>{var g;if(s("1.0.6"),(g=window.electron)!=null&&g.ipcRenderer){const p=(_,D)=>{i("available"),c(D),n(!1),h({title:"",description:` ${D.version} `})},y=()=>{i("not-available"),n(!1),h({title:"",description:""})},N=(_,D)=>{i("error"),x(D.message),n(!1),h({title:"",description:"",variant:"destructive"})};return window.electron.ipcRenderer.on("update-available",p),window.electron.ipcRenderer.on("update-not-available",y),window.electron.ipcRenderer.on("update-error",N),()=>{var _,D,T;(_=window.electron)==null||_.ipcRenderer.removeListener("update-available",p),(D=window.electron)==null||D.ipcRenderer.removeListener("update-not-available",y),(T=window.electron)==null||T.ipcRenderer.removeListener("update-error",N)}}},[h]);const f=()=>{var b;if(!((b=window.electron)!=null&&b.ipcRenderer)){h({title:"",description:" Desktop App ",variant:"destructive"});return}n(!0),i("checking"),x(""),window.electron.ipcRenderer.send("check-for-updates")},l=()=>{var b;!((b=window.electron)!=null&&b.ipcRenderer)||!o||(window.electron.ipcRenderer.send("download-update"),h({title:"",description:"..."}))},u=()=>{switch(r){case"checking":return e.jsx(pe,{className:"h-5 w-5 animate-spin text-blue-500"});case"available":return e.jsx(We,{className:"h-5 w-5 text-orange-500"});case"not-available":return e.jsx(Et,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(lt,{className:"h-5 w-5 text-red-500"});default:return null}},v=()=>{switch(r){case"checking":return"...";case"available":return` ${o==null?void 0:o.version} `;case"not-available":return"";case"error":return`: ${d}`;default:return""}};return e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:""}),e.jsx(ue,{children:""})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:t})]}),u()]}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[u(),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v()}),r==="available"&&(o==null?void 0:o.releaseNotes)&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/50 rounded text-xs",children:[e.jsx("p",{className:"font-semibold mb-1",children:":"}),e.jsx("p",{className:"whitespace-pre-wrap",children:o.releaseNotes})]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:f,disabled:a,className:"flex-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),""]})}),r==="available"&&e.jsxs(I,{onClick:l,variant:"default",className:"flex-1",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:""})]})]})},Go=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:V("w-full caption-bottom text-sm",t),...s})}));Go.displayName="Table";const qo=m.forwardRef(({className:t,...s},a)=>e.jsx("thead",{ref:a,className:V("[&_tr]:border-b",t),...s}));qo.displayName="TableHeader";const Ko=m.forwardRef(({className:t,...s},a)=>e.jsx("tbody",{ref:a,className:V("[&_tr:last-child]:border-0",t),...s}));Ko.displayName="TableBody";const Xf=m.forwardRef(({className:t,...s},a)=>e.jsx("tfoot",{ref:a,className:V("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s}));Xf.displayName="TableFooter";const Fa=m.forwardRef(({className:t,...s},a)=>e.jsx("tr",{ref:a,className:V("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s}));Fa.displayName="TableRow";const Ht=m.forwardRef(({className:t,...s},a)=>e.jsx("th",{ref:a,className:V("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s}));Ht.displayName="TableHead";const Vt=m.forwardRef(({className:t,...s},a)=>e.jsx("td",{ref:a,className:V("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s}));Vt.displayName="TableCell";const Qf=m.forwardRef(({className:t,...s},a)=>e.jsx("caption",{ref:a,className:V("mt-4 text-sm text-muted-foreground",t),...s}));Qf.displayName="TableCaption";const Zf=()=>{const[t,s]=m.useState([]),[a,n]=m.useState([]),[r,i]=m.useState("");m.useEffect(()=>{var h;if(o(),(h=window.electron)!=null&&h.ipcRenderer){const f=(l,u)=>{s(v=>[u,...v])};return window.electron.ipcRenderer.on("update-log-entry",f),()=>{var l;(l=window.electron)==null||l.ipcRenderer.removeListener("update-log-entry",f)}}},[]),m.useEffect(()=>{if(r.trim()==="")n(t);else{const h=r.toLowerCase(),f=t.filter(l=>{var u;return l.action.toLowerCase().includes(h)||((u=l.version)==null?void 0:u.toLowerCase().includes(h))||l.details.toLowerCase().includes(h)||Re(new Date(l.timestamp),"dd/MM/yyyy HH:mm",{locale:ms}).includes(h)});n(f)}},[r,t]);const o=()=>{var f;const h=localStorage.getItem("update-logs");if(h)try{const l=JSON.parse(h);s(l),n(l)}catch(l){console.error("Failed to parse stored logs:",l)}if((f=window.electron)!=null&&f.ipcRenderer){window.electron.ipcRenderer.send("get-update-logs");const l=(u,v)=>{s(v),n(v)};window.electron.ipcRenderer.on("update-logs-data",l)}},c=h=>{switch(h){case"check":return e.jsx(pe,{className:"h-4 w-4"});case"download":return e.jsx(We,{className:"h-4 w-4"});case"install":return e.jsx(Et,{className:"h-4 w-4"});case"error":return e.jsx(Te,{className:"h-4 w-4"});default:return null}},d=h=>{switch(h){case"check":return"";case"download":return"";case"install":return"";case"error":return"";default:return h}},x=(h,f)=>f==="error"?e.jsxs(J,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(Te,{className:"h-3 w-3"}),""]}):h?e.jsxs(J,{variant:"default",className:"flex items-center gap-1 bg-green-500",children:[e.jsx(Et,{className:"h-3 w-3"}),""]}):e.jsxs(J,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(Te,{className:"h-3 w-3"}),""]});return e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:""}),e.jsx(ue,{children:""})]}),e.jsxs(R,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{type:"text",placeholder:", , ...",value:r,onChange:h=>i(h.target.value),className:"pl-10"})]})}),a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:r?"":""})}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Go,{children:[e.jsx(qo,{children:e.jsxs(Fa,{children:[e.jsx(Ht,{className:"w-[180px]",children:"/"}),e.jsx(Ht,{className:"w-[120px]",children:""}),e.jsx(Ht,{className:"w-[100px]",children:""}),e.jsx(Ht,{className:"w-[100px]",children:""}),e.jsx(Ht,{children:""})]})}),e.jsx(Ko,{children:a.map((h,f)=>e.jsxs(Fa,{children:[e.jsx(Vt,{className:"font-mono text-xs",children:Re(new Date(h.timestamp),"dd/MM/yyyy HH:mm:ss",{locale:ms})}),e.jsx(Vt,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[c(h.action),e.jsx("span",{className:"text-sm",children:d(h.action)})]})}),e.jsx(Vt,{children:h.version?e.jsx(J,{variant:"outline",children:h.version}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})}),e.jsx(Vt,{children:x(h.success,h.action)}),e.jsx(Vt,{className:"text-sm text-muted-foreground max-w-md truncate",children:h.details})]},f))})]})}),a.length>0&&e.jsxs("div",{className:"mt-4 text-xs text-muted-foreground text-center",children:[" ",a.length," ",r&&`  ${t.length} `]})]})]})},eg=()=>{const[t,s]=m.useState(null),[a,n]=m.useState(null),[r,i]=m.useState(!1),[o,c]=m.useState(!1),[d,x]=m.useState(!0),h=Rt(),{toast:f}=xe();m.useEffect(()=>{(async()=>{var g,p;try{const{data:{session:y},error:N}=await $.auth.getSession();if(N)throw N;if(!y){x(!1);return}n(y),s(y.user);const{data:_,error:D}=await $.rpc("is_healthcare_staff",{_user_id:y.user.id});if(D){console.error("Error checking staff status:",D);const k=((g=y.user.email)==null?void 0:g.endsWith("@vchomehospital.co.th"))||!1;i(k)}else if(_)i(_);else{const k=((p=y.user.email)==null?void 0:p.endsWith("@vchomehospital.co.th"))||!1,B=["admin@vchomehospital.co.th","staff@vchomehospital.co.th"].includes(y.user.email||"");i(k||B)}const{data:T,error:O}=await $.rpc("has_role",{_user_id:y.user.id,_role:"admin"});if(O){console.error("Error checking admin status:",O);const k=y.user.email==="admin@vchomehospital.co.th"||y.user.email==="superadmin@vchomehospital.co.th";c(k)}else if(T)c(T);else{const k=y.user.email==="admin@vchomehospital.co.th"||y.user.email==="superadmin@vchomehospital.co.th";c(k)}}catch(y){console.error("Auth check error:",y),f({title:"",description:"",variant:"destructive"})}finally{x(!1)}})();const{data:{subscription:b}}=$.auth.onAuthStateChange(async(g,p)=>{(g==="SIGNED_OUT"||!p)&&(s(null),n(null),i(!1),c(!1),h("/auth"))});return()=>b.unsubscribe()},[h,f]);const l=async()=>{try{const{error:v}=await $.auth.signOut();if(v)throw v;f({title:"",description:""}),h("/auth")}catch(v){console.error("Sign out error:",v),f({title:"",description:"",variant:"destructive"})}},u=()=>{h("/auth")};return d?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsx(A,{className:"w-96",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"..."})]})})}):t?r?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white",children:[e.jsx("div",{className:"bg-white border-b shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"container mx-auto px-2 sm:px-4 py-3 sm:py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl overflow-hidden shadow-md flex-shrink-0 bg-gradient-to-br from-blue-50 to-blue-100 p-1",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"",className:"w-full h-full object-contain",onError:v=>{const b=v.target,g="./";b.src.includes("hospital-logo.png")?b.src=`${g}images/home-hospital-logo.png`:b.src.includes("home-hospital-logo.png")&&(b.src=`${g}favicon-hospital.png`)}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-foreground truncate",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"text-right hidden lg:block",children:[e.jsx("p",{className:"text-sm font-medium truncate max-w-[200px]",title:t.email,children:t.email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o?"":""})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"lg:hidden p-2",title:`${t.email} - ${o?"":""}`,children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsxs(I,{onClick:l,variant:"outline",size:"sm",className:"px-2 sm:px-4",children:[e.jsx(Ms,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs(mt,{defaultValue:"staff-portal",className:"w-full",children:[e.jsx("div",{className:"block lg:hidden mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(qe,{className:"flex w-max gap-1 p-1",children:[e.jsx(te,{value:"staff-portal",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),e.jsx(te,{value:"registrations",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),e.jsxs(e.Fragment,{children:[e.jsx(te,{value:"next-appointments",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),e.jsx(te,{value:"past-vaccinations",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),e.jsx(te,{value:"edit-appointments",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),e.jsx(te,{value:"vaccine-calculator",className:"text-xs px-3 py-2 whitespace-nowrap",children:""})]}),o&&!0&&e.jsx(te,{value:"user-roles",className:"text-xs px-3 py-2 whitespace-nowrap",children:""}),o&&!0&&e.jsx(te,{value:"settings",className:"text-xs px-3 py-2 whitespace-nowrap",children:""})]})})}),e.jsxs(qe,{className:`hidden lg:grid w-full mb-6 gap-1 ${o?"grid-cols-8":"grid-cols-6"}`,children:[e.jsx(te,{value:"staff-portal",className:"text-sm px-2 py-2",children:""}),e.jsx(te,{value:"registrations",className:"text-sm px-2 py-2",children:""}),e.jsx(te,{value:"next-appointments",className:"text-sm px-2 py-2",children:""}),e.jsx(te,{value:"past-vaccinations",className:"text-sm px-2 py-2",children:""}),e.jsx(te,{value:"edit-appointments",className:"text-sm px-2 py-2",children:""}),e.jsx(te,{value:"vaccine-calculator",className:"text-sm px-2 py-2",children:""}),o&&e.jsx(te,{value:"user-roles",className:"text-sm px-2 py-2",children:""}),o&&e.jsx(te,{value:"settings",className:"text-sm px-2 py-2",children:""})]}),e.jsx(ne,{value:"staff-portal",children:e.jsx(no,{isAdmin:o})}),e.jsx(ne,{value:"registrations",children:e.jsx(Bo,{})}),e.jsx(ne,{value:"next-appointments",children:e.jsx(Ho,{})}),e.jsx(ne,{value:"past-vaccinations",children:e.jsx(Vo,{})}),e.jsx(ne,{value:"edit-appointments",children:e.jsx(Yo,{})}),e.jsx(ne,{value:"vaccine-calculator",children:e.jsx(Vf,{})}),o&&e.jsx(ne,{value:"user-roles",children:e.jsx(Kf,{})}),o&&e.jsx(ne,{value:"settings",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(Jf,{}),e.jsx(Zf,{}),e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsx(z,{children:""}),e.jsx(ue,{children:""})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",t.email]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",o?"":""]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsx(Gf,{}),e.jsx(qf,{})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:""}),e.jsx("div",{className:"mt-2",children:e.jsx(ro,{})})]})]})})]})]})})]})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsxs(A,{className:"w-96",children:[e.jsx(W,{className:"text-center",children:e.jsxs(z,{className:"flex items-center justify-center gap-2 text-2xl text-destructive",children:[e.jsx(Pe,{className:"h-6 w-6"}),""]})}),e.jsxs(R,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",t==null?void 0:t.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," "]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(I,{onClick:()=>window.location.reload(),className:"w-full",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(I,{onClick:l,variant:"outline",className:"w-full",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),""]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsxs(A,{className:"w-96",children:[e.jsx(W,{className:"text-center",children:e.jsxs(z,{className:"flex items-center justify-center gap-2 text-2xl",children:[e.jsx(Pe,{className:"h-6 w-6 text-primary"}),""]})}),e.jsxs(R,{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:""}),e.jsx(I,{onClick:u,className:"w-full",children:""})]})]})})},er=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:" - Staff Portal",children:e.jsx(eg,{})})},Jo=({className:t="mx-auto",size:s=128})=>{const a="./",n=a.endsWith("/")?a:a+"/";return e.jsx("div",{className:t,style:{width:s,height:s},children:e.jsx("div",{className:"w-full h-full rounded-3xl overflow-hidden bg-gradient-to-br from-white/50 to-transparent p-2 backdrop-blur-sm",children:e.jsx("img",{src:n+"images/hospital-logo.png",alt:". - VCHome Hospital Logo",className:"w-full h-full object-contain drop-shadow-2xl",onError:r=>{const i=r.target,o=[n+"images/home-hospital-logo.png",n+"images/home-hospital-logo.svg",n+"favicon-hospital.png"],c=i.src;let d=-1;c.includes("hospital-logo.png")?d=0:c.includes("home-hospital-logo.png")?d=1:c.includes("home-hospital-logo.svg")&&(d=2),d>=0&&d<o.length&&(i.src=o[d])}})})})},tr=()=>{const[t,s]=m.useState(null),[a,n]=m.useState(null),[r,i]=m.useState(!0),[o,c]=m.useState(!1),[d,x]=m.useState(!1),h=Rt();return xe(),m.useEffect(()=>{i(!1),c(!0);const{data:{subscription:f}}=$.auth.onAuthStateChange(async(l,u)=>{n(u),s((u==null?void 0:u.user)??null),u!=null&&u.user&&setTimeout(async()=>{try{const{data:v,error:b}=await $.rpc("has_role",{_user_id:u.user.id,_role:"admin"}),{data:g,error:p}=await $.rpc("is_healthcare_staff",{_user_id:u.user.id});!b&&!p&&(c(v),x(g))}catch(v){console.error("Role check failed:",v)}},100)});return setTimeout(()=>{$.auth.getSession().then(({data:{session:l}})=>{n(l),s((l==null?void 0:l.user)??null)})},50),()=>f.unsubscribe()},[h]),r?e.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md bg-white rounded-2xl p-8 shadow-lg",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):o?e.jsxs(Je,{user:t,title:" - ",children:[e.jsxs("div",{className:"mb-8 text-center bg-gradient-to-br from-teal-50 via-white to-cyan-50 rounded-2xl p-8 border border-teal-200/50",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Jo,{className:"mx-auto",size:140})}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-teal-600 via-cyan-600 to-blue-600 bg-clip-text text-transparent",children:""}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-2xl md:text-3xl font-semibold text-gray-700",children:[e.jsx(Zl,{className:"h-6 w-6 text-red-500"}),e.jsx("span",{children:"VCHome Hospital"}),e.jsx(ec,{className:"h-6 w-6 text-yellow-500"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"   "})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-green-100 text-green-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),""]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx(Pe,{className:"h-4 w-4"})," 100%"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-purple-100 text-purple-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx(ls,{className:"h-4 w-4"}),"24/7 Support"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:"12"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+8.2% "})]}),e.jsx(he,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:"156"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+12.5% "})]}),e.jsx(Me,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:"8"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:""})]}),e.jsx(Pe,{className:"h-8 w-8 text-purple-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-3xl font-bold text-teal-600",children:"98.5%"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+2.1% "})]}),e.jsx(Ls,{className:"h-8 w-8 text-teal-600"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-8",children:[e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-teal-100 rounded-xl",children:e.jsx(Me,{className:"h-6 w-6 text-teal-600"})}),""]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:" "}),e.jsx(I,{asChild:!0,className:"w-full",children:e.jsxs(sa,{to:"/auth",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),""]})})]})]}),e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(us,{className:"h-6 w-6 text-blue-600"})}),"LINE Bot Management"]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:" LINE Bot  "}),e.jsx(I,{asChild:!0,className:"w-full",variant:"outline",children:e.jsxs(sa,{to:"/LineBot",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),""]})})]})]}),e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(ct,{className:"h-6 w-6 text-green-600"})}),""]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:" "}),e.jsx(I,{asChild:!0,className:"w-full",variant:"outline",children:e.jsxs(sa,{to:"/PatientPortal",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),""]})})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[e.jsx(A,{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border-teal-200",children:e.jsxs(R,{className:"p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-4 bg-teal-600 rounded-2xl",children:e.jsx(Pe,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:""}),e.jsx("p",{className:"text-gray-600",children:"Administrator Access"})]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"   "}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Full Access"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx(ls,{className:"h-3 w-3"}),"System Active"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx(yn,{className:"h-3 w-3"}),"Analytics"]})]})]})}),e.jsx(A,{children:e.jsxs(R,{className:"p-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(I,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/admin"),children:[e.jsx($e,{className:"h-4 w-4 mr-3"}),""]}),e.jsxs(I,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/reports"),children:[e.jsx(yn,{className:"h-4 w-4 mr-3"}),""]}),e.jsxs(I,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/notifications"),children:[e.jsx(Be,{className:"h-4 w-4 mr-3"}),""]}),e.jsxs(I,{className:"w-full justify-start h-12 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white",onClick:()=>h("/download"),children:[e.jsx(We,{className:"h-4 w-4 mr-3"})," Desktop App"]})]})]})})]}),e.jsxs("div",{className:"mt-8 p-8 bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:" "}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5,6,7,8].map(f=>e.jsxs(A,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2",children:[" ",f]}),e.jsx("p",{className:"text-muted-foreground",children:"      "})]},f))})]})]}):null},tg="./",sr=(window.location.origin+tg).replace(/\/+$/,""),ar=()=>{const[t,s]=m.useState(null),[a,n]=m.useState(null),[r,i]=m.useState(""),[o,c]=m.useState(""),[d,x]=m.useState(!1),[h,f]=m.useState(!1),[l,u]=m.useState(!1),[v,b]=m.useState(!1),[g,p]=m.useState(""),[y,N]=m.useState(""),_=Rt(),{toast:D}=xe(),T=m.useRef(!1);m.useEffect(()=>{const w=new URL(window.location.href),M=w.searchParams,F=new URLSearchParams(w.hash.slice(1)),U=M.get("type")||F.get("type"),H=M.get("code")||F.get("code"),P=F.get("access_token"),L=F.get("refresh_token");U==="recovery"&&(T.current=!0,b(!0),H?$.auth.exchangeCodeForSession(H).then(({error:X})=>{X&&(console.error("exchangeCodeForSession error:",X),D({title:"",description:"",variant:"destructive"}),b(!1),T.current=!1)}):P&&L&&$.auth.setSession({access_token:P,refresh_token:L}).then(({error:X})=>{X&&(console.error("setSession error:",X),D({title:"",description:"",variant:"destructive"}),b(!1),T.current=!1)}));const{data:{subscription:Y}}=$.auth.onAuthStateChange((X,S)=>{if(n(S),s((S==null?void 0:S.user)??null),X==="PASSWORD_RECOVERY"){b(!0),T.current=!0;return}S!=null&&S.user&&!T.current&&(_("/staff-portal",{replace:!0}),D({title:"",description:""}))});return $.auth.getSession().then(({data:{session:X}})=>{n(X),s((X==null?void 0:X.user)??null),X!=null&&X.user&&!T.current&&_("/staff-portal",{replace:!0})}),()=>Y.unsubscribe()},[_,D]);const O=async()=>{var w;x(!0);try{const{error:M}=await $.auth.signInWithPassword({email:r,password:o});if(M){M instanceof ic&&M.status===400?D({title:"",description:"",variant:"destructive"}):(w=M.message)!=null&&w.toLowerCase().includes("email not confirmed")?D({title:"",description:"",variant:"destructive"}):D({title:"",description:M.message,variant:"destructive"});return}}catch{D({title:"",description:" ",variant:"destructive"})}finally{x(!1)}},k=async()=>{var w,M;x(!0);try{const F=`${sr}/`,{error:U}=await $.auth.signUp({email:r,password:o,options:{emailRedirectTo:F}});if(U){(w=U.message)!=null&&w.toLowerCase().includes("already registered")?D({title:"",description:" ",variant:"destructive"}):(M=U.message)!=null&&M.toLowerCase().includes("password")?D({title:"",description:" 6 ",variant:"destructive"}):D({title:"",description:U.message,variant:"destructive"});return}D({title:"",description:""}),f(!1)}catch{D({title:"",description:" ",variant:"destructive"})}finally{x(!1)}},B=async()=>{if(!r){D({title:"",description:"",variant:"destructive"});return}x(!0);try{const{error:w}=await $.auth.resetPasswordForEmail(r,{redirectTo:`${sr}/auth?type=recovery`});w?D({title:"",description:w.message,variant:"destructive"}):(D({title:"",description:""}),u(!1))}catch{D({title:"",description:" ",variant:"destructive"})}finally{x(!1)}},C=async()=>{if(!g||!y){D({title:"",description:"",variant:"destructive"});return}if(g!==y){D({title:"",description:"",variant:"destructive"});return}if(g.length<6){D({title:"",description:" 6 ",variant:"destructive"});return}x(!0);try{const{error:w}=await $.auth.updateUser({password:g});w?D({title:"",description:w.message,variant:"destructive"}):(D({title:"",description:" "}),_("/auth",{replace:!0}),setTimeout(()=>{T.current=!1,b(!1),_("/staff-portal",{replace:!0})},800))}catch{D({title:"",description:" ",variant:"destructive"})}finally{x(!1)}},j=w=>{w.preventDefault(),v?C():l?B():h?k():O()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-primary/20 via-green-400/10 to-emerald-500/20 rounded-full blur-2xl animate-pulse"})}),e.jsxs("div",{className:"relative z-10 space-y-3",children:[e.jsx("h1",{className:"text-5xl font-black bg-gradient-to-r from-primary via-green-600 to-emerald-600 bg-clip-text text-transparent animate-fade-in",children:""}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-primary to-emerald-500 mx-auto rounded-full"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xl font-semibold text-foreground/90",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:""})]})]}),v?e.jsxs(A,{className:"border-2 border-blue-200 shadow-xl bg-white/95 backdrop-blur-sm animate-scale-in",children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-center",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(Ss,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent",children:""})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:""})]})})}),e.jsx(R,{children:e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"new-password",children:""}),e.jsx(ae,{id:"new-password",type:"password",placeholder:" ( 6 )",value:g,onChange:w=>p(w.target.value),required:!0,minLength:6,className:"border-2 border-blue-300 focus:border-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"confirm-password",children:""}),e.jsx(ae,{id:"confirm-password",type:"password",placeholder:"",value:y,onChange:w=>N(w.target.value),required:!0,minLength:6,className:"border-2 border-blue-300 focus:border-blue-500"})]}),e.jsxs(I,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-500/90 hover:to-purple-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):null,""]}),e.jsx("div",{className:"text-center",children:e.jsx(I,{type:"button",variant:"link",onClick:()=>{b(!1),T.current=!1,_("/auth",{replace:!0})},className:"text-sm text-muted-foreground hover:text-foreground font-medium",children:""})})]})})]}):e.jsxs(A,{className:"border-2 border-green-200 shadow-xl bg-white/95 backdrop-blur-sm animate-scale-in",children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-center",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx(Ss,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-emerald-600 bg-clip-text text-transparent",children:""})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:""})]})})}),e.jsx(R,{children:l?e.jsxs("div",{className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"reset-email",children:""}),e.jsx(ae,{id:"reset-email",type:"email",placeholder:"example@email.com",value:r,onChange:w=>i(w.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(I,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-500/90 hover:to-purple-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):null,""]}),e.jsx("div",{className:"text-center",children:e.jsx(I,{type:"button",variant:"link",onClick:()=>u(!1),className:"text-sm text-muted-foreground hover:text-foreground font-medium",children:""})})]})]}):e.jsxs(mt,{value:h?"signup":"signin",onValueChange:w=>f(w==="signup"),children:[e.jsxs(qe,{className:"grid w-full grid-cols-2 bg-green-50 p-1 rounded-xl border border-green-200",children:[e.jsxs(te,{value:"signin",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-green-200 rounded-lg font-semibold transition-all duration-300",children:[e.jsx(Ss,{className:"h-4 w-4"}),""]}),e.jsxs(te,{value:"signup",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-green-200 rounded-lg font-semibold transition-all duration-300",children:[e.jsx(ct,{className:"h-4 w-4"}),""]})]}),e.jsxs(ne,{value:"signin",className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"email",children:""}),e.jsx(ae,{id:"email",type:"email",placeholder:"example@email.com",value:r,onChange:w=>i(w.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"password",children:""}),e.jsx(ae,{id:"password",type:"password",placeholder:"",value:o,onChange:w=>c(w.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(I,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-primary to-emerald-500 hover:from-primary/90 hover:to-emerald-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(Ss,{className:"h-5 w-5 mr-3"}),""]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(I,{type:"button",variant:"link",onClick:()=>u(!0),className:"text-sm text-primary hover:text-primary/80 font-medium",children:"?"})})]})]}),e.jsxs(ne,{value:"signup",className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-email",children:""}),e.jsx(ae,{id:"signup-email",type:"email",placeholder:"example@email.com",value:r,onChange:w=>i(w.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-password",children:""}),e.jsx(ae,{id:"signup-password",type:"password",placeholder:" ( 6 )",value:o,onChange:w=>c(w.target.value),required:!0,minLength:6,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(I,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-500/90 hover:to-green-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(ct,{className:"h-5 w-5 mr-3"}),""]})]})]})]})})]}),!v&&e.jsx("div",{className:"text-center",children:e.jsxs(I,{variant:"outline",onClick:()=>_("/"),className:"flex items-center gap-2 border-2 border-green-200 hover:bg-green-50 hover:border-primary transition-all duration-300 font-medium",children:[e.jsx(Lr,{className:"h-4 w-4"}),""]})})]})})},sg=()=>{const[t,s]=m.useState(!1),a=Rt(),n=()=>{s(!0),setTimeout(()=>{a("/admin")},500)},r=()=>{s(!0),setTimeout(()=>{a("/auth")},500)},i=()=>{s(!0),setTimeout(()=>{a("/patient-portal")},500)};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',background:"hsl(210, 40%, 98%)"},children:e.jsxs("div",{style:{textAlign:"center",color:"hsl(210, 25%, 15%)",maxWidth:"500px",padding:"40px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",background:"hsl(170, 50%, 45%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 30px",fontSize:"50px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:""}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"32px",fontWeight:"700",color:"hsl(170, 50%, 45%)"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 40px 0",fontSize:"24px",color:"hsl(210, 25%, 15%)",fontWeight:"600"},children:""}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginBottom:"30px"},children:[e.jsx("button",{onClick:n,disabled:t,style:{padding:"15px 30px",background:"hsl(170, 50%, 45%)",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",transition:"all 0.2s"},children:t?"...":" "}),e.jsx("button",{onClick:r,disabled:t,style:{padding:"15px 30px",background:"white",color:"hsl(170, 50%, 45%)",border:"2px solid hsl(170, 50%, 45%)",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,transition:"all 0.2s"},children:t?"...":" "}),e.jsx("button",{onClick:i,disabled:t,style:{padding:"15px 30px",background:"white",color:"hsl(170, 50%, 45%)",border:"2px solid hsl(170, 50%, 45%)",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,transition:"all 0.2s"},children:t?"...":" "})]}),e.jsxs("div",{style:{padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"hsl(170, 50%, 45%)",fontSize:"18px"},children:" "}),e.jsxs("p",{style:{margin:"0",fontSize:"14px",color:"hsl(210, 25%, 40%)",lineHeight:"1.5"},children:["",e.jsx("br",{}),""]})]}),e.jsx("p",{style:{margin:"0",opacity:"0.5",fontSize:"13px"},children:"VCHome Hospital Management System v1.0.0"})]})})},ag=()=>{const[t,s]=m.useState(0),[a,n]=m.useState("..."),r=Rt();return m.useEffect(()=>{const i=[{progress:20,status:"...",delay:300},{progress:40,status:"...",delay:500},{progress:60,status:"...",delay:700},{progress:80,status:"...",delay:900},{progress:100,status:"!",delay:1200}];let o=0;const c=setInterval(()=>{if(o<i.length){const d=i[o];s(d.progress),n(d.status),o++}else clearInterval(c),setTimeout(()=>{r("/auth")},500)},400);return()=>clearInterval(c)},[r]),e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',background:"hsl(210, 40%, 98%)"},children:e.jsxs("div",{style:{textAlign:"center",color:"hsl(210, 25%, 15%)",maxWidth:"400px",padding:"40px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"hsl(170, 50%, 45%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 30px",fontSize:"40px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:""}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"28px",fontWeight:"700",color:"hsl(170, 50%, 45%)"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 30px 0",fontSize:"20px",color:"hsl(210, 25%, 15%)",fontWeight:"600"},children:""}),e.jsx("div",{style:{width:"100%",height:"8px",background:"hsl(170, 50%, 45%, 0.2)",borderRadius:"4px",overflow:"hidden",marginBottom:"20px"},children:e.jsx("div",{style:{width:`${t}%`,height:"100%",background:"hsl(170, 50%, 45%)",borderRadius:"4px",transition:"width 0.3s ease-out"}})}),e.jsx("p",{style:{margin:"0 0 10px 0",opacity:"0.7",fontSize:"16px"},children:a}),e.jsxs("p",{style:{margin:"0",opacity:"0.5",fontSize:"14px"},children:[t,"%"]}),e.jsx("div",{style:{marginTop:"40px",padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:e.jsxs("p",{style:{margin:"0",fontSize:"14px",color:"hsl(210, 25%, 40%)",lineHeight:"1.5"},children:["",e.jsx("br",{}),""]})})]})})},ng=()=>{const[t,s]=m.useState(!0),[a,n]=m.useState(0),r=Rt();m.useEffect(()=>{const o=setInterval(()=>{n(c=>c>=100?(clearInterval(o),s(!1),100):c+20)},200);return()=>clearInterval(o)},[]);const i=o=>{r(o)};return t?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)"},children:e.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.1)",maxWidth:"400px",width:"90%"},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",fontSize:"40px"},children:""}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"24px",fontWeight:"700",color:"#0ea5e9"},children:"VCHome Hospital"}),e.jsx("p",{style:{margin:"0 0 30px 0",color:"#64748b",fontSize:"16px"},children:""}),e.jsx("div",{style:{width:"100%",height:"8px",background:"#e2e8f0",borderRadius:"4px",overflow:"hidden",marginBottom:"15px"},children:e.jsx("div",{style:{width:`${a}%`,height:"100%",background:"linear-gradient(90deg, #0ea5e9 0%, #06b6d4 100%)",transition:"width 0.2s ease"}})}),e.jsxs("p",{style:{margin:"0",color:"#0ea5e9",fontSize:"18px",fontWeight:"600"},children:[a,"%"]})]})}):e.jsx("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",padding:"40px 20px"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",background:"linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",fontSize:"50px",boxShadow:"0 10px 30px rgba(0,0,0,0.1)"},children:""}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"36px",fontWeight:"700",color:"#0ea5e9"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 20px 0",fontSize:"20px",color:"#64748b",fontWeight:"500"},children:""}),e.jsx("p",{style:{margin:"0 auto",fontSize:"16px",color:"#64748b",maxWidth:"500px"},children:""})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"20px",marginBottom:"40px"},children:[e.jsxs("div",{onClick:()=>i("/admin"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:o=>{o.currentTarget.style.transform="translateY(-2px)",o.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:""}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#0ea5e9"},children:""}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:""})]}),e.jsxs("div",{onClick:()=>i("/staff-portal"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:o=>{o.currentTarget.style.transform="translateY(-2px)",o.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:""}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#10b981"},children:""}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:""})]}),e.jsxs("div",{onClick:()=>i("/patient-portal"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:o=>{o.currentTarget.style.transform="translateY(-2px)",o.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:""}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#8b5cf6"},children:""}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:""})]}),e.jsxs("div",{onClick:()=>i("/line-bot"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:o=>{o.currentTarget.style.transform="translateY(-2px)",o.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:""}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#f59e0b"},children:"LINE Bot"}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:""})]})]}),e.jsx("div",{style:{textAlign:"center",padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px"},children:"VCHome Hospital Management System v1.0.0"})})]})})},rg=()=>{const t="your-liff-id",[s,a]=m.useState({fullName:"",phone:""}),[n,r]=m.useState(!1),[i,o]=m.useState(!1),[c,d]=m.useState(!1),[x,h]=m.useState(!1),[f,l]=m.useState(null),[u,v]=m.useState(null),{toast:b}=xe();m.useEffect(()=>{(async()=>{try{if(typeof window<"u"&&window.liff)if(console.log("LIFF SDK found, initializing..."),await window.liff.init({liffId:t}),d(!0),h(window.liff.isInClient()),window.liff.isLoggedIn())try{const T=await window.liff.getProfile();l(T),a(O=>({...O,lineUserId:T.userId,lineDisplayName:T.displayName,linePictureUrl:T.pictureUrl,fullName:T.displayName||O.fullName})),console.log("LIFF Profile loaded:",T),b({title:" LINE ",description:` ${T.displayName}`})}catch(T){console.error("Error getting LIFF profile:",T),v(" LINE ")}else console.log("User not logged in to LINE"),window.liff.isInClient()&&window.liff.login();else console.log("LIFF SDK not found, loading..."),await g()}catch(T){console.error("LIFF initialization failed:",T),v(`LIFF : ${T}`)}})()},[t,b]);const g=()=>new Promise((D,T)=>{const O=document.createElement("script");O.src="https://static.line-scdn.net/liff/edge/2/sdk.js",O.onload=async()=>{try{if(await window.liff.init({liffId:t}),d(!0),h(window.liff.isInClient()),window.liff.isLoggedIn()){const k=await window.liff.getProfile();l(k),a(B=>({...B,lineUserId:k.userId,lineDisplayName:k.displayName,linePictureUrl:k.pictureUrl,fullName:k.displayName||B.fullName}))}D()}catch(k){T(k)}},O.onerror=T,document.head.appendChild(O)}),p=(D,T)=>{a(O=>({...O,[D]:T}))},y=async()=>{if(!s.fullName||!s.phone){b({title:"",description:"",variant:"destructive"});return}if(!/^[0-9]{9,10}$/.test(s.phone.replace(/[-\s]/g,""))){b({title:"",description:"",variant:"destructive"});return}r(!0);try{const T=`HOM-${Date.now().toString().slice(-6)}`,O=new Date(Date.now()+24*60*60*1e3).toISOString().split("T")[0],{data:k,error:B}=await $.from("appointments").insert({appointment_id:T,patient_name:s.fullName,patient_phone:s.phone,patient_id_number:s.lineUserId,vaccine_type:"general_service",appointment_date:O,appointment_time:"09:00",status:"scheduled",scheduled_by:"patient_liff",line_user_id:s.lineUserId,notes:` LINE LIFF - ${s.lineDisplayName}`}).select().single();if(B)throw B;if(o(!0),b({title:"",description:` (ID: ${T})`}),s.lineUserId)try{await $.functions.invoke("send-line-message",{body:{userId:s.lineUserId,message:` 

 :
 : ${s.fullName}
 : ${s.phone}
 : ${O}
 : ${T}

 
`,type:"template",templateData:{appointmentId:T,patientName:s.fullName,appointmentDate:O}}})}catch(C){console.error("Error sending LINE message:",C)}if(x&&window.liff)try{await window.liff.sendMessages([{type:"text",text:` 

: ${s.fullName}
: ${s.phone}
: ${T}


`}])}catch(C){console.error("Error sending LINE chat message:",C)}setTimeout(()=>{x&&window.liff&&window.liff.closeWindow()},8e3)}catch(T){console.error("Registration error:",T),b({title:"",description:`: ${T}`,variant:"destructive"})}finally{r(!1)}},N=()=>{a({fullName:(f==null?void 0:f.displayName)||"",phone:"",lineUserId:f==null?void 0:f.userId,lineDisplayName:f==null?void 0:f.displayName,linePictureUrl:f==null?void 0:f.pictureUrl}),o(!1)},_=()=>{window.liff&&window.liff.isInClient()&&window.liff.closeWindow()};return i?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx(A,{className:"border-green-200 bg-green-50",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx(ee,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"!"}),e.jsxs("p",{className:"text-green-700 mb-6",children:[" ",x&&e.jsx("span",{className:"block mt-2 text-sm font-medium",children:"  8 "})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold mb-2",children:":"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",s.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," "]}),s.lineUserId&&e.jsxs("p",{children:[e.jsx("strong",{children:"LINE ID:"})," ",s.lineUserId]})]})]}),e.jsxs("div",{className:"space-y-2",children:[!x&&e.jsx(I,{onClick:N,variant:"outline",className:"w-full",children:""}),x&&e.jsx(I,{onClick:_,className:"w-full",children:""})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:""}),e.jsx("h2",{className:"text-xl text-muted-foreground mt-2 font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:""})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5"})," LINE App"]})}),e.jsx(R,{children:u?e.jsxs(le,{variant:"destructive",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx(me,{children:u})]}):e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"LIFF :"}),e.jsx("span",{className:c?"text-green-600":"text-red-600",children:c?" ":" "})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:" LINE App:"}),e.jsx("span",{className:x?"text-green-600":"text-yellow-600",children:x?" ":" "})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:":"}),e.jsx("span",{className:f?"text-green-600":"text-yellow-600",children:f?" ":" "})]})]})})]}),f&&e.jsx(A,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[f.pictureUrl&&e.jsx("img",{src:f.pictureUrl,alt:"LINE Profile",className:"w-12 h-12 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:f.displayName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LINE"})]})]})})}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),""]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"fullName",children:"-"}),e.jsx(ae,{id:"fullName",placeholder:"//  ",value:s.fullName,onChange:D=>p("fullName",D.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"phone",children:""}),e.jsx(ae,{id:"phone",placeholder:"08x-xxx-xxxx",value:s.phone,onChange:D=>p("phone",D.target.value),className:"mt-1"})]})]})]}),e.jsx(I,{onClick:y,disabled:n,className:"w-full",size:"lg",children:n?"...":""}),e.jsx(le,{children:e.jsxs(me,{children:["  ",x&&"  LINE "]})})]})})},ig=()=>e.jsx(rg,{}),og=()=>{const[t,s]=m.useState([]),[a,n]=m.useState([]),[r,i]=m.useState(""),[o,c]=m.useState(null),[d,x]=m.useState(!1),[h,f]=m.useState(!0),[l,u]=m.useState(null),{toast:v}=xe();m.useEffect(()=>{b()},[]),m.useEffect(()=>{if(!r.trim())n(t);else{const N=t.filter(_=>_.patient_name.toLowerCase().includes(r.toLowerCase())||_.phone_number.includes(r)||_.registration_id.toLowerCase().includes(r.toLowerCase()));n(N)}},[r,t]);const b=async()=>{try{f(!0);const{data:N,error:_}=await $.from("patient_registrations").select("*").order("patient_name",{ascending:!0});if(_)throw _;s(N||[])}catch{v({variant:"destructive",title:"",description:""})}finally{f(!1)}},g=async N=>{x(!0),c(N);try{const T=await fetch("https://fljyjbrgfzervxofrilo.supabase.co/functions/v1/secure-vaccine-status-lookup",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZsanlqYnJnZnplcnZ4b2ZyaWxvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMDE1MDUsImV4cCI6MjA2OTY3NzUwNX0.2_rGfy-3UA4cPnRsg8Lm8uvj9KBCOoz5IhwCbSWYIq4"},body:JSON.stringify({searchType:"phone",searchValue:N.phone})});if(!T.ok){const k=await T.json();throw new Error(k.error||"")}const O=await T.json();u({appointments:O.appointments||[],logs:O.vaccineLogs||[],registrations:O.registrations||[]}),v({title:"",description:` ${N.patient_name} `})}catch(_){console.error("Error:",_),v({variant:"destructive",title:"",description:""})}finally{x(!1)}},p=N=>{const _={completed:{label:"",variant:"default",icon:ee},in_progress:{label:"",variant:"secondary",icon:Ie},scheduled:{label:"",variant:"outline",icon:he},cancelled:{label:"",variant:"destructive",icon:lt}},D=_[N]||_.in_progress,T=D.icon;return e.jsxs(J,{variant:D.variant,className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),D.label]})},y=N=>N?new Date(N).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"-";return e.jsx("div",{className:"container mx-auto p-4 max-w-6xl",children:e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),""]}),e.jsx(ue,{children:""})]}),e.jsx(R,{className:"space-y-6",children:o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-medium",children:[e.jsx(Qe,{className:"h-5 w-5"}),": ",o.patient_name]}),e.jsx(I,{variant:"outline",onClick:()=>{c(null),u(null)},children:""})]}),d?e.jsx("div",{className:"text-center py-8",children:"..."}):l&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{className:"text-lg",children:""})}),e.jsx(R,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"-:"}),e.jsx("span",{className:"ml-2 font-medium",children:o.patient_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-2",children:o.phone_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-2",children:o.hospital})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-2",children:o.registration_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-2",children:y(o.created_at)})]}),o.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"text-sm mt-1",children:o.notes})]})]})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{className:"text-lg",children:""})}),e.jsx(R,{children:l.appointments&&l.appointments.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.appointments.map(N=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:N.vaccine_type}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(he,{className:"h-3 w-3"}),y(N.appointment_date),N.appointment_time&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"h-3 w-3 ml-1"}),N.appointment_time.substring(0,5)]})]})]}),p(N.status)]}),N.notes&&e.jsx("p",{className:"text-sm text-muted-foreground",children:N.notes})]},N.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:""})})]}),e.jsxs(A,{className:"lg:col-span-2",children:[e.jsx(W,{children:e.jsx(z,{className:"text-lg",children:""})}),e.jsx(R,{children:l.logs&&l.logs.length>0?e.jsx("div",{className:"space-y-3",children:l.logs.map(N=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h4",{className:"font-medium",children:N.vaccine_type}),e.jsxs(J,{variant:"outline",children:[" ",N.dose_number]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:y(N.administered_date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:N.administered_by})]}),N.batch_number&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Batch:"}),e.jsx("p",{className:"font-medium",children:N.batch_number})]}),N.side_effects&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("p",{className:"font-medium",children:N.side_effects})]})]}),N.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:":"}),e.jsx("p",{className:"text-sm mt-1",children:N.notes})]})]},N.id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"  ",value:r,onChange:N=>i(N.target.value),className:"pl-10"})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"text-lg",children:[" (",a.length," )"]})}),e.jsx(R,{children:h?e.jsx("div",{className:"text-center py-8",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t.length===0?"":""}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.map(N=>e.jsx("div",{className:"border rounded-lg p-3 hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>g(N),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:N.patient_name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),N.phone_number]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-3 w-3"}),y(N.created_at)]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[": ",N.registration_id]})]}),e.jsx(J,{variant:N.status==="pending"?"secondary":"default",className:"ml-2",children:N.status==="pending"?"":N.status})]})},N.id))})})]})]})})]})})},lg=()=>e.jsx(og,{}),nr=()=>{const[t,s]=m.useState(null),[a,n]=m.useState(!0),[r,i]=m.useState(0),[o,c]=m.useState(!1);m.useEffect(()=>{d()},[]);const d=async()=>{try{const h=await fetch("https://moradok.github.io/VaccineHomeBot/release-info.json");if(h.ok){const f=await h.json();s(f)}else s({version:"1.0.0",downloadUrl:"https://moradok.github.io/VaccineHomeBot/downloads/VCHome-Hospital-Setup.exe",size:"186.8 MB",releaseDate:"9  2025",changelog:["","",""," LINE Bot"," Supabase"]})}catch(h){console.error("Failed to fetch release info:",h),s({version:"1.0.0",downloadUrl:"#",size:"186.8 MB",releaseDate:"9  2025",changelog:[""]})}finally{n(!1)}},x=async()=>{if(t){c(!0),i(0);try{const h=setInterval(()=>{i(l=>l>=100?(clearInterval(h),c(!1),100):l+10)},200),f=document.createElement("a");f.href=t.downloadUrl,f.download=`VCHome-Hospital-Setup-${t.version}.exe`,document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(h){console.error("Download failed:",h),c(!1),i(0)}}};return a?e.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-hero",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(Jo,{className:"mx-auto mb-6",size:120}),e.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-primary bg-clip-text text-transparent",children:" VCHome Hospital"}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:""}),e.jsx("div",{className:"mt-6 max-w-2xl mx-auto",children:e.jsxs("div",{className:"p-4 bg-medical-error/10 border-2 border-medical-error rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(lt,{className:"h-5 w-5 text-medical-error"}),e.jsx("p",{className:"font-bold text-medical-error",children:""})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" Desktop ",e.jsx("br",{}),""]})]})})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs(A,{className:"card-balanced",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx(tc,{className:"h-6 w-6 text-primary"}),"Windows Desktop App"]})}),e.jsx(R,{children:t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[" ",t.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",t.releaseDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:t.size}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:":"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:" Windows 10/11 (64-bit  32-bit)"}),e.jsx("li",{children:" RAM 4GB  ( 8GB)"}),e.jsx("li",{children:"  500MB"}),e.jsx("li",{children:" "})]})]}),e.jsxs("div",{className:"space-y-3",children:[o?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:e.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-300",style:{width:`${r}%`}})}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:["... ",r,"%"]})]}):e.jsxs(I,{onClick:x,className:"w-full btn-primary",size:"lg",children:[e.jsx(We,{className:"mr-2 h-5 w-5"}),""]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:": moradok.github.io/VaccineHomeBot"})]})]})})]}),e.jsxs(A,{className:"card-balanced",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"h-6 w-6 text-medical-success"}),""]})}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:' "" '})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" .exe "})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-medical-success text-white rounded-full flex items-center justify-center text-sm font-bold",children:""}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Start Menu  Desktop"})]})]})]}),e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(lt,{className:"h-4 w-4 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:""}),e.jsx("p",{className:"text-xs text-amber-700",children:'Windows   "More info"  "Run anyway" '})]})]})})]})})]})]}),t&&e.jsxs(A,{className:"card-balanced mt-8",children:[e.jsx(W,{children:e.jsx(z,{children:" "})}),e.jsx(R,{children:e.jsx("ul",{className:"space-y-2",children:t.changelog.map((h,f)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-medical-success"}),e.jsx("span",{children:h})]},f))})})]}),e.jsxs(A,{className:"card-balanced mt-8",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-medical-success"}),": LINE Bot"]})}),e.jsx(R,{children:e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-medical-success"}),e.jsx("h4",{className:"font-semibold",children:"LINE Official Account"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" LINE Bot "}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>window.open("https://line.me/R/ti/p/@vchome","_blank"),children:" LINE"})]})})]}),e.jsxs("div",{className:"text-center mt-8 p-6 bg-card rounded-lg border",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"?"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:" "}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(I,{variant:"outline",onClick:()=>window.open("https://github.com/moradok/VaccineHomeBot/issues","_blank"),children:""}),e.jsx(I,{variant:"outline",onClick:()=>window.open("mailto:support@vchome.hospital","_blank"),children:""})]})]})]})]})})},cg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(Ho,{})})},dg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(Bo,{})})},mg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(Vo,{})})},ug=()=>{const t="your-liff-id",s="https://firstprojecthome.onrender.com/webhook-test/Webhook-Vaccine",[a,n]=m.useState(null),[r,i]=m.useState(!0),[o,c]=m.useState(null),{toast:d}=xe();m.useEffect(()=>{x()},[]);const x=async()=>{i(!0),c(null);try{window.liff||await h(),await window.liff.init({liffId:t});const p={ready:!0,inClient:window.liff.isInClient(),loggedIn:window.liff.isLoggedIn(),profile:null,context:null,version:window.liff.getVersion(),isApiAvailable:{shareTargetPicker:window.liff.isApiAvailable("shareTargetPicker"),multipleLiffTransition:window.liff.isApiAvailable("multipleLiffTransition"),subwindowOpen:window.liff.isApiAvailable("subwindowOpen"),scanCode:window.liff.isApiAvailable("scanCode"),sendMessages:window.liff.isApiAvailable("sendMessages"),permanentLink:window.liff.isApiAvailable("permanentLink")}};if(window.liff.isLoggedIn()){try{p.profile=await window.liff.getProfile()}catch(y){console.error("Error getting profile:",y)}if(window.liff.isInClient())try{p.context=await window.liff.getContext()}catch(y){console.error("Error getting context:",y)}}n(p),console.log("LIFF Info:",p)}catch(p){console.error("LIFF initialization failed:",p),c(`LIFF Initialization Error: ${p}`)}finally{i(!1)}},h=()=>new Promise((p,y)=>{const N=document.createElement("script");N.src="https://static.line-scdn.net/liff/edge/2/sdk.js",N.onload=()=>p(),N.onerror=y,document.head.appendChild(N)}),f=async()=>{try{window.liff&&window.liff.login()}catch(p){d({title:"Login Error",description:`Failed to login: ${p}`,variant:"destructive"})}},l=async()=>{try{window.liff&&(window.liff.logout(),window.location.reload())}catch(p){d({title:"Logout Error",description:`Failed to logout: ${p}`,variant:"destructive"})}},u=async()=>{try{window.liff&&window.liff.isInClient()?(await window.liff.sendMessages([{type:"text",text:` LIFF Test Message

Time: ${new Date().toLocaleString()}
LIFF ID: ${t}
Webhook: ${s}`}]),d({title:"Message Sent",description:"Test message sent to LINE chat"})):d({title:"Cannot Send Message",description:"Messages can only be sent from within LINE app",variant:"destructive"})}catch(p){d({title:"Message Error",description:`Failed to send message: ${p}`,variant:"destructive"})}},v=async()=>{try{const p={type:"liff_check",data:{liffId:t,timestamp:new Date().toISOString(),source:"liff_checker"}},y=await fetch("/functions/v1/secure-patient-webhook",{method:"POST",headers:{"Content-Type":"application/json","x-webhook-secret":"secure-liff-check"},body:JSON.stringify(p)});if(y.ok)d({title:"Webhook Test Success",description:"Successfully sent data via secure proxy"});else throw new Error(`HTTP ${y.status}: ${y.statusText}`)}catch(p){d({title:"Webhook Test Failed",description:`Failed to connect to secure webhook: ${p}`,variant:"destructive"})}},b=(p,y)=>{navigator.clipboard.writeText(p),d({title:"Copied",description:`${y} copied to clipboard`})},g=()=>{window.liff&&window.liff.isInClient()&&window.liff.closeWindow()};return r?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Initializing LIFF..."})]})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"LIFF Checker"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:" LINE Front-end Framework"})]}),o&&e.jsxs(le,{variant:"destructive",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsx(me,{children:o})]}),a&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5"}),"LIFF Status"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.ready?e.jsx(ee,{className:"h-4 w-4 text-green-600"}):e.jsx(Te,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{children:"LIFF Ready"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.inClient?e.jsx(ee,{className:"h-4 w-4 text-green-600"}):e.jsx(Te,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{children:"In LINE App"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.loggedIn?e.jsx(ee,{className:"h-4 w-4 text-green-600"}):e.jsx(Te,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{children:"Logged In"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ir,{className:"h-4 w-4"}),e.jsxs("span",{children:["Version: ",a.version]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:x,variant:"outline",size:"sm",children:"Refresh"}),!a.loggedIn&&e.jsx(I,{onClick:f,size:"sm",children:"Login"}),a.loggedIn&&e.jsx(I,{onClick:l,variant:"destructive",size:"sm",children:"Logout"})]})]})]}),(a==null?void 0:a.profile)&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"LINE Profile"]})}),e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.profile.pictureUrl&&e.jsx("img",{src:a.profile.pictureUrl,alt:"Profile",className:"w-16 h-16 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.profile.displayName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.profile.userId,e.jsx(I,{variant:"ghost",size:"sm",className:"ml-2 h-6 w-6 p-0",onClick:()=>b(a.profile.userId,"User ID"),children:e.jsx(Ue,{className:"h-3 w-3"})})]}),a.profile.statusMessage&&e.jsx("p",{className:"text-sm",children:a.profile.statusMessage})]})]})})]}),(a==null?void 0:a.context)&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:"Context Information"})}),e.jsx(R,{children:e.jsx("pre",{className:"text-xs bg-muted p-3 rounded overflow-auto",children:JSON.stringify(a.context,null,2)})})]}),a&&e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:"API Availability"})}),e.jsx(R,{children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(a.isApiAvailable).map(([p,y])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{variant:y?"default":"secondary",children:y?"":""}),e.jsx("span",{className:"text-sm",children:p})]},p))})})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),"Test Actions"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsx(I,{onClick:u,disabled:!(a!=null&&a.inClient)||!(a!=null&&a.loggedIn),className:"w-full",children:"Send Test Message to LINE"}),e.jsx(I,{onClick:v,variant:"outline",className:"w-full",children:"Test Webhook Connection"}),(a==null?void 0:a.inClient)&&e.jsx(I,{onClick:g,variant:"secondary",className:"w-full",children:"Close LIFF Window"})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:"Configuration"})}),e.jsxs(R,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"LIFF ID:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:t}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>b(t,"LIFF ID"),children:e.jsx(Ue,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Webhook URL:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded max-w-xs truncate",children:s}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>b(s,"Webhook URL"),children:e.jsx(Ue,{className:"h-3 w-3"})})]})]})]})]})]})})},hg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:" LIFF",children:e.jsx(ug,{})})},xg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(Yo,{})})},pg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(eo,{})})};function fg(){const[t,s]=m.useState([]),[a,n]=m.useState(!1),{toast:r}=xe(),i=async()=>{n(!0);try{console.log(" ...");const{data:c,error:d}=await $.from("vaccine_schedules").select("*").eq("active",!0);if(d)throw d;console.log(" :",c==null?void 0:c.length);const{data:x,error:h}=await $.from("appointments").select("*").order("appointment_date",{ascending:!0});if(h)throw h;const f=(x==null?void 0:x.filter(b=>b.status==="completed"))||[],l=(x==null?void 0:x.filter(b=>["scheduled","pending"].includes(b.status)&&new Date(b.appointment_date)>=new Date))||[];console.log(" :",f.length),console.log(" :",l.length);const u=new Map;for(const b of f){const g=b.patient_id_number||b.line_user_id,p=`${g}-${b.vaccine_type}`;if(!u.has(p)){const y=f.filter(N=>(N.patient_id_number||N.line_user_id)===g&&N.vaccine_type===b.vaccine_type).sort((N,_)=>new Date(N.appointment_date).getTime()-new Date(_.appointment_date).getTime());u.set(p,{patient_name:b.patient_name,patient_id:g,vaccine_type:b.vaccine_type,all_doses:y})}}const v=[];for(const[b,g]of u){const p=c==null?void 0:c.find(k=>k.vaccine_type.toLowerCase()===g.vaccine_type.toLowerCase());if(!p)continue;const y=Array.isArray(p.dose_intervals)?p.dose_intervals:JSON.parse(p.dose_intervals),N=new Date(g.all_doses[0].appointment_date),_=[];for(let k=0;k<g.all_doses.length;k++){let B;if(k===0)B=N;else{let U=0;for(let H=0;H<k;H++)U+=y[H]||0;B=new Date(N),B.setDate(B.getDate()+U)}const C=new Date(g.all_doses[k].appointment_date),j=B.toISOString().split("T")[0],w=g.all_doses[k].appointment_date,M=Math.round((C.getTime()-B.getTime())/(1e3*60*60*24)),F=w===j;_.push({date:w,calculated_date:j,matches:F,days_diff:M})}let D=null,T=null,O=!1;if(g.all_doses.length<p.total_doses){let k=0;for(let j=0;j<g.all_doses.length;j++)k+=y[j]||0;const B=new Date(N);B.setDate(B.getDate()+k),D=B.toISOString().split("T")[0];const C=l.find(j=>(j.patient_id_number||j.line_user_id)===g.patient_id&&j.vaccine_type===g.vaccine_type);C&&(T=C.appointment_date,O=T===D)}v.push({patient_name:g.patient_name,patient_id:g.patient_id,vaccine_type:g.vaccine_type,vaccine_name:p.vaccine_name,doses_received:g.all_doses.length,total_doses:p.total_doses,first_dose_date:g.all_doses[0].appointment_date,all_doses:_,next_dose_calculated:D,next_dose_in_system:T,next_dose_matches:O,is_completed:g.all_doses.length>=p.total_doses})}s(v),r({title:"",description:` ${v.length} `})}catch(c){console.error("Error verifying appointments:",c),r({title:"",description:"",variant:"destructive"})}finally{n(!1)}};m.useEffect(()=>{i()},[]);const o=t.every(c=>c.all_doses.every(d=>d.matches)&&(c.is_completed||c.next_dose_matches||c.next_dose_in_system===null));return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" vaccine_schedules"})]}),e.jsxs(I,{onClick:i,disabled:a,children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),""]})]}),t.length>0&&e.jsx(le,{className:o?"border-green-200 bg-green-50":"border-yellow-200 bg-yellow-50",children:e.jsx(me,{children:e.jsx("div",{className:"flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"  vaccine_schedules"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-5 w-5 text-yellow-600"}),e.jsx("span",{className:"font-medium text-yellow-800",children:" "})]})})})}),e.jsxs("div",{className:"space-y-4",children:[t.map((c,d)=>e.jsxs(A,{children:[e.jsxs(W,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"text-lg",children:[c.patient_name," - ",c.vaccine_name]}),c.is_completed?e.jsx(J,{className:"bg-green-500",children:""}):e.jsxs(J,{className:"bg-blue-500",children:[c.doses_received,"/",c.total_doses," "]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",c.patient_id,"  : ",new Date(c.first_dose_date).toLocaleDateString("th-TH")]})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"space-y-2",children:c.all_doses.map((x,h)=>e.jsxs("div",{className:`p-3 rounded-lg border ${x.matches?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x.matches?e.jsx(ee,{className:"h-4 w-4 text-green-600"}):e.jsx(Te,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{className:"font-medium",children:[" ",h+1]})]}),e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:x.matches?"text-green-700":"text-yellow-700",children:x.matches?" ":`  ${x.days_diff>0?"+":""}${x.days_diff} `})})]}),e.jsxs("div",{className:"mt-2 text-sm grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"})," ",new Date(x.date).toLocaleDateString("th-TH")]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"})," ",new Date(x.calculated_date).toLocaleDateString("th-TH")]})]})]},h))})]}),!c.is_completed&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"})," ( ",c.doses_received+1,")"]}),e.jsx("div",{className:`p-3 rounded-lg border ${c.next_dose_in_system?c.next_dose_matches?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200":"bg-orange-50 border-orange-200"}`,children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:" vaccine_schedules:"})," ",e.jsx("span",{className:"font-medium",children:c.next_dose_calculated?new Date(c.next_dose_calculated).toLocaleDateString("th-TH"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"})," ",e.jsx("span",{className:"font-medium",children:c.next_dose_in_system?new Date(c.next_dose_in_system).toLocaleDateString("th-TH"):""})]}),c.next_dose_in_system&&!c.next_dose_matches&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("span",{className:"text-yellow-700 font-medium",children:["   ",new Date(c.next_dose_calculated).toLocaleDateString("th-TH")]})}),!c.next_dose_in_system&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("span",{className:"text-orange-700 font-medium",children:["  ",new Date(c.next_dose_calculated).toLocaleDateString("th-TH")]})})]})})]})]})]},d)),t.length===0&&!a&&e.jsx(A,{children:e.jsxs(R,{className:"py-12 text-center text-muted-foreground",children:[e.jsx(he,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:""})]})})]})]})}const gg=()=>e.jsx(fg,{});function vg(){const[t,s]=m.useState(""),[a,n]=m.useState("  VCHome Hospital"),[r,i]=m.useState(!1),[o,c]=m.useState(!1),[d,x]=m.useState({}),{toast:h}=xe(),f=g=>/^U[0-9a-f]{32}$/i.test(g),l=async()=>{i(!0);const g={};try{console.log("  Authentication...");const{data:{session:p},error:y}=await $.auth.getSession();if(y||!p)g.auth={status:"error",message:"",details:(y==null?void 0:y.message)||" session"};else{g.auth={status:"success",message:"",details:`User ID: ${p.user.id}`},console.log("  Healthcare Staff...");try{const{data:N,error:_}=await $.rpc("is_healthcare_staff",{_user_id:p.user.id});_?g.role={status:"error",message:"",details:_.message}:N?g.role={status:"success",message:" Healthcare Staff",details:""}:g.role={status:"error",message:" Healthcare Staff",details:" healthcare staff "}}catch(N){g.role={status:"error",message:"",details:N.message}}}console.log("  LINE User ID Format..."),t?f(t)?g.userId={status:"success",message:"LINE User ID ",details:`Format: ${t.substring(0,8)}...${t.substring(t.length-4)}`}:g.userId={status:"error",message:"LINE User ID ",details:" U  hex 32  ( U1234567890abcdef1234567890abcdef)"}:g.userId={status:"warning",message:" LINE User ID",details:" LINE User ID "},console.log("  LINE Channel...");try{const{error:N}=await $.functions.invoke("send-line-message",{body:{userId:"U00000000000000000000000000000000",message:"test"}});N?N.message.includes("LINE Channel Access Token not configured")?g.config={status:"error",message:"LINE Channel Access Token ",details:" LINE_CHANNEL_ACCESS_TOKEN  Supabase Edge Function secrets"}:N.message.includes("Invalid LINE userId")?g.config={status:"success",message:"LINE Channel ",details:""}:N.message.includes("Access denied")?g.config={status:"warning",message:"",details:" healthcare staff"}:g.config={status:"warning",message:"",details:N.message}:g.config={status:"success",message:"LINE Channel ",details:""}}catch(N){g.config={status:"error",message:"",details:N.message}}x(g)}catch(p){console.error("Error in diagnostics:",p),h({title:"",description:p.message||"",variant:"destructive"})}finally{i(!1)}},u=async()=>{if(!t||!f(t)){h({title:"",description:" LINE User ID ",variant:"destructive"});return}if(!a||a.length===0){h({title:"",description:"",variant:"destructive"});return}c(!0);const g={...d};try{console.log(" ...");const{data:p,error:y}=await $.functions.invoke("send-line-message",{body:{userId:t,message:a}});console.log("Response:",p,y),y?(g.send={status:"error",message:"",details:y.message},h({title:"",description:y.message,variant:"destructive"})):(g.send={status:"success",message:"",details:" LINE "},h({title:"",description:` ${t} `})),x(g)}catch(p){console.error("Error sending message:",p),g.send={status:"error",message:"",details:p.message},x(g),h({title:"",description:p.message||"",variant:"destructive"})}finally{c(!1)}},v=g=>{switch(g){case"success":return e.jsx(ee,{className:"h-5 w-5 text-green-600"});case"error":return e.jsx(Te,{className:"h-5 w-5 text-red-600"});case"warning":return e.jsx(Ye,{className:"h-5 w-5 text-yellow-600"});default:return null}},b=g=>{switch(g){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"warning":return"border-yellow-200 bg-yellow-50";default:return"border-gray-200"}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:" LINE Notification Debugger"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LINE"})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),""]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsx(I,{onClick:l,disabled:r,className:"w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),""]})}),Object.keys(d).length>0&&e.jsxs("div",{className:"space-y-3",children:[d.auth&&e.jsx(le,{className:b(d.auth.status),children:e.jsxs("div",{className:"flex items-start gap-3",children:[v(d.auth.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:d.auth.message})]}),d.auth.details&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.auth.details})]})]})}),d.role&&e.jsx(le,{className:b(d.role.status),children:e.jsxs("div",{className:"flex items-start gap-3",children:[v(d.role.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:d.role.message})]}),d.role.details&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.role.details})]})]})}),d.userId&&e.jsx(le,{className:b(d.userId.status),children:e.jsxs("div",{className:"flex items-start gap-3",children:[v(d.userId.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:d.userId.message})]}),d.userId.details&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.userId.details})]})]})}),d.config&&e.jsx(le,{className:b(d.config.status),children:e.jsxs("div",{className:"flex items-start gap-3",children:[v(d.config.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(sc,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:d.config.message})]}),d.config.details&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.config.details})]})]})}),d.send&&e.jsx(le,{className:b(d.send.status),children:e.jsxs("div",{className:"flex items-start gap-3",children:[v(d.send.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ot,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:d.send.message})]}),d.send.details&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.send.details})]})]})})]})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-5 w-5"}),""]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"test-user-id",children:"LINE User ID"}),e.jsx(ae,{id:"test-user-id",value:t,onChange:g=>s(g.target.value),placeholder:"U1234567890abcdef1234567890abcdef",className:"font-mono"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": U  hex 32  ( 33 )"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"test-message",children:""}),e.jsx(Ot,{id:"test-message",value:a,onChange:g=>n(g.target.value),placeholder:"...",rows:4}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",a.length,"/2000 "]})]}),e.jsx(I,{onClick:u,disabled:o||!t||!a,className:"w-full",children:o?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Tt,{className:"h-4 w-4 mr-2"}),""]})})]})]}),e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:" "})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"1. LINE User ID "}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["- LINE User ID  ",e.jsx("code",{className:"bg-gray-100 px-1",children:"U"}),"  hex 32 ",e.jsx("br",{}),"-  LINE Developer Console  webhook events"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"2.  Healthcare Staff"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["-  Admin ",e.jsx("br",{}),"-  /manage-staff"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"3. LINE Channel Access Token "}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["-  Supabase Dashboard  Edge Functions  Secrets",e.jsx("br",{}),"-  secret: ",e.jsx("code",{className:"bg-gray-100 px-1",children:"LINE_CHANNEL_ACCESS_TOKEN"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"4. Session "}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["- ",e.jsx("br",{}),"-  JWT token "]})]})]})]})]})}const bg=()=>e.jsx(vg,{});function jg(){const[t,s]=m.useState([]),[a,n]=m.useState(!1),[r,i]=m.useState(!1),{toast:o}=xe(),c=async()=>{var u;n(!0);try{console.log(" ...");const{data:v,error:b}=await $.from("vaccine_schedules").select("*").eq("active",!0);if(b)throw b;const{data:g,error:p}=await $.from("appointments").select("*").order("appointment_date",{ascending:!0});if(p)throw p;const y=(g==null?void 0:g.filter(T=>T.status==="completed"))||[],N=(g==null?void 0:g.filter(T=>["scheduled","pending"].includes(T.status)&&new Date(T.appointment_date)>=new Date))||[];console.log(" :",y.length),console.log(" :",N.length);const _=new Map;for(const T of y){const O=T.patient_id_number||T.line_user_id,k=`${O}-${T.vaccine_type}`;if(!_.has(k)){const B=y.filter(C=>(C.patient_id_number||C.line_user_id)===O&&C.vaccine_type===T.vaccine_type).sort((C,j)=>new Date(C.appointment_date).getTime()-new Date(j.appointment_date).getTime());_.set(k,{patient_name:T.patient_name,patient_id:O,vaccine_type:T.vaccine_type,all_doses:B})}}const D=[];for(const[T,O]of _){const k=v==null?void 0:v.find(P=>P.vaccine_type.toLowerCase()===O.vaccine_type.toLowerCase());if(!k)continue;const B=Array.isArray(k.dose_intervals)?k.dose_intervals:JSON.parse(((u=k.dose_intervals)==null?void 0:u.toString())||"[]"),C=O.all_doses[0].appointment_date,j=O.all_doses.length;if(j>=k.total_doses)continue;const w=N.find(P=>(P.patient_id_number||P.line_user_id)===O.patient_id&&P.vaccine_type.toLowerCase()===O.vaccine_type.toLowerCase());if(!w)continue;let M=0;for(let P=0;P<j;P++)M+=B[P]||0;const F=new Date(C),U=new Date(F);U.setDate(U.getDate()+M);const H=U.toISOString().split("T")[0];if(w.appointment_date!==H){const P=new Date(w.appointment_date),L=Math.round((P.getTime()-U.getTime())/(1e3*60*60*24));D.push({appointment_id:w.id,patient_name:O.patient_name,patient_id:O.patient_id,vaccine_type:O.vaccine_type,vaccine_name:k.vaccine_name,current_date:w.appointment_date,calculated_date:H,days_diff:L,dose_number:j+1,total_doses:k.total_doses,first_dose_date:C,selected:!0}),console.log(` : ${O.patient_name} - ${O.vaccine_type}`),console.log(`   : ${w.appointment_date}`),console.log(`   : ${H}`),console.log(`   : ${L} `)}}s(D),D.length===0?o({title:"",description:" vaccine_schedules "}):o({title:"",description:` ${D.length} `,variant:"destructive"})}catch(v){console.error("Error scanning appointments:",v),o({title:"",description:"",variant:"destructive"})}finally{n(!1)}},d=u=>{s(v=>v.map(b=>b.appointment_id===u?{...b,selected:!b.selected}:b))},x=()=>{const u=t.every(v=>v.selected);s(v=>v.map(b=>({...b,selected:!u})))},h=async()=>{const u=t.filter(v=>v.selected);if(u.length===0){o({title:"",description:"",variant:"destructive"});return}i(!0);try{let v=0,b=0;for(const g of u)try{const{error:p}=await $.from("appointments").update({appointment_date:g.calculated_date,notes:` vaccine_schedules (: ${g.current_date})`}).eq("id",g.appointment_id);if(p)throw p;console.log(` : ${g.patient_name} - ${g.vaccine_type}`),v++}catch(p){console.error(` : ${g.patient_name}`,p),b++}o({title:"",description:`: ${v} , : ${b} `}),await c()}catch(v){console.error("Error fixing appointments:",v),o({title:"",description:"",variant:"destructive"})}finally{i(!1)}},f=u=>new Date(u).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),l=t.filter(u=>u.selected).length;return e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(ac,{className:"h-5 w-5"}),""]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:" vaccine_schedules"})]}),e.jsxs(I,{onClick:c,disabled:a,children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),a?"...":""]})]})}),t.length>0&&e.jsxs(R,{className:"space-y-4",children:[e.jsxs(le,{children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsxs(me,{children:[e.jsxs("strong",{children:[" ",t.length," "]}),e.jsx("br",{}),""]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{checked:t.every(u=>u.selected),onCheckedChange:x}),e.jsxs("span",{className:"text-sm font-medium",children:[" (",l,"/",t.length,")"]})]}),e.jsx(I,{onClick:h,disabled:r||l===0,variant:"default",children:r?"...":` ${l} `})]}),e.jsx("div",{className:"space-y-3",children:t.map(u=>e.jsx(A,{className:"border-2",children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Os,{checked:u.selected,onCheckedChange:()=>d(u.appointment_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:u.patient_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.vaccine_name," -  ",u.dose_number,"/",u.total_doses]})]}),e.jsxs(J,{variant:Math.abs(u.days_diff)>7?"destructive":"secondary",children:[" ",Math.abs(u.days_diff)," "]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-1 text-red-600 mb-1",children:[e.jsx(Te,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:" ()"})]}),e.jsx("p",{className:"font-semibold",children:f(u.current_date)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.current_date})]}),e.jsxs("div",{className:"p-2 bg-green-50 rounded border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-600 mb-1",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:" ()"})]}),e.jsx("p",{className:"font-semibold",children:f(u.calculated_date)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.calculated_date})]}),e.jsxs("div",{className:"p-2 bg-blue-50 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-600 mb-1",children:[e.jsx(he,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:""})]}),e.jsx("p",{className:"font-semibold",children:f(u.first_dose_date)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.first_dose_date})]})]})]})]})})},u.appointment_id))})]}),!a&&t.length===0&&e.jsx(R,{children:e.jsxs(le,{children:[e.jsx(ee,{className:"h-4 w-4 text-green-600"}),e.jsxs(me,{children:[e.jsx("strong",{className:"text-green-800",children:""}),e.jsx("br",{})," vaccine_schedules "]})]})})]})})}const yg=()=>{const[t,s]=m.useState(null);return m.useEffect(()=>{$.auth.getSession().then(({data:{session:n}})=>{s((n==null?void 0:n.user)??null)});const{data:{subscription:a}}=$.auth.onAuthStateChange((n,r)=>{s((r==null?void 0:r.user)??null)});return()=>a.unsubscribe()},[]),e.jsx(Je,{user:t,title:"",children:e.jsx(jg,{})})},rr=new nc,Yt=/electron/i.test(navigator.userAgent)||window.location.protocol==="file:",Xo="./";console.log("[App] User Agent:",navigator.userAgent);console.log("[App] Protocol:",window.location.protocol);console.log("[App] Is Electron:",Yt);console.log("[App] Using",Yt?"HashRouter":"BrowserRouter");console.log("[App] Basename:",Xo);const Ng=()=>{const{toast:t}=xe(),[s,a]=m.useState(!1),[n,r]=m.useState(!1),[i,o]=m.useState(!1),[c,d]=m.useState(!1),[x,h]=m.useState({version:"",releaseDate:"",releaseNotes:""}),[f,l]=m.useState({percent:0,bytesPerSecond:0,transferred:0,total:0}),[u,v]=m.useState({message:"",type:"",canRetry:!1,manualDownloadUrl:"",technicalDetails:""});m.useEffect(()=>{var U;if(!Yt||!((U=window.electron)!=null&&U.ipcRenderer))return;const k=window.electron.ipcRenderer,B=(H,P)=>{console.log("[App] Update available:",P),h(P),a(!0)},C=(H,P)=>{console.log("[App] Update not available:",P)},j=(H,P)=>{console.log("[App] Download progress:",P.percent.toFixed(2)+"%"),l(P)},w=(H,P)=>{console.log("[App] Update downloaded:",P),r(!1),o(!0)},M=(H,P)=>{console.error("[App] Update error:",P),a(!1),r(!1),o(!1),v(P),d(!0)},F=(H,P)=>{console.log("[App] Update retry:",P),t({title:"Retrying Update",description:`${P.message} (Attempt ${P.attempt}/${P.maxRetries})`,duration:3e3})};return k.on("update-available",B),k.on("update-not-available",C),k.on("download-progress",j),k.on("update-downloaded",w),k.on("update-error",M),k.on("update-retry",F),()=>{k.removeListener("update-available",B),k.removeListener("update-not-available",C),k.removeListener("download-progress",j),k.removeListener("update-downloaded",w),k.removeListener("update-error",M),k.removeListener("update-retry",F)}},[]);const b=()=>{console.log("[App] Starting download..."),a(!1),r(!0)},g=()=>{console.log("[App] Skipping update"),a(!1)},p=()=>{console.log("[App] Installing update now..."),o(!1)},y=()=>{console.log("[App] Installing update later"),o(!1)},N=()=>{var k,B;console.log("[App] Retrying update..."),d(!1),u.type==="network"||u.type==="integrity"?((k=window.electron)!=null&&k.ipcRenderer&&window.electron.ipcRenderer.send("download-update"),r(!0)):(B=window.electron)!=null&&B.ipcRenderer&&window.electron.ipcRenderer.send("check-for-updates")},_=()=>{var k;console.log("[App] Opening manual download..."),(k=window.electron)!=null&&k.ipcRenderer&&window.electron.ipcRenderer.send("open-manual-download"),d(!1)},D=()=>{console.log("[App] Closing error dialog"),d(!1)},T=Yt?Al:Rl,O=Yt?{}:{basename:Xo};return Yt?e.jsx($n,{children:e.jsx(Nn,{client:rr,children:e.jsxs(Ea,{children:[e.jsx(In,{}),e.jsx(An,{}),e.jsxs(T,{...O,children:[e.jsx("div",{className:"min-h-screen flex flex-col bg-background text-foreground",children:e.jsx("main",{className:"flex-1 scroll-area",children:e.jsxs(Ml,{children:[e.jsx(be,{path:"/",element:e.jsx(tr,{})}),e.jsx(be,{path:"/home",element:e.jsx(tr,{})}),e.jsx(be,{path:"/loading",element:e.jsx(ag,{})}),e.jsx(be,{path:"/auth",element:e.jsx(ar,{})}),"            ",e.jsx(be,{path:"/Auth",element:e.jsx(ar,{})}),"            ",e.jsx(be,{path:"/auth-simple",element:e.jsx(sg,{})})," ",e.jsx(be,{path:"/admin",element:e.jsx(lh,{})}),e.jsx(be,{path:"/staff-portal",element:e.jsx(er,{})}),e.jsx(be,{path:"/StaffPortal",element:e.jsx(er,{})}),e.jsx(be,{path:"/manage-staff",element:e.jsx(pg,{})}),e.jsx(be,{path:"/next-appointments",element:e.jsx(cg,{})}),e.jsx(be,{path:"/edit-appointments",element:e.jsx(xg,{})}),e.jsx(be,{path:"/patient-registrations",element:e.jsx(dg,{})}),e.jsx(be,{path:"/past-vaccinations",element:e.jsx(mg,{})}),e.jsx(be,{path:"/verify-appointments",element:e.jsx(gg,{})}),e.jsx(be,{path:"/fix-appointments",element:e.jsx(yg,{})}),e.jsx(be,{path:"/line-debugger",element:e.jsx(bg,{})}),e.jsx(be,{path:"/patient-portal",element:e.jsx(Bn,{})}),e.jsx(be,{path:"/PatientPortal",element:e.jsx(Bn,{})}),e.jsx(be,{path:"/liff-patient-portal",element:e.jsx(ig,{})}),e.jsx(be,{path:"/vaccine-status",element:e.jsx(lg,{})}),e.jsx(be,{path:"/liff-checker",element:e.jsx(hg,{})}),e.jsx(be,{path:"/line-bot",element:e.jsx(Un,{})}),e.jsx(be,{path:"/LineBot",element:e.jsx(Un,{})}),e.jsx(be,{path:"/download",element:e.jsx(nr,{})}),e.jsx(be,{path:"/fast",element:e.jsx(ng,{})}),e.jsx(be,{path:"*",element:e.jsx(ch,{})})]})})}),e.jsx(Zm,{open:s,updateInfo:x,onDownload:b,onSkip:g}),e.jsx(cu,{open:n,progress:f}),e.jsx(du,{open:i,version:x.version,onInstallNow:p,onInstallLater:y}),e.jsx(mu,{open:c,error:u,onRetry:N,onManualDownload:_,onClose:D})]})]})})}):(console.log("[App] Web browser detected in production - redirecting to download page only"),e.jsx($n,{children:e.jsx(Nn,{client:rr,children:e.jsxs(Ea,{children:[e.jsx(In,{}),e.jsx(An,{}),e.jsx(nr,{})]})})}))};$r(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(Ng,{})}));
//# sourceMappingURL=main-BH302IOv.js.map
