var vi=Object.defineProperty;var bi=(t,s,a)=>s in t?vi(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var Os=(t,s,a)=>bi(t,typeof s!="symbol"?s+"":s,a);import{c as Pn,a as yi,u as ya,j as e,B as ji,P as Je,b as An,d as Rn,e as Me,f as xs,V as Mn,R as Ni,g as wi,h as _i,i as Si,k as Ci,o as ki,s as Di,l as Ei,m as Ii,n as Ti,p as Pi,q as Ai,r as Ri,S as Lt,L as On,T as Ln,C as $n,t as Mi,v as Fn,I as Oi,w as Wn,x as zn,y as Li,z as Bn,A as $i,D as Un,E as Hn,F as Fi,G as Wi,H as Vn,J as zi,K as Bi,M as Ui,N as Hi,O as Yn,Q as Vi,U as Gn,W as Yi,X as qn,Y as Kn,Z as Gi}from"./ui-vendor-Dhz5gdLW.js";import{a as ja,r as u,R as V,b as qi,c as Jn,u as Xn,e as Nt,N as Ka,L as Ls,H as Ki,B as Ji,f as Xi,h as ye}from"./react-vendor-BwSztqlq.js";import{c as Qn}from"./chart-vendor-pIViOuo6.js";import{X as Na,T as pt,R as De,B as qt,Z as ea,C as Z,F as Qi,a as qe,D as Rt,A as st,b as Zi,S as Ce,I as el,c as Ht,M as mt,d as Tt,U as We,e as we,f as Ae,g as Se,h as ve,i as fs,j as Zn,k as tl,l as er,m as ze,n as sl,P as tr,o as wa,L as sr,p as js,Q as Ja,E as al,q as Ns,r as Ee,G as nl,s as ar,t as nr,u as ws,v as $e,w as rl,x as xt,y as rr,z as ta,H as gs,J as or,K as ol,N as il,O as vs,V as rs,W as ll,Y as cl,_ as dl,$ as ul,a0 as $s,a1 as Xa,a2 as Vt,a3 as Qa,a4 as ml,a5 as ir,a6 as hl,a7 as pl,a8 as Za,a9 as os,aa as en}from"./icons-vendor-hXtjRKPI.js";import{Q as xl,a as fl}from"./query-vendor-Dj6VqTy4.js";import{c as gl,A as vl}from"./supabase-vendor-BL3BVkN7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var lr,tn=ja;lr=tn.createRoot,tn.hydrateRoot;const bl=1,yl=1e6;let Fs=0;function jl(){return Fs=(Fs+1)%Number.MAX_SAFE_INTEGER,Fs.toString()}const Ws=new Map,sn=t=>{if(Ws.has(t))return;const s=setTimeout(()=>{Ws.delete(t),Yt({type:"REMOVE_TOAST",toastId:t})},yl);Ws.set(t,s)},Nl=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,bl)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?sn(a):t.toasts.forEach(n=>{sn(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},ms=[];let hs={toasts:[]};function Yt(t){hs=Nl(hs,t),ms.forEach(s=>{s(hs)})}function wl({...t}){const s=jl(),a=r=>Yt({type:"UPDATE_TOAST",toast:{...r,id:s}}),n=()=>Yt({type:"DISMISS_TOAST",toastId:s});return Yt({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:r=>{r||n()}}}),{id:s,dismiss:n,update:a}}function fe(){const[t,s]=u.useState(hs);return u.useEffect(()=>(ms.push(s),()=>{const a=ms.indexOf(s);a>-1&&ms.splice(a,1)}),[t]),{...t,toast:wl,dismiss:a=>Yt({type:"DISMISS_TOAST",toastId:a})}}var _a="ToastProvider",[Sa,_l,Sl]=yi("Toast"),[cr]=Pn("Toast",[Sl]),[Cl,_s]=cr(_a),dr=t=>{const{__scopeToast:s,label:a="Notification",duration:n=5e3,swipeDirection:r="right",swipeThreshold:o=50,children:i}=t,[c,d]=u.useState(null),[p,h]=u.useState(0),f=u.useRef(!1),l=u.useRef(!1);return a.trim()||console.error(`Invalid prop \`label\` supplied to \`${_a}\`. Expected non-empty \`string\`.`),e.jsx(Sa.Provider,{scope:s,children:e.jsx(Cl,{scope:s,label:a,duration:n,swipeDirection:r,swipeThreshold:o,toastCount:p,viewport:c,onViewportChange:d,onToastAdd:u.useCallback(()=>h(m=>m+1),[]),onToastRemove:u.useCallback(()=>h(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:l,children:i})})};dr.displayName=_a;var ur="ToastViewport",kl=["F8"],sa="toast.viewportPause",aa="toast.viewportResume",mr=u.forwardRef((t,s)=>{const{__scopeToast:a,hotkey:n=kl,label:r="Notifications ({hotkey})",...o}=t,i=_s(ur,a),c=_l(a),d=u.useRef(null),p=u.useRef(null),h=u.useRef(null),f=u.useRef(null),l=ya(s,f,i.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;u.useEffect(()=>{const v=x=>{var _;n.length!==0&&n.every(S=>x[S]||x.code===S)&&((_=f.current)==null||_.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),u.useEffect(()=>{const v=d.current,x=f.current;if(g&&v&&x){const j=()=>{if(!i.isClosePausedRef.current){const T=new CustomEvent(sa);x.dispatchEvent(T),i.isClosePausedRef.current=!0}},_=()=>{if(i.isClosePausedRef.current){const T=new CustomEvent(aa);x.dispatchEvent(T),i.isClosePausedRef.current=!1}},S=T=>{!v.contains(T.relatedTarget)&&_()},C=()=>{v.contains(document.activeElement)||_()};return v.addEventListener("focusin",j),v.addEventListener("focusout",S),v.addEventListener("pointermove",j),v.addEventListener("pointerleave",C),window.addEventListener("blur",j),window.addEventListener("focus",_),()=>{v.removeEventListener("focusin",j),v.removeEventListener("focusout",S),v.removeEventListener("pointermove",j),v.removeEventListener("pointerleave",C),window.removeEventListener("blur",j),window.removeEventListener("focus",_)}}},[g,i.isClosePausedRef]);const b=u.useCallback(({tabbingDirection:v})=>{const j=c().map(_=>{const S=_.ref.current,C=[S,...Wl(S)];return v==="forwards"?C:C.reverse()});return(v==="forwards"?j.reverse():j).flat()},[c]);return u.useEffect(()=>{const v=f.current;if(v){const x=j=>{var C,T,W;const _=j.altKey||j.ctrlKey||j.metaKey;if(j.key==="Tab"&&!_){const D=document.activeElement,k=j.shiftKey;if(j.target===v&&k){(C=p.current)==null||C.focus();return}const y=b({tabbingDirection:k?"backwards":"forwards"}),E=y.findIndex(P=>P===D);zs(y.slice(E+1))?j.preventDefault():k?(T=p.current)==null||T.focus():(W=h.current)==null||W.focus()}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[c,b]),e.jsxs(ji,{ref:d,role:"region","aria-label":r.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&e.jsx(na,{ref:p,onFocusFromOutsideViewport:()=>{const v=b({tabbingDirection:"forwards"});zs(v)}}),e.jsx(Sa.Slot,{scope:a,children:e.jsx(Je.ol,{tabIndex:-1,...o,ref:l})}),g&&e.jsx(na,{ref:h,onFocusFromOutsideViewport:()=>{const v=b({tabbingDirection:"backwards"});zs(v)}})]})});mr.displayName=ur;var hr="ToastFocusProxy",na=u.forwardRef((t,s)=>{const{__scopeToast:a,onFocusFromOutsideViewport:n,...r}=t,o=_s(hr,a);return e.jsx(Mn,{"aria-hidden":!0,tabIndex:0,...r,ref:s,style:{position:"fixed"},onFocus:i=>{var p;const c=i.relatedTarget;!((p=o.viewport)!=null&&p.contains(c))&&n()}})});na.displayName=hr;var Ss="Toast",Dl="toast.swipeStart",El="toast.swipeMove",Il="toast.swipeCancel",Tl="toast.swipeEnd",pr=u.forwardRef((t,s)=>{const{forceMount:a,open:n,defaultOpen:r,onOpenChange:o,...i}=t,[c=!0,d]=An({prop:n,defaultProp:r,onChange:o});return e.jsx(Rn,{present:a||c,children:e.jsx(Rl,{open:c,...i,ref:s,onClose:()=>d(!1),onPause:xs(t.onPause),onResume:xs(t.onResume),onSwipeStart:Me(t.onSwipeStart,p=>{p.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Me(t.onSwipeMove,p=>{const{x:h,y:f}=p.detail.delta;p.currentTarget.setAttribute("data-swipe","move"),p.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),p.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Me(t.onSwipeCancel,p=>{p.currentTarget.setAttribute("data-swipe","cancel"),p.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),p.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),p.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),p.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Me(t.onSwipeEnd,p=>{const{x:h,y:f}=p.detail.delta;p.currentTarget.setAttribute("data-swipe","end"),p.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),p.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),p.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),p.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});pr.displayName=Ss;var[Pl,Al]=cr(Ss,{onClose(){}}),Rl=u.forwardRef((t,s)=>{const{__scopeToast:a,type:n="foreground",duration:r,open:o,onClose:i,onEscapeKeyDown:c,onPause:d,onResume:p,onSwipeStart:h,onSwipeMove:f,onSwipeCancel:l,onSwipeEnd:m,...g}=t,b=_s(Ss,a),[v,x]=u.useState(null),j=ya(s,P=>x(P)),_=u.useRef(null),S=u.useRef(null),C=r||b.duration,T=u.useRef(0),W=u.useRef(C),D=u.useRef(0),{onToastAdd:k,onToastRemove:H}=b,w=xs(()=>{var L;(v==null?void 0:v.contains(document.activeElement))&&((L=b.viewport)==null||L.focus()),i()}),y=u.useCallback(P=>{!P||P===1/0||(window.clearTimeout(D.current),T.current=new Date().getTime(),D.current=window.setTimeout(w,P))},[w]);u.useEffect(()=>{const P=b.viewport;if(P){const L=()=>{y(W.current),p==null||p()},z=()=>{const I=new Date().getTime()-T.current;W.current=W.current-I,window.clearTimeout(D.current),d==null||d()};return P.addEventListener(sa,z),P.addEventListener(aa,L),()=>{P.removeEventListener(sa,z),P.removeEventListener(aa,L)}}},[b.viewport,C,d,p,y]),u.useEffect(()=>{o&&!b.isClosePausedRef.current&&y(C)},[o,C,b.isClosePausedRef,y]),u.useEffect(()=>(k(),()=>H()),[k,H]);const E=u.useMemo(()=>v?jr(v):null,[v]);return b.viewport?e.jsxs(e.Fragment,{children:[E&&e.jsx(Ml,{__scopeToast:a,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:E}),e.jsx(Pl,{scope:a,onClose:w,children:ja.createPortal(e.jsx(Sa.ItemSlot,{scope:a,children:e.jsx(Ni,{asChild:!0,onEscapeKeyDown:Me(c,()=>{b.isFocusedToastEscapeKeyDownRef.current||w(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(Je.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":b.swipeDirection,...g,ref:j,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Me(t.onKeyDown,P=>{P.key==="Escape"&&(c==null||c(P.nativeEvent),P.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,w()))}),onPointerDown:Me(t.onPointerDown,P=>{P.button===0&&(_.current={x:P.clientX,y:P.clientY})}),onPointerMove:Me(t.onPointerMove,P=>{if(!_.current)return;const L=P.clientX-_.current.x,z=P.clientY-_.current.y,I=!!S.current,N=["left","right"].includes(b.swipeDirection),O=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,Y=N?O(0,L):0,U=N?0:O(0,z),J=P.pointerType==="touch"?10:2,Q={x:Y,y:U},ge={originalEvent:P,delta:Q};I?(S.current=Q,is(El,f,ge,{discrete:!1})):an(Q,b.swipeDirection,J)?(S.current=Q,is(Dl,h,ge,{discrete:!1}),P.target.setPointerCapture(P.pointerId)):(Math.abs(L)>J||Math.abs(z)>J)&&(_.current=null)}),onPointerUp:Me(t.onPointerUp,P=>{const L=S.current,z=P.target;if(z.hasPointerCapture(P.pointerId)&&z.releasePointerCapture(P.pointerId),S.current=null,_.current=null,L){const I=P.currentTarget,N={originalEvent:P,delta:L};an(L,b.swipeDirection,b.swipeThreshold)?is(Tl,m,N,{discrete:!0}):is(Il,l,N,{discrete:!0}),I.addEventListener("click",O=>O.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),Ml=t=>{const{__scopeToast:s,children:a,...n}=t,r=_s(Ss,s),[o,i]=u.useState(!1),[c,d]=u.useState(!1);return $l(()=>i(!0)),u.useEffect(()=>{const p=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(p)},[]),c?null:e.jsx(wi,{asChild:!0,children:e.jsx(Mn,{...n,children:o&&e.jsxs(e.Fragment,{children:[r.label," ",a]})})})},Ol="ToastTitle",xr=u.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t;return e.jsx(Je.div,{...n,ref:s})});xr.displayName=Ol;var Ll="ToastDescription",fr=u.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t;return e.jsx(Je.div,{...n,ref:s})});fr.displayName=Ll;var gr="ToastAction",vr=u.forwardRef((t,s)=>{const{altText:a,...n}=t;return a.trim()?e.jsx(yr,{altText:a,asChild:!0,children:e.jsx(Ca,{...n,ref:s})}):(console.error(`Invalid prop \`altText\` supplied to \`${gr}\`. Expected non-empty \`string\`.`),null)});vr.displayName=gr;var br="ToastClose",Ca=u.forwardRef((t,s)=>{const{__scopeToast:a,...n}=t,r=Al(br,a);return e.jsx(yr,{asChild:!0,children:e.jsx(Je.button,{type:"button",...n,ref:s,onClick:Me(t.onClick,r.onClose)})})});Ca.displayName=br;var yr=u.forwardRef((t,s)=>{const{__scopeToast:a,altText:n,...r}=t;return e.jsx(Je.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...r,ref:s})});function jr(t){const s=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&s.push(n.textContent),Fl(n)){const r=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!r)if(o){const i=n.dataset.radixToastAnnounceAlt;i&&s.push(i)}else s.push(...jr(n))}}),s}function is(t,s,a,{discrete:n}){const r=a.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:a});s&&r.addEventListener(t,s,{once:!0}),n?Si(r,o):r.dispatchEvent(o)}var an=(t,s,a=0)=>{const n=Math.abs(t.x),r=Math.abs(t.y),o=n>r;return s==="left"||s==="right"?o&&n>a:!o&&r>a};function $l(t=()=>{}){const s=xs(t);_i(()=>{let a=0,n=0;return a=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(s)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(n)}},[s])}function Fl(t){return t.nodeType===t.ELEMENT_NODE}function Wl(t){const s=[],a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)s.push(a.currentNode);return s}function zs(t){const s=document.activeElement;return t.some(a=>a===s?!0:(a.focus(),document.activeElement!==s))}var zl=dr,Nr=mr,wr=pr,_r=xr,Sr=fr,Cr=vr,kr=Ca;const nn=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,rn=Qn,wt=(t,s)=>a=>{var n;if((s==null?void 0:s.variants)==null)return rn(t,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:r,defaultVariants:o}=s,i=Object.keys(r).map(p=>{const h=a==null?void 0:a[p],f=o==null?void 0:o[p];if(h===null)return null;const l=nn(h)||nn(f);return r[p][l]}),c=a&&Object.entries(a).reduce((p,h)=>{let[f,l]=h;return l===void 0||(p[f]=l),p},{}),d=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((p,h)=>{let{class:f,className:l,...m}=h;return Object.entries(m).every(g=>{let[b,v]=g;return Array.isArray(v)?v.includes({...o,...c}[b]):{...o,...c}[b]===v})?[...p,f,l]:p},[]);return rn(t,i,d,a==null?void 0:a.class,a==null?void 0:a.className)},ka="-",Bl=t=>{const s=Hl(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:i=>{const c=i.split(ka);return c[0]===""&&c.length!==1&&c.shift(),Dr(c,s)||Ul(i)},getConflictingClassGroupIds:(i,c)=>{const d=a[i]||[];return c&&n[i]?[...d,...n[i]]:d}}},Dr=(t,s)=>{var i;if(t.length===0)return s.classGroupId;const a=t[0],n=s.nextPart.get(a),r=n?Dr(t.slice(1),n):void 0;if(r)return r;if(s.validators.length===0)return;const o=t.join(ka);return(i=s.validators.find(({validator:c})=>c(o)))==null?void 0:i.classGroupId},on=/^\[(.+)\]$/,Ul=t=>{if(on.test(t)){const s=on.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},Hl=t=>{const{theme:s,prefix:a}=t,n={nextPart:new Map,validators:[]};return Yl(Object.entries(t.classGroups),a).forEach(([o,i])=>{ra(i,n,o,s)}),n},ra=(t,s,a,n)=>{t.forEach(r=>{if(typeof r=="string"){const o=r===""?s:ln(s,r);o.classGroupId=a;return}if(typeof r=="function"){if(Vl(r)){ra(r(n),s,a,n);return}s.validators.push({validator:r,classGroupId:a});return}Object.entries(r).forEach(([o,i])=>{ra(i,ln(s,o),a,n)})})},ln=(t,s)=>{let a=t;return s.split(ka).forEach(n=>{a.nextPart.has(n)||a.nextPart.set(n,{nextPart:new Map,validators:[]}),a=a.nextPart.get(n)}),a},Vl=t=>t.isThemeGetter,Yl=(t,s)=>s?t.map(([a,n])=>{const r=n.map(o=>typeof o=="string"?s+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,c])=>[s+i,c])):o);return[a,r]}):t,Gl=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,n=new Map;const r=(o,i)=>{a.set(o,i),s++,s>t&&(s=0,n=a,a=new Map)};return{get(o){let i=a.get(o);if(i!==void 0)return i;if((i=n.get(o))!==void 0)return r(o,i),i},set(o,i){a.has(o)?a.set(o,i):r(o,i)}}},Er="!",ql=t=>{const{separator:s,experimentalParseClassName:a}=t,n=s.length===1,r=s[0],o=s.length,i=c=>{const d=[];let p=0,h=0,f;for(let v=0;v<c.length;v++){let x=c[v];if(p===0){if(x===r&&(n||c.slice(v,v+o)===s)){d.push(c.slice(h,v)),h=v+o;continue}if(x==="/"){f=v;continue}}x==="["?p++:x==="]"&&p--}const l=d.length===0?c:c.substring(h),m=l.startsWith(Er),g=m?l.substring(1):l,b=f&&f>h?f-h:void 0;return{modifiers:d,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:b}};return a?c=>a({className:c,parseClassName:i}):i},Kl=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(n=>{n[0]==="["?(s.push(...a.sort(),n),a=[]):a.push(n)}),s.push(...a.sort()),s},Jl=t=>({cache:Gl(t.cacheSize),parseClassName:ql(t),...Bl(t)}),Xl=/\s+/,Ql=(t,s)=>{const{parseClassName:a,getClassGroupId:n,getConflictingClassGroupIds:r}=s,o=[],i=t.trim().split(Xl);let c="";for(let d=i.length-1;d>=0;d-=1){const p=i[d],{modifiers:h,hasImportantModifier:f,baseClassName:l,maybePostfixModifierPosition:m}=a(p);let g=!!m,b=n(g?l.substring(0,m):l);if(!b){if(!g){c=p+(c.length>0?" "+c:c);continue}if(b=n(l),!b){c=p+(c.length>0?" "+c:c);continue}g=!1}const v=Kl(h).join(":"),x=f?v+Er:v,j=x+b;if(o.includes(j))continue;o.push(j);const _=r(b,g);for(let S=0;S<_.length;++S){const C=_[S];o.push(x+C)}c=p+(c.length>0?" "+c:c)}return c};function Zl(){let t=0,s,a,n="";for(;t<arguments.length;)(s=arguments[t++])&&(a=Ir(s))&&(n&&(n+=" "),n+=a);return n}const Ir=t=>{if(typeof t=="string")return t;let s,a="";for(let n=0;n<t.length;n++)t[n]&&(s=Ir(t[n]))&&(a&&(a+=" "),a+=s);return a};function ec(t,...s){let a,n,r,o=i;function i(d){const p=s.reduce((h,f)=>f(h),t());return a=Jl(p),n=a.cache.get,r=a.cache.set,o=c,c(d)}function c(d){const p=n(d);if(p)return p;const h=Ql(d,a);return r(d,h),h}return function(){return o(Zl.apply(null,arguments))}}const xe=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},Tr=/^\[(?:([a-z-]+):)?(.+)\]$/i,tc=/^\d+\/\d+$/,sc=new Set(["px","full","screen"]),ac=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rc=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,oc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ic=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ze=t=>Pt(t)||sc.has(t)||tc.test(t),ct=t=>$t(t,"length",xc),Pt=t=>!!t&&!Number.isNaN(Number(t)),Bs=t=>$t(t,"number",Pt),zt=t=>!!t&&Number.isInteger(Number(t)),lc=t=>t.endsWith("%")&&Pt(t.slice(0,-1)),ne=t=>Tr.test(t),dt=t=>ac.test(t),cc=new Set(["length","size","percentage"]),dc=t=>$t(t,cc,Pr),uc=t=>$t(t,"position",Pr),mc=new Set(["image","url"]),hc=t=>$t(t,mc,gc),pc=t=>$t(t,"",fc),Bt=()=>!0,$t=(t,s,a)=>{const n=Tr.exec(t);return n?n[1]?typeof s=="string"?n[1]===s:s.has(n[1]):a(n[2]):!1},xc=t=>nc.test(t)&&!rc.test(t),Pr=()=>!1,fc=t=>oc.test(t),gc=t=>ic.test(t),vc=()=>{const t=xe("colors"),s=xe("spacing"),a=xe("blur"),n=xe("brightness"),r=xe("borderColor"),o=xe("borderRadius"),i=xe("borderSpacing"),c=xe("borderWidth"),d=xe("contrast"),p=xe("grayscale"),h=xe("hueRotate"),f=xe("invert"),l=xe("gap"),m=xe("gradientColorStops"),g=xe("gradientColorStopPositions"),b=xe("inset"),v=xe("margin"),x=xe("opacity"),j=xe("padding"),_=xe("saturate"),S=xe("scale"),C=xe("sepia"),T=xe("skew"),W=xe("space"),D=xe("translate"),k=()=>["auto","contain","none"],H=()=>["auto","hidden","clip","visible","scroll"],w=()=>["auto",ne,s],y=()=>[ne,s],E=()=>["",Ze,ct],P=()=>["auto",Pt,ne],L=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],I=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],N=()=>["start","end","center","between","around","evenly","stretch"],O=()=>["","0",ne],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],U=()=>[Pt,ne];return{cacheSize:500,separator:":",theme:{colors:[Bt],spacing:[Ze,ct],blur:["none","",dt,ne],brightness:U(),borderColor:[t],borderRadius:["none","","full",dt,ne],borderSpacing:y(),borderWidth:E(),contrast:U(),grayscale:O(),hueRotate:U(),invert:O(),gap:y(),gradientColorStops:[t],gradientColorStopPositions:[lc,ct],inset:w(),margin:w(),opacity:U(),padding:y(),saturate:U(),scale:U(),sepia:O(),skew:U(),space:y(),translate:y()},classGroups:{aspect:[{aspect:["auto","square","video",ne]}],container:["container"],columns:[{columns:[dt]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...L(),ne]}],overflow:[{overflow:H()}],"overflow-x":[{"overflow-x":H()}],"overflow-y":[{"overflow-y":H()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",zt,ne]}],basis:[{basis:w()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ne]}],grow:[{grow:O()}],shrink:[{shrink:O()}],order:[{order:["first","last","none",zt,ne]}],"grid-cols":[{"grid-cols":[Bt]}],"col-start-end":[{col:["auto",{span:["full",zt,ne]},ne]}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":[Bt]}],"row-start-end":[{row:["auto",{span:[zt,ne]},ne]}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ne]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ne]}],gap:[{gap:[l]}],"gap-x":[{"gap-x":[l]}],"gap-y":[{"gap-y":[l]}],"justify-content":[{justify:["normal",...N()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...N(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...N(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[j]}],px:[{px:[j]}],py:[{py:[j]}],ps:[{ps:[j]}],pe:[{pe:[j]}],pt:[{pt:[j]}],pr:[{pr:[j]}],pb:[{pb:[j]}],pl:[{pl:[j]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[W]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[W]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ne,s]}],"min-w":[{"min-w":[ne,s,"min","max","fit"]}],"max-w":[{"max-w":[ne,s,"none","full","min","max","fit","prose",{screen:[dt]},dt]}],h:[{h:[ne,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ne,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ne,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ne,s,"auto","min","max","fit"]}],"font-size":[{text:["base",dt,ct]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Bs]}],"font-family":[{font:[Bt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ne]}],"line-clamp":[{"line-clamp":["none",Pt,Bs]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ze,ne]}],"list-image":[{"list-image":["none",ne]}],"list-style-type":[{list:["none","disc","decimal",ne]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ze,ct]}],"underline-offset":[{"underline-offset":["auto",Ze,ne]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ne]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ne]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...L(),uc]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",dc]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hc]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Ze,ne]}],"outline-w":[{outline:[Ze,ct]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Ze,ct]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",dt,pc]}],"shadow-color":[{shadow:[Bt]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...I(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":I()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",dt,ne]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[_]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ne]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",ne]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",ne]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[zt,ne]}],"translate-x":[{"translate-x":[D]}],"translate-y":[{"translate-y":[D]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ne]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ne]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":y()}],"scroll-mx":[{"scroll-mx":y()}],"scroll-my":[{"scroll-my":y()}],"scroll-ms":[{"scroll-ms":y()}],"scroll-me":[{"scroll-me":y()}],"scroll-mt":[{"scroll-mt":y()}],"scroll-mr":[{"scroll-mr":y()}],"scroll-mb":[{"scroll-mb":y()}],"scroll-ml":[{"scroll-ml":y()}],"scroll-p":[{"scroll-p":y()}],"scroll-px":[{"scroll-px":y()}],"scroll-py":[{"scroll-py":y()}],"scroll-ps":[{"scroll-ps":y()}],"scroll-pe":[{"scroll-pe":y()}],"scroll-pt":[{"scroll-pt":y()}],"scroll-pr":[{"scroll-pr":y()}],"scroll-pb":[{"scroll-pb":y()}],"scroll-pl":[{"scroll-pl":y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ne]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ze,ct,Bs]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},bc=ec(vc);function G(...t){return bc(Qn(t))}const yc=zl,Ar=u.forwardRef(({className:t,...s},a)=>e.jsx(Nr,{ref:a,className:G("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));Ar.displayName=Nr.displayName;const jc=wt("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Rr=u.forwardRef(({className:t,variant:s,...a},n)=>e.jsx(wr,{ref:n,className:G(jc({variant:s}),t),...a}));Rr.displayName=wr.displayName;const Nc=u.forwardRef(({className:t,...s},a)=>e.jsx(Cr,{ref:a,className:G("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));Nc.displayName=Cr.displayName;const Mr=u.forwardRef(({className:t,...s},a)=>e.jsx(kr,{ref:a,className:G("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(Na,{className:"h-4 w-4"})}));Mr.displayName=kr.displayName;const Or=u.forwardRef(({className:t,...s},a)=>e.jsx(_r,{ref:a,className:G("text-sm font-semibold",t),...s}));Or.displayName=_r.displayName;const Lr=u.forwardRef(({className:t,...s},a)=>e.jsx(Sr,{ref:a,className:G("text-sm opacity-90",t),...s}));Lr.displayName=Sr.displayName;function wc(){const{toasts:t}=fe();return e.jsxs(yc,{children:[t.map(function({id:s,title:a,description:n,action:r,...o}){return e.jsxs(Rr,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(Or,{children:a}),n&&e.jsx(Lr,{children:n})]}),r,e.jsx(Mr,{})]},s)}),e.jsx(Ar,{})]})}var cn=["light","dark"],_c="(prefers-color-scheme: dark)",Sc=u.createContext(void 0),Cc={setTheme:t=>{},themes:[]},kc=()=>{var t;return(t=u.useContext(Sc))!=null?t:Cc};u.memo(({forcedTheme:t,storageKey:s,attribute:a,enableSystem:n,enableColorScheme:r,defaultTheme:o,value:i,attrs:c,nonce:d})=>{let p=o==="system",h=a==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${a}',s='setAttribute';`,f=r?cn.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",l=(g,b=!1,v=!0)=>{let x=i?i[g]:g,j=b?g+"|| ''":`'${x}'`,_="";return r&&v&&!b&&cn.includes(g)&&(_+=`d.style.colorScheme = '${g}';`),a==="class"?b||x?_+=`c.add(${j})`:_+="null":x&&(_+=`d[s](n,${j})`),_},m=t?`!function(){${h}${l(t)}}()`:n?`!function(){try{${h}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${p})){var t='${_c}',m=window.matchMedia(t);if(m.media!==t||m.matches){${l("dark")}}else{${l("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${l(i?"x[e]":"e",!0)}}${p?"":"else{"+l(o,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${h}var e=localStorage.getItem('${s}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${l(i?"x[e]":"e",!0)}}else{${l(o,!1,!1)};}${f}}catch(t){}}();`;return u.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:m}})});var Dc=t=>{switch(t){case"success":return Tc;case"info":return Ac;case"warning":return Pc;case"error":return Rc;default:return null}},Ec=Array(12).fill(0),Ic=({visible:t})=>V.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},V.createElement("div",{className:"sonner-spinner"},Ec.map((s,a)=>V.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),Tc=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Pc=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Ac=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Rc=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Mc=()=>{let[t,s]=V.useState(document.hidden);return V.useEffect(()=>{let a=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",a),()=>window.removeEventListener("visibilitychange",a)},[]),t},oa=1,Oc=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let s=this.subscribers.indexOf(t);this.subscribers.splice(s,1)}),this.publish=t=>{this.subscribers.forEach(s=>s(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var s;let{message:a,...n}=t,r=typeof(t==null?void 0:t.id)=="number"||((s=t.id)==null?void 0:s.length)>0?t.id:oa++,o=this.toasts.find(c=>c.id===r),i=t.dismissible===void 0?!0:t.dismissible;return o?this.toasts=this.toasts.map(c=>c.id===r?(this.publish({...c,...t,id:r,title:a}),{...c,...t,id:r,dismissible:i,title:a}):c):this.addToast({title:a,...n,dismissible:i,id:r}),r},this.dismiss=t=>(t||this.toasts.forEach(s=>{this.subscribers.forEach(a=>a({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:t,dismiss:!0})),t),this.message=(t,s)=>this.create({...s,message:t}),this.error=(t,s)=>this.create({...s,message:t,type:"error"}),this.success=(t,s)=>this.create({...s,type:"success",message:t}),this.info=(t,s)=>this.create({...s,type:"info",message:t}),this.warning=(t,s)=>this.create({...s,type:"warning",message:t}),this.loading=(t,s)=>this.create({...s,type:"loading",message:t}),this.promise=(t,s)=>{if(!s)return;let a;s.loading!==void 0&&(a=this.create({...s,promise:t,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));let n=t instanceof Promise?t:t(),r=a!==void 0;return n.then(async o=>{if($c(o)&&!o.ok){r=!1;let i=typeof s.error=="function"?await s.error(`HTTP error! status: ${o.status}`):s.error,c=typeof s.description=="function"?await s.description(`HTTP error! status: ${o.status}`):s.description;this.create({id:a,type:"error",message:i,description:c})}else if(s.success!==void 0){r=!1;let i=typeof s.success=="function"?await s.success(o):s.success,c=typeof s.description=="function"?await s.description(o):s.description;this.create({id:a,type:"success",message:i,description:c})}}).catch(async o=>{if(s.error!==void 0){r=!1;let i=typeof s.error=="function"?await s.error(o):s.error,c=typeof s.description=="function"?await s.description(o):s.description;this.create({id:a,type:"error",message:i,description:c})}}).finally(()=>{var o;r&&(this.dismiss(a),a=void 0),(o=s.finally)==null||o.call(s)}),a},this.custom=(t,s)=>{let a=(s==null?void 0:s.id)||oa++;return this.create({jsx:t(a),id:a,...s}),a},this.subscribers=[],this.toasts=[]}},Te=new Oc,Lc=(t,s)=>{let a=(s==null?void 0:s.id)||oa++;return Te.addToast({title:t,...s,id:a}),a},$c=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Fc=Lc,Wc=()=>Te.toasts;Object.assign(Fc,{success:Te.success,info:Te.info,warning:Te.warning,error:Te.error,custom:Te.custom,message:Te.message,promise:Te.promise,dismiss:Te.dismiss,loading:Te.loading},{getHistory:Wc});function zc(t,{insertAt:s}={}){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}zc(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ls(t){return t.label!==void 0}var Bc=3,Uc="32px",Hc=4e3,Vc=356,Yc=14,Gc=20,qc=200;function Kc(...t){return t.filter(Boolean).join(" ")}var Jc=t=>{var s,a,n,r,o,i,c,d,p,h;let{invert:f,toast:l,unstyled:m,interacting:g,setHeights:b,visibleToasts:v,heights:x,index:j,toasts:_,expanded:S,removeToast:C,defaultRichColors:T,closeButton:W,style:D,cancelButtonStyle:k,actionButtonStyle:H,className:w="",descriptionClassName:y="",duration:E,position:P,gap:L,loadingIcon:z,expandByDefault:I,classNames:N,icons:O,closeButtonAriaLabel:Y="Close toast",pauseWhenPageIsHidden:U,cn:J}=t,[Q,ge]=V.useState(!1),[ce,oe]=V.useState(!1),[Le,Qe]=V.useState(!1),[rt,ot]=V.useState(!1),[ts,Ct]=V.useState(0),[vt,Wt]=V.useState(0),ss=V.useRef(null),it=V.useRef(null),Ps=j===0,As=j+1<=v,je=l.type,kt=l.dismissible!==!1,ui=l.className||"",mi=l.descriptionClassName||"",as=V.useMemo(()=>x.findIndex(ae=>ae.toastId===l.id)||0,[x,l.id]),hi=V.useMemo(()=>{var ae;return(ae=l.closeButton)!=null?ae:W},[l.closeButton,W]),Ha=V.useMemo(()=>l.duration||E||Hc,[l.duration,E]),Rs=V.useRef(0),Dt=V.useRef(0),Va=V.useRef(0),Et=V.useRef(null),[Ya,pi]=P.split("-"),Ga=V.useMemo(()=>x.reduce((ae,pe,me)=>me>=as?ae:ae+pe.height,0),[x,as]),qa=Mc(),xi=l.invert||f,Ms=je==="loading";Dt.current=V.useMemo(()=>as*L+Ga,[as,Ga]),V.useEffect(()=>{ge(!0)},[]),V.useLayoutEffect(()=>{if(!Q)return;let ae=it.current,pe=ae.style.height;ae.style.height="auto";let me=ae.getBoundingClientRect().height;ae.style.height=pe,Wt(me),b(He=>He.find(Ve=>Ve.toastId===l.id)?He.map(Ve=>Ve.toastId===l.id?{...Ve,height:me}:Ve):[{toastId:l.id,height:me,position:l.position},...He])},[Q,l.title,l.description,b,l.id]);let lt=V.useCallback(()=>{oe(!0),Ct(Dt.current),b(ae=>ae.filter(pe=>pe.toastId!==l.id)),setTimeout(()=>{C(l)},qc)},[l,C,b,Dt]);V.useEffect(()=>{if(l.promise&&je==="loading"||l.duration===1/0||l.type==="loading")return;let ae,pe=Ha;return S||g||U&&qa?(()=>{if(Va.current<Rs.current){let me=new Date().getTime()-Rs.current;pe=pe-me}Va.current=new Date().getTime()})():pe!==1/0&&(Rs.current=new Date().getTime(),ae=setTimeout(()=>{var me;(me=l.onAutoClose)==null||me.call(l,l),lt()},pe)),()=>clearTimeout(ae)},[S,g,I,l,Ha,lt,l.promise,je,U,qa]),V.useEffect(()=>{let ae=it.current;if(ae){let pe=ae.getBoundingClientRect().height;return Wt(pe),b(me=>[{toastId:l.id,height:pe,position:l.position},...me]),()=>b(me=>me.filter(He=>He.toastId!==l.id))}},[b,l.id]),V.useEffect(()=>{l.delete&&lt()},[lt,l.delete]);function fi(){return O!=null&&O.loading?V.createElement("div",{className:"sonner-loader","data-visible":je==="loading"},O.loading):z?V.createElement("div",{className:"sonner-loader","data-visible":je==="loading"},z):V.createElement(Ic,{visible:je==="loading"})}return V.createElement("li",{"aria-live":l.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:it,className:J(w,ui,N==null?void 0:N.toast,(s=l==null?void 0:l.classNames)==null?void 0:s.toast,N==null?void 0:N.default,N==null?void 0:N[je],(a=l==null?void 0:l.classNames)==null?void 0:a[je]),"data-sonner-toast":"","data-rich-colors":(n=l.richColors)!=null?n:T,"data-styled":!(l.jsx||l.unstyled||m),"data-mounted":Q,"data-promise":!!l.promise,"data-removed":ce,"data-visible":As,"data-y-position":Ya,"data-x-position":pi,"data-index":j,"data-front":Ps,"data-swiping":Le,"data-dismissible":kt,"data-type":je,"data-invert":xi,"data-swipe-out":rt,"data-expanded":!!(S||I&&Q),style:{"--index":j,"--toasts-before":j,"--z-index":_.length-j,"--offset":`${ce?ts:Dt.current}px`,"--initial-height":I?"auto":`${vt}px`,...D,...l.style},onPointerDown:ae=>{Ms||!kt||(ss.current=new Date,Ct(Dt.current),ae.target.setPointerCapture(ae.pointerId),ae.target.tagName!=="BUTTON"&&(Qe(!0),Et.current={x:ae.clientX,y:ae.clientY}))},onPointerUp:()=>{var ae,pe,me,He;if(rt||!kt)return;Et.current=null;let Ve=Number(((ae=it.current)==null?void 0:ae.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ns=new Date().getTime()-((pe=ss.current)==null?void 0:pe.getTime()),gi=Math.abs(Ve)/ns;if(Math.abs(Ve)>=Gc||gi>.11){Ct(Dt.current),(me=l.onDismiss)==null||me.call(l,l),lt(),ot(!0);return}(He=it.current)==null||He.style.setProperty("--swipe-amount","0px"),Qe(!1)},onPointerMove:ae=>{var pe;if(!Et.current||!kt)return;let me=ae.clientY-Et.current.y,He=ae.clientX-Et.current.x,Ve=(Ya==="top"?Math.min:Math.max)(0,me),ns=ae.pointerType==="touch"?10:2;Math.abs(Ve)>ns?(pe=it.current)==null||pe.style.setProperty("--swipe-amount",`${me}px`):Math.abs(He)>ns&&(Et.current=null)}},hi&&!l.jsx?V.createElement("button",{"aria-label":Y,"data-disabled":Ms,"data-close-button":!0,onClick:Ms||!kt?()=>{}:()=>{var ae;lt(),(ae=l.onDismiss)==null||ae.call(l,l)},className:J(N==null?void 0:N.closeButton,(r=l==null?void 0:l.classNames)==null?void 0:r.closeButton)},V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},V.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),V.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,l.jsx||V.isValidElement(l.title)?l.jsx||l.title:V.createElement(V.Fragment,null,je||l.icon||l.promise?V.createElement("div",{"data-icon":"",className:J(N==null?void 0:N.icon,(o=l==null?void 0:l.classNames)==null?void 0:o.icon)},l.promise||l.type==="loading"&&!l.icon?l.icon||fi():null,l.type!=="loading"?l.icon||(O==null?void 0:O[je])||Dc(je):null):null,V.createElement("div",{"data-content":"",className:J(N==null?void 0:N.content,(i=l==null?void 0:l.classNames)==null?void 0:i.content)},V.createElement("div",{"data-title":"",className:J(N==null?void 0:N.title,(c=l==null?void 0:l.classNames)==null?void 0:c.title)},l.title),l.description?V.createElement("div",{"data-description":"",className:J(y,mi,N==null?void 0:N.description,(d=l==null?void 0:l.classNames)==null?void 0:d.description)},l.description):null),V.isValidElement(l.cancel)?l.cancel:l.cancel&&ls(l.cancel)?V.createElement("button",{"data-button":!0,"data-cancel":!0,style:l.cancelButtonStyle||k,onClick:ae=>{var pe,me;ls(l.cancel)&&kt&&((me=(pe=l.cancel).onClick)==null||me.call(pe,ae),lt())},className:J(N==null?void 0:N.cancelButton,(p=l==null?void 0:l.classNames)==null?void 0:p.cancelButton)},l.cancel.label):null,V.isValidElement(l.action)?l.action:l.action&&ls(l.action)?V.createElement("button",{"data-button":!0,"data-action":!0,style:l.actionButtonStyle||H,onClick:ae=>{var pe,me;ls(l.action)&&(ae.defaultPrevented||((me=(pe=l.action).onClick)==null||me.call(pe,ae),lt()))},className:J(N==null?void 0:N.actionButton,(h=l==null?void 0:l.classNames)==null?void 0:h.actionButton)},l.action.label):null))};function dn(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var Xc=t=>{let{invert:s,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:r,closeButton:o,className:i,offset:c,theme:d="light",richColors:p,duration:h,style:f,visibleToasts:l=Bc,toastOptions:m,dir:g=dn(),gap:b=Yc,loadingIcon:v,icons:x,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:_,cn:S=Kc}=t,[C,T]=V.useState([]),W=V.useMemo(()=>Array.from(new Set([a].concat(C.filter(U=>U.position).map(U=>U.position)))),[C,a]),[D,k]=V.useState([]),[H,w]=V.useState(!1),[y,E]=V.useState(!1),[P,L]=V.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),z=V.useRef(null),I=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),N=V.useRef(null),O=V.useRef(!1),Y=V.useCallback(U=>{var J;(J=C.find(Q=>Q.id===U.id))!=null&&J.delete||Te.dismiss(U.id),T(Q=>Q.filter(({id:ge})=>ge!==U.id))},[C]);return V.useEffect(()=>Te.subscribe(U=>{if(U.dismiss){T(J=>J.map(Q=>Q.id===U.id?{...Q,delete:!0}:Q));return}setTimeout(()=>{qi.flushSync(()=>{T(J=>{let Q=J.findIndex(ge=>ge.id===U.id);return Q!==-1?[...J.slice(0,Q),{...J[Q],...U},...J.slice(Q+1)]:[U,...J]})})})}),[]),V.useEffect(()=>{if(d!=="system"){L(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?L("dark"):L("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:U})=>{L(U?"dark":"light")})},[d]),V.useEffect(()=>{C.length<=1&&w(!1)},[C]),V.useEffect(()=>{let U=J=>{var Q,ge;n.every(ce=>J[ce]||J.code===ce)&&(w(!0),(Q=z.current)==null||Q.focus()),J.code==="Escape"&&(document.activeElement===z.current||(ge=z.current)!=null&&ge.contains(document.activeElement))&&w(!1)};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[n]),V.useEffect(()=>{if(z.current)return()=>{N.current&&(N.current.focus({preventScroll:!0}),N.current=null,O.current=!1)}},[z.current]),C.length?V.createElement("section",{"aria-label":`${j} ${I}`,tabIndex:-1},W.map((U,J)=>{var Q;let[ge,ce]=U.split("-");return V.createElement("ol",{key:U,dir:g==="auto"?dn():g,tabIndex:-1,ref:z,className:i,"data-sonner-toaster":!0,"data-theme":P,"data-y-position":ge,"data-x-position":ce,style:{"--front-toast-height":`${((Q=D[0])==null?void 0:Q.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||Uc,"--width":`${Vc}px`,"--gap":`${b}px`,...f},onBlur:oe=>{O.current&&!oe.currentTarget.contains(oe.relatedTarget)&&(O.current=!1,N.current&&(N.current.focus({preventScroll:!0}),N.current=null))},onFocus:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||O.current||(O.current=!0,N.current=oe.relatedTarget)},onMouseEnter:()=>w(!0),onMouseMove:()=>w(!0),onMouseLeave:()=>{y||w(!1)},onPointerDown:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||E(!0)},onPointerUp:()=>E(!1)},C.filter(oe=>!oe.position&&J===0||oe.position===U).map((oe,Le)=>{var Qe,rt;return V.createElement(Jc,{key:oe.id,icons:x,index:Le,toast:oe,defaultRichColors:p,duration:(Qe=m==null?void 0:m.duration)!=null?Qe:h,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:s,visibleToasts:l,closeButton:(rt=m==null?void 0:m.closeButton)!=null?rt:o,interacting:y,position:U,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:Y,toasts:C.filter(ot=>ot.position==oe.position),heights:D.filter(ot=>ot.position==oe.position),setHeights:k,expandByDefault:r,gap:b,loadingIcon:v,expanded:H,pauseWhenPageIsHidden:_,cn:S})}))})):null};const Qc=({...t})=>{const{theme:s="system"}=kc();return e.jsx(Xc,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};function tt(t,s,{checkForDefaultPrevented:a=!0}={}){return function(r){if(t==null||t(r),a===!1||!r.defaultPrevented)return s==null?void 0:s(r)}}function un(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function $r(...t){return s=>{let a=!1;const n=t.map(r=>{const o=un(r,s);return!a&&typeof o=="function"&&(a=!0),o});if(a)return()=>{for(let r=0;r<n.length;r++){const o=n[r];typeof o=="function"?o():un(t[r],null)}}}}function _t(...t){return u.useCallback($r(...t),t)}function Fr(t,s=[]){let a=[];function n(o,i){const c=u.createContext(i),d=a.length;a=[...a,i];const p=f=>{var x;const{scope:l,children:m,...g}=f,b=((x=l==null?void 0:l[t])==null?void 0:x[d])||c,v=u.useMemo(()=>g,Object.values(g));return e.jsx(b.Provider,{value:v,children:m})};p.displayName=o+"Provider";function h(f,l){var b;const m=((b=l==null?void 0:l[t])==null?void 0:b[d])||c,g=u.useContext(m);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[p,h]}const r=()=>{const o=a.map(i=>u.createContext(i));return function(c){const d=(c==null?void 0:c[t])||o;return u.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return r.scopeName=t,[n,Zc(r,...s)]}function Zc(...t){const s=t[0];if(t.length===1)return s;const a=()=>{const n=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const i=n.reduce((c,{useScope:d,scopeName:p})=>{const f=d(o)[`__scope${p}`];return{...c,...f}},{});return u.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return a.scopeName=s.scopeName,a}function ed(t){const s=td(t),a=u.forwardRef((n,r)=>{const{children:o,...i}=n,c=u.Children.toArray(o),d=c.find(ad);if(d){const p=d.props.children,h=c.map(f=>f===d?u.Children.count(p)>1?u.Children.only(null):u.isValidElement(p)?p.props.children:null:f);return e.jsx(s,{...i,ref:r,children:u.isValidElement(p)?u.cloneElement(p,void 0,h):null})}return e.jsx(s,{...i,ref:r,children:o})});return a.displayName=`${t}.Slot`,a}function td(t){const s=u.forwardRef((a,n)=>{const{children:r,...o}=a;if(u.isValidElement(r)){const i=rd(r),c=nd(o,r.props);return r.type!==u.Fragment&&(c.ref=n?$r(n,i):i),u.cloneElement(r,c)}return u.Children.count(r)>1?u.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Wr=Symbol("radix.slottable");function sd(t){const s=({children:a})=>e.jsx(e.Fragment,{children:a});return s.displayName=`${t}.Slottable`,s.__radixId=Wr,s}function ad(t){return u.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Wr}function nd(t,s){const a={...s};for(const n in s){const r=t[n],o=s[n];/^on[A-Z]/.test(n)?r&&o?a[n]=(...c)=>{const d=o(...c);return r(...c),d}:r&&(a[n]=r):n==="style"?a[n]={...r,...o}:n==="className"&&(a[n]=[r,o].filter(Boolean).join(" "))}return{...t,...a}}function rd(t){var n,r;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var od=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],St=od.reduce((t,s)=>{const a=ed(`Primitive.${s}`),n=u.forwardRef((r,o)=>{const{asChild:i,...c}=r,d=i?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:o})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function id(t,s){t&&ja.flushSync(()=>t.dispatchEvent(s))}function Cs(t){const s=u.useRef(t);return u.useEffect(()=>{s.current=t}),u.useMemo(()=>(...a)=>{var n;return(n=s.current)==null?void 0:n.call(s,...a)},[])}function ld(t,s=globalThis==null?void 0:globalThis.document){const a=Cs(t);u.useEffect(()=>{const n=r=>{r.key==="Escape"&&a(r)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[a,s])}var cd="DismissableLayer",ia="dismissableLayer.update",dd="dismissableLayer.pointerDownOutside",ud="dismissableLayer.focusOutside",mn,zr=u.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Br=u.forwardRef((t,s)=>{const{disableOutsidePointerEvents:a=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:i,onDismiss:c,...d}=t,p=u.useContext(zr),[h,f]=u.useState(null),l=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=u.useState({}),g=_t(s,W=>f(W)),b=Array.from(p.layers),[v]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),j=h?b.indexOf(h):-1,_=p.layersWithOutsidePointerEventsDisabled.size>0,S=j>=x,C=pd(W=>{const D=W.target,k=[...p.branches].some(H=>H.contains(D));!S||k||(r==null||r(W),i==null||i(W),W.defaultPrevented||c==null||c())},l),T=xd(W=>{const D=W.target;[...p.branches].some(H=>H.contains(D))||(o==null||o(W),i==null||i(W),W.defaultPrevented||c==null||c())},l);return ld(W=>{j===p.layers.size-1&&(n==null||n(W),!W.defaultPrevented&&c&&(W.preventDefault(),c()))},l),u.useEffect(()=>{if(h)return a&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(mn=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(h)),p.layers.add(h),hn(),()=>{a&&p.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=mn)}},[h,l,a,p]),u.useEffect(()=>()=>{h&&(p.layers.delete(h),p.layersWithOutsidePointerEventsDisabled.delete(h),hn())},[h,p]),u.useEffect(()=>{const W=()=>m({});return document.addEventListener(ia,W),()=>document.removeEventListener(ia,W)},[]),e.jsx(St.div,{...d,ref:g,style:{pointerEvents:_?S?"auto":"none":void 0,...t.style},onFocusCapture:tt(t.onFocusCapture,T.onFocusCapture),onBlurCapture:tt(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:tt(t.onPointerDownCapture,C.onPointerDownCapture)})});Br.displayName=cd;var md="DismissableLayerBranch",hd=u.forwardRef((t,s)=>{const a=u.useContext(zr),n=u.useRef(null),r=_t(s,n);return u.useEffect(()=>{const o=n.current;if(o)return a.branches.add(o),()=>{a.branches.delete(o)}},[a.branches]),e.jsx(St.div,{...t,ref:r})});hd.displayName=md;function pd(t,s=globalThis==null?void 0:globalThis.document){const a=Cs(t),n=u.useRef(!1),r=u.useRef(()=>{});return u.useEffect(()=>{const o=c=>{if(c.target&&!n.current){let d=function(){Ur(dd,a,p,{discrete:!0})};const p={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",r.current),r.current=d,s.addEventListener("click",r.current,{once:!0})):d()}else s.removeEventListener("click",r.current);n.current=!1},i=window.setTimeout(()=>{s.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),s.removeEventListener("pointerdown",o),s.removeEventListener("click",r.current)}},[s,a]),{onPointerDownCapture:()=>n.current=!0}}function xd(t,s=globalThis==null?void 0:globalThis.document){const a=Cs(t),n=u.useRef(!1);return u.useEffect(()=>{const r=o=>{o.target&&!n.current&&Ur(ud,a,{originalEvent:o},{discrete:!1})};return s.addEventListener("focusin",r),()=>s.removeEventListener("focusin",r)},[s,a]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function hn(){const t=new CustomEvent(ia);document.dispatchEvent(t)}function Ur(t,s,a,{discrete:n}){const r=a.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:a});s&&r.addEventListener(t,s,{once:!0}),n?id(r,o):r.dispatchEvent(o)}var yt=globalThis!=null&&globalThis.document?u.useLayoutEffect:()=>{},fd=Jn[" useId ".trim().toString()]||(()=>{}),gd=0;function vd(t){const[s,a]=u.useState(fd());return yt(()=>{a(n=>n??String(gd++))},[t]),s?`radix-${s}`:""}var bd="Arrow",Hr=u.forwardRef((t,s)=>{const{children:a,width:n=10,height:r=5,...o}=t;return e.jsx(St.svg,{...o,ref:s,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?a:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});Hr.displayName=bd;var yd=Hr;function jd(t){const[s,a]=u.useState(void 0);return yt(()=>{if(t){a({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const o=r[0];let i,c;if("borderBoxSize"in o){const d=o.borderBoxSize,p=Array.isArray(d)?d[0]:d;i=p.inlineSize,c=p.blockSize}else i=t.offsetWidth,c=t.offsetHeight;a({width:i,height:c})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else a(void 0)},[t]),s}var Da="Popper",[Vr,Yr]=Fr(Da),[Nd,Gr]=Vr(Da),qr=t=>{const{__scopePopper:s,children:a}=t,[n,r]=u.useState(null);return e.jsx(Nd,{scope:s,anchor:n,onAnchorChange:r,children:a})};qr.displayName=Da;var Kr="PopperAnchor",Jr=u.forwardRef((t,s)=>{const{__scopePopper:a,virtualRef:n,...r}=t,o=Gr(Kr,a),i=u.useRef(null),c=_t(s,i),d=u.useRef(null);return u.useEffect(()=>{const p=d.current;d.current=(n==null?void 0:n.current)||i.current,p!==d.current&&o.onAnchorChange(d.current)}),n?null:e.jsx(St.div,{...r,ref:c})});Jr.displayName=Kr;var Ea="PopperContent",[wd,_d]=Vr(Ea),Xr=u.forwardRef((t,s)=>{var Le,Qe,rt,ot,ts,Ct;const{__scopePopper:a,side:n="bottom",sideOffset:r=0,align:o="center",alignOffset:i=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:p=[],collisionPadding:h=0,sticky:f="partial",hideWhenDetached:l=!1,updatePositionStrategy:m="optimized",onPlaced:g,...b}=t,v=Gr(Ea,a),[x,j]=u.useState(null),_=_t(s,vt=>j(vt)),[S,C]=u.useState(null),T=jd(S),W=(T==null?void 0:T.width)??0,D=(T==null?void 0:T.height)??0,k=n+(o!=="center"?"-"+o:""),H=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},w=Array.isArray(p)?p:[p],y=w.length>0,E={padding:H,boundary:w.filter(Cd),altBoundary:y},{refs:P,floatingStyles:L,placement:z,isPositioned:I,middlewareData:N}=Ci({strategy:"fixed",placement:k,whileElementsMounted:(...vt)=>Ri(...vt,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[ki({mainAxis:r+D,alignmentAxis:i}),d&&Di({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Ai():void 0,...E}),d&&Ei({...E}),Ii({...E,apply:({elements:vt,rects:Wt,availableWidth:ss,availableHeight:it})=>{const{width:Ps,height:As}=Wt.reference,je=vt.floating.style;je.setProperty("--radix-popper-available-width",`${ss}px`),je.setProperty("--radix-popper-available-height",`${it}px`),je.setProperty("--radix-popper-anchor-width",`${Ps}px`),je.setProperty("--radix-popper-anchor-height",`${As}px`)}}),S&&Ti({element:S,padding:c}),kd({arrowWidth:W,arrowHeight:D}),l&&Pi({strategy:"referenceHidden",...E})]}),[O,Y]=eo(z),U=Cs(g);yt(()=>{I&&(U==null||U())},[I,U]);const J=(Le=N.arrow)==null?void 0:Le.x,Q=(Qe=N.arrow)==null?void 0:Qe.y,ge=((rt=N.arrow)==null?void 0:rt.centerOffset)!==0,[ce,oe]=u.useState();return yt(()=>{x&&oe(window.getComputedStyle(x).zIndex)},[x]),e.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...L,transform:I?L.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(ot=N.transformOrigin)==null?void 0:ot.x,(ts=N.transformOrigin)==null?void 0:ts.y].join(" "),...((Ct=N.hide)==null?void 0:Ct.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(wd,{scope:a,placedSide:O,onArrowChange:C,arrowX:J,arrowY:Q,shouldHideArrow:ge,children:e.jsx(St.div,{"data-side":O,"data-align":Y,...b,ref:_,style:{...b.style,animation:I?void 0:"none"}})})})});Xr.displayName=Ea;var Qr="PopperArrow",Sd={top:"bottom",right:"left",bottom:"top",left:"right"},Zr=u.forwardRef(function(s,a){const{__scopePopper:n,...r}=s,o=_d(Qr,n),i=Sd[o.placedSide];return e.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:e.jsx(yd,{...r,ref:a,style:{...r.style,display:"block"}})})});Zr.displayName=Qr;function Cd(t){return t!==null}var kd=t=>({name:"transformOrigin",options:t,fn(s){var v,x,j;const{placement:a,rects:n,middlewareData:r}=s,i=((v=r.arrow)==null?void 0:v.centerOffset)!==0,c=i?0:t.arrowWidth,d=i?0:t.arrowHeight,[p,h]=eo(a),f={start:"0%",center:"50%",end:"100%"}[h],l=(((x=r.arrow)==null?void 0:x.x)??0)+c/2,m=(((j=r.arrow)==null?void 0:j.y)??0)+d/2;let g="",b="";return p==="bottom"?(g=i?f:`${l}px`,b=`${-d}px`):p==="top"?(g=i?f:`${l}px`,b=`${n.floating.height+d}px`):p==="right"?(g=`${-d}px`,b=i?f:`${m}px`):p==="left"&&(g=`${n.floating.width+d}px`,b=i?f:`${m}px`),{data:{x:g,y:b}}}});function eo(t){const[s,a="center"]=t.split("-");return[s,a]}var Dd=qr,Ed=Jr,Id=Xr,Td=Zr;function Pd(t,s){return u.useReducer((a,n)=>s[a][n]??a,t)}var to=t=>{const{present:s,children:a}=t,n=Ad(s),r=typeof a=="function"?a({present:n.isPresent}):u.Children.only(a),o=_t(n.ref,Rd(r));return typeof a=="function"||n.isPresent?u.cloneElement(r,{ref:o}):null};to.displayName="Presence";function Ad(t){const[s,a]=u.useState(),n=u.useRef(null),r=u.useRef(t),o=u.useRef("none"),i=t?"mounted":"unmounted",[c,d]=Pd(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return u.useEffect(()=>{const p=cs(n.current);o.current=c==="mounted"?p:"none"},[c]),yt(()=>{const p=n.current,h=r.current;if(h!==t){const l=o.current,m=cs(p);t?d("MOUNT"):m==="none"||(p==null?void 0:p.display)==="none"?d("UNMOUNT"):d(h&&l!==m?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,d]),yt(()=>{if(s){let p;const h=s.ownerDocument.defaultView??window,f=m=>{const b=cs(n.current).includes(CSS.escape(m.animationName));if(m.target===s&&b&&(d("ANIMATION_END"),!r.current)){const v=s.style.animationFillMode;s.style.animationFillMode="forwards",p=h.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=v)})}},l=m=>{m.target===s&&(o.current=cs(n.current))};return s.addEventListener("animationstart",l),s.addEventListener("animationcancel",f),s.addEventListener("animationend",f),()=>{h.clearTimeout(p),s.removeEventListener("animationstart",l),s.removeEventListener("animationcancel",f),s.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:u.useCallback(p=>{n.current=p?getComputedStyle(p):null,a(p)},[])}}function cs(t){return(t==null?void 0:t.animationName)||"none"}function Rd(t){var n,r;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var Md=Jn[" useInsertionEffect ".trim().toString()]||yt;function Od({prop:t,defaultProp:s,onChange:a=()=>{},caller:n}){const[r,o,i]=Ld({defaultProp:s,onChange:a}),c=t!==void 0,d=c?t:r;{const h=u.useRef(t!==void 0);u.useEffect(()=>{const f=h.current;f!==c&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,n])}const p=u.useCallback(h=>{var f;if(c){const l=$d(h)?h(t):h;l!==t&&((f=i.current)==null||f.call(i,l))}else o(h)},[c,t,o,i]);return[d,p]}function Ld({defaultProp:t,onChange:s}){const[a,n]=u.useState(t),r=u.useRef(a),o=u.useRef(s);return Md(()=>{o.current=s},[s]),u.useEffect(()=>{var i;r.current!==a&&((i=o.current)==null||i.call(o,a),r.current=a)},[a,r]),[a,n,o]}function $d(t){return typeof t=="function"}var Fd=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Wd="VisuallyHidden",so=u.forwardRef((t,s)=>e.jsx(St.span,{...t,ref:s,style:{...Fd,...t.style}}));so.displayName=Wd;var zd=so,[ks]=Fr("Tooltip",[Yr]),Ds=Yr(),ao="TooltipProvider",Bd=700,la="tooltip.open",[Ud,Ia]=ks(ao),no=t=>{const{__scopeTooltip:s,delayDuration:a=Bd,skipDelayDuration:n=300,disableHoverableContent:r=!1,children:o}=t,i=u.useRef(!0),c=u.useRef(!1),d=u.useRef(0);return u.useEffect(()=>{const p=d.current;return()=>window.clearTimeout(p)},[]),e.jsx(Ud,{scope:s,isOpenDelayedRef:i,delayDuration:a,onOpen:u.useCallback(()=>{window.clearTimeout(d.current),i.current=!1},[]),onClose:u.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:u.useCallback(p=>{c.current=p},[]),disableHoverableContent:r,children:o})};no.displayName=ao;var Kt="Tooltip",[Hd,Es]=ks(Kt),ro=t=>{const{__scopeTooltip:s,children:a,open:n,defaultOpen:r,onOpenChange:o,disableHoverableContent:i,delayDuration:c}=t,d=Ia(Kt,t.__scopeTooltip),p=Ds(s),[h,f]=u.useState(null),l=vd(),m=u.useRef(0),g=i??d.disableHoverableContent,b=c??d.delayDuration,v=u.useRef(!1),[x,j]=Od({prop:n,defaultProp:r??!1,onChange:W=>{W?(d.onOpen(),document.dispatchEvent(new CustomEvent(la))):d.onClose(),o==null||o(W)},caller:Kt}),_=u.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),S=u.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,j(!0)},[j]),C=u.useCallback(()=>{window.clearTimeout(m.current),m.current=0,j(!1)},[j]),T=u.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,j(!0),m.current=0},b)},[b,j]);return u.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),e.jsx(Dd,{...p,children:e.jsx(Hd,{scope:s,contentId:l,open:x,stateAttribute:_,trigger:h,onTriggerChange:f,onTriggerEnter:u.useCallback(()=>{d.isOpenDelayedRef.current?T():S()},[d.isOpenDelayedRef,T,S]),onTriggerLeave:u.useCallback(()=>{g?C():(window.clearTimeout(m.current),m.current=0)},[C,g]),onOpen:S,onClose:C,disableHoverableContent:g,children:a})})};ro.displayName=Kt;var ca="TooltipTrigger",oo=u.forwardRef((t,s)=>{const{__scopeTooltip:a,...n}=t,r=Es(ca,a),o=Ia(ca,a),i=Ds(a),c=u.useRef(null),d=_t(s,c,r.onTriggerChange),p=u.useRef(!1),h=u.useRef(!1),f=u.useCallback(()=>p.current=!1,[]);return u.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),e.jsx(Ed,{asChild:!0,...i,children:e.jsx(St.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...n,ref:d,onPointerMove:tt(t.onPointerMove,l=>{l.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(r.onTriggerEnter(),h.current=!0)}),onPointerLeave:tt(t.onPointerLeave,()=>{r.onTriggerLeave(),h.current=!1}),onPointerDown:tt(t.onPointerDown,()=>{r.open&&r.onClose(),p.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:tt(t.onFocus,()=>{p.current||r.onOpen()}),onBlur:tt(t.onBlur,r.onClose),onClick:tt(t.onClick,r.onClose)})})});oo.displayName=ca;var Vd="TooltipPortal",[jf,Yd]=ks(Vd,{forceMount:void 0}),Mt="TooltipContent",io=u.forwardRef((t,s)=>{const a=Yd(Mt,t.__scopeTooltip),{forceMount:n=a.forceMount,side:r="top",...o}=t,i=Es(Mt,t.__scopeTooltip);return e.jsx(to,{present:n||i.open,children:i.disableHoverableContent?e.jsx(lo,{side:r,...o,ref:s}):e.jsx(Gd,{side:r,...o,ref:s})})}),Gd=u.forwardRef((t,s)=>{const a=Es(Mt,t.__scopeTooltip),n=Ia(Mt,t.__scopeTooltip),r=u.useRef(null),o=_t(s,r),[i,c]=u.useState(null),{trigger:d,onClose:p}=a,h=r.current,{onPointerInTransitChange:f}=n,l=u.useCallback(()=>{c(null),f(!1)},[f]),m=u.useCallback((g,b)=>{const v=g.currentTarget,x={x:g.clientX,y:g.clientY},j=Qd(x,v.getBoundingClientRect()),_=Zd(x,j),S=eu(b.getBoundingClientRect()),C=su([..._,...S]);c(C),f(!0)},[f]);return u.useEffect(()=>()=>l(),[l]),u.useEffect(()=>{if(d&&h){const g=v=>m(v,h),b=v=>m(v,d);return d.addEventListener("pointerleave",g),h.addEventListener("pointerleave",b),()=>{d.removeEventListener("pointerleave",g),h.removeEventListener("pointerleave",b)}}},[d,h,m,l]),u.useEffect(()=>{if(i){const g=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},j=(d==null?void 0:d.contains(v))||(h==null?void 0:h.contains(v)),_=!tu(x,i);j?l():_&&(l(),p())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[d,h,i,p,l]),e.jsx(lo,{...t,ref:o})}),[qd,Kd]=ks(Kt,{isInside:!1}),Jd=sd("TooltipContent"),lo=u.forwardRef((t,s)=>{const{__scopeTooltip:a,children:n,"aria-label":r,onEscapeKeyDown:o,onPointerDownOutside:i,...c}=t,d=Es(Mt,a),p=Ds(a),{onClose:h}=d;return u.useEffect(()=>(document.addEventListener(la,h),()=>document.removeEventListener(la,h)),[h]),u.useEffect(()=>{if(d.trigger){const f=l=>{const m=l.target;m!=null&&m.contains(d.trigger)&&h()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,h]),e.jsx(Br,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:f=>f.preventDefault(),onDismiss:h,children:e.jsxs(Id,{"data-state":d.stateAttribute,...p,...c,ref:s,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Jd,{children:n}),e.jsx(qd,{scope:a,isInside:!0,children:e.jsx(zd,{id:d.contentId,role:"tooltip",children:r||n})})]})})});io.displayName=Mt;var co="TooltipArrow",Xd=u.forwardRef((t,s)=>{const{__scopeTooltip:a,...n}=t,r=Ds(a);return Kd(co,a).isInside?null:e.jsx(Td,{...r,...n,ref:s})});Xd.displayName=co;function Qd(t,s){const a=Math.abs(s.top-t.y),n=Math.abs(s.bottom-t.y),r=Math.abs(s.right-t.x),o=Math.abs(s.left-t.x);switch(Math.min(a,n,r,o)){case o:return"left";case r:return"right";case a:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Zd(t,s,a=5){const n=[];switch(s){case"top":n.push({x:t.x-a,y:t.y+a},{x:t.x+a,y:t.y+a});break;case"bottom":n.push({x:t.x-a,y:t.y-a},{x:t.x+a,y:t.y-a});break;case"left":n.push({x:t.x+a,y:t.y-a},{x:t.x+a,y:t.y+a});break;case"right":n.push({x:t.x-a,y:t.y-a},{x:t.x-a,y:t.y+a});break}return n}function eu(t){const{top:s,right:a,bottom:n,left:r}=t;return[{x:r,y:s},{x:a,y:s},{x:a,y:n},{x:r,y:n}]}function tu(t,s){const{x:a,y:n}=t;let r=!1;for(let o=0,i=s.length-1;o<s.length;i=o++){const c=s[o],d=s[i],p=c.x,h=c.y,f=d.x,l=d.y;h>n!=l>n&&a<(f-p)*(n-h)/(l-h)+p&&(r=!r)}return r}function su(t){const s=t.slice();return s.sort((a,n)=>a.x<n.x?-1:a.x>n.x?1:a.y<n.y?-1:a.y>n.y?1:0),au(s)}function au(t){if(t.length<=1)return t.slice();const s=[];for(let n=0;n<t.length;n++){const r=t[n];for(;s.length>=2;){const o=s[s.length-1],i=s[s.length-2];if((o.x-i.x)*(r.y-i.y)>=(o.y-i.y)*(r.x-i.x))s.pop();else break}s.push(r)}s.pop();const a=[];for(let n=t.length-1;n>=0;n--){const r=t[n];for(;a.length>=2;){const o=a[a.length-1],i=a[a.length-2];if((o.x-i.x)*(r.y-i.y)>=(o.y-i.y)*(r.x-i.x))a.pop();else break}a.push(r)}return a.pop(),s.length===1&&a.length===1&&s[0].x===a[0].x&&s[0].y===a[0].y?s:s.concat(a)}var nu=no,ru=ro,ou=oo,uo=io;const mo=nu,iu=ru,lu=ou,ho=u.forwardRef(({className:t,sideOffset:s=4,...a},n)=>e.jsx(uo,{ref:n,sideOffset:s,className:G("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));ho.displayName=uo.displayName;const A=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:G("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));A.displayName="Card";const $=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:G("flex flex-col space-y-1.5 p-6",t),...s}));$.displayName="CardHeader";const F=u.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:G("text-2xl font-semibold leading-none tracking-tight",t),...s}));F.displayName="CardTitle";const ie=u.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:G("text-sm text-muted-foreground",t),...s}));ie.displayName="CardDescription";const R=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:G("p-6 pt-0",t),...s}));R.displayName="CardContent";const cu=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:G("flex items-center p-6 pt-0",t),...s}));cu.displayName="CardFooter";const da=wt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),M=u.forwardRef(({className:t,variant:s,size:a,asChild:n=!1,...r},o)=>{const i=n?Lt:"button";return e.jsx(i,{className:G(da({variant:s,size:a,className:t})),ref:o,...r})});M.displayName="Button";const du=wt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),de=u.forwardRef(({className:t,variant:s,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:G(du({variant:s}),t),...a}));de.displayName="Alert";const uu=u.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:G("mb-1 font-medium leading-none tracking-tight",t),...s}));uu.displayName="AlertTitle";const ue=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:G("text-sm [&_p]:leading-relaxed",t),...s}));ue.displayName="AlertDescription";class mu extends u.Component{constructor(a){super(a);Os(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0}}componentDidCatch(a,n){console.error("ErrorBoundary caught an error:",a,n),this.setState({error:a,errorInfo:n})}render(){var a;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:e.jsxs(A,{className:"max-w-md w-full",children:[e.jsxs($,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(pt,{className:"h-12 w-12 text-destructive"})}),e.jsx(F,{className:"text-destructive",children:"เกิดข้อผิดพลาด"}),e.jsx(ie,{children:"ขออภัย แอปพลิเคชันเกิดข้อผิดพลาดที่ไม่คาดคิด"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(de,{variant:"destructive",children:[e.jsx(pt,{className:"h-4 w-4"}),e.jsx(ue,{children:((a=this.state.error)==null?void 0:a.message)||"Unknown error occurred"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{onClick:this.handleReset,className:"w-full",variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"ลองใหม่อีกครั้ง"]}),e.jsx(M,{onClick:()=>window.location.reload(),className:"w-full",variant:"secondary",children:"รีโหลดหน้าเว็บ"})]}),!1]})]})}):this.props.children}}const Xe=Mi,Oe=u.forwardRef(({className:t,...s},a)=>e.jsx(On,{ref:a,className:G("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));Oe.displayName=On.displayName;const K=u.forwardRef(({className:t,...s},a)=>e.jsx(Ln,{ref:a,className:G("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));K.displayName=Ln.displayName;const ee=u.forwardRef(({className:t,...s},a)=>e.jsx($n,{ref:a,className:G("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));ee.displayName=$n.displayName;const hu=wt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function te({className:t,variant:s,...a}){return e.jsx("div",{className:G(hu({variant:s}),t),...a})}const Ft=u.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:G("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s}));Ft.displayName="Textarea";var pu="Separator",pn="horizontal",xu=["horizontal","vertical"],po=u.forwardRef((t,s)=>{const{decorative:a,orientation:n=pn,...r}=t,o=fu(n)?n:pn,c=a?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(Je.div,{"data-orientation":o,...c,...r,ref:s})});po.displayName=pu;function fu(t){return xu.includes(t)}var xo=po;const _e=u.forwardRef(({className:t,orientation:s="horizontal",decorative:a=!0,...n},r)=>e.jsx(xo,{ref:r,decorative:a,orientation:s,className:G("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));_e.displayName=xo.displayName;const gu=({workflowNodes:t=[]})=>{const[s,a]=u.useState([]),[n,r]=u.useState(null),{toast:o}=fe(),i=()=>{const m=[{id:"ai-smart-router",name:"AI Smart Router (Rich Menu Compatible)",type:"ai-router",description:"รองรับ Rich Menu, Postback และ Quick Reply",replaces:t.filter(b=>b.type==="n8n-nodes-base.switch").map(b=>b.name),code:`// AI Smart Router - Rich Menu & Quick Reply Compatible
const input = $json.body?.events?.[0];
if (!input) {
  throw new Error('Invalid webhook payload: No events found');
}

// รองรับทั้ง text message, postback และ quick reply
const userMessage = input.message?.text || 
                   input.postbackData?.data || 
                   input.message?.quickReply?.postbackData?.data || 
                   input.postback?.data || '';

const userId = input.source?.userId;
const eventType = input.type; // message, postback, follow, etc.

if (!userId) {
  throw new Error('Invalid webhook payload: No userId found');
}

// ดึง LINE Profile เพื่อเอา Display Name
let displayName = "คุณ"; // default fallback
try {
  const profileResponse = await $http.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + $node.context().get("channelAccessToken")
    }
  });
  
  if (profileResponse.statusCode === 200) {
    displayName = profileResponse.body.displayName || "คุณ";
  }
} catch (error) {
  console.log("Error fetching profile:", error);
  // ใช้ fallback แทน
}

// จัดการ Rich Menu Actions และ Quick Replies
let processedMessage = userMessage;
let isRichMenuAction = false;
let dataCollected = {};

// ตรวจสอบ Postback Data จาก Rich Menu
if (input.postback?.data) {
  isRichMenuAction = true;
  console.log("Raw postback data:", input.postback.data);
  try {
    // รองรับ Postback data ในรูปแบบ JSON
    dataCollected = JSON.parse(input.postback.data);
    processedMessage = dataCollected.action || dataCollected.type || userMessage;
    console.log("Parsed postback data:", dataCollected);
    console.log("Processed message:", processedMessage);
  } catch (error) {
    // รองรับ Postback data แบบ string
    processedMessage = input.postback.data;
    console.log("String postback data:", processedMessage);
  }
}

// ตรวจสอบ datetime picker result
if (input.postback?.params?.date) {
  dataCollected.selectedDate = input.postback.params.date;
  processedMessage = 'confirm_appointment_date';
}

if (input.postback?.params?.time) {
  dataCollected.selectedTime = input.postback.params.time;
}

// AI Prompt ที่รองรับ Rich Menu และการบันทึกข้อมูล
const routingPrompt = \`คุณเป็น Smart Router สำหรับระบบจองวัคซีนที่รองรับ Rich Menu และการบันทึกข้อมูลอัตโนมัติ

Input: "\${processedMessage}"
Event Type: "\${eventType}"
Is Rich Menu Action: \${isRichMenuAction}
Collected Data: \${JSON.stringify(dataCollected)}

ส่งคืนในรูปแบบ JSON:
{
  "action": "checkin|record_appointment|hospital_info|vaccine_info|book_appointment|cancel_booking|check_status|general_info|show_rich_menu|show_vaccine_menu",
  "vaccine_type": "covid|flu|hepatitis|hpv|other",
  "intent_confidence": 0.8,
  "required_data": ["name", "phone", "vaccine_type", "date", "time", "symptoms"],
  "response_type": "rich_menu|quick_reply|datetime_picker|flex_message|confirm_template|form_input",
  "data_collection_step": "start|collecting|complete",
  "next_action": "show_menu|collect_missing_data|confirm|complete"
}

การทำงานของ Rich Menu:
- "checkin" → action: "checkin" (เช็คอิน)
- "record_appointment" → action: "record_appointment" (บันทึกนัดหมาย/ชื่อวัคซีน)
- "hospital_info" → action: "hospital_info" (ข้อมูลโรงพยาบาล)
- "show_vaccine_menu" → action: "show_vaccine_menu" (แสดงเมนูวัคซีน)
- "book_vaccine" → action: "book_appointment", vaccine_type: "covid"
- datetime selection → action: "collect_data", data_collection_step: "collecting"

การจับคู่ action:
- หาก input คือ "show_vaccine_menu" ต้องส่งคืน action: "show_vaccine_menu"
- หาก input คือ vaccine postback (pfizer, moderna, ฯลฯ) ส่งคืน action: "book_appointment"
\`;

// เตรียมข้อมูลสำหรับ HTTP Request
$json.openai_request = {
  model: 'gpt-4',
  messages: [{ role: 'user', content: routingPrompt }],
  temperature: 0.1
};

$json.userId = userId;
$json.displayName = displayName;
$json.originalInput = input;
$json.userMessage = processedMessage;
$json.eventType = eventType;
$json.isRichMenuAction = isRichMenuAction;
$json.collectedData = dataCollected;
$json.timestamp = new Date().toISOString();

return $input.all();`},{id:"dynamic-response-generator",name:"Dynamic Response Generator",type:"response-generator",description:"สร้าง response แบบ dynamic ตาม AI routing results",replaces:["Static Response Nodes"],code:`// Rich Menu Enhanced Dynamic Response Generator (Fixed)
const { routing, userId, displayName, collectedData, isRichMenuAction } = $json;

// ใช้ localStorage แทน getWorkflowStaticData เพื่อแก้ปัญหา ReferenceError
const nodeKey = 'vaccine_system_data';
let systemData = {};

try {
  // อ่านข้อมูลจาก localStorage (หรือจะใช้ database แทนได้)
  const existingData = $node.context().get(nodeKey);
  systemData = existingData || {};
} catch (e) {
  systemData = {};
}

// Database Node - สำหรับบันทึกข้อมูล  
if (!systemData.userBookings) systemData.userBookings = {};
if (!systemData.checkinRecords) systemData.checkinRecords = {};
if (!systemData.vaccineSlots) {
  systemData.vaccineSlots = {
    "2024-12-20": { available: 5, booked: 0 },
    "2024-12-21": { available: 8, booked: 0 },
    "2024-12-22": { available: 3, booked: 2 }
  };
}

// Configuration แบบ Rich Menu Compatible
const vaccineConfig = {
  "covid": {
    "info": "วัคซีนโควิด-19 ป้องกันการติดเชื้อ รุนแรง ลดการเสียชีวิต",
    "price": "ฟรี (ภาครัฐ)",
    "duration": "6 เดือน",
    "age_requirement": "6 เดือนขึ้นไป",
    "postback_data": { "action": "book_vaccine", "type": "covid" }
  },
  "flu": {
    "info": "วัคซีนไข้หวัดใหญ่ ป้องกันไข้หวัด โดยเฉพาะในกลุ่มเสี่ยง",
    "price": "800 บาท",
    "duration": "1 ปี", 
    "age_requirement": "6 เดือนขึ้นไป",
    "postback_data": { "action": "book_vaccine", "type": "flu" }
  },
  "hepatitis": {
    "info": "วัคซีนไวรัสตับอักเสบบี ป้องกันโรคตับอักเสบ",
    "price": "1,200 บาท",
    "duration": "ตลอดชีวิต",
    "age_requirement": "แรกเกิดขึ้นไป",
    "postback_data": { "action": "book_vaccine", "type": "hepatitis" }
  },
  "hpv": {
    "info": "วัคซีน HPV ป้องกันมะเร็งปากมดลูกและโรคอื่นๆ",
    "price": "3,500 บาท",
    "duration": "ตลอดชีวิต",
    "age_requirement": "9-45 ปี",
    "postback_data": { "action": "book_vaccine", "type": "hpv" }
  }
};

// สร้าง Response แบบ Rich Menu Compatible
let response = {};

switch(routing.action) {
  case 'show_rich_menu':
    // Main Rich Menu ตามที่คุณต้องการ
    response = {
      type: 'flex',
      altText: 'เมนูหลัก - บริการโรงพยาบาล',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: '🏥 ระบบบริการโรงพยาบาล',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446',
              align: 'center'
            },
            {
              type: 'text',
              text: 'เลือกบริการที่ต้องการ',
              wrap: true,
              margin: 'md',
              color: '#666666',
              align: 'center'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'box',
              layout: 'vertical',
              margin: 'xl',
              spacing: 'md',
              contents: [
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'primary',
                      color: '#1DB446',
                      action: {
                        type: 'postback',
                        label: '✅ เช็คอิน',
                        data: JSON.stringify({ action: 'checkin' })
                      }
                    }
                  ]
                },
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'secondary',
                      action: {
                        type: 'postback',
                        label: '📝 บันทึกนัดหมาย',
                        data: JSON.stringify({ action: 'record_appointment' })
                      }
                    }
                  ]
                },
                {
                  type: 'box',
                  layout: 'horizontal',
                  spacing: 'md',
                  contents: [
                    {
                      type: 'button',
                      flex: 1,
                      height: 'md',
                      style: 'secondary',
                      action: {
                        type: 'postback',
                        label: '🏥 ข้อมูลโรงพยาบาล',
                        data: JSON.stringify({ action: 'hospital_info' })
                      }
                    }
                  ]
                }
              ]
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'text',
              text: 'บริการเพิ่มเติม',
              weight: 'bold',
              margin: 'xl',
              color: '#666666'
            },
            {
              type: 'box',
              layout: 'horizontal',
              margin: 'md',
              spacing: 'sm',
              contents: [
                {
                  type: 'button',
                  flex: 1,
                  height: 'sm',
                  style: 'link',
                  action: {
                    type: 'postback',
                    label: '💉 จองวัคซีน',
                    data: JSON.stringify({ action: 'show_vaccine_menu' })
                  }
                },
                {
                  type: 'button',
                  flex: 1,
                  height: 'sm',
                  style: 'link',
                  action: {
                    type: 'postback',
                    label: '📋 ตรวจสอบการจอง',
                    data: JSON.stringify({ action: 'check_status' })
                  }
                }
              ]
            }
          ]
        }
      }
    };
    break;

  case 'show_vaccine_menu':
    // Vaccine Menu แยกต่างหาก
    response = {
      type: 'flex',
      altText: 'เมนูวัคซีน - เลือกบริการ',
      contents: {
        type: 'carousel',
        contents: Object.keys(vaccineConfig).map(vaccineType => {
          const vaccine = vaccineConfig[vaccineType];
          return {
            type: 'bubble',
            hero: {
              type: 'image',
              url: 'https://via.placeholder.com/300x200/1DB446/FFFFFF?text=' + vaccineType.toUpperCase(),
              size: 'full',
              aspectRatio: '20:13',
              aspectMode: 'cover'
            },
            body: {
              type: 'box',
              layout: 'vertical',
              contents: [
                {
                  type: 'text',
                  text: \`วัคซีน \${vaccineType.toUpperCase()}\`,
                  weight: 'bold',
                  size: 'xl',
                  color: '#1DB446'
                },
                {
                  type: 'text',
                  text: vaccine.info,
                  wrap: true,
                  margin: 'md',
                  size: 'sm'
                },
                {
                  type: 'box',
                  layout: 'vertical',
                  margin: 'lg',
                  spacing: 'sm',
                  contents: [
                    {
                      type: 'box',
                      layout: 'baseline',
                      spacing: 'sm',
                      contents: [
                        { type: 'text', text: 'ราคา', color: '#aaaaaa', size: 'sm', flex: 1 },
                        { type: 'text', text: vaccine.price, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                      ]
                    },
                    {
                      type: 'box',
                      layout: 'baseline',
                      spacing: 'sm',
                      contents: [
                        { type: 'text', text: 'ระยะเวลา', color: '#aaaaaa', size: 'sm', flex: 1 },
                        { type: 'text', text: vaccine.duration, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                      ]
                    }
                  ]
                }
              ]
            },
            footer: {
              type: 'box',
              layout: 'vertical',
              spacing: 'sm',
              contents: [
                {
                  type: 'button',
                  style: 'primary',
                  height: 'sm',
                  action: {
                    type: 'postback',
                    label: 'จองเลย',
                    data: JSON.stringify(vaccine.postback_data)
                  }
                },
                {
                  type: 'button',
                  style: 'secondary',
                  height: 'sm',
                  action: {
                    type: 'postback',
                    label: 'ดูข้อมูล',
                    data: JSON.stringify({ "action": "view_info", "type": vaccineType })
                  }
                }
              ]
            }
          };
        })
      }
    };
    break;

  case 'vaccine_info':
    const vaccineData = vaccineConfig[routing.vaccine_type];
    if (vaccineData) {
      response = {
        type: 'flex',
        altText: \`ข้อมูลวัคซีน \${routing.vaccine_type}\`,
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: \`วัคซีน \${routing.vaccine_type.toUpperCase()}\`,
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: vaccineData.info,
                wrap: true,
                margin: 'md'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'ราคา', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.price, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'อายุ', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.age_requirement, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'ระยะเวลา', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: vaccineData.duration, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'primary',
                action: {
                  type: 'postback',
                  label: 'จองวัคซีนนี้',
                  data: JSON.stringify(vaccineData.postback_data)
                }
              },
              {
                type: 'button',
                style: 'secondary',
                action: {
                  type: 'postback',
                  label: 'ดูวัคซีนอื่น',
                  data: JSON.stringify({ "action": "show_menu" })
                }
              }
            ]
          }
        }
      };
    }
    break;

  case 'book_appointment':
    // ตรวจสอบข้อมูลที่เก็บได้แล้ว
    const currentBooking = systemData.userBookings[userId] || {};
    
    if (collectedData.selectedDate) {
      // มีการเลือกวันที่แล้ว -> แสดง Time Picker
      response = {
        type: 'template',
        altText: 'เลือกเวลา',
        template: {
          type: 'buttons',
          text: \`เลือกเวลาสำหรับวันที่ \${collectedData.selectedDate}\`,
          actions: [
            {
              type: 'datetimepicker',
              label: '9:00-12:00',
              data: JSON.stringify({
                action: 'confirm_booking',
                date: collectedData.selectedDate,
                time: '09:00-12:00',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'time'
            },
            {
              type: 'datetimepicker', 
              label: '13:00-16:00',
              data: JSON.stringify({
                action: 'confirm_booking',
                date: collectedData.selectedDate,
                time: '13:00-16:00',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'time'
            },
            {
              type: 'message',
              label: 'เลือกวันใหม่',
              text: 'เลือกวันใหม่'
            }
          ]
        }
      };
    } else {
      // ยังไม่มีวันที่ -> แสดง Date Picker
      response = {
        type: 'template',
        altText: 'เลือกวันที่จอง',
        template: {
          type: 'buttons',
          text: "จองวัคซีน " + routing.vaccine_type.toUpperCase() + "\\nกรุณาเลือกวันที่",
          actions: [
            { 
              type: 'datetimepicker', 
              label: 'เลือกวันที่', 
              data: JSON.stringify({
                action: 'collect_date',
                vaccine_type: routing.vaccine_type
              }),
              mode: 'date'
            },
            { 
              type: 'postback', 
              label: 'ดูข้อมูลเพิ่ม', 
              data: JSON.stringify({
                action: 'view_info',
                type: routing.vaccine_type
              })
            },
            { 
              type: 'message', 
              label: 'ยกเลิก', 
              text: 'ยกเลิก' 
            }
          ]
        }
      };
    }
    break;

  case 'confirm_booking':
    // บันทึกข้อมูลการจอง
    if (collectedData.selectedDate && collectedData.selectedTime) {
      const bookingId = 'BK' + Date.now();
      systemData.userBookings[userId] = {
        id: bookingId,
        vaccineType: routing.vaccine_type || collectedData.vaccine_type,
        date: collectedData.selectedDate,
        time: collectedData.selectedTime,
        status: 'confirmed',
        createdAt: new Date().toISOString()
      };
      
      // Update available slots
      if (systemData.vaccineSlots[collectedData.selectedDate]) {
        systemData.vaccineSlots[collectedData.selectedDate].booked += 1;
      }
      
      response = {
        type: 'flex',
        altText: 'การจองสำเร็จ',
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: '✅ จองสำเร็จ!',
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: \`รหัสการจอง: \${bookingId}\`,
                margin: 'md',
                color: '#666666'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'วัคซีน', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: (routing.vaccine_type || collectedData.vaccine_type).toUpperCase(), wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'วันที่', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: collectedData.selectedDate, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'เวลา', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: collectedData.selectedTime, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'primary',
                action: {
                  type: 'postback',
                  label: 'ดูรายละเอียด',
                  data: JSON.stringify({ action: 'view_booking', booking_id: bookingId })
                }
              }
            ]
          }
        }
      };
    }
    break;

  case 'cancel_booking':
    const userBooking = systemData.userBookings[userId];
    if (userBooking) {
      response = {
        type: 'template',
        altText: 'ยืนยันการยกเลิก',
        template: {
          type: 'confirm',
          text: "ยกเลิกการจองรหัส " + userBooking.id + "?\\nวัคซีน: " + userBooking.vaccineType + "\\nวันที่: " + userBooking.date,
          actions: [
            {
              type: 'postback',
              label: 'ยืนยันยกเลิก',
              data: JSON.stringify({ action: 'confirm_cancel', booking_id: userBooking.id })
            },
            {
              type: 'message',
              label: 'ไม่ยกเลิก',
              text: 'ไม่ยกเลิก'
            }
          ]
        }
      };
    } else {
      response = {
        type: 'text',
        text: 'ไม่พบการจองของคุณ กรุณาตรวจสอบอีกครั้ง'
      };
    }
    break;

  case 'check_status':
    const booking = systemData.userBookings[userId];
    if (booking) {
      response = {
        type: 'flex',
        altText: 'สถานะการจอง',
        contents: {
          type: 'bubble',
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: 'สถานะการจอง',
                weight: 'bold',
                size: 'xl',
                color: '#1DB446'
              },
              {
                type: 'text',
                text: \`รหัส: \${booking.id}\`,
                margin: 'md',
                color: '#666666'
              },
              {
                type: 'separator',
                margin: 'xl'
              },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'xl',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'วัคซีน', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.vaccineType.toUpperCase(), wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'วันที่', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.date, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: 'สถานะ', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: booking.status === 'confirmed' ? '✅ ยืนยันแล้ว' : booking.status, wrap: true, color: '#666666', size: 'sm', flex: 3 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            spacing: 'sm',
            contents: [
              {
                type: 'button',
                style: 'secondary',
                action: {
                  type: 'postback',
                  label: 'ยกเลิกการจอง',
                  data: JSON.stringify({ action: 'cancel_booking' })
                }
              }
            ]
          }
        }
      };
    } else {
      response = {
        type: 'text',
        text: 'คุณยังไม่มีการจองวัคซีน กรุณาเลือกวัคซีนที่ต้องการจองจากเมนูด้านล่าง',
        quickReply: {
          items: [
            {
              type: 'action',
              action: {
                type: 'postback',
                label: 'ดูเมนูวัคซีน',
                data: JSON.stringify({ action: 'show_menu' })
              }
            }
          ]
        }
      };
    }
    break;

  case 'checkin':
    // เช็คอิน - เก็บข้อมูลการมาถึง
    const checkinId = 'CI' + Date.now();
    systemData.checkinRecords[userId] = {
      id: checkinId,
      userId: userId,
      checkinTime: new Date().toISOString(),
      status: 'checked_in',
      appointment: systemData.userBookings[userId] || null
    };
    
    response = {
      type: 'flex',
      altText: 'เช็คอินสำเร็จ',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: "✅ เช็คอินสำเร็จ " + (displayName || "คุณ") + "!",
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: \`รหัสเช็คอิน: \${checkinId}\`,
              margin: 'md',
              color: '#666666'
            },
            {
              type: 'text',
              text: \`เวลา: \${new Date().toLocaleString('th-TH')}\`,
              margin: 'sm',
              color: '#666666',
              size: 'sm'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'text',
              text: 'กรุณารอคิวและติดตามประกาศ',
              margin: 'xl',
              color: '#FF5555',
              weight: 'bold'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: 'ดูสถานะคิว',
                data: JSON.stringify({ action: 'check_queue' })
              }
            }
          ]
        }
      }
    };
    break;

  case 'record_appointment':
    // บันทึกนัดหมาย/ชื่อวัคซีน
    response = {
      type: 'flex',
      altText: 'บันทึกนัดหมาย',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: '📝 บันทึกนัดหมาย',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: 'เลือกประเภทการบันทึก',
              wrap: true,
              margin: 'md'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: 'บันทึกนัดหมายใหม่',
                data: JSON.stringify({ action: 'new_appointment_record' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: 'บันทึกชื่อวัคซีน',
                data: JSON.stringify({ action: 'record_vaccine_name' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: 'ดูประวัติการบันทึก',
                data: JSON.stringify({ action: 'view_records' })
              }
            }
          ]
        }
      }
    };
    break;

  case 'hospital_info':
    // ข้อมูลโรงพยาบาล
    response = {
      type: 'flex',
      altText: 'ข้อมูลโรงพยาบาล',
      contents: {
        type: 'bubble',
        hero: {
          type: 'image',
          url: 'https://via.placeholder.com/300x200/1DB446/FFFFFF?text=HOSPITAL',
          size: 'full',
          aspectRatio: '20:13',
          aspectMode: 'cover'
        },
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: '🏥 โรงพยาบาลเครือข่าย',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'separator',
              margin: 'xl'
            },
            {
              type: 'box',
              layout: 'vertical',
              margin: 'xl',
              spacing: 'sm',
              contents: [
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '📍', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: 'ที่อยู่', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: '123 ถนนสุขภาพ เขตดีเจ กรุงเทพฯ 10400', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '⏰', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: 'เวลา', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: 'จันทร์-ศุกร์ 8:00-20:00\\nเสาร์-อาทิตย์ 9:00-17:00', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '📞', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: 'โทร', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: '02-123-4567', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                },
                {
                  type: 'box',
                  layout: 'baseline',
                  spacing: 'sm',
                  contents: [
                    { type: 'text', text: '🚗', color: '#1DB446', size: 'sm', flex: 0 },
                    { type: 'text', text: 'จอดรถ', color: '#aaaaaa', size: 'sm', flex: 1 },
                    { type: 'text', text: 'มีที่จอดรถฟรี 200 คัน', wrap: true, color: '#666666', size: 'sm', flex: 4 }
                  ]
                }
              ]
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'uri',
                label: 'เปิดแผนที่',
                uri: 'https://maps.google.com/?q=โรงพยาบาล'
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'uri',
                label: 'โทรติดต่อ',
                uri: 'tel:021234567'
              }
            }
          ]
        }
      }
    };
    break;

  case 'general_info':
    response = {
      type: 'flex',
      altText: 'เมนูหลัก - เลือกบริการ',
      contents: {
        type: 'bubble',
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: 'ระบบจองวัคซีน 💉',
              weight: 'bold',
              size: 'xl',
              color: '#1DB446'
            },
            {
              type: 'text',
              text: 'เลือกบริการที่ต้องการ',
              wrap: true,
              margin: 'md',
              color: '#666666'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          spacing: 'sm',
          contents: [
            {
              type: 'button',
              style: 'primary',
              action: {
                type: 'postback',
                label: '✅ เช็คอิน',
                data: JSON.stringify({ action: 'checkin' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: '📝 บันทึกนัดหมาย/วัคซีน',
                data: JSON.stringify({ action: 'record_appointment' })
              }
            },
            {
              type: 'button',
              style: 'secondary',
              action: {
                type: 'postback',
                label: '🏥 ข้อมูลโรงพยาบาล',
                data: JSON.stringify({ action: 'hospital_info' })
              }
            },
            {
              type: 'button',
              style: 'link',
              action: {
                type: 'postback',
                label: 'ดูเมนูวัคซีน',
                data: JSON.stringify({ action: 'show_menu' })
              }
            }
          ]
        }
      }
    };
    break;

  default:
    response = {
      type: 'text',
      text: 'ขออภัย ไม่เข้าใจคำสั่ง กรุณาเลือกจากเมนูด้านล่าง',
      quickReply: {
        items: [
          {
            type: 'action',
            action: {
              type: 'postback',
              label: 'เมนูหลัก',
              data: JSON.stringify({ action: 'show_menu' })
            }
          }
        ]
      }
    };
}

// บันทึกข้อมูลกลับไปยัง node context
try {
  $node.context().set(nodeKey, systemData);
} catch (e) {
  console.error('Cannot save data to context:', e);
}

$json.lineResponse = response;
$json.processedBy = 'rich-menu-response-generator';
$json.savedData = systemData.userBookings[userId] || null;

return $input.all();`},{id:"context-manager",name:"Context Manager",type:"context-manager",description:"จัดการ user context และ session state",replaces:["Multiple Set Nodes"],code:`// Context Manager - จัดการ User Session (Fixed)
const { routing, userId } = $json;

// ใช้ node context แทน getWorkflowStaticData  
const nodeKey = 'user_sessions_data';
let sessionData = {};

try {
  const existingData = $node.context().get(nodeKey);
  sessionData = existingData || {};
} catch (e) {
  sessionData = {};
}

// จัดการ User Context
if (!sessionData.userSessions) sessionData.userSessions = {};
if (!sessionData.userSessions[userId]) {
  sessionData.userSessions[userId] = {
    currentFlow: null,
    data: {},
    history: [],
    preferences: {},
    lastActivity: new Date().toISOString()
  };
}

const userSession = sessionData.userSessions[userId];

// Update Context based on AI Routing
switch(routing.action) {
  case 'book_appointment':
    userSession.currentFlow = 'booking';
    userSession.data.vaccineType = routing.vaccine_type;
    userSession.data.step = 'select_date';
    userSession.data.confidence = routing.intent_confidence;
    break;
    
  case 'cancel_booking':
    userSession.currentFlow = 'cancellation';
    userSession.data.step = 'confirm_cancel';
    break;
    
  case 'vaccine_info':
    userSession.currentFlow = 'information';
    userSession.data.viewedVaccines = userSession.data.viewedVaccines || [];
    if (!userSession.data.viewedVaccines.includes(routing.vaccine_type)) {
      userSession.data.viewedVaccines.push(routing.vaccine_type);
    }
    break;
    
  case 'check_status':
    userSession.currentFlow = 'status_check';
    break;
}

// เก็บประวัติ (เก็บ 10 รายการล่าสุด)
userSession.history.push({
  input: $json.originalInput,
  routing: routing,
  timestamp: new Date().toISOString(),
  confidence: routing.intent_confidence
});

if (userSession.history.length > 10) {
  userSession.history = userSession.history.slice(-10);
}

// Update last activity
userSession.lastActivity = new Date().toISOString();

// ตรวจสอบและทำความสะอาด old sessions (เก็บ 24 ชั่วโมง)
const now = new Date();
Object.keys(sessionData.userSessions).forEach(sessionUserId => {
  const session = sessionData.userSessions[sessionUserId];
  const lastActivity = new Date(session.lastActivity);
  const hoursDiff = (now.getTime() - lastActivity.getTime()) / (1000 * 60 * 60);
  
  if (hoursDiff > 24) {
    delete sessionData.userSessions[sessionUserId];
  }
});

// Set user preferences based on behavior
if (userSession.history.length >= 3) {
  const recentActions = userSession.history.slice(-3).map(h => h.routing.action);
  const mostCommonAction = recentActions.reduce((a, b, _, arr) => 
    arr.filter(v => v === a).length >= arr.filter(v => v === b).length ? a : b
  );
  userSession.preferences.preferredAction = mostCommonAction;
}

// Determine next action
let nextAction = 'continue';
if (routing.action === 'book_appointment' && routing.intent_confidence < 0.6) {
  nextAction = 'clarify_vaccine_type';
} else if (routing.action === 'general_info' && routing.intent_confidence < 0.5) {
  nextAction = 'show_menu';
} else if (userSession.currentFlow === 'booking' && userSession.data.step === 'select_date') {
  nextAction = 'handle_date_selection';
}

// บันทึกข้อมูล session กลับไปยัง context
try {
  $node.context().set(nodeKey, sessionData);
} catch (e) {
  console.error('Cannot save session data:', e);
}

$json.userSession = userSession;
$json.nextAction = nextAction;
$json.sessionStats = {
  totalUsers: Object.keys(sessionData.userSessions).length,
  currentUserHistory: userSession.history.length,
  userPreferences: userSession.preferences
};

return $input.all();`}],g={name:"Smart Routing Vaccine Booking Workflow (HTTP Version)",nodes:[{parameters:{httpMethod:"POST",path:"vaccine-webhook",options:{}},id:"webhook-node",name:"Webhook",type:"n8n-nodes-base.webhook",typeVersion:1,position:[240,300],webhookId:"webhook-id"},{parameters:{jsCode:m[0].code},id:"input-processor-node",name:"Input Processor",type:"n8n-nodes-base.code",typeVersion:2,position:[460,300]},{parameters:{url:"https://api.openai.com/v1/chat/completions",method:"POST",authentication:"predefinedCredentialType",nodeCredentialType:"openAiApi",headers:{"Content-Type":"application/json"},body:"={{ JSON.stringify($json.openai_request) }}",options:{timeout:15e3,response:{response:{neverError:!0,responseFormat:"json"}},redirect:{redirect:{followRedirect:!1,maxRedirect:0}}}},id:"openai-http-node",name:"OpenAI HTTP Request (with Credentials)",type:"n8n-nodes-base.httpRequest",typeVersion:4,position:[680,300]},{parameters:{jsCode:`// AI Response Processor with Robust Error Handling
try {
  const httpResponse = $json;
  let routing = {};
  
  // ตรวจสอบ HTTP status และ response structure
  if (httpResponse.statusCode && httpResponse.statusCode !== 200) {
    console.warn('OpenAI API returned non-200 status:', httpResponse.statusCode);
    throw new Error(\`API returned status: \${httpResponse.statusCode}\`);
  }
  
  // ตรวจสอบ response structure
  if (!httpResponse.choices || !httpResponse.choices[0] || !httpResponse.choices[0].message) {
    throw new Error('Invalid OpenAI API response format');
  }
  
  // Parse AI response with validation
  try {
    routing = JSON.parse(httpResponse.choices[0].message.content);
  } catch (parseError) {
    // ถ้า JSON ไม่ถูกต้อง ใช้ fallback
    routing = {
      action: 'general_info',
      vaccine_type: 'covid',
      intent_confidence: 0.3,
      required_data: [],
      response_type: 'text'
    };
  }
  
  // Validate routing object
  if (!routing.action) {
    routing.action = 'general_info';
  }
  if (!routing.intent_confidence || routing.intent_confidence < 0 || routing.intent_confidence > 1) {
    routing.intent_confidence = 0.5;
  }
  
  // Combine with previous data
  $json.routing = routing;
  $json.userId = $('Input Processor').item.json.userId;
  $json.originalInput = $('Input Processor').item.json.originalInput;
  $json.userMessage = $('Input Processor').item.json.userMessage;
  $json.timestamp = $('Input Processor').item.json.timestamp;
  $json.apiSuccess = true;
  
} catch (error) {
  // Error handling - ใช้ fallback routing
  console.error('OpenAI API Error:', error);
  
  $json.routing = {
    action: 'general_info',
    vaccine_type: 'covid',
    intent_confidence: 0.2,
    required_data: [],
    response_type: 'text',
    error: true
  };
  $json.userId = $('Input Processor').item.json.userId;
  $json.originalInput = $('Input Processor').item.json.originalInput;
  $json.userMessage = $('Input Processor').item.json.userMessage;
  $json.timestamp = $('Input Processor').item.json.timestamp;
  $json.apiSuccess = false;
  $json.errorMessage = error.message;
}

return $input.all();`},id:"ai-response-processor-node",name:"AI Response Processor",type:"n8n-nodes-base.code",typeVersion:2,position:[900,300]},{parameters:{jsCode:m[2].code},id:"context-manager-node",name:"Context Manager",type:"n8n-nodes-base.code",typeVersion:2,position:[1120,300]},{parameters:{jsCode:m[1].code},id:"response-generator-node",name:"Dynamic Response Generator",type:"n8n-nodes-base.code",typeVersion:2,position:[1340,300]},{parameters:{authentication:"lineNotifyOAuth2Api",resource:"message",operation:"send",message:"={{ $json.lineResponse }}"},id:"line-response-node",name:"LINE Response",type:"n8n-nodes-base.line",typeVersion:1,position:[1560,300]}],connections:{Webhook:{main:[[{node:"Input Processor",type:"main",index:0}]]},"Input Processor":{main:[[{node:"OpenAI HTTP Request (with Credentials)",type:"main",index:0}]]},"OpenAI HTTP Request (with Credentials)":{main:[[{node:"AI Response Processor",type:"main",index:0}]]},"AI Response Processor":{main:[[{node:"Context Manager",type:"main",index:0}]]},"Context Manager":{main:[[{node:"Dynamic Response Generator",type:"main",index:0}]]},"Dynamic Response Generator":{main:[[{node:"LINE Response",type:"main",index:0}]]}},active:!1,settings:{executionOrder:"v1"},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),id:"smart-routing-workflow-http",tags:[]};m.forEach(b=>{b.workflowJSON=g}),a(m)},c=async(l,m)=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(l);else{const g=document.createElement("textarea");g.value=l,g.style.position="fixed",g.style.left="-999999px",g.style.top="-999999px",document.body.appendChild(g),g.focus(),g.select(),document.execCommand("copy"),g.remove()}r(m),setTimeout(()=>r(null),2e3),o({title:"คัดลอกสำเร็จ",description:"โค้ดถูกคัดลอกไปยัง clipboard แล้ว"})}catch(g){console.error("Failed to copy: ",g),o({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถคัดลอกได้ กรุณาลองใช้ปุ่มดาวน์โหลดแทน",variant:"destructive"})}},d=(l,m)=>{const g=new Blob([l],{type:"text/javascript"}),b=URL.createObjectURL(g),v=document.createElement("a");v.href=b,v.download=`${m}.js`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(b)},p=l=>{const m=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),g=URL.createObjectURL(m),b=document.createElement("a");b.href=g,b.download="smart-routing-workflow.json",document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(g),o({title:"ดาวน์โหลดสำเร็จ",description:"ไฟล์ workflow JSON ถูกดาวน์โหลดแล้ว สามารถ import เข้า n8n ได้เลย"})},h=l=>{switch(l){case"ai-router":return e.jsx(qt,{className:"w-4 h-4"});case"response-generator":return e.jsx(ea,{className:"w-4 h-4"});case"context-manager":return e.jsx(Ce,{className:"w-4 h-4"});default:return e.jsx(Zi,{className:"w-4 h-4"})}},f=l=>{switch(l){case"ai-router":return"bg-blue-500";case"response-generator":return"bg-green-500";case"context-manager":return"bg-purple-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Smart Routing Generator"]}),e.jsx(ie,{children:"สร้างโค้ด AI Smart Routing เพื่อแทนที่ Switch nodes และปรับปรุงประสิทธิภาพ workflow"})]}),e.jsx(R,{children:t.length===0?e.jsx(de,{children:e.jsx(ue,{children:"กรุณาวิเคราะห์ workflow ก่อนเพื่อดู nodes ที่สามารถแทนที่ด้วย Smart Routing ได้"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["พบ ",t.filter(l=>l.type==="n8n-nodes-base.switch").length," Switch nodes ที่สามารถแทนที่ได้"]})}),e.jsxs(M,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(ea,{className:"w-4 h-4"}),"สร้าง Smart Routing"]})]}),s.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(de,{className:"border-green-200 bg-green-50",children:[e.jsx(Z,{className:"w-4 h-4 text-green-600"}),e.jsx(ue,{className:"text-green-700",children:"สร้าง Smart Routing สำเร็จ! ดาวน์โหลด Workflow JSON เพื่อ import เข้า n8n โดยตรง"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{onClick:()=>p(s[0].workflowJSON),className:"flex items-center gap-2",variant:"default",children:[e.jsx(Qi,{className:"w-4 h-4"}),"ดาวน์โหลด Complete Workflow (JSON)"]}),e.jsxs(M,{onClick:()=>c(JSON.stringify(s[0].workflowJSON,null,2),"workflow-json"),variant:"outline",className:"flex items-center gap-2",children:[n==="workflow-json"?e.jsx(Z,{className:"w-4 h-4"}):e.jsx(qe,{className:"w-4 h-4"}),n==="workflow-json"?"คัดลอกแล้ว":"คัดลอก JSON"]})]})]})]})})]}),s.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:s.map(l=>e.jsxs(A,{className:"border-l-4",style:{borderLeftColor:f(l.type).replace("bg-","")},children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-md text-white ${f(l.type)}`,children:h(l.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{className:"text-lg",children:l.name}),e.jsx(ie,{className:"text-sm mt-1",children:l.description})]})]})}),e.jsxs(R,{className:"pt-0 space-y-3",children:[l.replaces.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"แทนที่:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.replaces.map((m,g)=>e.jsx(te,{variant:"outline",className:"text-xs",children:m},g))})]}),e.jsx(_e,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"font-medium text-sm",children:"Code สำหรับ n8n:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>c(l.code,l.id),className:"flex items-center gap-1",children:[n===l.id?e.jsx(Z,{className:"w-3 h-3"}):e.jsx(qe,{className:"w-3 h-3"}),n===l.id?"คัดลอกแล้ว":"คัดลอก"]}),e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>d(l.code,l.id),className:"flex items-center gap-1",children:[e.jsx(Rt,{className:"w-3 h-3"}),"ดาวน์โหลด"]})]})]}),e.jsx(Ft,{value:l.code,readOnly:!0,className:"font-mono text-xs h-32 bg-muted"})]})]})]},l.id))}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5"}),"วิธีใช้งาน Smart Routing"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"1. เตรียม Environment Variables"}),e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsx("code",{className:"text-sm",children:"OPENAI_API_KEY=your_openai_api_key"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"2. สร้าง Code Nodes"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:'• สร้าง Code node ชื่อ "AI Smart Router"'}),e.jsx("li",{children:'• สร้าง Code node ชื่อ "Dynamic Response Generator"'}),e.jsx("li",{children:'• สร้าง Code node ชื่อ "Context Manager"'})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"3. เชื่อมต่อกับ Nodes เดิม"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Smart Router → Database Nodes เดิม"}),e.jsx("li",{children:"• Response Generator → LINE Response เดิม"}),e.jsx("li",{children:"• Context Manager → HTTP Request เดิม"}),e.jsx("li",{children:"• ใช้ Merge Node เพื่อรวม flow เดิมและใหม่"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"4. ลบ Switch Nodes เก่า"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• ลบ Switch nodes ที่ไม่ใช้แล้ว"}),e.jsx("li",{children:"• ลบ Static response nodes"}),e.jsx("li",{children:"• ทดสอบ workflow ใหม่"})]})]})]}),e.jsxs(de,{children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"Integration กับ Flow เดิม:"})," สามารถเชื่อมต่อกับ Database, HTTP Request, และ LINE nodes เดิมได้ทั้งหมด โดยใช้ Merge Node หรือแทนที่ Switch nodes โดยตรง"]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-md",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔄 วิธี Migration ที่แนะนำ:"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("li",{children:["1. ",e.jsx("strong",{children:"Backup"})," workflow เดิมก่อน"]}),e.jsxs("li",{children:["2. ",e.jsx("strong",{children:"Import"})," Smart Routing workflow ใหม่"]}),e.jsxs("li",{children:["3. ",e.jsx("strong",{children:"Test"})," ใน development environment"]}),e.jsxs("li",{children:["4. ",e.jsx("strong",{children:"Connect"})," กับ nodes เดิมทีละส่วน"]}),e.jsxs("li",{children:["5. ",e.jsx("strong",{children:"Remove"})," Switch nodes เดิมเมื่อแน่ใจแล้ว"]})]})]})]})]})]})]})},vu=()=>{const[t,s]=u.useState(null),[a,n]=u.useState([]),[r,o]=u.useState(""),[i,c]=u.useState(!1),d=m=>{const g=[],b=new Set(m.nodes.map(D=>D.id)),v=new Set;Object.entries(m.connections).forEach(([D,k])=>{k.main&&k.main.forEach((H,w)=>{Array.isArray(H)&&H.forEach(y=>{v.add(D),v.add(y.node),b.has(y.node)||g.push({type:"error",title:"Connection ชี้ไปยัง Node ที่ไม่มีอยู่",description:`Node "${D}" พยายามเชื่อมต่อไปยัง node "${y.node}" ที่ไม่มีอยู่ใน workflow`,nodeId:D,solution:"ตรวจสอบและแก้ไข connection ที่เสียหายหรือลบ node ที่ไม่ใช้แล้ว"})})})}),m.nodes.forEach(D=>{!v.has(D.id)&&D.type!=="n8n-nodes-base.webhook"&&g.push({type:"warning",title:"Node แยกตัวออกมา (Isolated)",description:`Node "${D.name}" (${D.id}) ไม่ได้เชื่อมต่อกับ node อื่นใด`,nodeId:D.id,solution:"เชื่อมต่อ node นี้เข้ากับ workflow หรือลบออกหากไม่ต้องการใช้"})});const x=m.nodes.filter(D=>D.type==="n8n-nodes-base.webhook"),j=m.nodes.filter(D=>D.type==="n8n-nodes-base.switch"),_=m.nodes.filter(D=>D.type==="n8n-nodes-base.httpRequest");j.forEach(D=>{var H,w,y,E,P,L,z;const k=m.connections[D.id];if(k&&k.main){k.main.filter(O=>O&&O.length>0).length;const I=((y=(w=(H=D.parameters)==null?void 0:H.conditions)==null?void 0:w.conditions)==null?void 0:y.length)||((L=(P=(E=D.parameters)==null?void 0:E.rules)==null?void 0:P.rules)==null?void 0:L.length)||0;!(k.main.length>I&&((z=k.main[k.main.length-1])==null?void 0:z.length)>0)&&I>0&&g.push({type:"warning",title:"Switch Node ไม่มี Fallback Path",description:`Switch node "${D.name}" มี ${I} เงื่อนไข แต่ไม่มี fallback path สำหรับกรณีที่ไม่ตรงเงื่อนไขใดๆ`,nodeId:D.id,solution:"เพิ่ม fallback path โดยเชื่อมต่อ output ท้ายสุดของ Switch node เพื่อจัดการกรณีที่ไม่ตรงเงื่อนไข"})}}),_.forEach(D=>{var y,E,P,L,z,I,N;const k=m.connections[D.id],H=(k==null?void 0:k.main)&&k.main.length>1&&((y=k.main[1])==null?void 0:y.length)>0,w=((P=(E=D.parameters)==null?void 0:E.url)==null?void 0:P.includes("api.line.me"))||((z=(L=D.parameters)==null?void 0:L.url)==null?void 0:z.includes("openai.com"))||((I=D.name)==null?void 0:I.toLowerCase().includes("line"))||((N=D.name)==null?void 0:N.toLowerCase().includes("ai"));H||g.push({type:w?"error":"warning",title:"HTTP Request ไม่มี Error Handling",description:`HTTP node "${D.name}" ${w?"(Critical API)":""} ไม่มีการจัดการ error กรณีที่ request ล้มเหลว`,nodeId:D.id,solution:"เพิ่ม error output และเชื่อมต่อไปยัง error handling nodes เช่น Set node สำหรับ log หรือ HTTP node สำหรับส่งการแจ้งเตือน"})});const S=x.length>0,C=m.nodes.filter(D=>{var k,H;return D.name.toLowerCase().includes("line")||D.type==="n8n-nodes-base.httpRequest"&&((H=(k=D.parameters)==null?void 0:k.url)==null?void 0:H.includes("api.line.me"))});return S&&C.length===0&&g.push({type:"error",title:"ไม่พบ LINE Response Node",description:"Chatbot workflow ควรมี node สำหรับตอบกลับข้อความผ่าน LINE API",solution:"เพิ่ม HTTP Request node ที่เรียก https://api.line.me/v2/bot/message/reply พร้อม reply token และข้อความที่ต้องการส่ง"}),C.forEach(D=>{var H,w,y,E;((w=(H=D.parameters)==null?void 0:H.bodyParametersJson)==null?void 0:w.includes("replyToken"))||((E=(y=D.parameters)==null?void 0:y.body)==null?void 0:E.includes("replyToken"))||JSON.stringify(D.parameters).includes("replyToken")||g.push({type:"error",title:"LINE Node ไม่มี Reply Token",description:`LINE response node "${D.name}" ไม่ได้ใช้ reply token ที่ได้จาก webhook`,nodeId:D.id,solution:'ใช้ reply token จาก webhook data ในรูปแบบ {{ $json["events"][0]["replyToken"] }}'})}),m.nodes.filter(D=>D.type.includes("langchain")||D.type.includes("openai")||D.name.toLowerCase().includes("ai")||D.name.toLowerCase().includes("gpt")).forEach(D=>{var w,y,E,P,L,z;((w=D.parameters)==null?void 0:w.prompt)||((y=D.parameters)==null?void 0:y.text)||((E=D.parameters)==null?void 0:E.message)||g.push({type:"warning",title:"AI Agent ไม่มี Prompt",description:`AI node "${D.name}" ไม่ได้กำหนด prompt หรือ instruction ที่ชัดเจน`,nodeId:D.id,solution:"กำหนด prompt ที่ชัดเจน รวมถึง role, context และ instruction สำหรับ AI Agent"}),!(((P=D.parameters)==null?void 0:P.apiKey)||D.credentials||((L=D.parameters)==null?void 0:L.authentication)||((z=D.parameters)==null?void 0:z.model))&&(D.type.includes("openai")||D.type.includes("langchain"))&&g.push({type:"error",title:"AI Agent ไม่มี API Key",description:`AI node "${D.name}" ไม่ได้กำหนด API key หรือ credentials สำหรับการเชื่อมต่อ AI service`,nodeId:D.id,solution:"กำหนด API key ผ่าน credentials หรือ parameters ของ node ให้ตรงกับ AI service ที่ใช้"})}),m.nodes.filter(D=>D.type==="n8n-nodes-base.googleSheets").forEach(D=>{var k;(k=D.parameters)!=null&&k.documentId||g.push({type:"error",title:"Google Sheets ไม่ได้กำหนด Document ID",description:`Google Sheets node "${D.name}" ไม่ได้ระบุ spreadsheet ที่ต้องการใช้`,nodeId:D.id,solution:"กำหนด Google Sheets document ID และ sheet name ที่ถูกต้อง"})}),g},p=()=>{c(!0);try{const m=JSON.parse(r);s(m);const g=d(m);n(g)}catch{n([{type:"error",title:"JSON Format ไม่ถูกต้อง",description:"ไม่สามารถ parse JSON ได้ กรุณาตรวจสอบรูปแบบ JSON",solution:"ตรวจสอบ syntax JSON ให้ถูกต้อง เช่น การใช้ comma, brackets และ quotes"}])}c(!1)},h=m=>m.includes("webhook")?e.jsx(mt,{className:"w-4 h-4"}):m.includes("switch")?e.jsx(Ce,{className:"w-4 h-4"}):m.includes("langchain")?e.jsx(ea,{className:"w-4 h-4"}):m.includes("httpRequest")?e.jsx(mt,{className:"w-4 h-4"}):m.includes("googleSheets")?e.jsx(Tt,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"}),f=m=>m.includes("webhook")?"bg-node-webhook":m.includes("switch")?"bg-node-switch":m.includes("langchain")?"bg-node-ai":m.includes("httpRequest")?"bg-node-http":m.includes("googleSheets")?"bg-node-function":"bg-muted",l=m=>{switch(m){case"error":return e.jsx(Ht,{className:"w-4 h-4 text-workflow-error"});case"warning":return e.jsx(pt,{className:"w-4 h-4 text-workflow-warning"});case"info":return e.jsx(el,{className:"w-4 h-4 text-workflow-info"});default:return e.jsx(Z,{className:"w-4 h-4 text-workflow-success"})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-workflow-primary to-workflow-info bg-clip-text text-transparent",children:"n8n Workflow Analyzer"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"วิเคราะห์และตรวจสอบข้อผิดพลาดใน n8n workflow ของคุณ พร้อมคำแนะนำการแก้ไขแบบละเอียด"})]}),e.jsxs(A,{className:"shadow-workflow",children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5"}),"อัพโหลด Workflow JSON"]}),e.jsx(ie,{children:"วางโค้ด JSON ของ n8n workflow ที่ต้องการวิเคราะห์"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsx(Ft,{placeholder:"วาง n8n workflow JSON ที่นี่...",value:r,onChange:m=>o(m.target.value),className:"min-h-[200px] font-mono text-sm"}),e.jsx(M,{onClick:p,disabled:!r.trim()||i,className:"w-full",children:i?"กำลังวิเคราะห์...":"วิเคราะห์ Workflow"})]})]}),t&&e.jsxs(Xe,{defaultValue:"issues",className:"space-y-4",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-4",children:[e.jsxs(K,{value:"issues",children:["ปัญหาที่พบ (",a.length,")"]}),e.jsx(K,{value:"overview",children:"ภาพรวม เวิร์คโฟลว์"}),e.jsx(K,{value:"smart-routing",children:"Smart Routing"}),e.jsx(K,{value:"troubleshooting",children:"คู่มือแก้ไข"})]}),e.jsx(ee,{value:"issues",className:"space-y-4",children:a.length===0?e.jsxs(de,{className:"border-workflow-success",children:[e.jsx(Z,{className:"w-4 h-4 text-workflow-success"}),e.jsx(ue,{className:"text-workflow-success",children:"ไม่พบปัญหาสำคัญใน workflow นี้ แต่ควรตรวจสอบการทำงานจริงด้วยการทดสอบ"})]}):e.jsx("div",{className:"space-y-4",children:a.map((m,g)=>e.jsxs(A,{className:`border-l-4 ${m.type==="error"?"border-l-workflow-error":m.type==="warning"?"border-l-workflow-warning":"border-l-workflow-info"}`,children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[l(m.type),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{className:"text-lg",children:m.title}),m.nodeId&&e.jsxs(te,{variant:"outline",className:"mt-1",children:["Node: ",m.nodeId.slice(0,8),"..."]})]}),e.jsx(te,{variant:m.type==="error"?"destructive":m.type==="warning"?"secondary":"default",children:m.type==="error"?"ข้อผิดพลาด":m.type==="warning"?"คำเตือน":"ข้อมูล"})]})}),e.jsxs(R,{className:"pt-0 space-y-3",children:[e.jsx("p",{className:"text-muted-foreground",children:m.description}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-workflow-primary",children:"💡 วิธีแก้ไข:"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded-md",children:m.solution})]})]})]},g))})}),e.jsxs(ee,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(A,{children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-sm",children:"จำนวน Nodes"})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-primary",children:t.nodes.length})})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-sm",children:"การเชื่อมต่อ"})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-info",children:Object.keys(t.connections).length})})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-sm",children:"ข้อผิดพลาด"})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-error",children:a.filter(m=>m.type==="error").length})})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-sm",children:"คำเตือน"})}),e.jsx(R,{children:e.jsx("div",{className:"text-2xl font-bold text-workflow-warning",children:a.filter(m=>m.type==="warning").length})})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{children:"รายการ Nodes"})}),e.jsx(R,{children:e.jsx("div",{className:"space-y-2",children:t.nodes.map(m=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-md ${f(m.type)}`,children:h(m.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.type})]}),e.jsxs(te,{variant:"outline",className:"font-mono text-xs",children:[m.id.slice(0,8),"..."]})]},m.id))})})]})]}),e.jsx(ee,{value:"smart-routing",className:"space-y-4",children:e.jsx(gu,{workflowNodes:(t==null?void 0:t.nodes)||[]})}),e.jsx(ee,{value:"troubleshooting",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5"}),"คู่มือแก้ไขปัญหาแบบละเอียด"]}),e.jsx(ie,{children:"แนวทางแก้ไขปัญหาทีละขั้นตอนสำหรับปัญหาที่พบใน workflow นี้"})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[a.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ปัญหาที่พบใน workflow ของคุณ และวิธีแก้ไขที่แนะนำ:"}),a.map((m,g)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l(m.type),e.jsx("h4",{className:"font-semibold",children:m.title})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"💡 วิธีแก้ไข:"}),e.jsx("p",{className:"text-sm",children:m.solution})]}),m.nodeId&&e.jsxs(te,{variant:"outline",className:"text-xs",children:["Node: ",m.nodeId.slice(0,8),"..."]})]},g))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold text-green-700",children:"Workflow ไม่มีปัญหา!"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"ไม่พบปัญหาสำคัญใน workflow นี้ แต่ควรทดสอบการทำงานจริงอีกครั้ง"})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"📋 Checklist การตรวจสอบเพิ่มเติม:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"ทดสอบ workflow ด้วยข้อมูลจริง"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"ตรวจสอบ API keys และ credentials"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"ทดสอบ error scenarios"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"ตรวจสอบ performance และ rate limits"})]})]})]})]})})]})})]})]})},bu=()=>{const[t,s]=u.useState("overview"),{toast:a}=fe(),n=[{id:"webhook",name:"LINE Webhook",type:"trigger",description:"รับข้อความจาก LINE Bot พร้อม Rich Menu",implementation:`// Webhook Configuration
HTTP POST: https://your-n8n.domain/webhook/line-bot
Method: POST
Content-Type: application/json

// Rich Menu Configuration
{
  "areas": [
    {
      "bounds": {"x": 0, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback",
        "data": "{\\"action\\":\\"register\\"}",
        "displayText": "ลงทะเบียนคนไข้"
      }
    },
    {
      "bounds": {"x": 834, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback", 
        "data": "{\\"action\\":\\"show_vaccine_menu\\"}",
        "displayText": "จองวัคซีน"
      }
    },
    {
      "bounds": {"x": 1667, "y": 0, "width": 833, "height": 843},
      "action": {
        "type": "postback",
        "data": "{\\"action\\":\\"check_booking\\"}",
        "displayText": "ตรวจสอบการจอง"
      }
    }
  ]
}`,connections:["user-validator"],icon:mt,color:"bg-blue-500"},{id:"user-validator",name:"User Data Validator",type:"logic",description:"ตรวจสอบข้อมูลผู้ใช้และดึง LINE Profile",implementation:`// User Validation และ Profile Fetching
const input = $json.body?.events?.[0];
const userId = input?.source?.userId;
const eventType = input?.type;

if (!userId) {
  throw new Error('Invalid webhook: No userId found');
}

// ✅ ใช้ Environment Variables แทน context
const CHANNEL_ACCESS_TOKEN = process.env.LINE_CHANNEL_ACCESS_TOKEN;
const SPREADSHEET_ID = process.env.GOOGLE_SPREADSHEET_ID;
const GOOGLE_ACCESS_TOKEN = process.env.GOOGLE_ACCESS_TOKEN;

// ดึง LINE Profile
let userProfile = null;
try {
  const profileResponse = await $http.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + CHANNEL_ACCESS_TOKEN
    }
  });
  
  userProfile = profileResponse.body;
} catch (error) {
  console.log("Profile fetch error:", error);
  userProfile = { displayName: "ผู้ใช้", userId: userId };
}

// Helper function ตรวจสอบผู้ใช้ใน Google Sheets
async function checkUserInSheets(userId, spreadsheetId, accessToken) {
  const response = await $http.request({
    method: 'GET',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${spreadsheetId}/values/Users:A:G\`,
    headers: {
      'Authorization': 'Bearer ' + accessToken
    }
  });
  
  const rows = response.body.values || [];
  
  for (let i = 1; i < rows.length; i++) {
    if (rows[i][0] === userId) {
      return {
        exists: true,
        row: i + 1,
        data: {
          userId: rows[i][0],
          name: rows[i][1],
          phone: rows[i][2],
          email: rows[i][3],
          dateOfBirth: rows[i][4],
          address: rows[i][5],
          emergencyContact: rows[i][6]
        }
      };
    }
  }
  
  return { exists: false };
}

const existingUser = await checkUserInSheets(userId, SPREADSHEET_ID, GOOGLE_ACCESS_TOKEN);

$json.userId = userId;
$json.userProfile = userProfile;
$json.existingUser = existingUser;
$json.input = input;
$json.timestamp = new Date().toISOString();

return $input.all();`,connections:["smart-router"],icon:Se,color:"bg-green-500"},{id:"smart-router",name:"AI Smart Router",type:"logic",description:"วิเคราะห์ intent และเส้นทางการทำงาน",implementation:`// AI Smart Router with Rich Menu Support
const { input, userProfile, existingUser } = $json;

let action = 'unknown';
let collectedData = {};

// ตรวจสอบ Postback Data
if (input.postback?.data) {
  try {
    const postbackData = JSON.parse(input.postback.data);
    action = postbackData.action;
    collectedData = postbackData;
  } catch {
    action = input.postback.data;
  }
}

// ตรวจสอบ text message
const userMessage = input.message?.text || '';

// AI Routing Logic
const routingPrompt = \`
คุณเป็น Smart Router สำหรับระบบจองวัคซีน
Input: "\${userMessage}"
Action: "\${action}"
User Profile: \${JSON.stringify(userProfile)}
Existing User: \${!!existingUser}

ส่งคืน JSON:
{
  "route": "register|vaccine_menu|booking|status_check|appointment_reminder",
  "vaccine_type": "covid|flu|hepatitis|hpv|other",
  "required_fields": ["name", "phone", "id_card", "vaccine_type", "date", "time"],
  "next_step": "collect_data|show_calendar|confirm|complete",
  "is_returning_user": \${!!existingUser}
}
\`;

// OpenAI Request
$json.openai_request = {
  model: 'gpt-4',
  messages: [{ role: 'user', content: routingPrompt }],
  temperature: 0.1
};

$json.action = action;
$json.userMessage = userMessage;
$json.collectedData = collectedData;

return $input.all();`,connections:["user-registration","vaccine-booking"],icon:Ce,color:"bg-purple-500"},{id:"user-registration",name:"User Registration",type:"action",description:"ลงทะเบียนผู้ใช้ใหม่และเก็บข้อมูล",implementation:`// User Registration Process
const { userProfile, routing } = $json;

if (routing.route === 'register') {
  // สร้างข้อมูลผู้ใช้ใหม่
  const userData = {
    userId: userProfile.userId,
    displayName: userProfile.displayName,
    pictureUrl: userProfile.pictureUrl || '',
    registeredAt: new Date().toISOString(),
    status: 'active',
    vaccineHistory: [],
    appointments: []
  };

  // บันทึกใน Google Sheets
  const sheetData = [
    userData.userId,
    userData.displayName,
    userData.pictureUrl,
    userData.registeredAt,
    userData.status,
    '[]', // vaccineHistory
    '[]'  // appointments
  ];

  await saveToGoogleSheets('Users', sheetData);

  // Response ข้อความ
  $json.response = {
    type: 'text',
    text: \`สวัสดีคุณ \${userData.displayName}! 🎉
    
ยินดีต้อนรับสู่ระบบจองวัคซีนออนไลน์

✅ ลงทะเบียนเรียบร้อยแล้ว
📱 สามารถใช้เมนูด้านล่างเพื่อเลือกบริการ
💉 พร้อมจองวัคซีนได้ทันที

กดที่เมนู "จองวัคซีน" เพื่อเริ่มต้น\`
  };

  $json.userData = userData;
}

return $input.all();`,connections:["response-sender"],icon:We,color:"bg-teal-500"},{id:"vaccine-booking",name:"Vaccine Booking System",type:"action",description:"ระบบจองวัคซีนพร้อมการนัดหมาย",implementation:`// Vaccine Booking with Multi-dose Support
const { routing, userProfile, collectedData } = $json;

const vaccineTypes = {
  covid: { doses: 2, interval: 21, name: 'โควิด-19' },
  flu: { doses: 1, interval: 0, name: 'ไข้หวัดใหญ่' },
  hepatitis: { doses: 3, interval: 30, name: 'ไวรัสตับอักเสบบี' },
  hpv: { doses: 2, interval: 60, name: 'HPV' }
};

if (routing.route === 'vaccine_menu') {
  // แสดงเมนูวัคซีน
  $json.response = {
    type: 'flex',
    altText: 'เมนูวัคซีน',
    contents: {
      type: 'carousel',
      contents: Object.keys(vaccineTypes).map(type => ({
        type: 'bubble',
        hero: {
          type: 'image',
          url: \`https://via.placeholder.com/300x200/42A5F5/FFFFFF?text=\${vaccineTypes[type].name}\`,
          size: 'full'
        },
        body: {
          type: 'box',
          layout: 'vertical',
          contents: [
            {
              type: 'text',
              text: vaccineTypes[type].name,
              weight: 'bold',
              size: 'xl'
            },
            {
              type: 'text',
              text: \`จำนวนโดส: \${vaccineTypes[type].doses}\`,
              margin: 'md'
            }
          ]
        },
        footer: {
          type: 'box',
          layout: 'vertical',
          contents: [{
            type: 'button',
            action: {
              type: 'postback',
              label: 'จองเลย',
              data: JSON.stringify({ 
                action: 'book_vaccine', 
                vaccine_type: type 
              })
            }
          }]
        }
      }))
    }
  };
}

if (routing.route === 'booking' && collectedData.vaccine_type) {
  const vaccine = vaccineTypes[collectedData.vaccine_type];
  
  // สร้างนัดหมาย
  const appointment = {
    appointmentId: generateId(),
    userId: userProfile.userId,
    vaccineType: collectedData.vaccine_type,
    vaccineName: vaccine.name,
    doseNumber: 1,
    totalDoses: vaccine.doses,
    appointmentDate: collectedData.date,
    appointmentTime: collectedData.time,
    status: 'confirmed',
    createdAt: new Date().toISOString()
  };

  // คำนวณนัดครั้งถัดไป (ถ้ามี)
  if (vaccine.doses > 1) {
    const nextDate = new Date(collectedData.date);
    nextDate.setDate(nextDate.getDate() + vaccine.interval);
    appointment.nextAppointment = nextDate.toISOString().split('T')[0];
  }

  // บันทึกใน Google Sheets
  await saveAppointmentToSheets(appointment);

  $json.appointment = appointment;
  $json.response = {
    type: 'text',
    text: \`✅ จองวัคซีนเรียบร้อย!

📋 รายละเอียดการจอง:
🏥 วัคซีน: \${vaccine.name}
💉 โดสที่: 1/\${vaccine.doses}
📅 วันที่: \${collectedData.date}
⏰ เวลา: \${collectedData.time}

\${vaccine.doses > 1 ? \`📌 นัดครั้งถัดไป: \${appointment.nextAppointment}\` : ''}

💾 ข้อมูลถูกบันทึกแล้ว
🔔 จะแจ้งเตือนก่อนวันนัด 1 วัน\`
  };
}

return $input.all();`,connections:["calendar-scheduler","response-sender"],icon:we,color:"bg-red-500"},{id:"calendar-scheduler",name:"Google Calendar Scheduler",type:"calendar",description:"สร้างนัดหมายใน Google Calendar พร้อมระบบแจ้งเตือนอัตโนมัติ",implementation:`// Google Calendar Integration with Auto Reminders
const { appointment } = $json;

if (appointment) {
  // กำหนดค่า Google Calendar
  const CALENDAR_ID = 'primary'; // หรือ calendar ID ที่ต้องการ
  
  // สร้าง Event ใน Google Calendar
  const eventData = {
    summary: \`วัคซีน \${appointment.vaccineName} - โดสที่ \${appointment.doseNumber}/\${appointment.totalDoses}\`,
    description: \`📋 รายละเอียดการนัดฉีดวัคซีน
    
👤 ผู้ป่วย: \${appointment.userProfile?.displayName || 'ไม่ระบุ'}
💉 วัคซีน: \${appointment.vaccineName}
📊 โดสที่: \${appointment.doseNumber} จาก \${appointment.totalDoses} โดส
📱 LINE User ID: \${appointment.userId}
🆔 Appointment ID: \${appointment.appointmentId}

⚠️ หมายเหตุ: กรุณาให้ผู้ป่วยมาตรงเวลา
\${appointment.nextAppointment ? \`📅 นัดครั้งถัดไป: \${appointment.nextAppointment}\` : ''}\`,
    
    start: {
      dateTime: \`\${appointment.appointmentDate}T\${appointment.appointmentTime}:00+07:00\`,
      timeZone: 'Asia/Bangkok'
    },
    end: {
      dateTime: \`\${appointment.appointmentDate}T\${String(parseInt(appointment.appointmentTime.split(':')[0]) + 1).padStart(2, '0')}:\${appointment.appointmentTime.split(':')[1]}:00+07:00\`,
      timeZone: 'Asia/Bangkok'
    },
    
    // ตั้งค่าการแจ้งเตือน
    reminders: {
      useDefault: false,
      overrides: [
        { method: 'email', minutes: 24 * 60 }, // 1 วันก่อน
        { method: 'popup', minutes: 60 },      // 1 ชั่วโมงก่อน
        { method: 'email', minutes: 30 }       // 30 นาทีก่อน
      ]
    },
    
    // เพิ่ม Attendee
    attendees: [
      {
        email: 'vaccine.admin@hospital.com',
        displayName: 'Vaccine Administrator',
        responseStatus: 'accepted'
      }
    ],
    
    // กำหนดสถานะ
    status: 'confirmed',
    transparency: 'opaque',
    visibility: 'private',
    
    // Extended Properties สำหรับการติดตาม
    extendedProperties: {
      private: {
        lineUserId: appointment.userId,
        appointmentId: appointment.appointmentId,
        vaccineType: appointment.vaccineType,
        doseNumber: appointment.doseNumber.toString(),
        totalDoses: appointment.totalDoses.toString(),
        isVaccineAppointment: 'true'
      }
    }
  };

  // สร้าง Event ใน Google Calendar
  const calendarResponse = await $http.request({
    method: 'POST',
    url: \`https://www.googleapis.com/calendar/v3/calendars/\${CALENDAR_ID}/events\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: eventData
  });

  // บันทึก Event ID สำหรับการจัดการในอนาคต
  const calendarEvent = calendarResponse.body;
  appointment.calendarEventId = calendarEvent.id;
  appointment.calendarEventUrl = calendarEvent.htmlLink;

  // สร้าง Scheduled Reminder ใน n8n (ใช้ Cron Trigger)
  const reminderDate = new Date(appointment.appointmentDate);
  reminderDate.setDate(reminderDate.getDate() - 1); // 1 วันก่อน
  reminderDate.setHours(9, 0, 0, 0); // เวลา 9:00 น.

  const reminderData = {
    reminderId: generateId(),
    scheduledFor: reminderDate.toISOString(),
    userId: appointment.userId,
    appointmentId: appointment.appointmentId,
    calendarEventId: calendarEvent.id,
    message: \`🔔 แจ้งเตือนการนัดฉีดวัคซีน

พรุ่งนี้ (\${appointment.appointmentDate}) คุณมีนัดฉีดวัคซีน:

💉 วัคซีน: \${appointment.vaccineName}
📊 โดสที่: \${appointment.doseNumber}/\${appointment.totalDoses}
⏰ เวลา: \${appointment.appointmentTime} น.
📍 สถานที่: โรงพยาบาล/คลินิก

✅ สิ่งที่ต้องเตรียม:
• บัตรประชาชน
• บัตรประกันสุขภาพ (ถ้ามี)
• หน้ากากอนามัย

⚠️ หากไม่สามารถมาได้ กรุณาแจ้งล่วงหน้า 24 ชั่วโมง
📱 กดเมนู "ตรวจสอบการจอง" เพื่อดูรายละเอียด\`,
    type: 'appointment_reminder',
    status: 'pending'
  };

  // บันทึก Reminder Schedule
  await saveReminderToSheets(reminderData);

  // ถ้ามีโดสถัดไป ให้สร้าง Event สำหรับโดสถัดไป (แบบ Tentative)
  if (appointment.nextAppointment) {
    const nextEventData = {
      ...eventData,
      summary: \`วัคซีน \${appointment.vaccineName} - โดสที่ \${appointment.doseNumber + 1}/\${appointment.totalDoses} (ขั้นต้น)\`,
      description: \`📋 นัดฉีดโดสถัดไป (รอยืนยัน)
      
👤 ผู้ป่วย: \${appointment.userProfile?.displayName || 'ไม่ระบุ'}
💉 วัคซีน: \${appointment.vaccineName}
📊 โดสที่: \${appointment.doseNumber + 1} จาก \${appointment.totalDoses} โดส
⏰ สถานะ: รอยืนยันการจอง

📱 ระบบจะแจ้งเตือนให้จองเวลาที่แน่นอน\`,
      start: {
        dateTime: \`\${appointment.nextAppointment}T09:00:00+07:00\`,
        timeZone: 'Asia/Bangkok'
      },
      end: {
        dateTime: \`\${appointment.nextAppointment}T10:00:00+07:00\`,
        timeZone: 'Asia/Bangkok'
      },
      status: 'tentative', // สถานะไม่แน่นอน
      transparency: 'transparent'
    };

    const nextCalendarResponse = await $http.request({
      method: 'POST',
      url: \`https://www.googleapis.com/calendar/v3/calendars/\${CALENDAR_ID}/events\`,
      headers: {
        'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
        'Content-Type': 'application/json'
      },
      body: nextEventData
    });

    // สร้าง Reminder สำหรับโดสถัดไป
    const nextReminderDate = new Date(appointment.nextAppointment);
    nextReminderDate.setDate(nextReminderDate.getDate() - 7); // 1 สัปดาห์ก่อน
    nextReminderDate.setHours(10, 0, 0, 0);

    const nextReminderData = {
      reminderId: generateId(),
      scheduledFor: nextReminderDate.toISOString(),
      userId: appointment.userId,
      appointmentId: appointment.appointmentId,
      relatedAppointmentId: appointment.appointmentId,
      calendarEventId: nextCalendarResponse.body.id,
      message: \`🔔 แจ้งเตือนโดสวัคซีนถัดไป

อีก 1 สัปดาห์ถึงเวลานัดโดสถัดไป!

💉 วัคซีน: \${appointment.vaccineName}
📊 โดสที่: \${appointment.doseNumber + 1}/\${appointment.totalDoses}
📅 วันที่แนะนำ: \${appointment.nextAppointment}

📱 กรุณาจองเวลาที่แน่นอนผ่านเมนู "จองวัคซีน"
⚠️ ไม่ควรล่าช้าเกินวันที่แนะนำ\`,
      type: 'next_dose_reminder',
      status: 'pending'
    };

    await saveReminderToSheets(nextReminderData);
    
    appointment.nextCalendarEventId = nextCalendarResponse.body.id;
  }

  // อัปเดตข้อมูล appointment ด้วย Calendar Event IDs
  await updateAppointmentInSheets(appointment);

  $json.calendarEvent = calendarEvent;
  $json.reminderScheduled = true;
  $json.calendarCreated = true;
}

// Helper Functions
function generateId() {
  return Math.random().toString(36).substr(2, 9) + Date.now().toString(36);
}

async function saveReminderToSheets(reminderData) {
  const sheetData = [
    reminderData.reminderId,
    reminderData.scheduledFor,
    reminderData.userId,
    reminderData.appointmentId,
    reminderData.calendarEventId || '',
    reminderData.message,
    reminderData.type,
    reminderData.status,
    new Date().toISOString()
  ];

  return await $http.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${SPREADSHEET_ID}/values/Reminders:append\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [sheetData],
      valueInputOption: 'RAW'
    }
  });
}

async function updateAppointmentInSheets(appointment) {
  // อัปเดตข้อมูล appointment ด้วย calendar event IDs
  // ใช้ Google Sheets API เพื่ออัปเดตแถวที่ตรงกับ appointmentId
}

return $input.all();`,connections:["google-sheets"],icon:ve,color:"bg-orange-500"},{id:"google-sheets",name:"Google Sheets Database",type:"data",description:"จัดเก็บข้อมูลทั้งหมดใน Google Sheets",implementation:`// Google Sheets Database Management
const SPREADSHEET_ID = 'your-spreadsheet-id';

// Sheets Structure:
// 1. Users: userId, displayName, pictureUrl, registeredAt, status, vaccineHistory, appointments
// 2. Appointments: appointmentId, userId, vaccineType, doseNumber, totalDoses, date, time, status, createdAt
// 3. Reminders: reminderId, userId, appointmentId, scheduledFor, message, type, sent
// 4. VaccineHistory: historyId, userId, vaccineType, vaccineName, doseNumber, date, location, batch

async function saveToGoogleSheets(sheetName, data) {
  const response = await $http.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${SPREADSHEET_ID}/values/\${sheetName}:append\`,
    headers: {
      'Authorization': 'Bearer ' + GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [data],
      valueInputOption: 'RAW'
    }
  });
  
  return response.body;
}


// Auto-backup and data integrity
const backupData = {
  timestamp: new Date().toISOString(),
  totalUsers: await countRows('Users'),
  totalAppointments: await countRows('Appointments'),
  pendingReminders: await countPendingReminders()
};

$json.backupInfo = backupData;
$json.dataOperation = 'success';

return $input.all();`,connections:["response-sender"],icon:Tt,color:"bg-indigo-500"},{id:"response-sender",name:"LINE Response Handler",type:"action",description:"ส่งข้อความตอบกลับผ่าน LINE API",implementation:`// LINE Response Handler
const { response, input } = $json;
const replyToken = input.replyToken;

if (!replyToken) {
  throw new Error('No reply token found');
}

// ส่งข้อความผ่าน LINE API
const lineResponse = await $http.request({
  method: 'POST',
  url: 'https://api.line.me/v2/bot/message/reply',
  headers: {
    'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
    'Content-Type': 'application/json'
  },
  body: {
    replyToken: replyToken,
    messages: [response]
  }
});

// Log การส่งข้อความ
await logActivity({
  userId: $json.userId,
  action: 'message_sent',
  response: response,
  timestamp: new Date().toISOString()
});

$json.messageSent = true;
$json.lineResponse = lineResponse.body;

return $input.all();`,connections:[],icon:mt,color:"bg-green-600"}],r=()=>{const h={name:"ระบบจองวัคซีนครบวงจร",nodes:n.map((f,l)=>({id:f.id,name:f.name,type:o(f.type),typeVersion:1,position:[100+l%3*300,100+Math.floor(l/3)*200],parameters:i(f)})),connections:c(),active:!0,settings:{timezone:"Asia/Bangkok"}};return JSON.stringify(h,null,2)},o=h=>{switch(h){case"trigger":return"n8n-nodes-base.webhook";case"logic":return"n8n-nodes-base.code";case"action":return"n8n-nodes-base.httpRequest";case"data":return"n8n-nodes-base.googleSheets";case"calendar":return"n8n-nodes-base.googleCalendar";default:return"n8n-nodes-base.code"}},i=h=>h.type==="trigger"?{httpMethod:"POST",path:"line-vaccine-bot",responseMode:"respondImmediately"}:h.type==="logic"||h.type==="action"?{mode:"runOnceForAllItems",jsCode:h.implementation}:{},c=()=>{const h={},f=n.reduce((l,m)=>(l[m.id]=m.name,l),{});return n.forEach(l=>{l.connections.length>0&&(h[l.name]={main:[l.connections.map(m=>({node:f[m]||m,type:"main",index:0}))]})}),h},d=h=>{navigator.clipboard.writeText(h),a({title:"คัดลอกแล้ว",description:"โค้ดถูกคัดลอกไปยัง clipboard แล้ว"})},p=()=>{const h=r(),f=new Blob([h],{type:"application/json"}),l=URL.createObjectURL(f),m=document.createElement("a");m.href=l,m.download="vaccine-booking-workflow.json",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(l)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:"🏥 ระบบจองวัคซีนครบวงจร"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Workflow สมบูรณ์สำหรับระบบจองวัคซีน พร้อมการลงทะเบียน, นัดหมาย, และการแจ้งเตือนอัตโนมัติ"})]}),e.jsxs(Xe,{value:t,onValueChange:s,className:"space-y-4",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-5",children:[e.jsx(K,{value:"overview",children:"ภาพรวม"}),e.jsx(K,{value:"workflow",children:"โครงสร้าง"}),e.jsx(K,{value:"features",children:"คุณสมบัติ"}),e.jsx(K,{value:"implementation",children:"การติดตั้ง"}),e.jsx(K,{value:"export",children:"Export"})]}),e.jsxs(ee,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-4 text-teal-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"ลงทะเบียนผู้ใช้"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"ระบบลงทะเบียนอัตโนมัติด้วย LINE Profile"})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(we,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"จองวัคซีน"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"จองวัคซีนแบบ Multi-dose พร้อมนัดครั้งถัดไป"})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(Ae,{className:"w-12 h-12 mx-auto mb-4 text-orange-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"แจ้งเตือน"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"แจ้งเตือนอัตโนมัติก่อนวันนัด 1 วัน"})]})}),e.jsx(A,{className:"text-center",children:e.jsxs(R,{className:"p-6",children:[e.jsx(Tt,{className:"w-12 h-12 mx-auto mb-4 text-indigo-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"จัดเก็บข้อมูล"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"บันทึกใน Google Sheets แบบ Real-time"})]})})]}),e.jsxs(de,{children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"ความสมบูรณ์ 100%:"})," ระบบนี้ครอบคลุมทุกความต้องการที่คุณระบุ พร้อมใช้งานได้ทันที"]})]})]}),e.jsx(ee,{value:"workflow",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:n.map((h,f)=>{const l=h.icon;return e.jsxs(A,{className:"relative",children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${h.color} text-white`,children:e.jsx(l,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{className:"text-lg",children:h.name}),e.jsx(ie,{children:h.description})]}),e.jsx(te,{variant:h.type==="trigger"?"default":h.type==="logic"?"secondary":h.type==="action"?"destructive":"outline",children:h.type.toUpperCase()})]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"การทำงาน:"}),e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>d(h.implementation),children:e.jsx(qe,{className:"w-4 h-4"})})]}),e.jsxs("pre",{className:"text-xs overflow-x-auto whitespace-pre-wrap",children:[h.implementation.substring(0,200),"..."]})]}),h.connections.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(st,{className:"w-4 h-4"}),e.jsxs("span",{children:["เชื่อมต่อไปยัง: ",h.connections.join(", ")]})]})]})]},h.id)})})}),e.jsx(ee,{value:"features",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"w-5 h-5"}),"Rich Menu & UX"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Rich Menu 3 ปุ่มหลัก"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Carousel วัคซีนแยกประเภท"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Quick Reply สะดวกรวดเร็ว"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Datetime Picker เลือกวันเวลา"})]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"w-5 h-5"}),"การจัดเก็บข้อมูล"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Users Sheet - ข้อมูลผู้ใช้"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Appointments - การนัดหมาย"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Reminders - การแจ้งเตือน"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"VaccineHistory - ประวัติการฉีด"})]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5"}),"ระบบวัคซีน"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"โควิด-19 (2 โดส, ห่าง 21 วัน)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"ไข้หวัดใหญ่ (1 โดส)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"ไวรัสตับอักเสบบี (3 โดส)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"HPV (2 โดส, ห่าง 60 วัน)"})]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"การแจ้งเตือน"]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"แจ้งเตือนก่อนนัด 1 วัน"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"แจ้งเตือนโดสถัดไป"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Cron Schedule อัตโนมัติ"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"การยกเลิก/เลื่อนนัด"})]})]})]})]})}),e.jsx(ee,{value:"implementation",className:"space-y-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsx(F,{children:"ขั้นตอนการติดตั้ง"}),e.jsx(ie,{children:"คำแนะนำการติดตั้งและกำหนดค่าระบบ"})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"สร้าง LINE Bot"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"สร้าง LINE Bot ใน LINE Developers Console และได้ Channel Access Token"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ตั้งค่า Google Sheets"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"สร้าง Google Sheets พร้อม 4 Sheets: Users, Appointments, Reminders, VaccineHistory"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Import Workflow"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Import ไฟล์ JSON ลงใน n8n และกำหนดค่า credentials"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ติดตั้ง Rich Menu"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"อัปโหลด Rich Menu ไปยัง LINE Bot ด้วย API หรือ Console"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold",children:"5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ทดสอบระบบ"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ทดสอบการทำงานทุกฟีเจอร์ และปรับแต่งตามความต้องการ"})]})]})]}),e.jsx(_e,{}),e.jsxs(de,{children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"สำคัญ:"})," ต้องกำหนดค่า credentials สำหรับ LINE API, Google Sheets API และ OpenAI API ให้ครบถ้วน"]})]})]})]})}),e.jsxs(ee,{value:"export",className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs($,{children:[e.jsx(F,{children:"ดาวน์โหลด Workflow"}),e.jsx(ie,{children:"ดาวน์โหลดไฟล์ JSON ของ workflow เพื่อ import ใน n8n"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(M,{onClick:p,className:"flex-1",children:[e.jsx(Rt,{className:"w-4 h-4 mr-2"}),"ดาวน์โหลด JSON"]}),e.jsxs(M,{variant:"outline",onClick:()=>d(r()),className:"flex-1",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"คัดลอก JSON"]})]}),e.jsxs(de,{children:[e.jsx(fs,{className:"w-4 h-4"}),e.jsx(ue,{children:"ไฟล์ JSON นี้พร้อมใช้งาน ครอบคลุมทุกฟีเจอร์ตามที่คุณต้องการ รวมถึงการจัดการข้อผิดพลาดและ error handling"})]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{children:"คุณสมบัติพิเศษ"})}),e.jsx(R,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"🚀 Performance"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Async/Await pattern"}),e.jsx("li",{children:"• Error handling ครอบคลุม"}),e.jsx("li",{children:"• Connection pooling"}),e.jsx("li",{children:"• Rate limiting support"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"🔒 Security"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Token validation"}),e.jsx("li",{children:"• Data sanitization"}),e.jsx("li",{children:"• API rate limiting"}),e.jsx("li",{children:"• Access logging"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"📊 Analytics"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• User behavior tracking"}),e.jsx("li",{children:"• Appointment statistics"}),e.jsx("li",{children:"• Conversion metrics"}),e.jsx("li",{children:"• Performance monitoring"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"🔧 Maintenance"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Auto backup"}),e.jsx("li",{children:"• Health checks"}),e.jsx("li",{children:"• Log management"}),e.jsx("li",{children:"• Update mechanisms"})]})]})]})})]})]})]})]})},se=u.forwardRef(({className:t,type:s,...a},n)=>e.jsx("input",{type:s,className:G("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...a}));se.displayName="Input";var yu="Label",fo=u.forwardRef((t,s)=>e.jsx(Je.label,{...t,ref:s,onMouseDown:a=>{var r;a.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));fo.displayName=yu;var go=fo;const ju=wt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),q=u.forwardRef(({className:t,...s},a)=>e.jsx(go,{ref:a,className:G(ju(),t),...s}));q.displayName=go.displayName;const ft=zi,gt=Bi,at=u.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Fn,{ref:n,className:G("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(Oi,{asChild:!0,children:e.jsx(Zn,{className:"h-4 w-4 opacity-50"})})]}));at.displayName=Fn.displayName;const vo=u.forwardRef(({className:t,...s},a)=>e.jsx(Wn,{ref:a,className:G("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(tl,{className:"h-4 w-4"})}));vo.displayName=Wn.displayName;const bo=u.forwardRef(({className:t,...s},a)=>e.jsx(zn,{ref:a,className:G("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Zn,{className:"h-4 w-4"})}));bo.displayName=zn.displayName;const nt=u.forwardRef(({className:t,children:s,position:a="popper",...n},r)=>e.jsx(Li,{children:e.jsxs(Bn,{ref:r,className:G("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[e.jsx(vo,{}),e.jsx($i,{className:G("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(bo,{})]})}));nt.displayName=Bn.displayName;const Nu=u.forwardRef(({className:t,...s},a)=>e.jsx(Un,{ref:a,className:G("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));Nu.displayName=Un.displayName;const Ne=u.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Hn,{ref:n,className:G("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Fi,{children:e.jsx(er,{className:"h-4 w-4"})})}),e.jsx(Wi,{children:s})]}));Ne.displayName=Hn.displayName;const wu=u.forwardRef(({className:t,...s},a)=>e.jsx(Vn,{ref:a,className:G("-mx-1 my-1 h-px bg-muted",t),...s}));wu.displayName=Vn.displayName;const _u=()=>{const[t,s]=u.useState("patients"),[a,n]=u.useState([]),[r,o]=u.useState([]),[i,c]=u.useState(""),[d,p]=u.useState(null),[h,f]=u.useState(!1),{toast:l}=fe(),m=[{id:"flu",name:"วัคซีนไข้หวัดใหญ่",doses:2,interval:365,description:"วัคซีนป้องกันไข้หวัดใหญ่ประจำปี และฉีดกระตุ้นปีหน้า",available:!0},{id:"hep_b",name:"วัคซีนไวรัสตับอักเสบบี",doses:3,interval:30,description:"ฉีด 3 โดส: โดส 1, โดส 2 (1 เดือน), โดส 3 (6 เดือน)",available:!0},{id:"tetanus",name:"วัคซีนป้องกันบาดทะยัก",doses:3,interval:30,description:"ฉีด 3 โดส: โดส 1, โดส 2 (1 เดือน), โดส 3 (หลังจากโดส 2 อีก 6 เดือน)",available:!0},{id:"shingles",name:"วัคซีนงูสวัด",doses:2,interval:90,description:"ฉีด 2 โดส ห่างกัน 3 เดือน",available:!0},{id:"hpv",name:"วัคซีนป้องกันมะเร็งปากมดลูก",doses:3,interval:30,description:"ฉีด 3 โดส: โดส 1, โดส 2 (1 เดือน), โดส 3 (6 เดือน)",available:!0},{id:"pneumonia",name:"วัคซีนปอดอักเสบ",doses:2,interval:60,description:"ฉีด 2 โดส ห่างกัน 2 เดือน",available:!0},{id:"chickenpox",name:"วัคซีนอีสุกอีใส",doses:2,interval:30,description:"ฉีด 2 โดส ห่างกัน 1 เดือน",available:!0},{id:"rabies",name:"วัคซีนพิษสุนัขบ้า",doses:5,interval:3,description:"ฉีด 5 เข็ม: วันแรก, วันที่ 3, วันที่ 7, วันที่ 14, วันที่ 28",available:!0}];u.useEffect(()=>{const x=[{id:"1",lineUserId:"U1234567890",displayName:"สมชาย ใจดี",firstName:"สมชาย",lastName:"ใจดี",phone:"081-234-5678",registeredAt:"2024-01-15T10:30:00",status:"pending"},{id:"2",lineUserId:"U2345678901",displayName:"สมหญิง รักดี",firstName:"สมหญิง",lastName:"รักดี",phone:"082-345-6789",registeredAt:"2024-01-16T14:20:00",status:"pending"},{id:"3",lineUserId:"U3456789012",displayName:"วิชัย เก่งมาก",firstName:"วิชัย",lastName:"เก่งมาก",registeredAt:"2024-01-17T09:15:00",status:"completed"}],j=[{id:"apt-1",patientId:"3",patientName:"วิชัย เก่งมาก",vaccineId:"covid-19",vaccineName:"วัคซีนโควิด-19",doseNumber:1,totalDoses:2,appointmentDate:"2024-01-20",appointmentTime:"10:00",status:"completed",notes:"ฉีดเรียบร้อย ไม่มีผลข้างเคียง",createdAt:"2024-01-17T09:30:00",staffId:"staff-001"}];n(x),o(j)},[]);const g=a.filter(x=>{var j;return x.displayName.toLowerCase().includes(i.toLowerCase())||((j=x.phone)==null?void 0:j.includes(i))}),b=x=>{var _,S;if(!d)return;const j={id:`apt-${Date.now()}`,patientId:d.id,patientName:d.displayName,vaccineId:x.vaccineId,vaccineName:((_=m.find(C=>C.id===x.vaccineId))==null?void 0:_.name)||"",doseNumber:1,totalDoses:((S=m.find(C=>C.id===x.vaccineId))==null?void 0:S.doses)||1,appointmentDate:x.date,appointmentTime:x.time,status:"scheduled",notes:x.notes,createdAt:new Date().toISOString(),staffId:"staff-001"};o(C=>[...C,j]),f(!1),p(null),v(d,j),l({title:"สร้างนัดหมายสำเร็จ",description:`นัดหมายสำหรับ ${d.displayName} ถูกสร้างเรียบร้อยแล้ว`})},v=(x,j)=>{console.log("Sending LINE notification:",{to:x.lineUserId,message:`🎉 การนัดหมายของคุณถูกยืนยันแล้ว!

📋 รายละเอียดการนัด:
💉 วัคซีน: ${j.vaccineName}
📅 วันที่: ${j.appointmentDate}
⏰ เวลา: ${j.appointmentTime}
🏥 โดสที่: ${j.doseNumber}/${j.totalDoses}

⚠️ กรุณามาตรงเวลา
📞 หากมีปัญหาโทร: 02-xxx-xxxx`}),l({title:"ส่งการแจ้งเตือนแล้ว",description:`ส่งข้อความยืนยันการนัดไปยัง LINE ของ ${x.displayName} เรียบร้อยแล้ว`})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"ระบบจัดการวัคซีน - เจ้าหน้าที่"}),e.jsx("p",{className:"text-muted-foreground",children:"จัดการคนไข้ วัคซีน และการนัดหมาย"})]}),e.jsxs(Xe,{value:t,onValueChange:s,className:"w-full",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-4 max-w-2xl",children:[e.jsxs(K,{value:"patients",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"คนไข้"]}),e.jsxs(K,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"นัดหมาย"]}),e.jsxs(K,{value:"vaccines",className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"วัคซีน"]}),e.jsxs(K,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"แจ้งเตือน"]})]}),e.jsx(ee,{value:"patients",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"รายชื่อคนไข้ที่ลงทะเบียนผ่าน LINE"]}),e.jsx(ie,{children:"คนไข้ที่ลงทะเบียนชื่อ-นามสกุลผ่าน LINE Bot รอการจัดการ"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"ค้นหาชื่อหรือเบอร์โทร...",value:i,onChange:x=>c(x.target.value),className:"pl-10"})]})})]}),e.jsx(R,{children:e.jsx("div",{className:"grid gap-4",children:g.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(sl,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:x.displayName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x.phone||"ไม่มีเบอร์โทร"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ลงทะเบียนเมื่อ: ",new Date(x.registeredAt).toLocaleString("th-TH")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{variant:x.status==="completed"?"default":"secondary",children:x.status==="pending"?"รอดำเนินการ":x.status==="completed"?"เสร็จสิ้น":"ยกเลิก"}),e.jsxs(M,{onClick:()=>{p(x),f(!0)},size:"sm",className:"flex items-center gap-2",children:[e.jsx(tr,{className:"h-4 w-4"}),"จองวัคซีน"]})]})]},x.id))})})]})}),e.jsx(ee,{value:"appointments",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"รายการนัดหมาย"]}),e.jsx(ie,{children:"นัดหมายการฉีดวัคซีนทั้งหมด"})]}),e.jsx(R,{children:e.jsx("div",{className:"grid gap-4",children:r.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:x.patientName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[x.vaccineName," - โดสที่ ",x.doseNumber,"/",x.totalDoses]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["📅 ",x.appointmentDate," เวลา ",x.appointmentTime]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{variant:x.status==="completed"?"default":x.status==="scheduled"?"secondary":x.status==="cancelled"?"destructive":"outline",children:x.status==="scheduled"?"นัดแล้ว":x.status==="completed"?"เสร็จสิ้น":x.status==="cancelled"?"ยกเลิก":"ไม่มา"}),x.status==="scheduled"&&e.jsx(M,{size:"sm",variant:"outline",children:e.jsx(wa,{className:"h-4 w-4"})})]})]},x.id))})})]})}),e.jsx(ee,{value:"vaccines",className:"mt-6",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:m.map(x=>e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),x.name]}),e.jsx(ie,{children:x.description})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"จำนวนโดส:"}),e.jsxs("span",{className:"font-semibold",children:[x.doses," โดส"]})]}),x.interval>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"ห่างระหว่างโดส:"}),e.jsxs("span",{className:"font-semibold",children:[x.interval," วัน"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"สถานะ:"}),e.jsx(te,{variant:x.available?"default":"secondary",children:x.available?"พร้อมให้บริการ":"ไม่พร้อม"})]})]})})]},x.id))})}),e.jsx(ee,{value:"notifications",className:"mt-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5"}),"ส่งการแจ้งเตือน"]}),e.jsx(ie,{children:"ส่งข้อความแจ้งเตือนไปยัง LINE ของคนไข้"})]}),e.jsx(R,{children:e.jsxs(de,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx(ue,{children:"ระบบจะส่งการแจ้งเตือนอัตโนมัติเมื่อสร้างนัดหมายใหม่ และก่อนวันนัด 1 วัน"})]})})]})})]}),h&&d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs($,{children:[e.jsxs(F,{children:["จองวัคซีนสำหรับ ",d.displayName]}),e.jsx(ie,{children:"เลือกวัคซีนและกำหนดวันเวลานัดหมาย"})]}),e.jsx(R,{children:e.jsxs("form",{onSubmit:x=>{x.preventDefault();const j=new FormData(x.target);b({vaccineId:j.get("vaccine"),date:j.get("date"),time:j.get("time"),notes:j.get("notes")})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"vaccine",children:"เลือกวัคซีน"}),e.jsxs(ft,{name:"vaccine",required:!0,children:[e.jsx(at,{children:e.jsx(gt,{placeholder:"เลือกประเภทวัคซีน"})}),e.jsx(nt,{children:m.filter(x=>x.available).map(x=>e.jsxs(Ne,{value:x.id,children:[x.name," (",x.doses," โดส)"]},x.id))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"date",children:"วันที่นัด"}),e.jsx(se,{type:"date",name:"date",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"time",children:"เวลานัด"}),e.jsx(se,{type:"time",name:"time",required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notes",children:"หมายเหตุ (ไม่จำเป็น)"}),e.jsx(Ft,{name:"notes",placeholder:"หมายเหตุเพิ่มเติม...",rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(M,{type:"submit",className:"flex-1",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"สร้างนัดหมาย"]}),e.jsx(M,{type:"button",variant:"outline",onClick:()=>{f(!1),p(null)},children:"ยกเลิก"})]})]})})]})})]})})},Su=()=>{const[t,s]=u.useState(!1),[a,n]=u.useState(""),[r,o]=u.useState(!1),{toast:i}=fe(),c={name:"VaccineBot",id:"@vaccine-bot",webhook:"https://your-n8n.domain/webhook/line-bot"},d=()=>{const l=`// LINE Bot Webhook สำหรับลงทะเบียนคนไข้
// URL: ${c.webhook}

// ข้อความต้อนรับ
const welcomeMessage = {
  "type": "text",
  "text": "🏥 ยินดีต้อนรับสู่ระบบลงทะเบียนวัคซีน\\n\\n📝 กรุณากรอกข้อมูลของคุณ:\\n\\n1️⃣ ชื่อ-นามสกุล (เต็ม)\\n2️⃣ เบอร์โทรศัพท์\\n\\nตอบกลับข้อความนี้เพื่อเริ่มลงทะเบียน"
};

// การประมวลผลข้อความ
if (input.type === "message" && input.message.type === "text") {
  const userText = input.message.text.trim();
  const userId = input.source.userId;
  
  // ดึงข้อมูล Profile จาก LINE
  const profileResponse = await this.helpers.request({
    method: "GET",
    url: "https://api.line.me/v2/bot/profile/" + userId,
    headers: {
      "Authorization": "Bearer " + process.env.LINE_CHANNEL_ACCESS_TOKEN
    }
  });
  
  const profile = profileResponse.body;
  
  // วิเคราะห์ข้อความที่ส่งมา
  const patterns = {
    fullName: /^[ก-๙a-zA-Z\\s]{4,50}$/,
    phone: /^(08|09|06|02)\\d{8}$/
  };
  
  let responseMessage = "";
  
  // ตรวจสอบรูปแบบข้อมูล
  if (patterns.fullName.test(userText)) {
    // เป็นชื่อ-นามสกุล
    responseMessage = \`✅ บันทึกชื่อ: \${userText}\\n\\n📱 กรุณาส่งเบอร์โทรศัพท์ของคุณ\\n(ตัวอย่าง: 081-234-5678)\`;
    
    // บันทึกลง Google Sheets
    await saveToGoogleSheets('Patients', [
      userId,
      profile.displayName,
      userText, // ชื่อเต็มที่ผู้ใช้กรอก
      '', // เบอร์โทร - รอกรอก
      new Date().toISOString(),
      'pending-phone'
    ]);
    
  } else if (patterns.phone.test(userText.replace(/-/g, ''))) {
    // เป็นเบอร์โทรศัพท์
    responseMessage = \`✅ บันทึกเบอร์โทร: \${userText}\\n\\n🎉 ลงทะเบียนสำเร็จ!\\n\\n👩‍⚕️ เจ้าหน้าที่จะติดต่อกลับเพื่อนัดหมายการฉีดวัคซีน\\n\\n⏰ โดยปกติจะได้รับการติดต่อภายใน 24 ชั่วโมง\`;
    
    // อัปเดตข้อมูลใน Google Sheets
    await updatePatientPhone(userId, userText);
    
    // แจ้งเตือนเจ้าหน้าที่
    await notifyStaff(userId, profile.displayName, userText);
    
  } else {
    // รูปแบบไม่ถูกต้อง
    responseMessage = \`❌ รูปแบบข้อมูลไม่ถูกต้อง\\n\\n📝 กรุณาส่ง:\\n\\n1️⃣ ชื่อ-นามสกุล (ภาษาไทยหรืออังกฤษ)\\nตัวอย่าง: สมชาย ใจดี\\n\\n2️⃣ เบอร์โทรศัพท์ (10 หลัก)\\nตัวอย่าง: 081-234-5678\`;
  }
  
  // ส่งข้อความตอบกลับ
  return [{
    json: {
      to: userId,
      messages: [{
        type: "text",
        text: responseMessage
      }]
    }
  }];
}

// Helper Functions
async function saveToGoogleSheets(sheetName, data) {
  const response = await this.helpers.request({
    method: 'POST',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/\${sheetName}:append\`,
    headers: {
      'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN,
      'Content-Type': 'application/json'
    },
    body: {
      values: [data],
      valueInputOption: 'RAW'
    }
  });
  return response.body;
}

async function updatePatientPhone(userId, phone) {
  // ค้นหาแถวที่ต้องอัปเดต
  const getResponse = await this.helpers.request({
    method: 'GET',
    url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/Patients:A:F\`,
    headers: {
      'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN
    }
  });
  
  const rows = getResponse.body.values || [];
  let updateRow = -1;
  
  for (let i = 0; i < rows.length; i++) {
    if (rows[i][0] === userId) {
      updateRow = i + 1;
      break;
    }
  }
  
  if (updateRow > 0) {
    // อัปเดตเบอร์โทรและสถานะ
    await this.helpers.request({
      method: 'PUT',
      url: \`https://sheets.googleapis.com/v4/spreadsheets/\${process.env.GOOGLE_SPREADSHEET_ID}/values/Patients:D\${updateRow}:F\${updateRow}\`,
      headers: {
        'Authorization': 'Bearer ' + process.env.GOOGLE_ACCESS_TOKEN,
        'Content-Type': 'application/json'
      },
      body: {
        values: [[
          phone,
          new Date().toISOString(),
          'completed'
        ]],
        valueInputOption: 'RAW'
      }
    });
  }
}

async function notifyStaff(userId, displayName, phone) {
  // ส่งการแจ้งเตือนไปยังระบบเจ้าหน้าที่
  // (สามารถใช้ Webhook, Email, หรือ Slack)
  console.log('New patient registered:', {
    userId,
    displayName,
    phone,
    timestamp: new Date().toISOString()
  });
}`;n(l)},p=l=>{navigator.clipboard.writeText(l),i({title:"คัดลอกแล้ว",description:"คัดลอกโค้ดไปยังคลิปบอร์ดเรียบร้อยแล้ว"})},h=async l=>{o(!0);try{await fetch("/functions/v1/secure-patient-webhook",{method:"POST",headers:{"Content-Type":"application/json","x-webhook-secret":"secure-patient-registration"},body:JSON.stringify({type:"patient_registration",patientName:l.fullName||l.displayName,registrationType:l.registrationType||"manual",timestamp:new Date().toISOString(),source:"frontend_registration"})}),i({title:"ส่งข้อมูลสำเร็จ",description:"ข้อมูลได้ถูกส่งผ่านระบบรักษาความปลอดภัยแล้ว"})}catch(m){console.error("Error sending to secure webhook:",m),i({title:"ข้อผิดพลาด",description:"ไม่สามารถส่งข้อมูลได้",variant:"destructive"})}finally{o(!1)}},f=()=>{h({LineUserID:"test-user-123",displayName:"ทดสอบ ระบบ",fullName:"นาย ทดสอบ ระบบ",registrationType:"manual"})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"ระบบลงทะเบียนคนไข้ผ่าน LINE Bot"}),e.jsx("p",{className:"text-muted-foreground",children:"คนไข้สามารถลงทะเบียนชื่อ-นามสกุลและเบอร์โทรศัพท์ผ่าน LINE Bot"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(sr,{className:"h-5 w-5"}),"เชื่อมต่อกับ n8n Workflow"]}),e.jsx(ie,{children:"ระบบจะเชื่อมต่อกับ n8n Webhook อัตโนมัติจากการตั้งค่าของผู้ดูแลระบบ"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(de,{children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"ระบบรักษาความปลอดภัย:"}),e.jsx("br",{}),"• ข้อมูลจะถูกส่งผ่านระบบรักษาความปลอดภัยของ Supabase",e.jsx("br",{}),"• ข้อมูลส่วนตัวจะถูกกรองก่อนส่งต่อ",e.jsx("br",{}),'• กดปุ่ม "ทดสอบ" เพื่อทดสอบการเชื่อมต่อ']})]}),e.jsxs(M,{onClick:f,disabled:r,className:"w-full",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),r?"กำลังส่ง...":"ทดสอบระบบ"]})]})]}),e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"ข้อมูล LINE Bot"]}),e.jsx(ie,{children:"ข้อมูลสำหรับตั้งค่า LINE Bot สำหรับรับลงทะเบียนคนไข้"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{children:"ชื่อบอท"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(se,{value:c.name,readOnly:!0}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>p(c.name),children:e.jsx(qe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(q,{children:"LINE Bot ID"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(se,{value:c.id,readOnly:!0}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>p(c.id),children:e.jsx(qe,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{children:[e.jsx(q,{children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(se,{value:c.webhook,readOnly:!0}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>p(c.webhook),children:e.jsx(qe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(M,{onClick:()=>s(!t),children:[e.jsx(Ja,{className:"h-4 w-4 mr-2"}),t?"ซ่อน QR Code":"แสดง QR Code"]}),e.jsxs(M,{variant:"outline",onClick:d,children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"สร้างโค้ด n8n"]})]}),t&&e.jsx("div",{className:"flex justify-center p-6 bg-muted rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-48 h-48 bg-white p-4 rounded-lg shadow-md mx-auto mb-4",children:e.jsx("div",{className:"w-full h-full bg-gray-200 rounded flex items-center justify-center",children:e.jsx(Ja,{className:"h-20 w-20 text-gray-400"})})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"QR Code สำหรับเพิ่มเพื่อน LINE Bot"}),e.jsxs(M,{size:"sm",variant:"outline",className:"mt-2",children:[e.jsx(al,{className:"h-4 w-4 mr-2"}),"เปิดใน LINE"]})]})})]})]}),e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),"ขั้นตอนการลงทะเบียนสำหรับคนไข้"]}),e.jsx(ie,{children:"ลำดับขั้นตอนที่คนไข้ต้องทำผ่าน LINE"})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"เพิ่มเพื่อน LINE Bot"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["สแกน QR Code หรือค้นหา ID: ",c.id]})]})]}),e.jsx(st,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ส่งชื่อ-นามสกุล"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"พิมพ์ชื่อ-นามสกุลเต็ม (ภาษาไทยหรืออังกฤษ)"}),e.jsx(te,{variant:"outline",className:"mt-1",children:"ตัวอย่าง: สมชาย ใจดี"})]})]}),e.jsx(st,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ส่งเบอร์โทรศัพท์"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"พิมพ์เบอร์โทรศัพท์ 10 หลัก"}),e.jsx(te,{variant:"outline",className:"mt-1",children:"ตัวอย่าง: 081-234-5678"})]})]}),e.jsx(st,{className:"h-5 w-5 text-muted-foreground ml-4"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center",children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-600",children:"ลงทะเบียนสำเร็จ"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เจ้าหน้าที่จะติดต่อกลับเพื่อนัดหมายภายใน 24 ชั่วโมง"})]})]})]})})]}),a&&e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"โค้ด n8n Webhook"}),e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>p(a),children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"คัดลอก"]})]}),e.jsx(ie,{children:"โค้ดสำหรับใส่ใน Code Node ของ n8n เพื่อจัดการการลงทะเบียน"})]}),e.jsx(R,{children:e.jsx("pre",{className:"bg-muted p-4 rounded-lg text-sm overflow-x-auto",children:e.jsx("code",{children:a})})})]}),e.jsx(de,{children:e.jsx(ue,{children:e.jsx("span",{className:"text-red-500 font-bold",children:"ระบบยังไม่ได้ตั้งค่า Webhook URL!"})})}),e.jsxs(de,{children:[e.jsx(We,{className:"h-4 w-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"หมายเหตุ:"})," ระบบนี้เป็นส่วนสำหรับคนไข้ลงทะเบียนเบื้องต้นเท่านั้น เจ้าหน้าที่จะใช้ระบบ Staff Dashboard เพื่อจัดการการจองวัคซีนและการนัดหมาย"]})]})]})]})})},Cu=()=>{const[t,s]=u.useState("overview"),[a,n]=u.useState(!1),r=(o,i)=>{navigator.clipboard.writeText(o),alert(`คัดลอก ${i} แล้ว!`)};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"🏥 คู่มือการติดตั้งระบบลงทะเบียนวัคซีน"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"ระบบจัดการการลงทะเบียนวัคซีนผ่าน LINE Bot พร้อมระบบนัดหมายอัตโนมัติ สำหรับโรงพยาบาล คลินิก และสถานพยาบาล"})]}),e.jsxs(Xe,{value:t,onValueChange:s,className:"w-full",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-6",children:[e.jsx(K,{value:"overview",children:"ภาพรวม"}),e.jsx(K,{value:"requirements",children:"ความต้องการ"}),e.jsx(K,{value:"line-setup",children:"ตั้งค่า LINE"}),e.jsx(K,{value:"n8n-setup",children:"ตั้งค่า n8n"}),e.jsx(K,{value:"calendar",children:"Google Calendar"}),e.jsx(K,{value:"usage",children:"การใช้งาน"})]}),e.jsx(ee,{value:"overview",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"ภาพรวมระบบ"]}),e.jsx(ie,{children:"ระบบลงทะเบียนวัคซีนแบบครบวงจร ประกอบด้วย 3 ส่วนหลัก"})]}),e.jsx(R,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ns,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"LINE Bot"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"คนไข้ลงทะเบียนชื่อ-นามสกุลผ่าน LINE Bot พร้อม Rich Menu"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Se,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Staff Dashboard"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เจ้าหน้าที่เลือกวัคซีน สร้างนัดหมาย และส่งการแจ้งเตือน"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ve,{className:"h-8 w-8 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Auto Scheduling"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ระบบนัดหมายอัตโนมัติใน Google Calendar พร้อมแจ้งเตือน"})]})]})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{children:"🔄 ขั้นตอนการทำงาน"})}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(te,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"1"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"คนไข้ลงทะเบียนผ่าน LINE Bot"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(te,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"2"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"เจ้าหน้าที่เลือกวัคซีนและสร้างนัดหมาย"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(te,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"3"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"ระบบส่งการแจ้งเตือนไป LINE และสร้างนัดใน Google Calendar"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(te,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center",children:"4"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"แจ้งเตือนอัตโนมัติก่อนวันนัด"})]})]})})]})]})}),e.jsx(ee,{value:"requirements",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"ความต้องการของระบบ"]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"บัญชีและเครื่องมือที่จำเป็น"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"LINE Developers Account"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"n8n Self-hosted หรือ Cloud"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Account"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Sheets"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Google Calendar"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(nl,{className:"h-4 w-4"}),"ข้อกำหนดทางเทคนิค"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Public URL สำหรับ Webhook"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"SSL Certificate (HTTPS)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Internet Connection"})]})]})]})]})})]}),e.jsxs(de,{children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"หมายเหตุ:"})," หากใช้ n8n แบบ Self-hosted จำเป็นต้องมี Server ที่สามารถรัน Docker หรือ Node.js และมี Public URL สำหรับรับ Webhook จาก LINE"]})]})]})}),e.jsx(ee,{value:"line-setup",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"การตั้งค่า LINE Bot"]}),e.jsx(ie,{children:"ขั้นตอนการสร้างและตั้งค่า LINE Bot สำหรับการลงทะเบียนวัคซีน"})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1. สร้าง LINE Bot"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:["• ไปที่ ",e.jsx("a",{href:"https://developers.line.biz",target:"_blank",className:"text-primary underline",children:"LINE Developers Console"})]}),e.jsx("p",{className:"text-sm",children:"• สร้าง Provider ใหม่ (ถ้ายังไม่มี)"}),e.jsx("p",{className:"text-sm",children:'• สร้าง Channel ประเภท "Messaging API"'}),e.jsx("p",{className:"text-sm",children:'• ตั้งชื่อ Bot เช่น "ระบบลงทะเบียนวัคซีน"'})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2. ตั้งค่า Webhook"}),e.jsxs("div",{className:"pl-4 space-y-3",children:[e.jsx("p",{className:"text-sm",children:"• ในหน้า Channel Settings"}),e.jsx("p",{className:"text-sm",children:'• เปิดใช้งาน "Use webhook"'}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Webhook URL:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border",children:"https://your-n8n-domain.com/webhook/line-vaccine"}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>r("https://your-n8n-domain.com/webhook/line-vaccine","Webhook URL"),children:e.jsx(qe,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3. ข้อมูลสำคัญที่ต้องเก็บ"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Channel Access Token:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border flex-1",children:a?"YOUR_CHANNEL_ACCESS_TOKEN_HERE":"••••••••••••••••••••"}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>n(!a),children:a?e.jsx(ar,{className:"h-4 w-4"}):e.jsx(nr,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Channel Secret:"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("code",{className:"text-sm bg-background px-2 py-1 rounded border flex-1",children:a?"YOUR_CHANNEL_SECRET_HERE":"••••••••••••••••••••"})})]})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"4. สร้าง Rich Menu"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"• ใช้ LINE Official Account Manager"}),e.jsx("p",{className:"text-sm",children:"• สร้างเมนูขนาด 2500x843 pixels"}),e.jsx("p",{className:"text-sm",children:"• แบ่งเป็น 3 พื้นที่:"}),e.jsxs("div",{className:"ml-4 space-y-1",children:[e.jsx("p",{className:"text-xs",children:"- ลงทะเบียนคนไข้"}),e.jsx("p",{className:"text-xs",children:"- จองวัคซีน"}),e.jsx("p",{className:"text-xs",children:"- ตรวจสอบการจอง"})]})]})]})]})]})})}),e.jsx(ee,{value:"n8n-setup",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-5 w-5"}),"การตั้งค่า n8n Workflow"]}),e.jsx(ie,{children:"ขั้นตอนการสร้างและกำหนดค่า n8n workflow สำหรับระบบ"})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1. ติดตั้ง n8n"}),e.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Docker (แนะนำ):"}),e.jsx("code",{className:"text-sm block bg-background p-2 rounded border",children:"docker run -it --rm --name n8n -p 5678:5678 -v ~/.n8n:/home/node/.n8n n8nio/n8n"})]}),e.jsxs("div",{className:"bg-muted p-4 rounded-md mt-3",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"NPM:"}),e.jsxs("code",{className:"text-sm block bg-background p-2 rounded border",children:["npm install n8n -g",e.jsx("br",{}),"n8n start"]})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2. กำหนด Environment Variables"}),e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsxs("code",{className:"text-sm block",children:["LINE_CHANNEL_ACCESS_TOKEN=your_line_access_token",e.jsx("br",{}),"LINE_CHANNEL_SECRET=your_line_channel_secret",e.jsx("br",{}),"GOOGLE_ACCESS_TOKEN=your_google_access_token",e.jsx("br",{}),"GOOGLE_SPREADSHEET_ID=your_spreadsheet_id",e.jsx("br",{}),"GOOGLE_CALENDAR_ID=your_calendar_id"]})})})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3. สร้าง Workflow Nodes"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Webhook Trigger"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"รับข้อมูลจาก LINE Bot"}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Method: POST",e.jsx("br",{}),"Path: /webhook/line-vaccine"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Code Node - Vaccine Mapping"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"ใช้โค้ดที่คุณให้มา"}),e.jsxs(M,{size:"sm",variant:"outline",className:"w-full",children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"ดาวน์โหลดโค้ด Vaccine Mapping"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Google Sheets"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"บันทึกข้อมูลคนไข้และนัดหมาย"}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Operation: Append",e.jsx("br",{}),"Sheet: Patients, Appointments"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"LINE Message Reply"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"ส่งข้อความตอบกลับ"}),e.jsxs("div",{className:"text-xs bg-background p-2 rounded border",children:["Type: Reply Message",e.jsx("br",{}),"Format: Text, Flex Message"]})]})]})]})]})]})})}),e.jsx(ee,{value:"calendar",className:"mt-6",children:e.jsx("div",{className:"grid gap-6",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"การตั้งค่า Google Calendar"]}),e.jsx(ie,{children:"เชื่อมต่อระบบกับ Google Calendar สำหรับการนัดหมายอัตโนมัติ"})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"1. สร้าง Google Cloud Project"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:["• ไปที่ ",e.jsx("a",{href:"https://console.cloud.google.com",target:"_blank",className:"text-primary underline",children:"Google Cloud Console"})]}),e.jsx("p",{className:"text-sm",children:"• สร้าง Project ใหม่"}),e.jsx("p",{className:"text-sm",children:"• เปิดใช้งาน Google Calendar API"}),e.jsx("p",{className:"text-sm",children:"• สร้าง Service Account"})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"2. สร้าง Calendar สำหรับวัคซีน"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"• เข้า Google Calendar"}),e.jsx("p",{className:"text-sm",children:'• สร้าง Calendar ใหม่ชื่อ "วัคซีนคลินิก"'}),e.jsx("p",{className:"text-sm",children:"• แชร์ Calendar ให้ Service Account"}),e.jsx("p",{className:"text-sm",children:"• คัดลอก Calendar ID"})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"3. ตั้งค่าการแจ้งเตือน"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"การแจ้งเตือนอัตโนมัติ:"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{children:"• 1 วันก่อนนัด - ส่งข้อความไป LINE"}),e.jsx("p",{children:"• 1 ชั่วโมงก่อนนัด - แจ้งเตือนใน Calendar"}),e.jsx("p",{children:"• 30 นาทีก่อนนัด - Email reminder"})]})]})})]})]})]})})}),e.jsx(ee,{value:"usage",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"วิธีการใช้งานระบบ"]}),e.jsx(ie,{children:"คู่มือการใช้งานสำหรับเจ้าหน้าที่และคนไข้"})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"สำหรับคนไข้ (ผ่าน LINE Bot)"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"1. เพิ่มเพื่อน LINE Bot ของคลินิก"}),e.jsx("p",{className:"text-sm",children:'2. กดเมนู "ลงทะเบียนคนไข้"'}),e.jsx("p",{className:"text-sm",children:"3. กรอกข้อมูล ชื่อ-นามสกุล และเบอร์โทร"}),e.jsx("p",{className:"text-sm",children:"4. รอเจ้าหน้าที่ติดต่อกลับเพื่อนัดหมาย"}),e.jsx("p",{className:"text-sm",children:"5. ได้รับการแจ้งเตือนการนัดผ่าน LINE"})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"สำหรับเจ้าหน้าที่"}),e.jsxs("div",{className:"pl-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"1. เข้าใช้งาน Staff Dashboard"}),e.jsx("p",{className:"text-sm",children:"2. ดูรายชื่อคนไข้ที่ลงทะเบียน"}),e.jsx("p",{className:"text-sm",children:'3. เลือกคนไข้และกดปุ่ม "จองวัคซีน"'}),e.jsx("p",{className:"text-sm",children:"4. เลือกประเภทวัคซีนและวันเวลานัด"}),e.jsx("p",{className:"text-sm",children:"5. ระบบจะส่งการแจ้งเตือนอัตโนมัติ"})]})]}),e.jsx(_e,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"การจัดการวัคซีนหลายโดส"}),e.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[e.jsx("p",{className:"text-sm mb-2",children:"ระบบรองรับวัคซีนที่ต้องฉีดหลายโดส:"}),e.jsxs("div",{className:"text-sm space-y-1 ml-4",children:[e.jsx("p",{children:"• วัคซีนไวรัสตับอักเสบบี: 3 โดส"}),e.jsx("p",{children:"• วัคซีนป้องกันมะเร็งปากมดลูก: 3 โดส"}),e.jsx("p",{children:"• วัคซีนพิษสุนัขบ้า: 5 เข็ม"}),e.jsx("p",{children:"• ระบบจะคำนวณวันนัดครั้งถัดไปอัตโนมัติ"})]})]})]})]})]}),e.jsxs(de,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"เคล็ดลับ:"})," ใช้ฟีเจอร์ค้นหาใน Staff Dashboard เพื่อหาคนไข้ได้เร็วขึ้น สามารถค้นหาด้วยชื่อหรือเบอร์โทรศัพท์"]})]})]})})]})]})})},yo=()=>{const[t,s]=u.useState(""),[a,n]=u.useState(""),[r,o]=u.useState(""),[i,c]=u.useState(""),[d,p]=u.useState(!1),[h,f]=u.useState("disconnected"),{toast:l}=fe(),m=async()=>{if(!t){l({title:"ข้อผิดพลาด",description:"กรุณากรอก Webhook URL",variant:"destructive"});return}p(!0);try{const v=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"test",message:"Connection test from web app",timestamp:new Date().toISOString()})});f("connected"),l({title:"เชื่อมต่อสำเร็จ",description:"เชื่อมต่อกับ n8n workflow สำเร็จ"})}catch{f("error"),l({title:"เชื่อมต่อไม่สำเร็จ",description:"ไม่สามารถเชื่อมต่อกับ n8n workflow ได้",variant:"destructive"})}finally{p(!1)}},g=async()=>{if(!(!t||!i)){p(!0);try{await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"message",data:{message:i,source:"web_app_test"}})}),l({title:"ส่งข้อความสำเร็จ",description:"ส่งข้อความทดสอบไปยัง n8n แล้ว"}),c("")}catch{l({title:"ส่งข้อความไม่สำเร็จ",description:"เกิดข้อผิดพลาดในการส่งข้อความ",variant:"destructive"})}finally{p(!1)}}},b=()=>{const v=`${t}/line-webhook`;navigator.clipboard.writeText(v),l({title:"คัดลอกสำเร็จ",description:"คัดลอก LINE Webhook URL แล้ว"})};return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"LINE Bot Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"จัดการและเชื่อมต่อ LINE Bot กับ n8n workflow"})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(sr,{className:"h-5 w-5"}),"เชื่อมต่อ n8n Workflow"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"webhook-url",children:"n8n Webhook URL"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(se,{id:"webhook-url",placeholder:"https://your-n8n.render.com/webhook/...",value:t,onChange:v=>s(v.target.value)}),e.jsx(M,{onClick:m,disabled:d,variant:h==="connected"?"secondary":"default",children:h==="connected"?"เชื่อมต่อแล้ว":"ทดสอบ"})]})]}),h==="connected"&&e.jsxs(de,{children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsxs(ue,{children:["เชื่อมต่อกับ n8n workflow สำเร็จ! สำหรับ LINE Bot ให้ใช้ URL:",e.jsxs("code",{className:"mx-1 p-1 bg-muted rounded",children:[t,"/line-webhook"]}),e.jsx(M,{variant:"ghost",size:"sm",className:"ml-2",onClick:b,children:e.jsx(qe,{className:"h-3 w-3"})})]})]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"การตั้งค่า LINE Bot"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"channel-access-token",children:"Channel Access Token"}),e.jsx(se,{id:"channel-access-token",type:"password",placeholder:"Channel Access Token จาก LINE Developers",value:a,onChange:v=>n(v.target.value)})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"channel-secret",children:"Channel Secret"}),e.jsx(se,{id:"channel-secret",type:"password",placeholder:"Channel Secret จาก LINE Developers",value:r,onChange:v=>o(v.target.value)})]}),e.jsx(de,{children:e.jsxs(ue,{children:[e.jsx("strong",{children:"วิธีการตั้งค่า LINE Bot:"}),e.jsx("br",{}),"1. ไปที่ LINE Developers Console",e.jsx("br",{}),"2. คัดลอก Webhook URL ไปใส่ใน Messaging API",e.jsx("br",{}),"3. กรอก Channel Access Token และ Channel Secret ที่นี่",e.jsx("br",{}),"4. เปิดใช้งาน Webhook ใน LINE Developers"]})})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"ทดสอบส่งข้อความ"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"test-message",children:"ข้อความทดสอบ"}),e.jsx(Ft,{id:"test-message",placeholder:"พิมพ์ข้อความที่ต้องการทดสอบ...",value:i,onChange:v=>c(v.target.value)})]}),e.jsxs(M,{onClick:g,disabled:!t||!i||d,className:"w-full",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),d?"กำลังส่ง...":"ส่งข้อความทดสอบ"]})]})]})]})})},ku="",Du="";throw new Error("Missing VITE_SUPABASE_URL or VITE_SUPABASE_ANON_KEY");const Eu=globalThis,B=Eu.__supabase??gl(ku,Du,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),Iu=()=>{const[t,s]=u.useState([]),[a,n]=u.useState([]),[r,o]=u.useState(!1),[i,c]=u.useState(""),{toast:d}=fe();u.useEffect(()=>{(async()=>{try{if(window.liff&&window.liff.isLoggedIn()){const v=await window.liff.getProfile();c(v.userId),p(v.userId),h(v.userId)}else console.log("LINE LIFF not available or not logged in")}catch(v){console.log("Error getting LINE profile:",v)}})()},[]);const p=async b=>{if(b){o(!0);try{console.log("🔍 เริ่มโหลดข้อมูลการติดตามผู้ป่วย...");const{data:v,error:x}=await B.from("appointments").select("*").eq("line_user_id",b).order("appointment_date",{ascending:!1});if(x)throw x;console.log("📊 ข้อมูลนัดทั้งหมด:",(v==null?void 0:v.length)||0,"รายการ");const j=(v==null?void 0:v.filter(w=>w.status==="completed"))||[],_=(v==null?void 0:v.filter(w=>["scheduled","pending"].includes(w.status)))||[];console.log("✅ การฉีดที่เสร็จสิ้น:",j.length,"รายการ"),console.log("📅 นัดที่มีอยู่แล้ว:",_.length,"รายการ");const{data:S}=await B.from("vaccine_schedules").select("*").eq("active",!0);console.log("💉 โหลดข้อมูลวัคซีน:",(S==null?void 0:S.length)||0,"ประเภท");const C=[];for(const w of _)if(new Date(w.appointment_date)>new Date){const y=j.filter(P=>P.vaccine_type.toLowerCase()===w.vaccine_type.toLowerCase()),E=S==null?void 0:S.find(P=>P.vaccine_type.toLowerCase()===w.vaccine_type.toLowerCase());E&&(C.push({id:`scheduled-${w.id}`,patient_id:b,patient_name:w.patient_name||"ผู้ใช้",vaccine_name:w.vaccine_name||E.vaccine_name,vaccine_type:w.vaccine_type,current_dose:y.length,total_doses:E.total_doses,next_dose_due:w.appointment_date,last_dose_date:y.length>0?y.reduce((P,L)=>new Date(L.appointment_date)>new Date(P.appointment_date)?L:P).appointment_date:"",completion_status:"scheduled"}),console.log(`📅 นัดที่มีอยู่: ${w.vaccine_type} วันที่ ${w.appointment_date}`))}const T=new Map;for(const w of j||[]){const y=w.vaccine_type;if(!T.has(y)){const E=j.filter(L=>L.vaccine_type.toLowerCase()===w.vaccine_type.toLowerCase());console.log(`💉 วัคซีน: ${w.vaccine_type}, โดสที่ฉีดแล้ว: ${E.length}`);const P=E.reduce((L,z)=>new Date(z.appointment_date)>new Date(L.appointment_date)?z:L);console.log(`📅 เข็มล่าสุด: ${P.appointment_date}`),T.set(y,{vaccine_type:w.vaccine_type,doses_received:E.length,latest_date:P.appointment_date,patient_name:w.patient_name})}}const W=Array.from(T.values()).map(async w=>{var y;try{const E=S==null?void 0:S.find(Y=>Y.vaccine_type.toLowerCase()===w.vaccine_type.toLowerCase());if(!E)return console.log(`❌ ไม่พบข้อมูลวัคซีน: ${w.vaccine_type}`),null;if(w.doses_received>=E.total_doses)return console.log(`✅ ได้รับวัคซีน ${w.vaccine_type} ครบแล้ว`),null;const P=_.find(Y=>Y.vaccine_type.toLowerCase()===w.vaccine_type.toLowerCase()&&new Date(Y.appointment_date)>new Date);if(P)return console.log(`📅 มีนัด ${w.vaccine_type} แล้วในวันที่ ${P.appointment_date} - ข้าม`),null;const L=Array.isArray(E.dose_intervals)?E.dose_intervals:JSON.parse(((y=E.dose_intervals)==null?void 0:y.toString())||"[]");let z=new Date(w.latest_date);const I=w.doses_received,N=typeof L[I]=="number"?L[I]:typeof L[w.doses_received-1]=="number"?L[w.doses_received-1]:30;z.setDate(z.getDate()+N);const O=w.doses_received+1;return console.log(`🎯 วัคซีน ${w.vaccine_type}: ต้องการโดสใหม่ ${O}/${E.total_doses}, คำนวณนัด: ${z.toISOString().split("T")[0]}, ช่วงห่าง: ${N} วัน`),{id:`new-${b}-${w.vaccine_type}`,patient_id:b,patient_name:w.patient_name||"ผู้ใช้",vaccine_name:E.vaccine_name,vaccine_type:w.vaccine_type,current_dose:w.doses_received,total_doses:E.total_doses,next_dose_due:z.toISOString().split("T")[0],last_dose_date:w.latest_date,completion_status:"needs_appointment"}}catch(E){return console.error("Error processing vaccine:",w.vaccine_type,E),null}}),k=(await Promise.all(W)).filter(w=>w!==null),H=[...C,...k].sort((w,y)=>new Date(w.next_dose_due).getTime()-new Date(y.next_dose_due).getTime());console.log("✅ ข้อมูลการติดตามที่คำนวณได้:",H.length,"รายการ"),console.log("📅 นัดที่มีอยู่แล้ว:",C.length,"รายการ"),console.log("🆕 นัดใหม่ที่ต้องสร้าง:",k.length,"รายการ"),H.forEach(w=>{const y=w.completion_status==="scheduled"?"(มีนัดแล้ว)":"(ต้องสร้างนัด)";console.log(`- วัคซีน: ${w.vaccine_name}, โดส ${w.current_dose+1}/${w.total_doses}, นัด: ${w.next_dose_due}, เข็มล่าสุด: ${w.last_dose_date||"ยังไม่มี"} ${y}`)}),s(H)}catch(v){console.error("Error loading next appointments:",v),d({title:"ไม่สามารถโหลดข้อมูลได้",description:"กรุณาลองใหม่อีกครั้ง",variant:"destructive"})}finally{o(!1)}}},h=async b=>{if(b)try{const{data:v,error:x}=await B.rpc("api_next_appointments",{_line_user_id:b,_limit:5});if(x)throw x;v&&n(v)}catch(v){console.error("Error loading upcoming appointments:",v)}},f=()=>{i&&(p(i),h(i))},l=b=>new Date(b).toLocaleDateString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=b=>{switch(b){case"scheduled":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},g=b=>{const v=new Date,j=new Date(b).getTime()-v.getTime();return Math.ceil(j/(1e3*60*60*24))};return i?e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"นัดหมายของฉัน"}),e.jsx("p",{className:"text-muted-foreground",children:"ตรวจสอบนัดหมายและวัคซีนครั้งถัดไป"})]}),e.jsxs(M,{onClick:f,disabled:r,variant:"outline",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"รีเฟรช"]})]}),a.length>0&&e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"นัดหมายที่จะมาถึง"]})}),e.jsx(R,{className:"space-y-4",children:a.map((b,v)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:b.vaccine_name}),e.jsx(te,{className:m(b.status),children:b.status==="scheduled"?"นัดแล้ว":b.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-4 w-4"}),l(b.appointment_date)]}),b.appointment_time&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-4 w-4"}),b.appointment_time]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(rl,{className:"h-4 w-4"}),b.location]})]})]},v))})]}),t.length>0?e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"วัคซีนครั้งถัดไปที่ต้องฉีด"]})}),e.jsx(R,{className:"space-y-4",children:t.map(b=>{const v=g(b.next_dose_due),x=v<0,j=v<=7&&v>=0;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:b.vaccine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["เข็มที่ ",b.current_dose+1," จาก ",b.total_doses," เข็ม"]})]}),e.jsx(te,{variant:x?"destructive":j?"secondary":"outline",className:x?"bg-red-100 text-red-800":j?"bg-yellow-100 text-yellow-800":"",children:x?`เลยกำหนด ${Math.abs(v)} วัน`:j?`อีก ${v} วัน`:`อีก ${v} วัน`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"วันที่ควรฉีด:"}),e.jsx("p",{className:"font-medium",children:l(b.next_dose_due)})]}),b.last_dose_date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"เข็มล่าสุด:"}),e.jsx("p",{className:"font-medium",children:l(b.last_dose_date)})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:b.completion_status==="scheduled"?"✅ มีนัดหมายแล้ว - กรุณามาตามเวลาที่นัด":"💡 กรุณาติดต่อโรงพยาบาลโฮม เพื่อนัดหมายฉีดวัคซีนเข็มถัดไป"})})]},b.id)})})]}):e.jsx(A,{children:e.jsxs(R,{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto text-green-500 mb-4"}),e.jsx("h3",{className:"font-semibold mb-2",children:"ไม่มีวัคซีนที่ต้องฉีดครั้งถัดไป"}),e.jsx("p",{className:"text-muted-foreground",children:"วัคซีนทั้งหมดของคุณครบตามกำหนดแล้ว หรือยังไม่มีการลงทะเบียนฉีดวัคซีน"})]})}),e.jsx(A,{children:e.jsx(R,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"โรงพยาบาลโฮม"}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("p",{children:"📞 โทร: 02-xxx-xxxx"}),e.jsx("p",{children:"📍 ที่อยู่: [ใส่ที่อยู่โรงพยาบาล]"}),e.jsx("p",{children:"🕐 เวลาทำการ: จันทร์-ศุกร์ 08:00-17:00"})]})]})})})]}):e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx(de,{children:e.jsx(ue,{children:"กรุณาเข้าสู่ระบบผ่าน LINE เพื่อดูข้อมูลนัดหมายของคุณ"})})})},jo=()=>{const[t,s]=u.useState({fullName:"",phone:""}),[a,n]=u.useState(!1),[r,o]=u.useState(!1),[i,c]=u.useState(0),{toast:d}=fe(),p=(l,m)=>{s(g=>({...g,[l]:m}))},h=async()=>{if(!t.fullName||!t.phone){d({title:"ข้อผิดพลาด",description:"กรุณากรอกข้อมูลให้ครบถ้วน",variant:"destructive"});return}if(!/^[0-9]{9,10}$/.test(t.phone.replace(/[-\s]/g,""))){d({title:"ข้อผิดพลาด",description:"กรุณากรอกหมายเลขโทรศัพท์ให้ถูกต้อง",variant:"destructive"});return}n(!0);try{const m=`HOM-${Date.now()}`;let g=null;try{window.liff&&window.liff.isLoggedIn()&&(g=(await window.liff.getProfile()).userId,s(j=>({...j,lineUserId:g})))}catch(x){console.log("LINE profile not available:",x)}const{error:b}=await B.from("patient_registrations").insert({full_name:t.fullName,phone:t.phone,line_user_id:g||`temp_${Date.now()}`,hospital:"โรงพยาบาลโฮม",registration_id:m,source:g?"line_liff":"web_portal",status:"pending"});if(b)throw b;if(o(!0),d({title:"ลงทะเบียนสำเร็จ",description:"ลงทะเบียนรับบริการสำเร็จแล้ว"}),g)try{await B.functions.invoke("send-line-message",{body:{userId:g,message:`✅ ลงทะเบียนรับบริการสำเร็จ

📋 รายละเอียด:
• ชื่อ: ${t.fullName}
• เบอร์โทร: ${t.phone}
• รหัสลงทะเบียน: ${m}

🏥 โรงพยาบาลโฮม
เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย`}})}catch(x){console.error("Error sending LINE message:",x)}const v=window.setTimeout(()=>{window.liff&&window.liff.isInClient()&&window.liff.closeWindow()},1e4);c(v)}catch(m){console.error("Registration error:",m),d({title:"ลงทะเบียนไม่สำเร็จ",description:"เกิดข้อผิดพลาดในการลงทะเบียน กรุณาลองใหม่อีกครั้ง",variant:"destructive"})}finally{n(!1)}},f=()=>{i&&(window.clearTimeout(i),c(0)),s({fullName:"",phone:""}),o(!1)};return r?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx(A,{className:"border-green-200 bg-green-50",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"โรงพยาบาลโฮม",className:"mx-auto h-16 w-auto object-contain mb-4"})}),e.jsx(Z,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"ลงทะเบียนสำเร็จ!"}),e.jsxs("p",{className:"text-green-700 mb-6",children:["ขอบคุณที่ลงทะเบียน เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมายและแจ้งข้อมูลบริการ",t.lineUserId&&e.jsx("span",{className:"block mt-2 text-sm",children:"📱 ข้อความยืนยันได้ส่งไปที่ LINE แล้ว"}),window.liff&&window.liff.isInClient()&&e.jsx("span",{className:"block mt-2 text-sm",children:"⏰ หน้าต่างจะปิดอัตโนมัติใน 10 วินาที"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"ข้อมูลที่ลงทะเบียน:"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ชื่อ:"})," ",t.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"เบอร์โทร:"})," ",t.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"สถานที่:"})," โรงพยาบาลโฮม"]}),t.lineUserId&&e.jsxs("p",{children:[e.jsx("strong",{children:"LINE ID:"})," ",t.lineUserId]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{onClick:f,variant:"outline",className:"w-full",children:"ลงทะเบียนใหม่"}),window.liff&&window.liff.isInClient()&&e.jsx(M,{onClick:()=>window.liff.closeWindow(),className:"w-full",children:"ปิดหน้าต่าง"})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"โรงพยาบาลโฮม",className:"mx-auto h-24 w-auto object-contain"})}),e.jsx("h1",{className:"text-3xl font-bold",children:"โรงพยาบาลโฮม"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"บริการวัคซีนและการนัดหมาย"})]}),e.jsxs(Xe,{defaultValue:"appointments",className:"w-full",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-2",children:[e.jsxs(K,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"นัดหมายของฉัน"]}),e.jsxs(K,{value:"register",className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4"}),"ลงทะเบียน"]})]}),e.jsx(ee,{value:"appointments",className:"mt-6",children:e.jsx(Iu,{})}),e.jsx(ee,{value:"register",className:"mt-6",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"ลงทะเบียนรับบริการ"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:"กรุณากรอกข้อมูลเพื่อลงทะเบียนรับบริการ"})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-5 w-5"}),"ข้อมูลผู้ลงทะเบียน"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"fullName",children:"ชื่อ-นามสกุล"}),e.jsx(se,{id:"fullName",placeholder:"นาย/นาง/นางสาว ชื่อ นามสกุล",value:t.fullName,onChange:l=>{console.log("Name input changed:",l.target.value),p("fullName",l.target.value)},onFocus:()=>console.log("Name input focused"),onBlur:()=>console.log("Name input blurred"),className:"mt-1",autoComplete:"name"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"phone",children:"หมายเลขโทรศัพท์"}),e.jsx(se,{id:"phone",placeholder:"08x-xxx-xxxx",value:t.phone,onChange:l=>p("phone",l.target.value),className:"mt-1"})]})]})]}),e.jsx(M,{onClick:h,disabled:a,className:"w-full",size:"lg",children:a?"กำลังลงทะเบียน...":"ลงทะเบียนรับบริการ"}),e.jsx(de,{children:e.jsx(ue,{children:"หลังจากลงทะเบียน เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย และแจ้งข้อมูลบริการที่ต้องการ"})})]})})]})]})})},Gt=["domain:read","domain:write","domain:delete","vaccine:read","vaccine:write","appointments:read","appointments:write","system:settings"],Tu=[...Gt,"users:manage","system:admin","domain:force_delete"],Pu=[{email:"admin@vchomehospital.co.th",password:"admin123",role:"admin",permissions:Gt},{email:"superadmin@vchomehospital.co.th",password:"superadmin123",role:"superadmin",permissions:Tu}],ds=t=>t.endsWith("@vchomehospital.co.th")?!0:["admin@gmail.com","admin@example.com","test@admin.com"].includes(t.toLowerCase());function No(){const[t,s]=u.useState(null),[a,n]=u.useState(!0),[r,o]=u.useState(null);u.useEffect(()=>{(async()=>{var m;const{data:{session:f}}=await B.auth.getSession();if((m=f==null?void 0:f.user)!=null&&m.email&&ds(f.user.email)){const g={id:f.user.id,email:f.user.email,role:(f.user.email.endsWith("@vchomehospital.co.th"),"admin"),permissions:Gt,isAdmin:!0,isSuperAdmin:f.user.email==="superadmin@vchomehospital.co.th"};s(g),localStorage.setItem("admin_user",JSON.stringify(g)),n(!1);return}const l=localStorage.getItem("admin_user");if(l)try{const g=JSON.parse(l);s(g)}catch{localStorage.removeItem("admin_user")}n(!1)})();const{data:{subscription:h}}=B.auth.onAuthStateChange(async(f,l)=>{var m;if((m=l==null?void 0:l.user)!=null&&m.email&&ds(l.user.email)){const g={id:l.user.id,email:l.user.email,role:(l.user.email.endsWith("@vchomehospital.co.th"),"admin"),permissions:Gt,isAdmin:!0,isSuperAdmin:l.user.email==="superadmin@vchomehospital.co.th"};s(g),localStorage.setItem("admin_user",JSON.stringify(g))}else f==="SIGNED_OUT"&&(s(null),localStorage.removeItem("admin_user"))});return()=>h.unsubscribe()},[]);const i=async(p,h)=>{n(!0),o(null);try{const{data:f,error:l}=await B.auth.signInWithPassword({email:p,password:h});if(f.user&&ds(p)){const m={id:f.user.id,email:f.user.email,role:(p.endsWith("@vchomehospital.co.th"),"admin"),permissions:Gt,isAdmin:!0,isSuperAdmin:p==="superadmin@vchomehospital.co.th"};s(m),localStorage.setItem("admin_user",JSON.stringify(m));return}if(l){const m=Pu.find(b=>b.email===p&&b.password===h);if(!m)throw new Error("Invalid credentials. Please check your email and password.");const g={id:`demo_admin_${Date.now()}`,email:m.email,role:m.role,permissions:m.permissions,isAdmin:!0,isSuperAdmin:m.role==="superadmin"};s(g),localStorage.setItem("admin_user",JSON.stringify(g));return}if(f.user&&!ds(p))throw await B.auth.signOut(),new Error("Access denied. Admin privileges required.")}catch(f){throw o(f instanceof Error?f.message:"Login failed"),f}finally{n(!1)}},c=async()=>{await B.auth.signOut(),s(null),localStorage.removeItem("admin_user")},d=p=>(t==null?void 0:t.permissions.includes(p))||!1;return{user:t,isLoading:a,isAdmin:(t==null?void 0:t.isAdmin)||!1,isSuperAdmin:(t==null?void 0:t.isSuperAdmin)||!1,hasPermission:d,login:i,logout:c,error:r}}function Au({onSuccess:t}){const[s,a]=u.useState(""),[n,r]=u.useState(""),[o,i]=u.useState(!1),{login:c,isLoading:d,error:p}=No(),h=async f=>{f.preventDefault();try{await c(s,n),t==null||t()}catch{}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs(A,{className:"w-full max-w-md",children:[e.jsxs($,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ee,{className:"h-6 w-6 text-blue-600"})}),e.jsx(F,{className:"text-2xl font-bold",children:"Admin Access"}),e.jsx(ie,{children:"เข้าสู่ระบบสำหรับผู้ดูแลระบบ"})]}),e.jsxs(R,{children:[e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[p&&e.jsx(de,{variant:"destructive",children:e.jsx(ue,{children:p})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"email",children:"Email"}),e.jsx(se,{id:"email",type:"email",value:s,onChange:f=>a(f.target.value),placeholder:"admin@vchomehospital.co.th",required:!0,disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{id:"password",type:o?"text":"password",value:n,onChange:f=>r(f.target.value),placeholder:"รหัสผ่าน",required:!0,disabled:d}),e.jsx(M,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!o),disabled:d,children:o?e.jsx(ar,{className:"h-4 w-4"}):e.jsx(nr,{className:"h-4 w-4"})})]})]}),e.jsx(M,{type:"submit",className:"w-full",disabled:d||!s||!n,children:d?e.jsxs(e.Fragment,{children:[e.jsx(rr,{className:"h-4 w-4 animate-spin mr-2"}),"กำลังเข้าสู่ระบบ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"เข้าสู่ระบบ"]})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Admin Access:"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Existing Users:"})," Use your regular login credentials"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Demo Admin:"})," admin@vchomehospital.co.th / admin123"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Super Admin:"})," superadmin@vchomehospital.co.th / superadmin123"]})]}),e.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"💡 Admin access is granted to @vchomehospital.co.th emails"})]})]})]})})}function wo({children:t,requiredPermission:s,fallback:a,showLoginForm:n=!0}){const{user:r,isLoading:o,isAdmin:i,hasPermission:c,logout:d}=No();return o?e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ee,{className:"h-8 w-8 animate-pulse text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"กำลังตรวจสอบสิทธิ์..."})]})})}):i?s&&!c(s)?e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ta,{className:"h-12 w-12 text-orange-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-700",children:"Insufficient Permissions"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"คุณไม่มีสิทธิ์เข้าถึงฟีเจอร์นี้"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Required: ",s]})]})]})})}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Admin Mode: ",r==null?void 0:r.email]}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:r==null?void 0:r.role})]}),e.jsxs(M,{size:"sm",variant:"ghost",onClick:d,className:"text-blue-600 hover:text-blue-800",children:[e.jsx(gs,{className:"h-3 w-3 mr-1"}),"Logout"]})]})}),t]}):n?e.jsx(Au,{}):a||e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ta,{className:"h-12 w-12 text-red-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-700",children:"Access Restricted"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"คุณต้องเป็น Admin เพื่อเข้าถึงส่วนนี้"})]})]})})})}function Ru(){const[t,s]=u.useState([]),[a,n]=u.useState(!0),[r,o]=u.useState(null),[i,c]=u.useState(!1),[d,p]=u.useState({vaccine_type:"",vaccine_name:"",total_doses:1}),{toast:h}=fe(),f=async()=>{try{const{data:x,error:j}=await B.from("vaccine_schedules").select("*").order("vaccine_name");if(j)throw j;s(x||[])}catch(x){console.error("Error loading vaccines:",x),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลวัคซีนได้",variant:"destructive"})}finally{n(!1)}},l=async()=>{if(!d.vaccine_type||!d.vaccine_name||d.total_doses<1){h({title:"ข้อมูลไม่ครบถ้วน",description:"กรุณากรอกข้อมูลให้ครบถ้วน",variant:"destructive"});return}try{if(r){const{error:x}=await B.from("vaccine_schedules").update({vaccine_type:d.vaccine_type,vaccine_name:d.vaccine_name,total_doses:d.total_doses,updated_at:new Date().toISOString()}).eq("id",r);if(x)throw x;h({title:"อัพเดตสำเร็จ",description:"อัพเดตข้อมูลวัคซีนแล้ว"})}else{const{error:x}=await B.from("vaccine_schedules").insert([{vaccine_type:d.vaccine_type,vaccine_name:d.vaccine_name,total_doses:d.total_doses,active:!0}]);if(x)throw x;h({title:"เพิ่มสำเร็จ",description:"เพิ่มวัคซีนใหม่แล้ว"})}p({vaccine_type:"",vaccine_name:"",total_doses:1}),o(null),c(!1),f()}catch(x){console.error("Error saving vaccine:",x),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกข้อมูลได้",variant:"destructive"})}},m=x=>{p({vaccine_type:x.vaccine_type,vaccine_name:x.vaccine_name,total_doses:x.total_doses}),o(x.id),c(!0)},g=async(x,j)=>{try{const{error:_}=await B.from("vaccine_schedules").update({active:!j,updated_at:new Date().toISOString()}).eq("id",x);if(_)throw _;h({title:"อัพเดตสำเร็จ",description:`${j?"ปิดใช้งาน":"เปิดใช้งาน"}วัคซีนแล้ว`}),f()}catch(_){console.error("Error toggling vaccine status:",_),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัพเดตสถานะได้",variant:"destructive"})}},b=async(x,j)=>{if(confirm(`คุณต้องการลบวัคซีน "${j}" หรือไม่?`))try{const{error:_}=await B.from("vaccine_schedules").delete().eq("id",x);if(_)throw _;h({title:"ลบสำเร็จ",description:"ลบวัคซีนแล้ว"}),f()}catch(_){console.error("Error deleting vaccine:",_),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลบวัคซีนได้",variant:"destructive"})}},v=()=>{p({vaccine_type:"",vaccine_name:"",total_doses:1}),o(null),c(!1)};return u.useEffect(()=>{f()},[]),e.jsx(wo,{requiredPermission:"vaccine:write",children:e.jsxs(A,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"การตั้งค่าวัคซีน"]}),e.jsx(ie,{children:"จัดการประเภทวัคซีนและจำนวนเข็มที่ต้องฉีด"})]}),e.jsxs(M,{onClick:()=>c(!0),disabled:i,children:[e.jsx(tr,{className:"h-4 w-4 mr-2"}),"เพิ่มวัคซีน"]})]})}),e.jsxs(R,{children:[i&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"mb-6",children:[e.jsx($,{children:e.jsx(F,{className:"text-lg",children:r?"แก้ไขวัคซีน":"เพิ่มวัคซีนใหม่"})}),e.jsxs(R,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"vaccine_type",children:"รหัสวัคซีน"}),e.jsx(se,{id:"vaccine_type",value:d.vaccine_type,onChange:x=>p({...d,vaccine_type:x.target.value}),placeholder:"เช่น COVID19, INFLUENZA"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"vaccine_name",children:"ชื่อวัคซีน"}),e.jsx(se,{id:"vaccine_name",value:d.vaccine_name,onChange:x=>p({...d,vaccine_name:x.target.value}),placeholder:"เช่น วัคซีนโควิด-19"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"total_doses",children:"จำนวนเข็ม"}),e.jsx(se,{id:"total_doses",type:"number",min:"1",max:"10",value:d.total_doses,onChange:x=>p({...d,total_doses:parseInt(x.target.value)||1})})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(M,{onClick:l,children:[e.jsx(or,{className:"h-4 w-4 mr-2"}),r?"อัพเดต":"บันทึก"]}),e.jsxs(M,{variant:"outline",onClick:v,children:[e.jsx(Na,{className:"h-4 w-4 mr-2"}),"ยกเลิก"]})]})]})]}),e.jsx(_e,{className:"mb-6"})]}),a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(rr,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"กำลังโหลดข้อมูลวัคซีน..."})]}):e.jsxs("div",{className:"space-y-4",children:[t.map(x=>e.jsx(A,{children:e.jsx(R,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(we,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:x.vaccine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["รหัส: ",x.vaccine_type," • ",x.total_doses," เข็ม"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{variant:x.active?"default":"secondary",children:x.active?"ใช้งาน":"ปิดใช้งาน"}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>m(x),children:e.jsx(wa,{className:"h-3 w-3"})}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>g(x.id,x.active),children:x.active?"ปิด":"เปิด"}),e.jsx(M,{size:"sm",variant:"outline",onClick:()=>b(x.id,x.vaccine_name),children:e.jsx(ol,{className:"h-3 w-3"})})]})]})})},x.id)),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"ยังไม่มีวัคซีนในระบบ"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'คลิก "เพิ่มวัคซีน" เพื่อเริ่มต้น'})]})]})]})]})})}class Nf extends V.Component{constructor(a){super(a);Os(this,"retry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,n){console.error("Domain Management Error:",a,n)}render(){if(this.state.hasError&&this.state.error){const a=this.props.fallback;return e.jsx(a,{error:this.state.error,retry:this.retry})}return this.props.children}}const _o=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(!1),[r,o]=u.useState(new Date().toISOString().split("T")[0]),[i,c]=u.useState([]),[d,p]=u.useState([]),[h,f]=u.useState(""),[l,m]=u.useState(null),[g,b]=u.useState("appointments"),[v,x]=u.useState({vaccineType:"",doseNumber:"1",notes:""}),{toast:j}=fe(),_=async N=>{n(!0);try{const{data:O,error:Y}=await B.from("appointments").select("*").eq("appointment_date",N).order("appointment_time",{ascending:!0});if(Y)throw Y;s(O||[])}catch(O){console.error("Error loading appointments:",O),j({title:"เกิดข้อผิดพลาด",description:`ไม่สามารถโหลดข้อมูลนัดหมายวันที่ ${new Date(N).toLocaleDateString("th-TH")} ได้`,variant:"destructive"})}finally{n(!1)}},S=()=>_(r),C=async()=>{try{const{data:N,error:O}=await B.from("vaccine_schedules").select("id, vaccine_type, vaccine_name, total_doses").eq("active",!0).order("vaccine_name");if(O)throw O;c(N||[])}catch(N){console.error("Error loading vaccine options:",N),j({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลวัคซีนได้",variant:"destructive"})}},T=async()=>{try{const{data:N,error:O}=await B.from("patient_registrations").select("*").order("created_at",{ascending:!1});if(O)throw O;console.log("Patient registrations loaded:",(N==null?void 0:N.length)||0,"records"),console.log("Sample data:",N==null?void 0:N.slice(0,3)),p(N||[])}catch(N){console.error("Error loading patient registrations:",N),j({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลผู้ป่วยได้",variant:"destructive"})}},W=async(N,O)=>{try{const{error:Y}=await B.from("appointments").update({status:O,updated_at:new Date().toISOString()}).eq("appointment_id",N);if(Y)throw Y;j({title:"อัปเดตสำเร็จ",description:`อัปเดตสถานะนัดหมายเป็น ${H(O)} แล้ว`}),S()}catch(Y){console.error("Error updating appointment:",Y),j({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัปเดตสถานะได้",variant:"destructive"})}},D=async()=>{if(!l||!v.vaccineType||!v.doseNumber){j({title:"ข้อมูลไม่ครบถ้วน",description:"กรุณาเลือกผู้ป่วย ประเภทวัคซีน และโดสที่ฉีด",variant:"destructive"});return}const N=i.find(Y=>Y.vaccine_type===v.vaccineType),O=parseInt(v.doseNumber);if(N&&O>N.total_doses){j({title:"โดสไม่ถูกต้อง",description:`วัคซีน ${N.vaccine_name} มีเพียง ${N.total_doses} เข็ม`,variant:"destructive"});return}try{const Y=new Date().toISOString().split("T")[0],J=new Date().toTimeString().slice(0,5),Q=v.doseNumber==="1"?"เข็มที่ 1":v.doseNumber==="2"?"เข็มที่ 2":v.doseNumber==="3"?"เข็มที่ 3":`เข็มที่ ${v.doseNumber}`,ge={patient_name:l.full_name,patient_phone:l.phone,patient_id_number:l.registration_id,line_user_id:l.line_user_id,vaccine_type:v.vaccineType,appointment_date:Y,appointment_time:J,status:"completed",scheduled_by:"walk_in",notes:`ฉีดวัคซีน Walk-in ${Q} (${N==null?void 0:N.vaccine_name}) วันนี้${v.notes?" - "+v.notes:""}`},{error:ce}=await B.from("appointments").insert([ge]);if(ce)throw ce;j({title:"บันทึกสำเร็จ",description:`บันทึกการฉีดวัคซีน ${N==null?void 0:N.vaccine_name} ${Q} ของ ${l.full_name} แล้ว`}),m(null),f(""),x({vaccineType:"",doseNumber:"1",notes:""}),S()}catch(Y){console.error("Error creating walk-in vaccination:",Y),j({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกการฉีดวัคซีนได้",variant:"destructive"})}};u.useEffect(()=>{_(r),C(),T()},[r]);const k=N=>{o(N)},H=N=>{switch(N){case"scheduled":return"นัดหมาย";case"completed":return"เสร็จสิ้น";case"cancelled":return"ยกเลิก";case"no_show":return"ไม่มา";default:return N}},w=N=>{switch(N){case"scheduled":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"no_show":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=N=>{switch(N){case"scheduled":return e.jsx($e,{className:"h-4 w-4"});case"completed":return e.jsx(Z,{className:"h-4 w-4"});case"cancelled":return e.jsx(Ht,{className:"h-4 w-4"});case"no_show":return e.jsx(Ht,{className:"h-4 w-4"});default:return e.jsx($e,{className:"h-4 w-4"})}},E=t.filter(N=>N.status==="completed").length,P=t.filter(N=>N.status==="scheduled").length,L=t.length,z=r===new Date().toISOString().split("T")[0],I=z?"วันนี้":new Date(r).toLocaleDateString("th-TH");return e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(il,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Staff Portal"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"จัดการระบบโรงพยาบาลวัคซีน"})]})]})}),e.jsxs(Xe,{value:g,onValueChange:b,className:"w-full",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-2 lg:w-auto lg:grid-cols-2",children:[e.jsxs(K,{value:"appointments",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"นัดหมายและการฉีด"}),e.jsx("span",{className:"sm:hidden",children:"นัดหมาย"})]}),e.jsxs(K,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"ตั้งค่าระบบ"}),e.jsx("span",{className:"sm:hidden",children:"ตั้งค่า"})]})]}),e.jsxs(ee,{value:"appointments",className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{htmlFor:"date-picker",className:"text-sm font-medium",children:"เลือกวันที่:"}),e.jsx(se,{id:"date-picker",type:"date",value:r,onChange:N=>k(N.target.value),className:"w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{onClick:()=>k(new Date().toISOString().split("T")[0]),variant:"outline",size:"sm",disabled:z,children:"วันนี้"}),e.jsx(M,{onClick:()=>{const N=new Date;N.setDate(N.getDate()+1),k(N.toISOString().split("T")[0])},variant:"outline",size:"sm",children:"พรุ่งนี้"}),e.jsxs(M,{onClick:S,disabled:a,variant:"outline",size:"sm",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),"รีเฟรช"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ve,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["นัดหมาย",I]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:L})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Z,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ฉีดแล้ว"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:E})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx($e,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"รอฉีด"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:P})]})]})})}),e.jsx(A,{children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(vs,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"อัตราสำเร็จ"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[L>0?Math.round(E/L*100):0,"%"]})]})]})})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"บันทึกการฉีดวัคซีน Walk-in"]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"patientSearch",children:"ค้นหาผู้ป่วยที่ลงทะเบียนแล้ว *"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{id:"patientSearch",value:h,onChange:N=>f(N.target.value),placeholder:"กรอกชื่อ หรือเบอร์โทรศัพท์เพื่อค้นหา",className:"pr-10"}),h&&e.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 bg-background border rounded-b-md shadow-lg max-h-60 overflow-y-auto",children:[d.filter(N=>N.full_name.toLowerCase().includes(h.toLowerCase())||N.phone.includes(h)||N.registration_id.includes(h)).slice(0,10).map(N=>e.jsxs("div",{className:"p-3 hover:bg-muted cursor-pointer border-b last:border-b-0 transition-colors",onClick:()=>{m(N),f("")},children:[e.jsx("div",{className:"font-medium text-foreground",children:N.full_name}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center justify-between",children:[e.jsxs("span",{children:["โทร: ",N.phone]}),e.jsxs("span",{className:"text-xs",children:["ID: ",N.registration_id]})]})]},N.id)),d.filter(N=>N.full_name.toLowerCase().includes(h.toLowerCase())||N.phone.includes(h)||N.registration_id.includes(h)).length===0&&e.jsx("div",{className:"p-3 text-center text-muted-foreground",children:"ไม่พบผู้ป่วยที่ตรงกับการค้นหา"})]})]})]}),l&&e.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:l.full_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:l.phone}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",l.registration_id]})]}),e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>m(null),children:e.jsx(Ht,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"vaccineType",children:"ประเภทวัคซีน *"}),e.jsxs(ft,{value:v.vaccineType,onValueChange:N=>x({...v,vaccineType:N,doseNumber:"1"}),children:[e.jsx(at,{children:e.jsx(gt,{placeholder:"เลือกประเภทวัคซีน"})}),e.jsx(nt,{children:i.filter(N=>N.vaccine_type&&N.vaccine_type.trim()!=="").map(N=>e.jsx(Ne,{value:N.vaccine_type,children:N.vaccine_name},N.id))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"doseNumber",children:"โดสที่มาฉีด *"}),e.jsxs(ft,{value:v.doseNumber,onValueChange:N=>x({...v,doseNumber:N}),disabled:!v.vaccineType,children:[e.jsx(at,{children:e.jsx(gt,{placeholder:v.vaccineType?"เลือกโดสที่ฉีด":"เลือกวัคซีนก่อน"})}),e.jsx(nt,{children:v.vaccineType&&(()=>{const N=i.find(U=>U.vaccine_type===v.vaccineType),O=(N==null?void 0:N.total_doses)||1,Y=[];for(let U=1;U<=O;U++){let J=`เข็มที่ ${U}`;U===1?J+=" (เข็มแรก)":U===O&&O>2?J+=" (เข็มสุดท้าย)":U>2&&(J+=" (เข็มเสริม)"),Y.push(e.jsx(Ne,{value:U.toString(),children:J},U))}return Y})()})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:v.vaccineType?(()=>{const N=i.find(O=>O.vaccine_type===v.vaccineType);return`วัคซีนนี้มี ${(N==null?void 0:N.total_doses)||1} เข็ม - เลือกโดสที่คนไข้มาฉีดครั้งนี้`})():"กรุณาเลือกประเภทวัคซีนก่อน"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notes",children:"หมายเหตุ"}),e.jsx(se,{id:"notes",value:v.notes,onChange:N=>x({...v,notes:N.target.value}),placeholder:"หมายเหตุเพิ่มเติม"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(M,{onClick:D,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"บันทึกการฉีดวัคซีน"]})})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"นัดหมาย",I]}),e.jsxs(te,{variant:"secondary",children:[t.length," รายการ"]})]})}),e.jsxs(R,{children:[e.jsx("div",{className:"space-y-4",children:t.map(N=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:N.patient_name}),e.jsxs(te,{className:w(N.status),children:[y(N.status),e.jsx("span",{className:"ml-1",children:H(N.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),N.vaccine_type]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),N.appointment_time||"ไม่ระบุเวลา"]}),N.patient_phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"📞"}),N.patient_phone]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🆔"}),N.appointment_id]})]}),N.notes&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:N.notes})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:N.status==="scheduled"&&e.jsxs(e.Fragment,{children:[e.jsxs(M,{size:"sm",onClick:()=>W(N.appointment_id,"completed"),className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"ฉีดแล้ว"]}),e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>W(N.appointment_id,"no_show"),className:"flex-1 sm:flex-none",children:[e.jsx(Ht,{className:"h-4 w-4 mr-1"}),"ไม่มา"]})]})})]})},N.id))}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ve,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsxs("p",{className:"text-muted-foreground",children:["ไม่มีนัดหมายใน",I]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:z?"ใช้ฟอร์มด้านบนสำหรับบันทึกการฉีดวัคซีน Walk-in":"เลือกวันที่อื่นเพื่อดูนัดหมาย"})]})]})]})]}),e.jsx(ee,{value:"settings",className:"space-y-6 mt-6",children:e.jsx(wo,{requiredPermission:"system:settings",showLoginForm:!1,fallback:e.jsx(A,{children:e.jsx(R,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ta,{className:"h-12 w-12 text-orange-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-700",children:"Admin Access Required"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"การตั้งค่าระบบต้องใช้สิทธิ์ Admin เท่านั้น"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"กรุณาติดต่อผู้ดูแลระบบเพื่อขอสิทธิ์เข้าถึง"})]})]})})}),children:e.jsx(Ru,{})})})]})]})},So=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(!1),[r,o]=u.useState({patientId:"",patientName:"",date:"",time:"",vaccine:"",hospital:"โรงพยาบาลโฮม",notes:"",notificationDate:""}),{toast:i}=fe(),c=async()=>{n(!0);try{const{data:m,error:g}=await B.from("patient_registrations").select("id, full_name, phone, line_user_id, registration_id, created_at").order("created_at",{ascending:!1});if(g)throw g;const b=(m==null?void 0:m.map(v=>({id:v.registration_id||v.id,name:v.full_name,phone:v.phone,lineId:v.line_user_id,createdAt:v.created_at})))||[];s(b),i({title:"โหลดข้อมูลสำเร็จ",description:`โหลดข้อมูลผู้ป่วย ${b.length} คน จาก Supabase`})}catch(m){i({title:"ข้อผิดพลาด",description:m.message||"ไม่สามารถโหลดข้อมูลได้",variant:"destructive"})}finally{n(!1)}},d=async()=>{if(t.length===0){i({title:"ไม่มีข้อมูล",description:"กรุณาโหลดข้อมูลผู้ป่วยก่อน",variant:"destructive"});return}n(!0);try{const{data:m,error:g}=await B.functions.invoke("google-sheets-integration",{body:{action:"syncPatients",data:t}});if(g)throw g;i({title:"Sync สำเร็จ",description:`Sync ข้อมูลผู้ป่วย ${t.length} คน ไป Google Sheets แล้ว`})}catch(m){i({title:"Sync ไม่สำเร็จ",description:m.message||"ไม่สามารถ sync ข้อมูลได้",variant:"destructive"})}finally{n(!1)}},p=async()=>{if(!r.patientId||!r.date||!r.time||!r.vaccine){i({title:"ข้อผิดพลาด",description:"กรุณากรอกข้อมูลให้ครบถ้วน",variant:"destructive"});return}n(!0);try{const m=t.find(v=>v.id===r.patientId);if(!m)throw new Error("ไม่พบข้อมูลผู้ป่วย");const g={patient_name:m.name,patient_phone:m.phone,patient_id_number:r.patientId,line_user_id:m.lineId,vaccine_type:r.vaccine,appointment_date:r.date,appointment_time:r.time,status:"scheduled",notes:r.notes||`นัดหมายจาก ${r.hospital}`,scheduled_by:"staff_manual"},{error:b}=await B.from("appointments").insert([g]);if(b)throw b;try{await B.functions.invoke("google-sheets-integration",{body:{action:"saveAppointment",data:{...r,patientName:m.name,patientPhone:m.phone,lineId:m.lineId,timestamp:new Date().toISOString()}}}),console.log("✅ Synced to Google Sheets successfully")}catch(v){console.warn("⚠️ Failed to sync to Google Sheets:",v)}i({title:"บันทึกสำเร็จ",description:`บันทึกการนัดหมายของ ${m.name} เรียบร้อยแล้ว (พร้อม sync ข้อมูลสำรอง)`}),o({patientId:"",patientName:"",date:"",time:"",vaccine:"",hospital:"โรงพยาบาลโฮม",notes:"",notificationDate:""})}catch(m){i({title:"ข้อผิดพลาด",description:m.message||"ไม่สามารถบันทึกได้",variant:"destructive"})}finally{n(!1)}},h=async()=>{if(!r.patientId||!r.date){i({title:"ข้อผิดพลาด",description:"กรุณากรอกข้อมูลผู้ป่วยและวันที่นัดก่อน",variant:"destructive"});return}n(!0);try{const m=t.find(v=>v.id===r.patientId);if(!m||!m.lineId)throw new Error("ไม่พบ LINE ID ของผู้ป่วย");const g=`🔔 แจ้งเตือนการนัดหมายฉีดวัคซีน

สวัสดีคุณ ${m.name}

📅 วันที่: ${r.date}
⏰ เวลา: ${r.time}
💉 วัคซีน: ${r.vaccine}
🏥 สถานที่: ${r.hospital}

${r.notes?`📝 หมายเหตุ: ${r.notes}`:""}

กรุณามาตามเวลานัดหมาย`,{error:b}=await B.functions.invoke("send-line-message",{body:{userId:m.lineId,message:g}});if(b)throw b;i({title:"ส่งการแจ้งเตือนสำเร็จ",description:`ส่งข้อความแจ้งเตือนไปยัง ${m.name} แล้ว`})}catch(m){i({title:"ข้อผิดพลาด",description:m.message||"ไม่สามารถตั้งค่าการแจ้งเตือนได้",variant:"destructive"})}finally{n(!1)}},f=m=>{const g=t.find(b=>b.id===m);g&&o(b=>({...b,patientId:m,patientName:g.name}))},l=async()=>{n(!0);try{const{data:m,error:g}=await B.from("appointments").select("*").order("created_at",{ascending:!1}).limit(100);if(g)throw g;if(!m||m.length===0){i({title:"ไม่มีข้อมูล",description:"ไม่พบข้อมูลนัดหมายที่จะ sync",variant:"destructive"});return}const{error:b}=await B.functions.invoke("google-sheets-integration",{body:{action:"syncAppointments",data:m}});if(b)throw b;i({title:"Sync สำเร็จ",description:`Sync ข้อมูลนัดหมาย ${m.length} รายการ ไป Google Sheets แล้ว`})}catch(m){i({title:"Sync ไม่สำเร็จ",description:m.message||"ไม่สามารถ sync ข้อมูลนัดหมายได้",variant:"destructive"})}finally{n(!1)}};return u.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs(A,{children:[e.jsx($,{className:"pb-3 md:pb-4",children:e.jsxs(F,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(Se,{className:"h-5 w-5 text-primary"}),"ข้อมูลผู้ป่วยจาก Supabase"]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs(M,{onClick:c,disabled:a,className:"h-10 md:h-11",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),a?"กำลังโหลด...":"โหลดข้อมูลผู้ป่วย"]}),e.jsxs(M,{onClick:d,disabled:a||t.length===0,variant:"outline",className:"h-10 md:h-11",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),a?"กำลัง Sync...":"Sync ไป Google Sheets"]})]}),e.jsxs(de,{children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsxs(ue,{children:[e.jsx("strong",{children:"ระบบ Dual Backup:"})," ข้อมูลจะถูกบันทึกใน Supabase (หลัก) และ sync ไป Google Sheets (สำรอง) เพื่อความปลอดภัยและการเข้าถึงที่สะดวก"]})]}),t.length>0&&e.jsxs("div",{className:"bg-muted/50 p-3 md:p-4 rounded-lg border",children:[e.jsxs("p",{className:"text-sm md:text-base font-medium mb-3",children:["ผู้ป่วยทั้งหมด: ",t.length," คน"]}),e.jsx("div",{className:"max-h-32 md:max-h-40 overflow-y-auto space-y-2",children:t.map(m=>e.jsxs("div",{className:"text-xs md:text-sm bg-background p-2 md:p-3 rounded border border-border/30",children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsx("div",{className:"text-muted-foreground",children:m.phone})]},m.id))})]})]})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-3 md:pb-4",children:e.jsxs(F,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(ve,{className:"h-5 w-5 text-primary"}),"บันทึกการนัดหมาย"]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"patient",className:"text-sm md:text-base font-medium",children:"เลือกผู้ป่วย"}),e.jsxs(ft,{value:r.patientId,onValueChange:f,children:[e.jsx(at,{className:"mt-1",children:e.jsx(gt,{placeholder:"เลือกผู้ป่วย"})}),e.jsx(nt,{children:t.filter(m=>m.id&&m.id.trim()!=="").map(m=>e.jsxs(Ne,{value:m.id,children:[m.name," - ",m.phone]},m.id))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"vaccine",className:"text-sm md:text-base font-medium",children:"ประเภทวัคซีน"}),e.jsxs(ft,{value:r.vaccine,onValueChange:m=>o(g=>({...g,vaccine:m})),children:[e.jsx(at,{className:"mt-1",children:e.jsx(gt,{placeholder:"เลือกประเภทวัคซีน"})}),e.jsxs(nt,{children:[e.jsx(Ne,{value:"COVID-19",children:"COVID-19"}),e.jsx(Ne,{value:"ไข้หวัดใหญ่",children:"ไข้หวัดใหญ่"}),e.jsx(Ne,{value:"โควิด + ไข้หวัดใหญ่",children:"โควิด + ไข้หวัดใหญ่"}),e.jsx(Ne,{value:"HPV",children:"HPV"}),e.jsx(Ne,{value:"MMR",children:"MMR"})]})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"date",className:"text-sm md:text-base font-medium",children:"วันที่นัด"}),e.jsx(se,{id:"date",type:"date",value:r.date,onChange:m=>o(g=>({...g,date:m.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"time",className:"text-sm md:text-base font-medium",children:"เวลา"}),e.jsx(se,{id:"time",type:"time",value:r.time,onChange:m=>o(g=>({...g,time:m.target.value})),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notes",className:"text-sm md:text-base font-medium",children:"หมายเหตุ"}),e.jsx(Ft,{id:"notes",placeholder:"หมายเหตุเพิ่มเติม",value:r.notes,onChange:m=>o(g=>({...g,notes:m.target.value})),className:"mt-1 min-h-[80px] md:min-h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs(M,{onClick:p,disabled:a,className:"h-10 md:h-11",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),a?"กำลังบันทึก...":"บันทึกการนัดหมาย"]}),e.jsxs(M,{onClick:l,disabled:a,variant:"outline",className:"h-10 md:h-11",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),a?"กำลัง Sync...":"Sync นัดหมายทั้งหมด"]})]})]})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-3 md:pb-4",children:e.jsxs(F,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(Ae,{className:"h-5 w-5 text-primary"}),"ส่งการแจ้งเตือน"]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notificationDate",className:"text-sm md:text-base font-medium",children:"วันที่ต้องการแจ้งเตือน"}),e.jsx(se,{id:"notificationDate",type:"date",value:r.notificationDate,onChange:m=>o(g=>({...g,notificationDate:m.target.value})),className:"mt-1"})]}),e.jsxs(de,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx(ue,{className:"text-sm md:text-base",children:"ระบบจะแจ้งเตือนผู้ป่วยผ่าน LINE ในวันที่กำหนด เพื่อเตือนเรื่องการนัดหมายฉีดวัคซีน"})]}),e.jsxs(M,{onClick:h,disabled:a,className:"w-full h-10 md:h-11",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),a?"กำลังส่ง...":"ส่งการแจ้งเตือนทันที"]})]})]})]})},Mu=()=>e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Xe,{defaultValue:"designer",className:"w-full",children:[e.jsx("div",{className:"container mx-auto pt-6",children:e.jsxs(Oe,{className:"grid w-full grid-cols-8 max-w-7xl mx-auto",children:[e.jsx(K,{value:"setup",children:"คู่มือติดตั้ง"}),e.jsx(K,{value:"designer",children:"Workflow Designer"}),e.jsx(K,{value:"analyzer",children:"Analyzer"}),e.jsx(K,{value:"LineBot",children:"LINE Bot"}),e.jsx(K,{value:"PatientPortal",children:"ลงทะเบียนผู้ป่วย"}),e.jsx(K,{value:"StaffPortal",children:"เจ้าหน้าที่"}),e.jsx(K,{value:"googlesheets",children:"Google Sheets"}),e.jsx(K,{value:"staff",children:"Dashboard เดิม"})]})}),e.jsx(ee,{value:"designer",className:"mt-0",children:e.jsx(bu,{})}),e.jsx(ee,{value:"analyzer",className:"mt-0",children:e.jsx(vu,{})}),e.jsx(ee,{value:"staff",className:"mt-0",children:e.jsx(_u,{})}),e.jsx(ee,{value:"patient",className:"mt-0",children:e.jsx(Su,{})}),e.jsx(ee,{value:"setup",className:"mt-0",children:e.jsx(Cu,{})}),e.jsx(ee,{value:"LineBot",className:"mt-0",children:e.jsx(yo,{})}),e.jsx(ee,{value:"PatientPortal",className:"mt-0",children:e.jsx(jo,{})}),e.jsx(ee,{value:"StaffPortal",className:"mt-0",children:e.jsx(_o,{})}),e.jsx(ee,{value:"googlesheets",className:"mt-0",children:e.jsx(So,{})})]})}),Ou=()=>{const t=Xn();return u.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},xn=()=>e.jsx(yo,{}),fn=()=>e.jsx(jo,{});var Ta="Checkbox",[Lu]=Pn(Ta),[$u,Fu]=Lu(Ta),Co=u.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:n,checked:r,defaultChecked:o,required:i,disabled:c,value:d="on",onCheckedChange:p,form:h,...f}=t,[l,m]=u.useState(null),g=ya(s,S=>m(S)),b=u.useRef(!1),v=l?h||!!l.closest("form"):!0,[x=!1,j]=An({prop:r,defaultProp:o,onChange:p}),_=u.useRef(x);return u.useEffect(()=>{const S=l==null?void 0:l.form;if(S){const C=()=>j(_.current);return S.addEventListener("reset",C),()=>S.removeEventListener("reset",C)}},[l,j]),e.jsxs($u,{scope:a,state:x,disabled:c,children:[e.jsx(Je.button,{type:"button",role:"checkbox","aria-checked":ht(x)?"mixed":x,"aria-required":i,"data-state":Eo(x),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:g,onKeyDown:Me(t.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:Me(t.onClick,S=>{j(C=>ht(C)?!0:!C),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&e.jsx(Wu,{control:l,bubbles:!b.current,name:n,value:d,checked:x,required:i,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:ht(o)?!1:o})]})});Co.displayName=Ta;var ko="CheckboxIndicator",Do=u.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:n,...r}=t,o=Fu(ko,a);return e.jsx(Rn,{present:n||ht(o.state)||o.state===!0,children:e.jsx(Je.span,{"data-state":Eo(o.state),"data-disabled":o.disabled?"":void 0,...r,ref:s,style:{pointerEvents:"none",...t.style}})})});Do.displayName=ko;var Wu=t=>{const{control:s,checked:a,bubbles:n=!0,defaultChecked:r,...o}=t,i=u.useRef(null),c=Ui(a),d=Hi(s);u.useEffect(()=>{const h=i.current,f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==a&&m){const g=new Event("click",{bubbles:n});h.indeterminate=ht(a),m.call(h,ht(a)?!1:a),h.dispatchEvent(g)}},[c,a,n]);const p=u.useRef(ht(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r??p.current,...o,tabIndex:-1,ref:i,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ht(t){return t==="indeterminate"}function Eo(t){return ht(t)?"indeterminate":t?"checked":"unchecked"}var Io=Co,zu=Do;const To=u.forwardRef(({className:t,...s},a)=>e.jsx(Io,{ref:a,className:G("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(zu,{className:G("flex items-center justify-center text-current"),children:e.jsx(er,{className:"h-4 w-4"})})}));To.displayName=Io.displayName;function re(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function Re(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}function be(t,s){const a=re(t);return isNaN(s)?Re(t,NaN):(s&&a.setDate(a.getDate()+s),a)}function Be(t,s){const a=re(t);if(isNaN(s))return Re(t,NaN);if(!s)return a;const n=a.getDate(),r=Re(t,a.getTime());r.setMonth(a.getMonth()+s+1,0);const o=r.getDate();return n>=o?r:(a.setFullYear(r.getFullYear(),r.getMonth(),n),a)}const Pa=6048e5,Bu=864e5,Po=6e4,Ao=36e5;let Uu={};function Xt(){return Uu}function Ke(t,s){var c,d,p,h;const a=Xt(),n=(s==null?void 0:s.weekStartsOn)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??a.weekStartsOn??((h=(p=a.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)??0,r=re(t),o=r.getDay(),i=(o<n?7:0)+o-n;return r.setDate(r.getDate()-i),r.setHours(0,0,0,0),r}function jt(t){return Ke(t,{weekStartsOn:1})}function Ro(t){const s=re(t),a=s.getFullYear(),n=Re(t,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const r=jt(n),o=Re(t,0);o.setFullYear(a,0,4),o.setHours(0,0,0,0);const i=jt(o);return s.getTime()>=r.getTime()?a+1:s.getTime()>=i.getTime()?a:a-1}function Ot(t){const s=re(t);return s.setHours(0,0,0,0),s}function bs(t){const s=re(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function Fe(t,s){const a=Ot(t),n=Ot(s),r=+a-bs(a),o=+n-bs(n);return Math.round((r-o)/Bu)}function Hu(t){const s=Ro(t),a=Re(t,0);return a.setFullYear(s,0,4),a.setHours(0,0,0,0),jt(a)}function ua(t,s){const a=s*7;return be(t,a)}function Vu(t,s){return Be(t,s*12)}function Yu(t){let s;return t.forEach(function(a){const n=re(a);(s===void 0||s<n||isNaN(Number(n)))&&(s=n)}),s||new Date(NaN)}function Gu(t){let s;return t.forEach(a=>{const n=re(a);(!s||s>n||isNaN(+n))&&(s=n)}),s||new Date(NaN)}function ke(t,s){const a=Ot(t),n=Ot(s);return+a==+n}function Aa(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function qu(t){if(!Aa(t)&&typeof t!="number")return!1;const s=re(t);return!isNaN(Number(s))}function Jt(t,s){const a=re(t),n=re(s),r=a.getFullYear()-n.getFullYear(),o=a.getMonth()-n.getMonth();return r*12+o}function Ku(t,s,a){const n=Ke(t,a),r=Ke(s,a),o=+n-bs(n),i=+r-bs(r);return Math.round((o-i)/Pa)}function Us(t,s){const a=re(t),n=re(s),r=gn(a,n),o=Math.abs(Fe(a,n));a.setDate(a.getDate()-r*o);const i=+(gn(a,n)===-r),c=r*(o-i);return c===0?0:c}function gn(t,s){const a=t.getFullYear()-s.getFullYear()||t.getMonth()-s.getMonth()||t.getDate()-s.getDate()||t.getHours()-s.getHours()||t.getMinutes()-s.getMinutes()||t.getSeconds()-s.getSeconds()||t.getMilliseconds()-s.getMilliseconds();return a<0?-1:a>0?1:a}function Ra(t){const s=re(t),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(23,59,59,999),s}function Ie(t){const s=re(t);return s.setDate(1),s.setHours(0,0,0,0),s}function Mo(t){const s=re(t),a=Re(t,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}function Ma(t,s){var c,d,p,h;const a=Xt(),n=(s==null?void 0:s.weekStartsOn)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??a.weekStartsOn??((h=(p=a.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)??0,r=re(t),o=r.getDay(),i=(o<n?-7:0)+6-(o-n);return r.setDate(r.getDate()+i),r.setHours(23,59,59,999),r}function Oo(t){return Ma(t,{weekStartsOn:1})}const Ju={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Xu=(t,s,a)=>{let n;const r=Ju[t];return typeof r=="string"?n=r:s===1?n=r.one:n=r.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+n:n+" ago":n};function At(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const Qu={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Zu={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},em={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tm={date:At({formats:Qu,defaultWidth:"full"}),time:At({formats:Zu,defaultWidth:"full"}),dateTime:At({formats:em,defaultWidth:"full"})},sm={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},am=(t,s,a,n)=>sm[t];function Ye(t){return(s,a)=>{const n=a!=null&&a.context?String(a.context):"standalone";let r;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,c=a!=null&&a.width?String(a.width):i;r=t.formattingValues[c]||t.formattingValues[i]}else{const i=t.defaultWidth,c=a!=null&&a.width?String(a.width):t.defaultWidth;r=t.values[c]||t.values[i]}const o=t.argumentCallback?t.argumentCallback(s):s;return r[o]}}const nm={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},rm={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},om={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},im={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},lm={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},cm={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dm=(t,s)=>{const a=Number(t),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},um={ordinalNumber:dm,era:Ye({values:nm,defaultWidth:"wide"}),quarter:Ye({values:rm,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ye({values:om,defaultWidth:"wide"}),day:Ye({values:im,defaultWidth:"wide"}),dayPeriod:Ye({values:lm,defaultWidth:"wide",formattingValues:cm,defaultFormattingWidth:"wide"})};function Ge(t){return(s,a={})=>{const n=a.width,r=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=s.match(r);if(!o)return null;const i=o[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?hm(c,f=>f.test(i)):mm(c,f=>f.test(i));let p;p=t.valueCallback?t.valueCallback(d):d,p=a.valueCallback?a.valueCallback(p):p;const h=s.slice(i.length);return{value:p,rest:h}}}function mm(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function hm(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function Lo(t){return(s,a={})=>{const n=s.match(t.matchPattern);if(!n)return null;const r=n[0],o=s.match(t.parsePattern);if(!o)return null;let i=t.valueCallback?t.valueCallback(o[0]):o[0];i=a.valueCallback?a.valueCallback(i):i;const c=s.slice(r.length);return{value:i,rest:c}}}const pm=/^(\d+)(th|st|nd|rd)?/i,xm=/\d+/i,fm={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},gm={any:[/^b/i,/^(a|c)/i]},vm={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},bm={any:[/1/i,/2/i,/3/i,/4/i]},ym={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jm={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Nm={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},wm={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},_m={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Sm={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Cm={ordinalNumber:Lo({matchPattern:pm,parsePattern:xm,valueCallback:t=>parseInt(t,10)}),era:Ge({matchPatterns:fm,defaultMatchWidth:"wide",parsePatterns:gm,defaultParseWidth:"any"}),quarter:Ge({matchPatterns:vm,defaultMatchWidth:"wide",parsePatterns:bm,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ge({matchPatterns:ym,defaultMatchWidth:"wide",parsePatterns:jm,defaultParseWidth:"any"}),day:Ge({matchPatterns:Nm,defaultMatchWidth:"wide",parsePatterns:wm,defaultParseWidth:"any"}),dayPeriod:Ge({matchPatterns:_m,defaultMatchWidth:"any",parsePatterns:Sm,defaultParseWidth:"any"})},$o={code:"en-US",formatDistance:Xu,formatLong:tm,formatRelative:am,localize:um,match:Cm,options:{weekStartsOn:0,firstWeekContainsDate:1}};function km(t){const s=re(t);return Fe(s,Mo(s))+1}function Fo(t){const s=re(t),a=+jt(s)-+Hu(s);return Math.round(a/Pa)+1}function Wo(t,s){var h,f,l,m;const a=re(t),n=a.getFullYear(),r=Xt(),o=(s==null?void 0:s.firstWeekContainsDate)??((f=(h=s==null?void 0:s.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(l=r.locale)==null?void 0:l.options)==null?void 0:m.firstWeekContainsDate)??1,i=Re(t,0);i.setFullYear(n+1,0,o),i.setHours(0,0,0,0);const c=Ke(i,s),d=Re(t,0);d.setFullYear(n,0,o),d.setHours(0,0,0,0);const p=Ke(d,s);return a.getTime()>=c.getTime()?n+1:a.getTime()>=p.getTime()?n:n-1}function Dm(t,s){var c,d,p,h;const a=Xt(),n=(s==null?void 0:s.firstWeekContainsDate)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(p=a.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,r=Wo(t,s),o=Re(t,0);return o.setFullYear(r,0,n),o.setHours(0,0,0,0),Ke(o,s)}function zo(t,s){const a=re(t),n=+Ke(a,s)-+Dm(a,s);return Math.round(n/Pa)+1}function le(t,s){const a=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return a+n}const ut={y(t,s){const a=t.getFullYear(),n=a>0?a:1-a;return le(s==="yy"?n%100:n,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):le(a+1,2)},d(t,s){return le(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return le(t.getHours()%12||12,s.length)},H(t,s){return le(t.getHours(),s.length)},m(t,s){return le(t.getMinutes(),s.length)},s(t,s){return le(t.getSeconds(),s.length)},S(t,s){const a=s.length,n=t.getMilliseconds(),r=Math.trunc(n*Math.pow(10,a-3));return le(r,s.length)}},It={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},vn={G:function(t,s,a){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(n,{width:"abbreviated"});case"GGGGG":return a.era(n,{width:"narrow"});case"GGGG":default:return a.era(n,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const n=t.getFullYear(),r=n>0?n:1-n;return a.ordinalNumber(r,{unit:"year"})}return ut.y(t,s)},Y:function(t,s,a,n){const r=Wo(t,n),o=r>0?r:1-r;if(s==="YY"){const i=o%100;return le(i,2)}return s==="Yo"?a.ordinalNumber(o,{unit:"year"}):le(o,s.length)},R:function(t,s){const a=Ro(t);return le(a,s.length)},u:function(t,s){const a=t.getFullYear();return le(a,s.length)},Q:function(t,s,a){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return le(n,2);case"Qo":return a.ordinalNumber(n,{unit:"quarter"});case"QQQ":return a.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,a){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return le(n,2);case"qo":return a.ordinalNumber(n,{unit:"quarter"});case"qqq":return a.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,a){const n=t.getMonth();switch(s){case"M":case"MM":return ut.M(t,s);case"Mo":return a.ordinalNumber(n+1,{unit:"month"});case"MMM":return a.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,a){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return le(n+1,2);case"Lo":return a.ordinalNumber(n+1,{unit:"month"});case"LLL":return a.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,a,n){const r=zo(t,n);return s==="wo"?a.ordinalNumber(r,{unit:"week"}):le(r,s.length)},I:function(t,s,a){const n=Fo(t);return s==="Io"?a.ordinalNumber(n,{unit:"week"}):le(n,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):ut.d(t,s)},D:function(t,s,a){const n=km(t);return s==="Do"?a.ordinalNumber(n,{unit:"dayOfYear"}):le(n,s.length)},E:function(t,s,a){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(n,{width:"short",context:"formatting"});case"EEEE":default:return a.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,a,n){const r=t.getDay(),o=(r-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(o);case"ee":return le(o,2);case"eo":return a.ordinalNumber(o,{unit:"day"});case"eee":return a.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})}},c:function(t,s,a,n){const r=t.getDay(),o=(r-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(o);case"cc":return le(o,s.length);case"co":return a.ordinalNumber(o,{unit:"day"});case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})}},i:function(t,s,a){const n=t.getDay(),r=n===0?7:n;switch(s){case"i":return String(r);case"ii":return le(r,s.length);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return a.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(n,{width:"short",context:"formatting"});case"iiii":default:return a.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,a){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,s,a){const n=t.getHours();let r;switch(n===12?r=It.noon:n===0?r=It.midnight:r=n/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,s,a){const n=t.getHours();let r;switch(n>=17?r=It.evening:n>=12?r=It.afternoon:n>=4?r=It.morning:r=It.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),a.ordinalNumber(n,{unit:"hour"})}return ut.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):ut.H(t,s)},K:function(t,s,a){const n=t.getHours()%12;return s==="Ko"?a.ordinalNumber(n,{unit:"hour"}):le(n,s.length)},k:function(t,s,a){let n=t.getHours();return n===0&&(n=24),s==="ko"?a.ordinalNumber(n,{unit:"hour"}):le(n,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):ut.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):ut.s(t,s)},S:function(t,s){return ut.S(t,s)},X:function(t,s,a){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return yn(n);case"XXXX":case"XX":return bt(n);case"XXXXX":case"XXX":default:return bt(n,":")}},x:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"x":return yn(n);case"xxxx":case"xx":return bt(n);case"xxxxx":case"xxx":default:return bt(n,":")}},O:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+bn(n,":");case"OOOO":default:return"GMT"+bt(n,":")}},z:function(t,s,a){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+bn(n,":");case"zzzz":default:return"GMT"+bt(n,":")}},t:function(t,s,a){const n=Math.trunc(t.getTime()/1e3);return le(n,s.length)},T:function(t,s,a){const n=t.getTime();return le(n,s.length)}};function bn(t,s=""){const a=t>0?"-":"+",n=Math.abs(t),r=Math.trunc(n/60),o=n%60;return o===0?a+String(r):a+String(r)+s+le(o,2)}function yn(t,s){return t%60===0?(t>0?"-":"+")+le(Math.abs(t)/60,2):bt(t,s)}function bt(t,s=""){const a=t>0?"-":"+",n=Math.abs(t),r=le(Math.trunc(n/60),2),o=le(n%60,2);return a+r+s+o}const jn=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Bo=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Em=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],n=a[1],r=a[2];if(!r)return jn(t,s);let o;switch(n){case"P":o=s.dateTime({width:"short"});break;case"PP":o=s.dateTime({width:"medium"});break;case"PPP":o=s.dateTime({width:"long"});break;case"PPPP":default:o=s.dateTime({width:"full"});break}return o.replace("{{date}}",jn(n,s)).replace("{{time}}",Bo(r,s))},Im={p:Bo,P:Em},Tm=/^D+$/,Pm=/^Y+$/,Am=["D","DD","YY","YYYY"];function Rm(t){return Tm.test(t)}function Mm(t){return Pm.test(t)}function Om(t,s,a){const n=Lm(t,s,a);if(console.warn(n),Am.includes(t))throw new RangeError(n)}function Lm(t,s,a){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $m=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Fm=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Wm=/^'([^]*?)'?$/,zm=/''/g,Bm=/[a-zA-Z]/;function Pe(t,s,a){var h,f,l,m,g,b,v,x;const n=Xt(),r=(a==null?void 0:a.locale)??n.locale??$o,o=(a==null?void 0:a.firstWeekContainsDate)??((f=(h=a==null?void 0:a.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(l=n.locale)==null?void 0:l.options)==null?void 0:m.firstWeekContainsDate)??1,i=(a==null?void 0:a.weekStartsOn)??((b=(g=a==null?void 0:a.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((x=(v=n.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,c=re(t);if(!qu(c))throw new RangeError("Invalid time value");let d=s.match(Fm).map(j=>{const _=j[0];if(_==="p"||_==="P"){const S=Im[_];return S(j,r.formatLong)}return j}).join("").match($m).map(j=>{if(j==="''")return{isToken:!1,value:"'"};const _=j[0];if(_==="'")return{isToken:!1,value:Um(j)};if(vn[_])return{isToken:!0,value:j};if(_.match(Bm))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:j}});r.localize.preprocessor&&(d=r.localize.preprocessor(c,d));const p={firstWeekContainsDate:o,weekStartsOn:i,locale:r};return d.map(j=>{if(!j.isToken)return j.value;const _=j.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&Mm(_)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&Rm(_))&&Om(_,s,String(t));const S=vn[_[0]];return S(c,_,r.localize,p)}).join("")}function Um(t){const s=t.match(Wm);return s?s[1].replace(zm,"'"):t}function Hm(t){const s=re(t),a=s.getFullYear(),n=s.getMonth(),r=Re(t,0);return r.setFullYear(a,n+1,0),r.setHours(0,0,0,0),r.getDate()}function Vm(t){return Math.trunc(+re(t)/1e3)}function Ym(t){const s=re(t),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(0,0,0,0),s}function Gm(t,s){return Ku(Ym(t),Ie(t),s)+1}function ma(t,s){const a=re(t),n=re(s);return a.getTime()>n.getTime()}function Uo(t,s){const a=re(t),n=re(s);return+a<+n}function Oa(t,s){const a=re(t),n=re(s);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}function qm(t,s){const a=re(t),n=re(s);return a.getFullYear()===n.getFullYear()}function Hs(t,s){return be(t,-s)}function Vs(t,s){const n=Qm(t);let r;if(n.date){const d=Zm(n.date,2);r=eh(d.restDateString,d.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const o=r.getTime();let i=0,c;if(n.time&&(i=th(n.time),isNaN(i)))return new Date(NaN);if(n.timezone){if(c=sh(n.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(o+i),p=new Date(0);return p.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),p.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),p}return new Date(o+i+c)}const us={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Km=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Jm=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Xm=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Qm(t){const s={},a=t.split(us.dateTimeDelimiter);let n;if(a.length>2)return s;if(/:/.test(a[0])?n=a[0]:(s.date=a[0],n=a[1],us.timeZoneDelimiter.test(s.date)&&(s.date=t.split(us.timeZoneDelimiter)[0],n=t.substr(s.date.length,t.length))),n){const r=us.timezone.exec(n);r?(s.time=n.replace(r[1],""),s.timezone=r[1]):s.time=n}return s}function Zm(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),n=t.match(a);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?r:o*100,restDateString:t.slice((n[1]||n[2]).length)}}function eh(t,s){if(s===null)return new Date(NaN);const a=t.match(Km);if(!a)return new Date(NaN);const n=!!a[4],r=Ut(a[1]),o=Ut(a[2])-1,i=Ut(a[3]),c=Ut(a[4]),d=Ut(a[5])-1;if(n)return ih(s,c,d)?ah(s,c,d):new Date(NaN);{const p=new Date(0);return!rh(s,o,i)||!oh(s,r)?new Date(NaN):(p.setUTCFullYear(s,o,Math.max(r,i)),p)}}function Ut(t){return t?parseInt(t):1}function th(t){const s=t.match(Jm);if(!s)return NaN;const a=Ys(s[1]),n=Ys(s[2]),r=Ys(s[3]);return lh(a,n,r)?a*Ao+n*Po+r*1e3:NaN}function Ys(t){return t&&parseFloat(t.replace(",","."))||0}function sh(t){if(t==="Z")return 0;const s=t.match(Xm);if(!s)return 0;const a=s[1]==="+"?-1:1,n=parseInt(s[2]),r=s[3]&&parseInt(s[3])||0;return ch(n,r)?a*(n*Ao+r*Po):NaN}function ah(t,s,a){const n=new Date(0);n.setUTCFullYear(t,0,4);const r=n.getUTCDay()||7,o=(s-1)*7+a+1-r;return n.setUTCDate(n.getUTCDate()+o),n}const nh=[31,null,31,30,31,30,31,31,30,31,30,31];function Ho(t){return t%400===0||t%4===0&&t%100!==0}function rh(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(nh[s]||(Ho(t)?29:28))}function oh(t,s){return s>=1&&s<=(Ho(t)?366:365)}function ih(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function lh(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function ch(t,s){return s>=0&&s<=59}function Gs(t,s){const a=re(t),n=a.getFullYear(),r=a.getDate(),o=Re(t,0);o.setFullYear(n,s,15),o.setHours(0,0,0,0);const i=Hm(o);return a.setMonth(s,Math.min(r,i)),a}function Nn(t,s){const a=re(t);return isNaN(+a)?Re(t,NaN):(a.setFullYear(s),a)}const dh={lessThanXSeconds:{one:"น้อยกว่า 1 วินาที",other:"น้อยกว่า {{count}} วินาที"},xSeconds:{one:"1 วินาที",other:"{{count}} วินาที"},halfAMinute:"ครึ่งนาที",lessThanXMinutes:{one:"น้อยกว่า 1 นาที",other:"น้อยกว่า {{count}} นาที"},xMinutes:{one:"1 นาที",other:"{{count}} นาที"},aboutXHours:{one:"ประมาณ 1 ชั่วโมง",other:"ประมาณ {{count}} ชั่วโมง"},xHours:{one:"1 ชั่วโมง",other:"{{count}} ชั่วโมง"},xDays:{one:"1 วัน",other:"{{count}} วัน"},aboutXWeeks:{one:"ประมาณ 1 สัปดาห์",other:"ประมาณ {{count}} สัปดาห์"},xWeeks:{one:"1 สัปดาห์",other:"{{count}} สัปดาห์"},aboutXMonths:{one:"ประมาณ 1 เดือน",other:"ประมาณ {{count}} เดือน"},xMonths:{one:"1 เดือน",other:"{{count}} เดือน"},aboutXYears:{one:"ประมาณ 1 ปี",other:"ประมาณ {{count}} ปี"},xYears:{one:"1 ปี",other:"{{count}} ปี"},overXYears:{one:"มากกว่า 1 ปี",other:"มากกว่า {{count}} ปี"},almostXYears:{one:"เกือบ 1 ปี",other:"เกือบ {{count}} ปี"}},uh=(t,s,a)=>{let n;const r=dh[t];return typeof r=="string"?n=r:s===1?n=r.one:n=r.other.replace("{{count}}",String(s)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?t==="halfAMinute"?"ใน"+n:"ใน "+n:n+"ที่ผ่านมา":n},mh={full:"วันEEEEที่ do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},hh={full:"H:mm:ss น. zzzz",long:"H:mm:ss น. z",medium:"H:mm:ss น.",short:"H:mm น."},ph={full:"{{date}} 'เวลา' {{time}}",long:"{{date}} 'เวลา' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xh={date:At({formats:mh,defaultWidth:"full"}),time:At({formats:hh,defaultWidth:"medium"}),dateTime:At({formats:ph,defaultWidth:"full"})},fh={lastWeek:"eeee'ที่แล้วเวลา' p",yesterday:"'เมื่อวานนี้เวลา' p",today:"'วันนี้เวลา' p",tomorrow:"'พรุ่งนี้เวลา' p",nextWeek:"eeee 'เวลา' p",other:"P"},gh=(t,s,a,n)=>fh[t],vh={narrow:["B","คศ"],abbreviated:["BC","ค.ศ."],wide:["ปีก่อนคริสตกาล","คริสต์ศักราช"]},bh={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["ไตรมาสแรก","ไตรมาสที่สอง","ไตรมาสที่สาม","ไตรมาสที่สี่"]},yh={narrow:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],short:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],abbreviated:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],wide:["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"]},jh={narrow:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],abbreviated:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],wide:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"]},Nh={narrow:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"เช้า",afternoon:"บ่าย",evening:"เย็น",night:"กลางคืน"},abbreviated:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"เช้า",afternoon:"บ่าย",evening:"เย็น",night:"กลางคืน"},wide:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"เช้า",afternoon:"บ่าย",evening:"เย็น",night:"กลางคืน"}},wh={narrow:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"ตอนเช้า",afternoon:"ตอนกลางวัน",evening:"ตอนเย็น",night:"ตอนกลางคืน"},abbreviated:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"ตอนเช้า",afternoon:"ตอนกลางวัน",evening:"ตอนเย็น",night:"ตอนกลางคืน"},wide:{am:"ก่อนเที่ยง",pm:"หลังเที่ยง",midnight:"เที่ยงคืน",noon:"เที่ยง",morning:"ตอนเช้า",afternoon:"ตอนกลางวัน",evening:"ตอนเย็น",night:"ตอนกลางคืน"}},_h=(t,s)=>String(t),Sh={ordinalNumber:_h,era:Ye({values:vh,defaultWidth:"wide"}),quarter:Ye({values:bh,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ye({values:jh,defaultWidth:"wide"}),day:Ye({values:yh,defaultWidth:"wide"}),dayPeriod:Ye({values:Nh,defaultWidth:"wide",formattingValues:wh,defaultFormattingWidth:"wide"})},Ch=/^\d+/i,kh=/\d+/i,Dh={narrow:/^([bB]|[aA]|คศ)/i,abbreviated:/^([bB]\.?\s?[cC]\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?|ค\.?ศ\.?)/i,wide:/^(ก่อนคริสตกาล|คริสต์ศักราช|คริสตกาล)/i},Eh={any:[/^[bB]/i,/^(^[aA]|ค\.?ศ\.?|คริสตกาล|คริสต์ศักราช|)/i]},Ih={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^ไตรมาส(ที่)? ?[1234]/i},Th={any:[/(1|แรก|หนึ่ง)/i,/(2|สอง)/i,/(3|สาม)/i,/(4|สี่)/i]},Ph={narrow:/^(ม\.?ค\.?|ก\.?พ\.?|มี\.?ค\.?|เม\.?ย\.?|พ\.?ค\.?|มิ\.?ย\.?|ก\.?ค\.?|ส\.?ค\.?|ก\.?ย\.?|ต\.?ค\.?|พ\.?ย\.?|ธ\.?ค\.?)/i,abbreviated:/^(ม\.?ค\.?|ก\.?พ\.?|มี\.?ค\.?|เม\.?ย\.?|พ\.?ค\.?|มิ\.?ย\.?|ก\.?ค\.?|ส\.?ค\.?|ก\.?ย\.?|ต\.?ค\.?|พ\.?ย\.?|ธ\.?ค\.?')/i,wide:/^(มกราคม|กุมภาพันธ์|มีนาคม|เมษายน|พฤษภาคม|มิถุนายน|กรกฎาคม|สิงหาคม|กันยายน|ตุลาคม|พฤศจิกายน|ธันวาคม)/i},Ah={wide:[/^มก/i,/^กุม/i,/^มี/i,/^เม/i,/^พฤษ/i,/^มิ/i,/^กรก/i,/^ส/i,/^กัน/i,/^ต/i,/^พฤศ/i,/^ธ/i],any:[/^ม\.?ค\.?/i,/^ก\.?พ\.?/i,/^มี\.?ค\.?/i,/^เม\.?ย\.?/i,/^พ\.?ค\.?/i,/^มิ\.?ย\.?/i,/^ก\.?ค\.?/i,/^ส\.?ค\.?/i,/^ก\.?ย\.?/i,/^ต\.?ค\.?/i,/^พ\.?ย\.?/i,/^ธ\.?ค\.?/i]},Rh={narrow:/^(อา\.?|จ\.?|อ\.?|พฤ\.?|พ\.?|ศ\.?|ส\.?)/i,short:/^(อา\.?|จ\.?|อ\.?|พฤ\.?|พ\.?|ศ\.?|ส\.?)/i,abbreviated:/^(อา\.?|จ\.?|อ\.?|พฤ\.?|พ\.?|ศ\.?|ส\.?)/i,wide:/^(อาทิตย์|จันทร์|อังคาร|พุธ|พฤหัสบดี|ศุกร์|เสาร์)/i},Mh={wide:[/^อา/i,/^จั/i,/^อั/i,/^พุธ/i,/^พฤ/i,/^ศ/i,/^เส/i],any:[/^อา/i,/^จ/i,/^อ/i,/^พ(?!ฤ)/i,/^พฤ/i,/^ศ/i,/^ส/i]},Oh={any:/^(ก่อนเที่ยง|หลังเที่ยง|เที่ยงคืน|เที่ยง|(ตอน.*?)?.*(เที่ยง|เช้า|บ่าย|เย็น|กลางคืน))/i},Lh={any:{am:/^ก่อนเที่ยง/i,pm:/^หลังเที่ยง/i,midnight:/^เที่ยงคืน/i,noon:/^เที่ยง/i,morning:/เช้า/i,afternoon:/บ่าย/i,evening:/เย็น/i,night:/กลางคืน/i}},$h={ordinalNumber:Lo({matchPattern:Ch,parsePattern:kh,valueCallback:t=>parseInt(t,10)}),era:Ge({matchPatterns:Dh,defaultMatchWidth:"wide",parsePatterns:Eh,defaultParseWidth:"any"}),quarter:Ge({matchPatterns:Ih,defaultMatchWidth:"wide",parsePatterns:Th,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ge({matchPatterns:Ph,defaultMatchWidth:"wide",parsePatterns:Ah,defaultParseWidth:"any"}),day:Ge({matchPatterns:Rh,defaultMatchWidth:"wide",parsePatterns:Mh,defaultParseWidth:"any"}),dayPeriod:Ge({matchPatterns:Oh,defaultMatchWidth:"any",parsePatterns:Lh,defaultParseWidth:"any"})},qs={code:"th",formatDistance:uh,formatLong:xh,formatRelative:gh,localize:Sh,match:$h,options:{weekStartsOn:0,firstWeekContainsDate:1}};var X=function(){return X=Object.assign||function(s){for(var a,n=1,r=arguments.length;n<r;n++){a=arguments[n];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s},X.apply(this,arguments)};function Fh(t,s){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)s.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(a[n[r]]=t[n[r]]);return a}function Vo(t,s,a){for(var n=0,r=s.length,o;n<r;n++)(o||!(n in s))&&(o||(o=Array.prototype.slice.call(s,0,n)),o[n]=s[n]);return t.concat(o||Array.prototype.slice.call(s))}function Qt(t){return t.mode==="multiple"}function Zt(t){return t.mode==="range"}function Is(t){return t.mode==="single"}var Wh={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function zh(t,s){return Pe(t,"LLLL y",s)}function Bh(t,s){return Pe(t,"d",s)}function Uh(t,s){return Pe(t,"LLLL",s)}function Hh(t){return"".concat(t)}function Vh(t,s){return Pe(t,"cccccc",s)}function Yh(t,s){return Pe(t,"yyyy",s)}var Gh=Object.freeze({__proto__:null,formatCaption:zh,formatDay:Bh,formatMonthCaption:Uh,formatWeekNumber:Hh,formatWeekdayName:Vh,formatYearCaption:Yh}),qh=function(t,s,a){return Pe(t,"do MMMM (EEEE)",a)},Kh=function(){return"Month: "},Jh=function(){return"Go to next month"},Xh=function(){return"Go to previous month"},Qh=function(t,s){return Pe(t,"cccc",s)},Zh=function(t){return"Week n. ".concat(t)},ep=function(){return"Year: "},tp=Object.freeze({__proto__:null,labelDay:qh,labelMonthDropdown:Kh,labelNext:Jh,labelPrevious:Xh,labelWeekNumber:Zh,labelWeekday:Qh,labelYearDropdown:ep});function sp(){var t="buttons",s=Wh,a=$o,n={},r={},o=1,i={},c=new Date;return{captionLayout:t,classNames:s,formatters:Gh,labels:tp,locale:a,modifiersClassNames:n,modifiers:r,numberOfMonths:o,styles:i,today:c,mode:"default"}}function ap(t){var s=t.fromYear,a=t.toYear,n=t.fromMonth,r=t.toMonth,o=t.fromDate,i=t.toDate;return n?o=Ie(n):s&&(o=new Date(s,0,1)),r?i=Ra(r):a&&(i=new Date(a,11,31)),{fromDate:o?Ot(o):void 0,toDate:i?Ot(i):void 0}}var Yo=u.createContext(void 0);function np(t){var s,a=t.initialProps,n=sp(),r=ap(a),o=r.fromDate,i=r.toDate,c=(s=a.captionLayout)!==null&&s!==void 0?s:n.captionLayout;c!=="buttons"&&(!o||!i)&&(c="buttons");var d;(Is(a)||Qt(a)||Zt(a))&&(d=a.onSelect);var p=X(X(X({},n),a),{captionLayout:c,classNames:X(X({},n.classNames),a.classNames),components:X({},a.components),formatters:X(X({},n.formatters),a.formatters),fromDate:o,labels:X(X({},n.labels),a.labels),mode:a.mode||n.mode,modifiers:X(X({},n.modifiers),a.modifiers),modifiersClassNames:X(X({},n.modifiersClassNames),a.modifiersClassNames),onSelect:d,styles:X(X({},n.styles),a.styles),toDate:i});return e.jsx(Yo.Provider,{value:p,children:t.children})}function he(){var t=u.useContext(Yo);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function Go(t){var s=he(),a=s.locale,n=s.classNames,r=s.styles,o=s.formatters.formatCaption;return e.jsx("div",{className:n.caption_label,style:r.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:o(t.displayMonth,{locale:a})})}function rp(t){return e.jsx("svg",X({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function qo(t){var s,a,n=t.onChange,r=t.value,o=t.children,i=t.caption,c=t.className,d=t.style,p=he(),h=(a=(s=p.components)===null||s===void 0?void 0:s.IconDropdown)!==null&&a!==void 0?a:rp;return e.jsxs("div",{className:c,style:d,children:[e.jsx("span",{className:p.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:p.classNames.dropdown,style:p.styles.dropdown,value:r,onChange:n,children:o}),e.jsxs("div",{className:p.classNames.caption_label,style:p.styles.caption_label,"aria-hidden":"true",children:[i,e.jsx(h,{className:p.classNames.dropdown_icon,style:p.styles.dropdown_icon})]})]})}function op(t){var s,a=he(),n=a.fromDate,r=a.toDate,o=a.styles,i=a.locale,c=a.formatters.formatMonthCaption,d=a.classNames,p=a.components,h=a.labels.labelMonthDropdown;if(!n)return e.jsx(e.Fragment,{});if(!r)return e.jsx(e.Fragment,{});var f=[];if(qm(n,r))for(var l=Ie(n),m=n.getMonth();m<=r.getMonth();m++)f.push(Gs(l,m));else for(var l=Ie(new Date),m=0;m<=11;m++)f.push(Gs(l,m));var g=function(v){var x=Number(v.target.value),j=Gs(Ie(t.displayMonth),x);t.onChange(j)},b=(s=p==null?void 0:p.Dropdown)!==null&&s!==void 0?s:qo;return e.jsx(b,{name:"months","aria-label":h(),className:d.dropdown_month,style:o.dropdown_month,onChange:g,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:i}),children:f.map(function(v){return e.jsx("option",{value:v.getMonth(),children:c(v,{locale:i})},v.getMonth())})})}function ip(t){var s,a=t.displayMonth,n=he(),r=n.fromDate,o=n.toDate,i=n.locale,c=n.styles,d=n.classNames,p=n.components,h=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,l=[];if(!r)return e.jsx(e.Fragment,{});if(!o)return e.jsx(e.Fragment,{});for(var m=r.getFullYear(),g=o.getFullYear(),b=m;b<=g;b++)l.push(Nn(Mo(new Date),b));var v=function(j){var _=Nn(Ie(a),Number(j.target.value));t.onChange(_)},x=(s=p==null?void 0:p.Dropdown)!==null&&s!==void 0?s:qo;return e.jsx(x,{name:"years","aria-label":f(),className:d.dropdown_year,style:c.dropdown_year,onChange:v,value:a.getFullYear(),caption:h(a,{locale:i}),children:l.map(function(j){return e.jsx("option",{value:j.getFullYear(),children:h(j,{locale:i})},j.getFullYear())})})}function lp(t,s){var a=u.useState(t),n=a[0],r=a[1],o=s===void 0?n:s;return[o,r]}function cp(t){var s=t.month,a=t.defaultMonth,n=t.today,r=s||a||n||new Date,o=t.toDate,i=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(o&&Jt(o,r)<0){var p=-1*(d-1);r=Be(o,p)}return i&&Jt(r,i)<0&&(r=i),Ie(r)}function dp(){var t=he(),s=cp(t),a=lp(s,t.month),n=a[0],r=a[1],o=function(i){var c;if(!t.disableNavigation){var d=Ie(i);r(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[n,o]}function up(t,s){for(var a=s.reverseMonths,n=s.numberOfMonths,r=Ie(t),o=Ie(Be(r,n)),i=Jt(o,r),c=[],d=0;d<i;d++){var p=Be(r,d);c.push(p)}return a&&(c=c.reverse()),c}function mp(t,s){if(!s.disableNavigation){var a=s.toDate,n=s.pagedNavigation,r=s.numberOfMonths,o=r===void 0?1:r,i=n?o:1,c=Ie(t);if(!a)return Be(c,i);var d=Jt(a,t);if(!(d<o))return Be(c,i)}}function hp(t,s){if(!s.disableNavigation){var a=s.fromDate,n=s.pagedNavigation,r=s.numberOfMonths,o=r===void 0?1:r,i=n?o:1,c=Ie(t);if(!a)return Be(c,-i);var d=Jt(c,a);if(!(d<=0))return Be(c,-i)}}var Ko=u.createContext(void 0);function pp(t){var s=he(),a=dp(),n=a[0],r=a[1],o=up(n,s),i=mp(n,s),c=hp(n,s),d=function(f){return o.some(function(l){return Oa(f,l)})},p=function(f,l){d(f)||(l&&Uo(f,l)?r(Be(f,1+s.numberOfMonths*-1)):r(f))},h={currentMonth:n,displayMonths:o,goToMonth:r,goToDate:p,previousMonth:c,nextMonth:i,isDateDisplayed:d};return e.jsx(Ko.Provider,{value:h,children:t.children})}function es(){var t=u.useContext(Ko);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function wn(t){var s,a=he(),n=a.classNames,r=a.styles,o=a.components,i=es().goToMonth,c=function(h){i(Be(h,t.displayIndex?-t.displayIndex:0))},d=(s=o==null?void 0:o.CaptionLabel)!==null&&s!==void 0?s:Go,p=e.jsx(d,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:n.caption_dropdowns,style:r.caption_dropdowns,children:[e.jsx("div",{className:n.vhidden,children:p}),e.jsx(op,{onChange:c,displayMonth:t.displayMonth}),e.jsx(ip,{onChange:c,displayMonth:t.displayMonth})]})}function xp(t){return e.jsx("svg",X({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function fp(t){return e.jsx("svg",X({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var ys=u.forwardRef(function(t,s){var a=he(),n=a.classNames,r=a.styles,o=[n.button_reset,n.button];t.className&&o.push(t.className);var i=o.join(" "),c=X(X({},r.button_reset),r.button);return t.style&&Object.assign(c,t.style),e.jsx("button",X({},t,{ref:s,type:"button",className:i,style:c}))});function gp(t){var s,a,n=he(),r=n.dir,o=n.locale,i=n.classNames,c=n.styles,d=n.labels,p=d.labelPrevious,h=d.labelNext,f=n.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var l=p(t.previousMonth,{locale:o}),m=[i.nav_button,i.nav_button_previous].join(" "),g=h(t.nextMonth,{locale:o}),b=[i.nav_button,i.nav_button_next].join(" "),v=(s=f==null?void 0:f.IconRight)!==null&&s!==void 0?s:fp,x=(a=f==null?void 0:f.IconLeft)!==null&&a!==void 0?a:xp;return e.jsxs("div",{className:i.nav,style:c.nav,children:[!t.hidePrevious&&e.jsx(ys,{name:"previous-month","aria-label":l,className:m,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:r==="rtl"?e.jsx(v,{className:i.nav_icon,style:c.nav_icon}):e.jsx(x,{className:i.nav_icon,style:c.nav_icon})}),!t.hideNext&&e.jsx(ys,{name:"next-month","aria-label":g,className:b,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:r==="rtl"?e.jsx(x,{className:i.nav_icon,style:c.nav_icon}):e.jsx(v,{className:i.nav_icon,style:c.nav_icon})})]})}function _n(t){var s=he().numberOfMonths,a=es(),n=a.previousMonth,r=a.nextMonth,o=a.goToMonth,i=a.displayMonths,c=i.findIndex(function(g){return Oa(t.displayMonth,g)}),d=c===0,p=c===i.length-1,h=s>1&&(d||!p),f=s>1&&(p||!d),l=function(){n&&o(n)},m=function(){r&&o(r)};return e.jsx(gp,{displayMonth:t.displayMonth,hideNext:h,hidePrevious:f,nextMonth:r,previousMonth:n,onPreviousClick:l,onNextClick:m})}function vp(t){var s,a=he(),n=a.classNames,r=a.disableNavigation,o=a.styles,i=a.captionLayout,c=a.components,d=(s=c==null?void 0:c.CaptionLabel)!==null&&s!==void 0?s:Go,p;return r?p=e.jsx(d,{id:t.id,displayMonth:t.displayMonth}):i==="dropdown"?p=e.jsx(wn,{displayMonth:t.displayMonth,id:t.id}):i==="dropdown-buttons"?p=e.jsxs(e.Fragment,{children:[e.jsx(wn,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(_n,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):p=e.jsxs(e.Fragment,{children:[e.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(_n,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:n.caption,style:o.caption,children:p})}function bp(t){var s=he(),a=s.footer,n=s.styles,r=s.classNames.tfoot;return a?e.jsx("tfoot",{className:r,style:n.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:a})})}):e.jsx(e.Fragment,{})}function yp(t,s,a){for(var n=a?jt(new Date):Ke(new Date,{locale:t,weekStartsOn:s}),r=[],o=0;o<7;o++){var i=be(n,o);r.push(i)}return r}function jp(){var t=he(),s=t.classNames,a=t.styles,n=t.showWeekNumber,r=t.locale,o=t.weekStartsOn,i=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,p=yp(r,o,i);return e.jsxs("tr",{style:a.head_row,className:s.head_row,children:[n&&e.jsx("td",{style:a.head_cell,className:s.head_cell}),p.map(function(h,f){return e.jsx("th",{scope:"col",className:s.head_cell,style:a.head_cell,"aria-label":d(h,{locale:r}),children:c(h,{locale:r})},f)})]})}function Np(){var t,s=he(),a=s.classNames,n=s.styles,r=s.components,o=(t=r==null?void 0:r.HeadRow)!==null&&t!==void 0?t:jp;return e.jsx("thead",{style:n.head,className:a.head,children:e.jsx(o,{})})}function wp(t){var s=he(),a=s.locale,n=s.formatters.formatDay;return e.jsx(e.Fragment,{children:n(t.date,{locale:a})})}var La=u.createContext(void 0);function _p(t){if(!Qt(t.initialProps)){var s={selected:void 0,modifiers:{disabled:[]}};return e.jsx(La.Provider,{value:s,children:t.children})}return e.jsx(Sp,{initialProps:t.initialProps,children:t.children})}function Sp(t){var s=t.initialProps,a=t.children,n=s.selected,r=s.min,o=s.max,i=function(p,h,f){var l,m;(l=s.onDayClick)===null||l===void 0||l.call(s,p,h,f);var g=!!(h.selected&&r&&(n==null?void 0:n.length)===r);if(!g){var b=!!(!h.selected&&o&&(n==null?void 0:n.length)===o);if(!b){var v=n?Vo([],n):[];if(h.selected){var x=v.findIndex(function(j){return ke(p,j)});v.splice(x,1)}else v.push(p);(m=s.onSelect)===null||m===void 0||m.call(s,v,p,h,f)}}},c={disabled:[]};n&&c.disabled.push(function(p){var h=o&&n.length>o-1,f=n.some(function(l){return ke(l,p)});return!!(h&&!f)});var d={selected:n,onDayClick:i,modifiers:c};return e.jsx(La.Provider,{value:d,children:a})}function $a(){var t=u.useContext(La);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function Cp(t,s){var a=s||{},n=a.from,r=a.to;return n&&r?ke(r,t)&&ke(n,t)?void 0:ke(r,t)?{from:r,to:void 0}:ke(n,t)?void 0:ma(n,t)?{from:t,to:r}:{from:n,to:t}:r?ma(t,r)?{from:r,to:t}:{from:t,to:r}:n?Uo(t,n)?{from:t,to:n}:{from:n,to:t}:{from:t,to:void 0}}var Fa=u.createContext(void 0);function kp(t){if(!Zt(t.initialProps)){var s={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(Fa.Provider,{value:s,children:t.children})}return e.jsx(Dp,{initialProps:t.initialProps,children:t.children})}function Dp(t){var s=t.initialProps,a=t.children,n=s.selected,r=n||{},o=r.from,i=r.to,c=s.min,d=s.max,p=function(m,g,b){var v,x;(v=s.onDayClick)===null||v===void 0||v.call(s,m,g,b);var j=Cp(m,n);(x=s.onSelect)===null||x===void 0||x.call(s,j,m,g,b)},h={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(h.range_start=[o],i?(h.range_end=[i],ke(o,i)||(h.range_middle=[{after:o,before:i}])):h.range_end=[o]):i&&(h.range_start=[i],h.range_end=[i]),c&&(o&&!i&&h.disabled.push({after:Hs(o,c-1),before:be(o,c-1)}),o&&i&&h.disabled.push({after:o,before:be(o,c-1)}),!o&&i&&h.disabled.push({after:Hs(i,c-1),before:be(i,c-1)})),d){if(o&&!i&&(h.disabled.push({before:be(o,-d+1)}),h.disabled.push({after:be(o,d-1)})),o&&i){var f=Fe(i,o)+1,l=d-f;h.disabled.push({before:Hs(o,l)}),h.disabled.push({after:be(i,l)})}!o&&i&&(h.disabled.push({before:be(i,-d+1)}),h.disabled.push({after:be(i,d-1)}))}return e.jsx(Fa.Provider,{value:{selected:n,onDayClick:p,modifiers:h},children:a})}function Wa(){var t=u.useContext(Fa);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function ps(t){return Array.isArray(t)?Vo([],t):t!==void 0?[t]:[]}function Ep(t){var s={};return Object.entries(t).forEach(function(a){var n=a[0],r=a[1];s[n]=ps(r)}),s}var Ue;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(Ue||(Ue={}));var Ip=Ue.Selected,et=Ue.Disabled,Tp=Ue.Hidden,Pp=Ue.Today,Ks=Ue.RangeEnd,Js=Ue.RangeMiddle,Xs=Ue.RangeStart,Ap=Ue.Outside;function Rp(t,s,a){var n,r=(n={},n[Ip]=ps(t.selected),n[et]=ps(t.disabled),n[Tp]=ps(t.hidden),n[Pp]=[t.today],n[Ks]=[],n[Js]=[],n[Xs]=[],n[Ap]=[],n);return t.fromDate&&r[et].push({before:t.fromDate}),t.toDate&&r[et].push({after:t.toDate}),Qt(t)?r[et]=r[et].concat(s.modifiers[et]):Zt(t)&&(r[et]=r[et].concat(a.modifiers[et]),r[Xs]=a.modifiers[Xs],r[Js]=a.modifiers[Js],r[Ks]=a.modifiers[Ks]),r}var Jo=u.createContext(void 0);function Mp(t){var s=he(),a=$a(),n=Wa(),r=Rp(s,a,n),o=Ep(s.modifiers),i=X(X({},r),o);return e.jsx(Jo.Provider,{value:i,children:t.children})}function Xo(){var t=u.useContext(Jo);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function Op(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function Lp(t){return!!(t&&typeof t=="object"&&"from"in t)}function $p(t){return!!(t&&typeof t=="object"&&"after"in t)}function Fp(t){return!!(t&&typeof t=="object"&&"before"in t)}function Wp(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function zp(t,s){var a,n=s.from,r=s.to;if(n&&r){var o=Fe(r,n)<0;o&&(a=[r,n],n=a[0],r=a[1]);var i=Fe(t,n)>=0&&Fe(r,t)>=0;return i}return r?ke(r,t):n?ke(n,t):!1}function Bp(t){return Aa(t)}function Up(t){return Array.isArray(t)&&t.every(Aa)}function Hp(t,s){return s.some(function(a){if(typeof a=="boolean")return a;if(Bp(a))return ke(t,a);if(Up(a))return a.includes(t);if(Lp(a))return zp(t,a);if(Wp(a))return a.dayOfWeek.includes(t.getDay());if(Op(a)){var n=Fe(a.before,t),r=Fe(a.after,t),o=n>0,i=r<0,c=ma(a.before,a.after);return c?i&&o:o||i}return $p(a)?Fe(t,a.after)>0:Fp(a)?Fe(a.before,t)>0:typeof a=="function"?a(t):!1})}function za(t,s,a){var n=Object.keys(s).reduce(function(o,i){var c=s[i];return Hp(t,c)&&o.push(i),o},[]),r={};return n.forEach(function(o){return r[o]=!0}),a&&!Oa(t,a)&&(r.outside=!0),r}function Vp(t,s){for(var a=Ie(t[0]),n=Ra(t[t.length-1]),r,o,i=a;i<=n;){var c=za(i,s),d=!c.disabled&&!c.hidden;if(!d){i=be(i,1);continue}if(c.selected)return i;c.today&&!o&&(o=i),r||(r=i),i=be(i,1)}return o||r}var Yp=365;function Qo(t,s){var a=s.moveBy,n=s.direction,r=s.context,o=s.modifiers,i=s.retry,c=i===void 0?{count:0,lastFocused:t}:i,d=r.weekStartsOn,p=r.fromDate,h=r.toDate,f=r.locale,l={day:be,week:ua,month:Be,year:Vu,startOfWeek:function(v){return r.ISOWeek?jt(v):Ke(v,{locale:f,weekStartsOn:d})},endOfWeek:function(v){return r.ISOWeek?Oo(v):Ma(v,{locale:f,weekStartsOn:d})}},m=l[a](t,n==="after"?1:-1);n==="before"&&p?m=Yu([p,m]):n==="after"&&h&&(m=Gu([h,m]));var g=!0;if(o){var b=za(m,o);g=!b.disabled&&!b.hidden}return g?m:c.count>Yp?c.lastFocused:Qo(m,{moveBy:a,direction:n,context:r,modifiers:o,retry:X(X({},c),{count:c.count+1})})}var Zo=u.createContext(void 0);function Gp(t){var s=es(),a=Xo(),n=u.useState(),r=n[0],o=n[1],i=u.useState(),c=i[0],d=i[1],p=Vp(s.displayMonths,a),h=r??(c&&s.isDateDisplayed(c))?c:p,f=function(){d(r),o(void 0)},l=function(v){o(v)},m=he(),g=function(v,x){if(r){var j=Qo(r,{moveBy:v,direction:x,context:m,modifiers:a});ke(r,j)||(s.goToDate(j,r),l(j))}},b={focusedDay:r,focusTarget:h,blur:f,focus:l,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return e.jsx(Zo.Provider,{value:b,children:t.children})}function Ba(){var t=u.useContext(Zo);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function qp(t,s){var a=Xo(),n=za(t,a,s);return n}var Ua=u.createContext(void 0);function Kp(t){if(!Is(t.initialProps)){var s={selected:void 0};return e.jsx(Ua.Provider,{value:s,children:t.children})}return e.jsx(Jp,{initialProps:t.initialProps,children:t.children})}function Jp(t){var s=t.initialProps,a=t.children,n=function(o,i,c){var d,p,h;if((d=s.onDayClick)===null||d===void 0||d.call(s,o,i,c),i.selected&&!s.required){(p=s.onSelect)===null||p===void 0||p.call(s,void 0,o,i,c);return}(h=s.onSelect)===null||h===void 0||h.call(s,o,o,i,c)},r={selected:s.selected,onDayClick:n};return e.jsx(Ua.Provider,{value:r,children:a})}function ei(){var t=u.useContext(Ua);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function Xp(t,s){var a=he(),n=ei(),r=$a(),o=Wa(),i=Ba(),c=i.focusDayAfter,d=i.focusDayBefore,p=i.focusWeekAfter,h=i.focusWeekBefore,f=i.blur,l=i.focus,m=i.focusMonthBefore,g=i.focusMonthAfter,b=i.focusYearBefore,v=i.focusYearAfter,x=i.focusStartOfWeek,j=i.focusEndOfWeek,_=function(I){var N,O,Y,U;Is(a)?(N=n.onDayClick)===null||N===void 0||N.call(n,t,s,I):Qt(a)?(O=r.onDayClick)===null||O===void 0||O.call(r,t,s,I):Zt(a)?(Y=o.onDayClick)===null||Y===void 0||Y.call(o,t,s,I):(U=a.onDayClick)===null||U===void 0||U.call(a,t,s,I)},S=function(I){var N;l(t),(N=a.onDayFocus)===null||N===void 0||N.call(a,t,s,I)},C=function(I){var N;f(),(N=a.onDayBlur)===null||N===void 0||N.call(a,t,s,I)},T=function(I){var N;(N=a.onDayMouseEnter)===null||N===void 0||N.call(a,t,s,I)},W=function(I){var N;(N=a.onDayMouseLeave)===null||N===void 0||N.call(a,t,s,I)},D=function(I){var N;(N=a.onDayPointerEnter)===null||N===void 0||N.call(a,t,s,I)},k=function(I){var N;(N=a.onDayPointerLeave)===null||N===void 0||N.call(a,t,s,I)},H=function(I){var N;(N=a.onDayTouchCancel)===null||N===void 0||N.call(a,t,s,I)},w=function(I){var N;(N=a.onDayTouchEnd)===null||N===void 0||N.call(a,t,s,I)},y=function(I){var N;(N=a.onDayTouchMove)===null||N===void 0||N.call(a,t,s,I)},E=function(I){var N;(N=a.onDayTouchStart)===null||N===void 0||N.call(a,t,s,I)},P=function(I){var N;(N=a.onDayKeyUp)===null||N===void 0||N.call(a,t,s,I)},L=function(I){var N;switch(I.key){case"ArrowLeft":I.preventDefault(),I.stopPropagation(),a.dir==="rtl"?c():d();break;case"ArrowRight":I.preventDefault(),I.stopPropagation(),a.dir==="rtl"?d():c();break;case"ArrowDown":I.preventDefault(),I.stopPropagation(),p();break;case"ArrowUp":I.preventDefault(),I.stopPropagation(),h();break;case"PageUp":I.preventDefault(),I.stopPropagation(),I.shiftKey?b():m();break;case"PageDown":I.preventDefault(),I.stopPropagation(),I.shiftKey?v():g();break;case"Home":I.preventDefault(),I.stopPropagation(),x();break;case"End":I.preventDefault(),I.stopPropagation(),j();break}(N=a.onDayKeyDown)===null||N===void 0||N.call(a,t,s,I)},z={onClick:_,onFocus:S,onBlur:C,onKeyDown:L,onKeyUp:P,onMouseEnter:T,onMouseLeave:W,onPointerEnter:D,onPointerLeave:k,onTouchCancel:H,onTouchEnd:w,onTouchMove:y,onTouchStart:E};return z}function Qp(){var t=he(),s=ei(),a=$a(),n=Wa(),r=Is(t)?s.selected:Qt(t)?a.selected:Zt(t)?n.selected:void 0;return r}function Zp(t){return Object.values(Ue).includes(t)}function ex(t,s){var a=[t.classNames.day];return Object.keys(s).forEach(function(n){var r=t.modifiersClassNames[n];if(r)a.push(r);else if(Zp(n)){var o=t.classNames["day_".concat(n)];o&&a.push(o)}}),a}function tx(t,s){var a=X({},t.styles.day);return Object.keys(s).forEach(function(n){var r;a=X(X({},a),(r=t.modifiersStyles)===null||r===void 0?void 0:r[n])}),a}function sx(t,s,a){var n,r,o,i=he(),c=Ba(),d=qp(t,s),p=Xp(t,d),h=Qp(),f=!!(i.onDayClick||i.mode!=="default");u.useEffect(function(){var T;d.outside||c.focusedDay&&f&&ke(c.focusedDay,t)&&((T=a.current)===null||T===void 0||T.focus())},[c.focusedDay,t,a,f,d.outside]);var l=ex(i,d).join(" "),m=tx(i,d),g=!!(d.outside&&!i.showOutsideDays||d.hidden),b=(o=(r=i.components)===null||r===void 0?void 0:r.DayContent)!==null&&o!==void 0?o:wp,v=e.jsx(b,{date:t,displayMonth:s,activeModifiers:d}),x={style:m,className:l,children:v,role:"gridcell"},j=c.focusTarget&&ke(c.focusTarget,t)&&!d.outside,_=c.focusedDay&&ke(c.focusedDay,t),S=X(X(X({},x),(n={disabled:d.disabled,role:"gridcell"},n["aria-selected"]=d.selected,n.tabIndex=_||j?0:-1,n)),p),C={isButton:f,isHidden:g,activeModifiers:d,selectedDays:h,buttonProps:S,divProps:x};return C}function ax(t){var s=u.useRef(null),a=sx(t.date,t.displayMonth,s);return a.isHidden?e.jsx("div",{role:"gridcell"}):a.isButton?e.jsx(ys,X({name:"day",ref:s},a.buttonProps)):e.jsx("div",X({},a.divProps))}function nx(t){var s=t.number,a=t.dates,n=he(),r=n.onWeekNumberClick,o=n.styles,i=n.classNames,c=n.locale,d=n.labels.labelWeekNumber,p=n.formatters.formatWeekNumber,h=p(Number(s),{locale:c});if(!r)return e.jsx("span",{className:i.weeknumber,style:o.weeknumber,children:h});var f=d(Number(s),{locale:c}),l=function(m){r(s,a,m)};return e.jsx(ys,{name:"week-number","aria-label":f,className:i.weeknumber,style:o.weeknumber,onClick:l,children:h})}function rx(t){var s,a,n=he(),r=n.styles,o=n.classNames,i=n.showWeekNumber,c=n.components,d=(s=c==null?void 0:c.Day)!==null&&s!==void 0?s:ax,p=(a=c==null?void 0:c.WeekNumber)!==null&&a!==void 0?a:nx,h;return i&&(h=e.jsx("td",{className:o.cell,style:r.cell,children:e.jsx(p,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:o.row,style:r.row,children:[h,t.dates.map(function(f){return e.jsx("td",{className:o.cell,style:r.cell,role:"presentation",children:e.jsx(d,{displayMonth:t.displayMonth,date:f})},Vm(f))})]})}function Sn(t,s,a){for(var n=a!=null&&a.ISOWeek?Oo(s):Ma(s,a),r=a!=null&&a.ISOWeek?jt(t):Ke(t,a),o=Fe(n,r),i=[],c=0;c<=o;c++)i.push(be(r,c));var d=i.reduce(function(p,h){var f=a!=null&&a.ISOWeek?Fo(h):zo(h,a),l=p.find(function(m){return m.weekNumber===f});return l?(l.dates.push(h),p):(p.push({weekNumber:f,dates:[h]}),p)},[]);return d}function ox(t,s){var a=Sn(Ie(t),Ra(t),s);if(s!=null&&s.useFixedWeeks){var n=Gm(t,s);if(n<6){var r=a[a.length-1],o=r.dates[r.dates.length-1],i=ua(o,6-n),c=Sn(ua(o,1),i,s);a.push.apply(a,c)}}return a}function ix(t){var s,a,n,r=he(),o=r.locale,i=r.classNames,c=r.styles,d=r.hideHead,p=r.fixedWeeks,h=r.components,f=r.weekStartsOn,l=r.firstWeekContainsDate,m=r.ISOWeek,g=ox(t.displayMonth,{useFixedWeeks:!!p,ISOWeek:m,locale:o,weekStartsOn:f,firstWeekContainsDate:l}),b=(s=h==null?void 0:h.Head)!==null&&s!==void 0?s:Np,v=(a=h==null?void 0:h.Row)!==null&&a!==void 0?a:rx,x=(n=h==null?void 0:h.Footer)!==null&&n!==void 0?n:bp;return e.jsxs("table",{id:t.id,className:i.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&e.jsx(b,{}),e.jsx("tbody",{className:i.tbody,style:c.tbody,children:g.map(function(j){return e.jsx(v,{displayMonth:t.displayMonth,dates:j.dates,weekNumber:j.weekNumber},j.weekNumber)})}),e.jsx(x,{displayMonth:t.displayMonth})]})}function lx(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var cx=lx()?u.useLayoutEffect:u.useEffect,Qs=!1,dx=0;function Cn(){return"react-day-picker-".concat(++dx)}function ux(t){var s,a=t??(Qs?Cn():null),n=u.useState(a),r=n[0],o=n[1];return cx(function(){r===null&&o(Cn())},[]),u.useEffect(function(){Qs===!1&&(Qs=!0)},[]),(s=t??r)!==null&&s!==void 0?s:void 0}function mx(t){var s,a,n=he(),r=n.dir,o=n.classNames,i=n.styles,c=n.components,d=es().displayMonths,p=ux(n.id?"".concat(n.id,"-").concat(t.displayIndex):void 0),h=n.id?"".concat(n.id,"-grid-").concat(t.displayIndex):void 0,f=[o.month],l=i.month,m=t.displayIndex===0,g=t.displayIndex===d.length-1,b=!m&&!g;r==="rtl"&&(s=[m,g],g=s[0],m=s[1]),m&&(f.push(o.caption_start),l=X(X({},l),i.caption_start)),g&&(f.push(o.caption_end),l=X(X({},l),i.caption_end)),b&&(f.push(o.caption_between),l=X(X({},l),i.caption_between));var v=(a=c==null?void 0:c.Caption)!==null&&a!==void 0?a:vp;return e.jsxs("div",{className:f.join(" "),style:l,children:[e.jsx(v,{id:p,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(ix,{id:h,"aria-labelledby":p,displayMonth:t.displayMonth})]},t.displayIndex)}function hx(t){var s=he(),a=s.classNames,n=s.styles;return e.jsx("div",{className:a.months,style:n.months,children:t.children})}function px(t){var s,a,n=t.initialProps,r=he(),o=Ba(),i=es(),c=u.useState(!1),d=c[0],p=c[1];u.useEffect(function(){r.initialFocus&&o.focusTarget&&(d||(o.focus(o.focusTarget),p(!0)))},[r.initialFocus,d,o.focus,o.focusTarget,o]);var h=[r.classNames.root,r.className];r.numberOfMonths>1&&h.push(r.classNames.multiple_months),r.showWeekNumber&&h.push(r.classNames.with_weeknumber);var f=X(X({},r.styles.root),r.style),l=Object.keys(n).filter(function(g){return g.startsWith("data-")}).reduce(function(g,b){var v;return X(X({},g),(v={},v[b]=n[b],v))},{}),m=(a=(s=n.components)===null||s===void 0?void 0:s.Months)!==null&&a!==void 0?a:hx;return e.jsx("div",X({className:h.join(" "),style:f,dir:r.dir,id:r.id,nonce:n.nonce,title:n.title,lang:n.lang},l,{children:e.jsx(m,{children:i.displayMonths.map(function(g,b){return e.jsx(mx,{displayIndex:b,displayMonth:g},b)})})}))}function xx(t){var s=t.children,a=Fh(t,["children"]);return e.jsx(np,{initialProps:a,children:e.jsx(pp,{children:e.jsx(Kp,{initialProps:a,children:e.jsx(_p,{initialProps:a,children:e.jsx(kp,{initialProps:a,children:e.jsx(Mp,{children:e.jsx(Gp,{children:s})})})})})})})}function fx(t){return e.jsx(xx,X({},t,{children:e.jsx(px,{initialProps:t})}))}function ti({className:t,classNames:s,showOutsideDays:a=!0,...n}){return e.jsx(fx,{showOutsideDays:a,className:G("p-3 select-none",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium leading-none",nav:"space-x-1 flex items-center",nav_button:G(da({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1 table-fixed",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem] flex items-center justify-center",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative overflow-hidden [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:G(da({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100 flex items-center justify-center text-center leading-none"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground font-medium",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...r})=>e.jsx(cl,{className:"h-4 w-4"}),IconRight:({...r})=>e.jsx(ll,{className:"h-4 w-4"})},...n})}ti.displayName="Calendar";const gx=()=>{const[t,s]=u.useState([]),[a,n]=u.useState([]),[r,o]=u.useState(null),[i,c]=u.useState(""),[d,p]=u.useState(""),[h,f]=u.useState({}),[l,m]=u.useState(null),[g,b]=u.useState([]),[v,x]=u.useState(!1),{toast:j}=fe();u.useEffect(()=>{_(),S()},[]);const _=async()=>{try{const{data:w,error:y}=await B.from("vaccine_schedules").select("*").eq("active",!0).order("vaccine_name");if(y)throw y;s(w||[])}catch{j({title:"ข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลตารางวัคซีนได้",variant:"destructive"})}},S=async()=>{var w;try{console.log("🔍 เริ่มโหลดข้อมูลการติดตามผู้ป่วย...");const{data:y,error:E}=await B.from("appointments").select("*").order("appointment_date",{ascending:!1});if(E)throw E;console.log("📊 ข้อมูลนัดทั้งหมด:",(y==null?void 0:y.length)||0,"รายการ");const P=(y==null?void 0:y.filter(O=>O.status==="completed"))||[],L=(y==null?void 0:y.filter(O=>["scheduled","pending"].includes(O.status)))||[];console.log("✅ การฉีดที่เสร็จสิ้น:",P.length,"รายการ"),console.log("📅 นัดที่มีอยู่แล้ว:",L.length,"รายการ");const z=new Map;for(const O of P||[]){const Y=O.patient_id_number||O.line_user_id,U=`${Y}-${O.vaccine_type}`;if(!z.has(U)){const J=P.filter(ce=>(ce.patient_id_number||ce.line_user_id)===Y&&ce.vaccine_type===O.vaccine_type&&ce.status==="completed");console.log(`👤 ผู้ป่วย: ${O.patient_name}, วัคซีน: ${O.vaccine_type}, โดสที่ฉีดแล้ว: ${J.length}`);const Q=J.reduce((ce,oe)=>new Date(oe.appointment_date)>new Date(ce.appointment_date)?oe:ce),ge=J.reduce((ce,oe)=>new Date(oe.appointment_date)<new Date(ce.appointment_date)?oe:ce);console.log(`📅 เข็มล่าสุด: ${Q.appointment_date}, เข็มแรก: ${ge.appointment_date}`),z.set(U,{patient_id:Y,patient_name:O.patient_name,vaccine_type:O.vaccine_type,doses_received:J.length,latest_date:Q.appointment_date,first_dose_date:ge.appointment_date})}}const{data:I}=await B.from("vaccine_schedules").select("*").eq("active",!0);console.log("💉 โหลดข้อมูลวัคซีน:",(I==null?void 0:I.length)||0,"ประเภท");const N=[];for(const O of z.values())try{const Y=I==null?void 0:I.find(Q=>Q.vaccine_type.toLowerCase()===O.vaccine_type.toLowerCase());if(!Y){console.log(`❌ ไม่พบข้อมูลวัคซีน: ${O.vaccine_type}`);continue}let U="in_progress",J=null;if(O.doses_received>=Y.total_doses)U="completed",console.log(`✅ ผู้ป่วย ${O.patient_name} ได้รับวัคซีน ${O.vaccine_type} ครบแล้ว`);else{const Q=L.find(Le=>(Le.patient_id_number||Le.line_user_id)===O.patient_id&&Le.vaccine_type.toLowerCase()===O.vaccine_type.toLowerCase()&&new Date(Le.appointment_date)>new Date),ge=Array.isArray(Y.dose_intervals)?Y.dose_intervals:JSON.parse(((w=Y.dose_intervals)==null?void 0:w.toString())||"[]");let ce=new Date(O.latest_date);const oe=typeof ge[O.doses_received]=="number"?ge[O.doses_received]:30;ce.setDate(ce.getDate()+oe),J=ce.toISOString().split("T")[0],Q?(J=Q.appointment_date,console.log(`📅 วัคซีน ${O.vaccine_type}: พบนัดที่มีแล้ว ${J}`)):console.log(`🎯 วัคซีน ${O.vaccine_type}: คำนวณนัดใหม่ ${O.doses_received+1}/${Y.total_doses}, วันที่: ${J}, ช่วงห่าง: ${oe} วัน`)}N.push({id:`${O.patient_id}-${O.vaccine_type}`,patient_id:O.patient_id,patient_name:O.patient_name,vaccine_schedule_id:Y.id,current_dose:O.doses_received,total_doses:Y.total_doses,last_dose_date:O.latest_date,next_dose_due:J,completion_status:U,auto_reminder_enabled:!0,reminder_days_before:1,contraindication_checked:!1,contraindication_notes:null,vaccine_schedules:{vaccine_name:Y.vaccine_name,vaccine_type:Y.vaccine_type,dose_intervals:Y.dose_intervals,total_doses:Y.total_doses},existing_appointment:!!L.find(Q=>(Q.patient_id_number||Q.line_user_id)===O.patient_id&&Q.vaccine_type.toLowerCase()===O.vaccine_type.toLowerCase()&&new Date(Q.appointment_date)>new Date)})}catch(Y){console.error("Error processing patient:",O.patient_id,Y)}console.log("✅ ข้อมูลการติดตามที่คำนวณได้:",N.length,"รายการ"),n(N)}catch(y){console.error("Error loading patient tracking:",y),j({title:"ข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลการติดตามผู้ป่วยได้",variant:"destructive"})}},C=async w=>{if(w)try{x(!0);const{data:y,error:E}=await B.rpc("check_contraindications",{_vaccine_schedule_id:w,_patient_conditions:h});if(E)throw E;m(y)}catch{j({title:"ข้อผิดพลาด",description:"ไม่สามารถตรวจสอบข้อห้ามได้",variant:"destructive"})}finally{x(!1)}},T=()=>{if(!r)return;const w=r,y=new Date,E=[];E.push({dose:1,date:y,dueDays:0,status:"due",description:`โดสแรกของวัคซีน ${w.vaccine_name}`});let P=y;for(let L=1;L<w.total_doses;L++){const z=w.dose_intervals[L-1]||30;P=be(P,z),E.push({dose:L+1,date:P,dueDays:Us(P,y),status:"scheduled",description:`โดสที่ ${L+1} ของวัคซีน ${w.vaccine_name} (หลังจากโดสก่อนหน้า ${z} วัน)`})}if(w.booster_required&&w.booster_interval){const L=be(P,w.booster_interval);E.push({dose:"booster",date:L,dueDays:Us(L,y),status:"booster",description:`โดสเสริม (หลังจากโดสสุดท้าย ${w.booster_interval} วัน)`})}b(E)},W=async()=>{var w;if(!r||!i||!d){j({title:"ข้อผิดพลาด",description:"กรุณากรอกข้อมูลให้ครบถ้วน",variant:"destructive"});return}if(l!=null&&l.has_contraindications){j({title:"พบข้อห้าม",description:"ไม่สามารถสร้างการติดตามได้เนื่องจากมีข้อห้าม",variant:"destructive"});return}try{x(!0);const y=be(new Date,0),{error:E}=await B.from("patient_vaccine_tracking").insert({patient_id:i,patient_name:d,vaccine_schedule_id:r.id,current_dose:1,total_doses:r.total_doses,next_dose_due:Pe(y,"yyyy-MM-dd"),completion_status:"in_progress",auto_reminder_enabled:!0,reminder_days_before:1,contraindication_checked:!0,contraindication_notes:((w=l==null?void 0:l.contraindications)==null?void 0:w.length)>0?`ตรวจพบ: ${l.contraindications.join(", ")}`:null});if(E)throw E;await D(i,y),j({title:"สำเร็จ",description:"สร้างการติดตามวัคซีนเรียบร้อยแล้ว",variant:"default"}),c(""),p(""),f({}),m(null),b([]),S()}catch{j({title:"ข้อผิดพลาด",description:"ไม่สามารถสร้างการติดตามได้",variant:"destructive"})}finally{x(!1)}},D=async(w,y)=>{const E=be(y,-1);await B.from("notification_schedules").insert({patient_tracking_id:null,notification_type:"reminder",scheduled_date:Pe(E,"yyyy-MM-dd"),message_content:`🔔 แจ้งเตือนการฉีดวัคซีน

พรุ่งนี้ (${Pe(y,"dd/MM/yyyy")}) คุณมีนัดฉีดวัคซีน ${r==null?void 0:r.vaccine_name}

กรุณามาตรงเวลา`,line_user_id:w,sent:!1})},k=(w,y)=>{f(E=>({...E,[w]:y}))},H=w=>{const y={due:{color:"bg-green-500",text:"ถึงกำหนด"},scheduled:{color:"bg-blue-500",text:"กำหนดการ"},booster:{color:"bg-purple-500",text:"โดสเสริม"},overdue:{color:"bg-red-500",text:"เกินกำหนด"},completed:{color:"bg-gray-500",text:"เสร็จสิ้น"}},E=y[w]||y.scheduled;return e.jsx(te,{className:E.color,children:E.text})};return e.jsx("div",{className:"space-y-4 md:space-y-6",children:e.jsxs(Xe,{defaultValue:"calculator",className:"space-y-4",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-1 md:grid-cols-3 gap-1 md:gap-0 h-auto md:h-10",children:[e.jsxs(K,{value:"calculator",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(dl,{className:"h-4 w-4"}),e.jsx("span",{children:"คำนวณตารางวัคซีน"})]}),e.jsxs(K,{value:"tracking",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:"ติดตามผู้ป่วย"})]}),e.jsxs(K,{value:"schedules",className:"flex items-center gap-2 text-sm md:text-base p-3 md:p-2",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"ตารางวัคซีน"})]})]}),e.jsx(ee,{value:"calculator",className:"space-y-4 md:space-y-6",children:e.jsxs(A,{children:[e.jsxs($,{className:"pb-3 md:pb-4",children:[e.jsxs(F,{className:"flex items-center space-x-2 text-lg md:text-xl",children:[e.jsx(we,{className:"h-5 w-5 text-primary"}),e.jsx("span",{children:"คำนวณตารางวัคซีนสำหรับผู้ป่วย"})]}),e.jsx(ie,{className:"text-sm md:text-base",children:"เลือกวัคซีนและระบุข้อมูลผู้ป่วยเพื่อคำนวณตารางการฉีดและตรวจสอบข้อห้าม"})]}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"patient-id",className:"text-sm md:text-base font-medium",children:"รหัสผู้ป่วย/LINE User ID"}),e.jsx(se,{id:"patient-id",value:i,onChange:w=>c(w.target.value),placeholder:"ระบุรหัสผู้ป่วย",className:"text-sm md:text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"patient-name",className:"text-sm md:text-base font-medium",children:"ชื่อผู้ป่วย"}),e.jsx(se,{id:"patient-name",value:d,onChange:w=>p(w.target.value),placeholder:"ระบุชื่อผู้ป่วย",className:"text-sm md:text-base"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"vaccine-select",className:"text-sm md:text-base font-medium",children:"เลือกวัคซีน"}),e.jsxs(ft,{value:(r==null?void 0:r.id)||"",onValueChange:w=>{const y=t.find(E=>E.id===w);o(y||null),m(null)},children:[e.jsx(at,{className:"text-sm md:text-base",children:e.jsx(gt,{placeholder:"เลือกวัคซีนที่ต้องการ"})}),e.jsx(nt,{children:t.map(w=>e.jsxs(Ne,{value:w.id,className:"text-sm md:text-base",children:[w.vaccine_name," (",w.total_doses," โดส)"]},w.id))})]})]}),r&&e.jsxs(A,{className:"border-primary/20 mt-4",children:[e.jsx($,{className:"pb-3",children:e.jsxs(F,{className:"text-base md:text-lg text-primary",children:["ข้อมูลวัคซีน: ",r.vaccine_name]})}),e.jsxs(R,{className:"space-y-3 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm md:text-base",children:[e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:"จำนวนโดส:"}),e.jsxs("p",{className:"font-semibold",children:[r.total_doses," โดส"]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:"ระยะห่าง:"}),e.jsxs("p",{className:"font-semibold",children:[r.dose_intervals.join(", ")," วัน"]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:"ระยะเวลาคุ้มกัน:"}),e.jsxs("p",{className:"font-semibold",children:[Math.round(r.efficacy_duration/365)," ปี"]})]}),e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-1",children:"โดสเสริม:"}),e.jsx("p",{className:"font-semibold",children:r.booster_required?"ต้องการ":"ไม่ต้องการ"})]})]}),r.age_restrictions&&e.jsxs("div",{className:"bg-background/50 p-3 rounded-lg",children:[e.jsx("span",{className:"font-medium text-muted-foreground block mb-2",children:"ข้อจำกัดอายุ:"}),e.jsxs("p",{className:"text-sm md:text-base",children:[r.age_restrictions.min_age&&`อายุขั้นต่ำ ${r.age_restrictions.min_age} ปี`,r.age_restrictions.min_age&&r.age_restrictions.max_age&&" - ",r.age_restrictions.max_age&&`อายุสูงสุด ${r.age_restrictions.max_age} ปี`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"ข้อบ่งชี้:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.indications.map((w,y)=>e.jsx(te,{variant:"secondary",className:"text-xs md:text-sm",children:w},y))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"ข้อห้าม:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.contraindications.map((w,y)=>e.jsx(te,{variant:"destructive",className:"text-xs md:text-sm",children:w},y))})]})]})]}),r&&e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{className:"text-lg",children:"ตรวจสอบข้อห้ามสำหรับผู้ป่วย"})}),e.jsxs(R,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"age",children:"อายุ (ปี)"}),e.jsx(se,{id:"age",type:"number",value:h.age||"",onChange:w=>k("age",parseInt(w.target.value)||0),placeholder:"อายุ"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(q,{children:"ประวัติและสภาวะของผู้ป่วย:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{key:"pregnancy",label:"ตั้งครรภ์"},{key:"immunocompromised",label:"ภูมิคุ้มกันบกพร่อง"},{key:"severe_allergic_reaction",label:"แพ้รุนแรง"},{key:"myocarditis_history",label:"ประวัติกล้ามเนื้อหัวใจอักเสบ"},{key:"guillain_barre_syndrome",label:"กิแลง-บาร์เร่ ซินโดรม"},{key:"chronic_disease",label:"โรคเรื้อรัง"}].map(({key:w,label:y})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(To,{id:w,checked:!!h[w],onCheckedChange:E=>k(w,!!E)}),e.jsx(q,{htmlFor:w,className:"text-sm",children:y})]},w))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{onClick:()=>C(r.id),disabled:v,children:v?"กำลังตรวจสอบ...":"ตรวจสอบข้อห้าม"}),e.jsx(M,{onClick:T,variant:"outline",children:"คำนวณตารางวัคซีน"})]}),l&&e.jsxs(de,{className:l.has_contraindications?"border-red-200":"border-green-200",children:[e.jsx(pt,{className:"h-4 w-4"}),e.jsx(ue,{children:l.has_contraindications?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-600",children:"พบข้อห้าม:"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:l.contraindications.map((w,y)=>e.jsx("li",{children:w},y))})]}):e.jsx("p",{className:"text-green-600",children:"ไม่พบข้อห้าม สามารถฉีดวัคซีนได้"})})]})]})]}),g.length>0&&e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center space-x-2",children:[e.jsx(ti,{className:"h-5 w-5"}),e.jsx("span",{children:"ตารางการฉีดวัคซีน"})]})}),e.jsxs(R,{children:[e.jsx("div",{className:"space-y-3",children:g.map((w,y)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-lg font-medium",children:typeof w.dose=="number"?`โดส ${w.dose}`:"โดสเสริม"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:Pe(w.date,"dd MMMM yyyy",{locale:qs})}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",w.dueDays===0?"วันนี้":`อีก ${w.dueDays} วัน`,")"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:H(w.status)})]},y))}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx(M,{onClick:W,disabled:v||(l==null?void 0:l.has_contraindications),className:"w-full",children:v?"กำลังสร้าง...":"สร้างการติดตามวัคซีน"})})]})]})]})]})}),e.jsx(ee,{value:"tracking",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"h-5 w-5"}),e.jsx("span",{children:"การติดตามผู้ป่วย"})]}),e.jsx(ie,{children:"รายการผู้ป่วยที่กำลังอยู่ในระหว่างการฉีดวัคซีนตามตาราง"})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[a.map(w=>{var y,E,P;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(xt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:w.patient_name}),e.jsx(te,{variant:"outline",children:w.patient_id})]}),e.jsx(te,{className:w.completion_status==="completed"?"bg-green-500":w.completion_status==="overdue"?"bg-red-500":w.completion_status==="cancelled"?"bg-gray-500":"bg-blue-500",children:w.completion_status==="completed"?"เสร็จสิ้น":w.completion_status==="overdue"?"เกินกำหนด":w.completion_status==="cancelled"?"ยกเลิก":"อยู่ระหว่างดำเนินการ"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"วัคซีน:"}),e.jsx("p",{className:"font-medium",children:(y=w.vaccine_schedules)==null?void 0:y.vaccine_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ประเภท: ",(E=w.vaccine_schedules)==null?void 0:E.vaccine_type]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ความคืบหน้า:"}),e.jsx("p",{className:"font-medium",children:w.current_dose>0?`ฉีดแล้ว ${w.current_dose} จาก ${w.total_doses} เข็ม`:"ยังไม่เริ่มฉีด"}),w.current_dose>0&&w.current_dose<w.total_doses&&e.jsxs("p",{className:"text-xs text-green-600",children:["โดสถัดไป: เข็มที่ ",w.current_dose+1]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"เข็มล่าสุด:"}),e.jsx("p",{className:"font-medium",children:w.last_dose_date&&w.current_dose>0?Pe(Vs(w.last_dose_date),"dd MMM yyyy",{locale:qs}):"ยังไม่ได้ฉีด"}),w.last_dose_date&&w.current_dose>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["เข็มที่ ",w.current_dose]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"นัดครั้งถัดไป:"}),w.next_dose_due?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-600",children:Pe(Vs(w.next_dose_due),"dd MMM yyyy",{locale:qs})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["เข็มที่ ",w.current_dose+1," •",(()=>{const L=Us(Vs(w.next_dose_due),new Date);return L<0?` เลยมา ${Math.abs(L)} วัน`:L===0?" วันนี้":` อีก ${L} วัน`})()]}),w.existing_appointment&&e.jsx("p",{className:"text-xs text-green-600",children:"✓ นัดในระบบแล้ว"}),((P=w.vaccine_schedules)==null?void 0:P.dose_intervals)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ระยะห่าง: ",w.vaccine_schedules.dose_intervals[w.current_dose]||"N/A"," วัน"]})]}):w.completion_status==="completed"?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-600",children:"เสร็จสิ้น"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ครบตามตาราง"})]}):w.current_dose<w.total_doses?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-orange-600",children:"ต้องกำหนดนัด"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["เข็มที่ ",w.current_dose+1]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-500",children:"ไม่มี"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"รอการกำหนด"})]})]})]}),w.contraindication_notes&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pt,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"หมายเหตุข้อห้าม:"})]}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:w.contraindication_notes})]}),e.jsx("div",{className:"mt-3 flex items-center space-x-2",children:w.auto_reminder_enabled&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsxs("span",{children:["แจ้งเตือนอัตโนมัติ ",w.reminder_days_before," วันก่อน"]})]})})]},w.id)}),a.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(fs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"ยังไม่มีการติดตามผู้ป่วย"})]})]})})]})}),e.jsx(ee,{value:"schedules",className:"space-y-4",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsx(F,{children:"ตารางวัคซีนที่มีในระบบ"}),e.jsx(ie,{children:"ข้อมูลวัคซีนทั้งหมดที่สามารถใช้คำนวณตารางได้"})]}),e.jsx(R,{children:e.jsx("div",{className:"space-y-4",children:t.map(w=>e.jsxs(A,{className:"border-muted",children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(F,{className:"text-lg",children:w.vaccine_name}),e.jsx(te,{className:"bg-primary",children:w.vaccine_type})]})}),e.jsxs(R,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"จำนวนโดส:"}),e.jsxs("p",{children:[w.total_doses," โดส"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ระยะห่าง:"}),e.jsx("p",{children:w.dose_intervals.length>0?w.dose_intervals.join(", ")+" วัน":"ไม่มี"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ระยะเวลาคุ้มกัน:"}),e.jsxs("p",{children:[Math.round(w.efficacy_duration/365)," ปี"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"โดสเสริม:"}),e.jsx("p",{children:w.booster_required?`จำเป็น (ทุก ${Math.round((w.booster_interval||0)/365)} ปี)`:"ไม่จำเป็น"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"ข้อบ่งชี้:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.indications.map((y,E)=>e.jsx(te,{variant:"secondary",className:"text-xs",children:y},E))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"ข้อห้าม:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.contraindications.map((y,E)=>e.jsx(te,{variant:"destructive",className:"text-xs",children:y},E))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:"ผลข้างเคียง:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.side_effects.map((y,E)=>e.jsx(te,{variant:"outline",className:"text-xs",children:y},E))})]})]})]})]},w.id))})})]})})]})})},vx=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(""),[r,o]=u.useState(!1),{toast:i}=fe(),c=async()=>{o(!0);try{const{data:l,error:m}=await B.from("patient_registrations").select("*").order("created_at",{ascending:!1});if(m)throw m;s(l||[])}catch(l){console.error("Error loading registrations:",l),i({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลการลงทะเบียนได้",variant:"destructive"})}finally{o(!1)}},d=async(l,m)=>{try{const{error:g}=await B.from("patient_registrations").update({status:m,updated_at:new Date().toISOString()}).eq("id",l);if(g)throw g;i({title:"อัปเดตสำเร็จ",description:"อัปเดตสถานะการลงทะเบียนแล้ว"}),c()}catch(g){console.error("Error updating registration:",g),i({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัปเดตสถานะได้",variant:"destructive"})}};u.useEffect(()=>{c()},[]);const p=t.filter(l=>l.full_name.toLowerCase().includes(a.toLowerCase())||l.phone.includes(a)||l.registration_id.toLowerCase().includes(a.toLowerCase())),h=l=>{switch(l){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},f=l=>{switch(l){case"pending":return"รอดำเนินการ";case"confirmed":return"ยืนยันแล้ว";case"completed":return"เสร็จสิ้น";case"cancelled":return"ยกเลิก";default:return l}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Se,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"รายการลงทะเบียน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"จัดการข้อมูลผู้ลงทะเบียนรับวัคซีน"})]})]}),e.jsxs(M,{onClick:c,disabled:r,variant:"outline",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"รีเฟรช"]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"ค้นหาผู้ลงทะเบียน"]}),e.jsxs(te,{variant:"secondary",children:["ทั้งหมด ",p.length," คน"]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(se,{placeholder:"ค้นหาด้วยชื่อ, เบอร์โทร, หรือ ID",value:a,onChange:l=>n(l.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:p.map(l=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:l.full_name}),e.jsx(te,{className:h(l.status),children:f(l.status)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ul,{className:"h-4 w-4"}),l.phone]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"ID: ",l.registration_id]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),new Date(l.created_at).toLocaleDateString("th-TH")]})]}),l.notes&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:l.notes})]}),e.jsx("div",{className:"flex gap-2 ml-4",children:l.status==="pending"&&e.jsxs(M,{size:"sm",onClick:()=>d(l.id,"confirmed"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"ยืนยัน"]})})]})},l.id))}),p.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"ไม่พบข้อมูลที่ค้นหา":"ยังไม่มีการลงทะเบียน"})]})]})]})]})},bx=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(""),[r,o]=u.useState(!1),[i,c]=u.useState(null),[d,p]=u.useState(null),{toast:h}=fe(),f=async()=>{o(!0);try{console.log("🔍 เริ่มโหลดข้อมูลนัดครั้งถัดไป...");const{data:x,error:j}=await B.from("appointments").select("*").order("appointment_date",{ascending:!1});if(j)throw j;console.log("📊 ข้อมูลนัดทั้งหมด:",(x==null?void 0:x.length)||0,"รายการ");const _=(x==null?void 0:x.filter(y=>y.status==="completed"))||[],S=(x==null?void 0:x.filter(y=>["scheduled","pending"].includes(y.status)&&new Date(y.appointment_date)>=new Date))||[];console.log("✅ การฉีดที่เสร็จสิ้น:",_.length,"รายการ"),console.log("📅 นัดที่มีอยู่แล้ว:",S.length,"รายการ");const C=new Map;for(const y of _||[]){const E=y.patient_id_number||y.line_user_id,P=`${E}-${y.vaccine_type}`;if(!C.has(P)){const L=_.filter(N=>(N.patient_id_number||N.line_user_id)===E&&N.vaccine_type===y.vaccine_type&&N.status==="completed");console.log(`👤 ผู้ป่วย: ${y.patient_name}, วัคซีน: ${y.vaccine_type}, โดสที่ฉีดแล้ว: ${L.length}`);const z=L.reduce((N,O)=>new Date(O.appointment_date)>new Date(N.appointment_date)?O:N),I=L.reduce((N,O)=>new Date(O.appointment_date)<new Date(N.appointment_date)?O:N);console.log(`📅 เข็มล่าสุด: ${z.appointment_date}, เข็มแรก: ${I.appointment_date}`),C.set(P,{patient_id:E,patient_name:y.patient_name,line_user_id:y.line_user_id,vaccine_type:y.vaccine_type,doses_received:L.length,latest_date:z.appointment_date,first_dose_date:I.appointment_date})}}const{data:T}=await B.from("vaccine_schedules").select("*").eq("active",!0);console.log("💉 โหลดข้อมูลวัคซีน:",(T==null?void 0:T.length)||0,"ประเภท");const W=[];for(const y of S)if(new Date(y.appointment_date)>new Date&&["scheduled","pending"].includes(y.status)){const E=y.patient_id_number||y.line_user_id,P=_.filter(z=>(z.patient_id_number||z.line_user_id)===E&&z.vaccine_type.toLowerCase()===y.vaccine_type.toLowerCase()),L=T==null?void 0:T.find(z=>z.vaccine_type.toLowerCase()===y.vaccine_type.toLowerCase());L&&(W.push({id:`scheduled-${y.id}`,patient_id:E,patient_name:y.patient_name,vaccine_name:y.vaccine_name||L.vaccine_name,vaccine_type:y.vaccine_type,current_dose:P.length,total_doses:L.total_doses,next_dose_due:y.appointment_date,last_dose_date:P.length>0?P.reduce((z,I)=>new Date(I.appointment_date)>new Date(z.appointment_date)?I:z).appointment_date:null,first_dose_date:P.length>0?P.reduce((z,I)=>new Date(I.appointment_date)<new Date(z.appointment_date)?I:z).appointment_date:null,completion_status:"scheduled",line_user_id:y.line_user_id,vaccine_schedule_id:L.id,is_existing_appointment:!0}),console.log(`📅 นัดที่มีอยู่: ${y.patient_name} - ${y.vaccine_type} วันที่ ${y.appointment_date}`))}const D=Array.from(C.values()).map(async y=>{var E;try{const P=T==null?void 0:T.find(U=>U.vaccine_type.toLowerCase()===y.vaccine_type.toLowerCase());if(!P)return console.log(`❌ ไม่พบข้อมูลวัคซีน: ${y.vaccine_type}`),null;if(y.doses_received>=P.total_doses)return console.log(`✅ ผู้ป่วย ${y.patient_name} ได้รับวัคซีน ${y.vaccine_type} ครบแล้ว`),null;const L=S.find(U=>(U.patient_id_number||U.line_user_id)===y.patient_id&&U.vaccine_type.toLowerCase()===y.vaccine_type.toLowerCase()&&new Date(U.appointment_date)>new Date&&["scheduled","pending"].includes(U.status));if(L)return console.log(`📅 ผู้ป่วย ${y.patient_name} มีนัด ${y.vaccine_type} แล้วในวันที่ ${L.appointment_date} - ข้าม`),null;const z=Array.isArray(P.dose_intervals)?P.dose_intervals:JSON.parse(((E=P.dose_intervals)==null?void 0:E.toString())||"[]");let I=new Date(y.latest_date);const N=y.doses_received,O=typeof z[N]=="number"?z[N]:typeof z[y.doses_received-1]=="number"?z[y.doses_received-1]:30;I.setDate(I.getDate()+O);const Y=y.doses_received+1;return console.log(`🎯 ${y.patient_name}: ต้องการโดสใหม่ ${Y}/${P.total_doses}, คำนวณนัด: ${I.toISOString().split("T")[0]}, ช่วงห่าง: ${O} วัน`),{id:`new-${y.patient_id}-${y.vaccine_type}`,patient_id:y.patient_id,patient_name:y.patient_name,vaccine_name:P.vaccine_name,vaccine_type:y.vaccine_type,current_dose:y.doses_received,total_doses:P.total_doses,next_dose_due:I.toISOString().split("T")[0],last_dose_date:y.latest_date,first_dose_date:y.first_dose_date,completion_status:"needs_appointment",line_user_id:y.line_user_id,vaccine_schedule_id:P.id,is_existing_appointment:!1}}catch(P){return console.error("Error processing patient:",y.patient_id,P),null}}),H=(await Promise.all(D)).filter(y=>y!==null),w=[...W,...H].sort((y,E)=>new Date(y.next_dose_due).getTime()-new Date(E.next_dose_due).getTime());console.log("✅ ผลลัพธ์สุดท้าย:",w.length,"รายการ"),console.log("📅 นัดที่มีอยู่แล้ว:",W.length,"รายการ"),console.log("🆕 นัดใหม่ที่ต้องสร้าง:",H.length,"รายการ"),w.forEach(y=>{const E=y.is_existing_appointment?"(มีนัดแล้ว)":"(ต้องสร้างนัด)";console.log(`- ${y.patient_name}: โดส ${y.current_dose+1}/${y.total_doses}, นัด: ${y.next_dose_due}, เข็มล่าสุด: ${y.last_dose_date||"ยังไม่มี"} ${E}`)}),s(w)}catch(x){console.error("Error loading next appointments:",x),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลนัดครั้งถัดไปได้",variant:"destructive"})}finally{o(!1)}},l=async x=>{try{const{data:j}=await B.from("appointments").select("*").eq("patient_id_number",x.patient_id).eq("vaccine_type",x.vaccine_type).in("status",["scheduled","pending"]).gte("appointment_date",new Date().toISOString().split("T")[0]);if(j&&j.length>0){h({title:"มีนัดอยู่แล้ว",description:`${x.patient_name} มีนัดหมายสำหรับวัคซีนนี้แล้ว`,variant:"destructive"}),s(_=>_.filter(S=>S.id!==x.id));return}}catch(j){console.error("Error checking existing appointments:",j)}c(x.id);try{const j={patient_id_number:x.patient_id,patient_name:x.patient_name,vaccine_type:x.vaccine_type,appointment_date:x.next_dose_due,status:"scheduled",line_user_id:x.line_user_id,notes:`นัดเข็มที่ ${x.current_dose+1} จาก ${x.total_doses} เข็ม`},{error:_}=await B.from("appointments").insert([j]);if(_)throw _;s(S=>S.filter(C=>C.id!==x.id)),h({title:"นัดหมายสำเร็จ",description:`สร้างนัดหมายสำหรับ ${x.patient_name} แล้ว`})}catch(j){console.error("Error scheduling appointment:",j),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถสร้างนัดหมายได้",variant:"destructive"})}finally{c(null)}},m=async x=>{if(!x.line_user_id){h({title:"ไม่สามารถส่งได้",description:"ไม่พบ LINE User ID ของผู้ป่วย",variant:"destructive"});return}p(x.id);try{const{data:{session:j},error:_}=await B.auth.getSession();if(_||!j){console.error("Authentication error:",_),h({title:"ไม่สามารถส่งได้",description:"กรุณาเข้าสู่ระบบก่อนใช้งาน",variant:"destructive"});return}const{data:S,error:C}=await B.rpc("is_healthcare_staff",{_user_id:j.user.id});if(C&&console.error("Role check error:",C),!S){h({title:"ไม่มีสิทธิ์เข้าถึง",description:"คุณไม่มีสิทธิ์ส่งข้อความแจ้งเตือน (ต้องการสิทธิ์ healthcare staff)",variant:"destructive"});return}const{error:T}=await B.functions.invoke("send-line-message",{body:{userId:x.line_user_id,message:`🏥 แจ้งเตือนนัดฉีดวัคซีน

คุณ ${x.patient_name}
นัดฉีดเข็มที่ ${x.current_dose+1} 
วัคซีน: ${x.vaccine_name}
วันที่นัด: ${new Date(x.next_dose_due).toLocaleDateString("th-TH")}

กรุณามาตามนัดตรงเวลา

📍 โรงพยาบาลโฮม`}});if(T)throw console.error("Edge function error:",T),T;h({title:"ส่งข้อความแล้ว",description:`ส่งข้อความแจ้งเตือนไปยัง ${x.patient_name} แล้ว`})}catch(j){console.error("Error sending reminder:",j);let _="ไม่สามารถส่งข้อความแจ้งเตือนได้";j!=null&&j.message&&(j.message.includes("LINE")?_="ไม่สามารถเชื่อมต่อ LINE API ได้ กรุณาตรวจสอบการตั้งค่า":j.message.includes("authentication")||j.message.includes("auth")?_="เซสชันหมดอายุ กรุณาเข้าสู่ระบบใหม่":j.message.includes("Access denied")||j.message.includes("role")?_="ไม่มีสิทธิ์เข้าถึงฟังก์ชันนี้":_=`เกิดข้อผิดพลาด: ${j.message}`),h({title:"เกิดข้อผิดพลาด",description:_,variant:"destructive"})}finally{p(null)}};u.useEffect(()=>{f();const x=setInterval(()=>{f()},3e4);return()=>clearInterval(x)},[]);const g=t.filter(x=>x.patient_name.toLowerCase().includes(a.toLowerCase())||x.vaccine_type.toLowerCase().includes(a.toLowerCase())||x.patient_id.toLowerCase().includes(a.toLowerCase())),b=x=>{const j=new Date,S=new Date(x).getTime()-j.getTime();return Math.ceil(S/(1e3*60*60*24))},v=x=>x<0?e.jsxs(te,{className:"bg-red-100 text-red-800 border-red-200",children:["เกินกำหนด ",Math.abs(x)," วัน"]}):x===0?e.jsx(te,{className:"bg-orange-100 text-orange-800 border-orange-200",children:"ครบกำหนดวันนี้"}):x<=7?e.jsxs(te,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:["อีก ",x," วัน"]}):e.jsxs(te,{className:"bg-green-100 text-green-800 border-green-200",children:["อีก ",x," วัน"]});return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx($s,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"นัดครั้งถัดไป"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["รายการผู้ป่วยที่ต้องฉีดเข็มถัดไป (อัปเดตล่าสุด: ",new Date().toLocaleTimeString("th-TH"),")"]})]})]}),e.jsxs(M,{onClick:f,disabled:r,variant:"outline",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"รีเฟรช"]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"ค้นหานัดครั้งถัดไป"]}),e.jsxs(te,{variant:"secondary",children:["ทั้งหมด ",g.length," คน"]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(se,{placeholder:"ค้นหาด้วยชื่อผู้ป่วย, ประเภทวัคซีน, หรือ ID",value:a,onChange:x=>n(x.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:g.map(x=>{const j=b(x.next_dose_due);return e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:x.patient_name}),v(j)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),x.vaccine_name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"เข็มที่ ",x.current_dose+1," จาก ",x.total_doses]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"ครบกำหนด: ",new Date(x.next_dose_due).toLocaleDateString("th-TH")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"📅"}),"เข็มล่าสุด: ",x.last_dose_date?new Date(x.last_dose_date).toLocaleDateString("th-TH"):"ไม่พบข้อมูล"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-2 rounded flex justify-between",children:[e.jsxs("span",{children:["ID: ",x.patient_id]}),e.jsx("span",{className:"text-blue-600",children:x.is_existing_appointment?"✓ มีนัดแล้ว":"⚠ ต้องสร้างนัด"})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[x.is_existing_appointment?e.jsx(te,{className:"bg-green-100 text-green-800 border-green-200",children:"มีนัดแล้ว"}):e.jsxs(M,{size:"sm",onClick:()=>l(x),disabled:i===x.id||i!==null,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[i===x.id?e.jsx(De,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx($s,{className:"h-4 w-4 mr-1"}),i===x.id?"กำลังสร้าง...":"สร้างนัด"]}),x.line_user_id&&e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>m(x),disabled:d===x.id,className:"disabled:opacity-50",children:[d===x.id?e.jsx(De,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(js,{className:"h-4 w-4 mr-1"}),d===x.id?"กำลังส่ง...":"แจ้งเตือน"]})]})]})},x.id)})}),g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx($s,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"ไม่พบข้อมูลที่ค้นหา":"ไม่มีนัดครั้งถัดไปในขณะนี้"})]})]})]})]})},yx=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(""),[r,o]=u.useState(!1),{toast:i}=fe(),c=async()=>{o(!0);try{const{data:h,error:f}=await B.from("appointments").select("*").eq("status","completed").order("appointment_date",{ascending:!1});if(f)throw f;s(h||[])}catch(h){console.error("Error loading vaccinations:",h),i({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลประวัติการฉีดวัคซีนได้",variant:"destructive"})}finally{o(!1)}};u.useEffect(()=>{c()},[]);const d=t.filter(h=>h.patient_name.toLowerCase().includes(a.toLowerCase())||h.vaccine_type.toLowerCase().includes(a.toLowerCase())||h.patient_phone&&h.patient_phone.includes(a)||h.patient_id_number&&h.patient_id_number.toLowerCase().includes(a.toLowerCase())),p=()=>{const h=[["วันที่","ชื่อผู้ป่วย","เบอร์โทร","ประเภทวัคซีน","หมายเหตุ"].join(","),...d.map(g=>[new Date(g.appointment_date).toLocaleDateString("th-TH"),g.patient_name,g.patient_phone||"",g.vaccine_type,g.notes||""].join(","))].join(`
`),f=new Blob([h],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),m=URL.createObjectURL(f);l.setAttribute("href",m),l.setAttribute("download",`vaccination_history_${new Date().toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Xa,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"ประวัติการฉีดวัคซีน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"รายการผู้ที่ได้รับวัคซีนแล้ว"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{onClick:p,variant:"outline",size:"sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"ส่งออก CSV"]}),e.jsxs(M,{onClick:c,disabled:r,variant:"outline",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"รีเฟรช"]})]})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"ค้นหาประวัติการฉีดวัคซีน"]}),e.jsxs(te,{variant:"secondary",children:["ทั้งหมด ",d.length," ครั้ง"]})]})}),e.jsxs(R,{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(se,{placeholder:"ค้นหาด้วยชื่อผู้ป่วย, ประเภทวัคซีน, หรือเบอร์โทร",value:a,onChange:h=>n(h.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:d.map(h=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:h.patient_name}),e.jsx(te,{className:"bg-green-100 text-green-800 border-green-200",children:"ฉีดแล้ว"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),new Date(h.appointment_date).toLocaleDateString("th-TH"),h.appointment_time&&` เวลา ${h.appointment_time}`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),h.vaccine_type]}),h.patient_phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"📞"}),h.patient_phone]}),h.patient_id_number&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🆔"}),h.patient_id_number]})]}),h.notes&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground bg-muted/50 p-2 rounded",children:["หมายเหตุ: ",h.notes]})]})})},h.id))}),d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Xa,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a?"ไม่พบข้อมูลที่ค้นหา":"ยังไม่มีประวัติการฉีดวัคซีน"})]})]})]})]})},jx=()=>{const[t,s]=u.useState([]),[a,n]=u.useState(!1),[r,o]=u.useState(null),{toast:i}=fe(),c=async()=>{try{const{data:l,error:m}=await B.from("appointment_notifications").select("*").order("created_at",{ascending:!1}).limit(50);if(m)throw m;s(l||[])}catch(l){console.error("Error loading notification history:",l),i({title:"ข้อผิดพลาด",description:"ไม่สามารถโหลดประวัติการแจ้งเตือนได้",variant:"destructive"})}},d=async()=>{var l,m;n(!0);try{const{data:g,error:b}=await B.functions.invoke("manual-notification-trigger",{body:{}});if(b)throw b;o(g.result),i({title:"ระบบแจ้งเตือนทำงานสำเร็จ",description:`ส่งการแจ้งเตือน ${((m=(l=g.result)==null?void 0:l.statistics)==null?void 0:m.notificationsSent)||0} รายการ`}),setTimeout(()=>{c()},2e3)}catch(g){console.error("Error running auto notifications:",g),i({title:"เกิดข้อผิดพลาด",description:g.message||"ไม่สามารถเรียกใช้ระบบแจ้งเตือนได้",variant:"destructive"})}finally{n(!1)}},p=l=>{switch(l){case"sent":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},h=l=>{switch(l){case"reminder":return e.jsx($e,{className:"h-4 w-4"});case"overdue":return e.jsx(pt,{className:"h-4 w-4"});default:return e.jsx(Ae,{className:"h-4 w-4"})}},f=l=>{switch(l){case"reminder":return"แจ้งเตือนล่วงหน้า";case"overdue":return"การนัดเกินกำหนด";default:return l}};return u.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs(A,{children:[e.jsx($,{className:"pb-3 md:pb-4",children:e.jsxs(F,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(Vt,{className:"h-5 w-5 text-primary"}),"ระบบแจ้งเตือนอัตโนมัติ"]})}),e.jsxs(R,{className:"space-y-4 p-4 md:p-6",children:[e.jsxs(de,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsxs(ue,{className:"text-sm md:text-base",children:["ระบบจะตรวจสอบและส่งการแจ้งเตือนล่วงหน้าอัตโนมัติ:",e.jsx("br",{}),"• แจ้งเตือน 1 วันก่อนวันนัด และ 8 ชั่วโมงก่อนวันนัด",e.jsx("br",{}),"• ตรวจสอบการนัดเกินกำหนดและส่งการแจ้งเตือน"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(M,{onClick:d,disabled:a,className:"flex-1 h-11",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),a?"กำลังดำเนินการ...":"เรียกใช้ระบบแจ้งเตือน"]}),e.jsxs(M,{onClick:c,variant:"outline",className:"h-11",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"รีเฟรช"]})]}),(r==null?void 0:r.statistics)&&e.jsxs("div",{className:"mt-4 p-3 md:p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("h3",{className:"font-medium text-sm md:text-base mb-3 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-600"}),"ผลการทำงานล่าสุด"]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg",children:r.statistics.appointmentsChecked}),e.jsx("div",{className:"text-muted-foreground",children:"นัดพรุ่งนี้"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg",children:r.statistics.overdueAppointmentsChecked}),e.jsx("div",{className:"text-muted-foreground",children:"นัดเกินกำหนด"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg text-green-600",children:r.statistics.notificationsSent}),e.jsx("div",{className:"text-muted-foreground",children:"ส่งสำเร็จ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-lg text-red-600",children:r.statistics.errors}),e.jsx("div",{className:"text-muted-foreground",children:"ข้อผิดพลาด"})]})]}),r.timestamp&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["เมื่อ: ",new Date(r.timestamp).toLocaleString("th-TH")]})]})]})]}),e.jsxs(A,{children:[e.jsx($,{className:"pb-3 md:pb-4",children:e.jsxs(F,{className:"flex items-center gap-2 text-lg md:text-xl",children:[e.jsx(ve,{className:"h-5 w-5 text-primary"}),"ประวัติการแจ้งเตือน (",t.length,")"]})}),e.jsx(R,{className:"p-4 md:p-6",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Se,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"ยังไม่มีการแจ้งเตือน"})]}):e.jsx("div",{className:"space-y-3",children:t.map(l=>e.jsxs("div",{className:"border rounded-lg p-3 md:p-4 hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h(l.notification_type),e.jsx("span",{className:"font-medium text-sm md:text-base",children:f(l.notification_type)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:p(l.status)+" text-xs",children:l.status==="sent"?"ส่งแล้ว":l.status==="failed"?"ไม่สำเร็จ":l.status}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(l.created_at).toLocaleString("th-TH")})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["ส่งถึง: ",l.sent_to]}),e.jsx("div",{className:"text-xs md:text-sm bg-background p-2 rounded border border-border/30 max-h-20 overflow-y-auto",children:l.message_content})]},l.id))})})]})]})},Nx=()=>{const[t,s]=u.useState(""),[a,n]=u.useState([]),[r,o]=u.useState([]),[i,c]=u.useState(null),[d,p]=u.useState({lastDoseDate:"",nextDoseDate:"",doseNumber:"2",notes:"",customNextDate:!1}),[h,f]=u.useState([]),[l,m]=u.useState(!1),[g,b]=u.useState(!1),{toast:v}=fe(),x=async()=>{m(!0);try{const{data:k,error:H}=await B.from("appointments").select("*").eq("status","completed").order("appointment_date",{ascending:!1});if(H)throw H;n(k||[])}catch(k){console.error("Error loading appointments:",k),v({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลนัดหมายได้",variant:"destructive"})}finally{m(!1)}},j=async()=>{try{const{data:k,error:H}=await B.from("vaccine_schedules").select("*").eq("active",!0);if(H)throw H;const w=(k==null?void 0:k.map(y=>({...y,dose_intervals:Array.isArray(y.dose_intervals)?y.dose_intervals:typeof y.dose_intervals=="string"?JSON.parse(y.dose_intervals):[]})))||[];o(w)}catch(k){console.error("Error loading vaccine schedules:",k)}},_=(k,H,w)=>{const y=r.find(N=>N.vaccine_type===H);if(!y)return"";const E=y.dose_intervals,P=w-2,L=E[P]||30,z=new Date(k),I=new Date(z);return I.setDate(I.getDate()+L),I.toISOString().split("T")[0]},S=async k=>{c(k),p({lastDoseDate:k.appointment_date,nextDoseDate:"",doseNumber:"2",notes:k.notes||"",customNextDate:!1});try{const{data:H,error:w}=await B.from("appointments").select("*").eq("patient_id_number",k.patient_id_number).eq("vaccine_type",k.vaccine_type).in("status",["scheduled","pending"]).gte("appointment_date",new Date().toISOString().split("T")[0]);if(w)throw w;f(H||[])}catch(H){console.error("Error loading future appointments:",H),f([])}},C=k=>{p(H=>({...H,lastDoseDate:k,nextDoseDate:i?_(k,i.vaccine_type,parseInt(H.doseNumber)+1):""}))},T=k=>{p(H=>({...H,doseNumber:k,nextDoseDate:i&&H.lastDoseDate?_(H.lastDoseDate,i.vaccine_type,parseInt(k)+1):""}))},W=async()=>{if(!i||!d.lastDoseDate){v({title:"ข้อมูลไม่ครบถ้วน",description:"กรุณากรอกวันที่ฉีดเข็มล่าสุด",variant:"destructive"});return}let k=d.nextDoseDate;if(!k&&(k=_(d.lastDoseDate,i.vaccine_type,parseInt(d.doseNumber)+1),!k)){v({title:"ไม่สามารถคำนวณวันนัดได้",description:"ไม่พบข้อมูลวัคซีนหรือช่วงห่างการฉีด",variant:"destructive"});return}b(!0);try{const H=i.patient_id_number,w=parseInt(d.doseNumber)+1,{data:y,error:E}=await B.from("appointments").select("*").eq("patient_id_number",H).eq("vaccine_type",i.vaccine_type).in("status",["scheduled","pending"]).gte("appointment_date",new Date().toISOString().split("T")[0]);if(E)throw E;if(console.log("พบนัดเก่า:",(y==null?void 0:y.length)||0,"รายการ"),y&&y.length>0)for(const I of y){const{error:N}=await B.from("appointments").update({status:"cancelled",notes:`${I.notes||""} (ยกเลิกเนื่องจากแก้ไขข้อมูลเมื่อ ${new Date().toLocaleDateString("th-TH")})`}).eq("id",I.id);if(N)throw N;console.log("ยกเลิกนัดเก่า ID:",I.id)}const{error:P}=await B.from("appointments").update({appointment_date:d.lastDoseDate,notes:`${d.notes} (แก้ไขเมื่อ ${new Date().toLocaleDateString("th-TH")})`}).eq("id",i.id);if(P)throw P;const L=r.find(I=>I.vaccine_type===i.vaccine_type);if(L&&w<=L.total_doses){const{error:I}=await B.from("appointments").insert([{patient_name:i.patient_name,patient_id_number:i.patient_id_number,vaccine_type:i.vaccine_type,appointment_date:k,status:"scheduled",notes:`นัดเข็มที่ ${w} จาก ${L.total_doses} เข็ม (สร้างใหม่จากการแก้ไข ${new Date().toLocaleDateString("th-TH")})`}]);if(I)throw I;console.log("สร้างนัดใหม่สำเร็จ:",k)}const z=(y==null?void 0:y.length)||0;v({title:"บันทึกสำเร็จ",description:`แก้ไขข้อมูลของ ${i.patient_name} แล้ว${z>0?` (ยกเลิกนัดเก่า ${z} รายการ และสร้างนัดใหม่)`:" และสร้างนัดครั้งถัดไป"}`}),c(null),f([]),p({lastDoseDate:"",nextDoseDate:"",doseNumber:"2",notes:"",customNextDate:!1}),x()}catch(H){console.error("Error saving changes:",H),v({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกการเปลี่ยนแปลงได้",variant:"destructive"})}finally{b(!1)}};u.useEffect(()=>{x(),j()},[]);const D=a.filter(k=>k.patient_name.toLowerCase().includes(t.toLowerCase())||k.patient_id_number.toLowerCase().includes(t.toLowerCase())||k.vaccine_type.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(wa,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"แก้ไขข้อมูลนัดหมาย"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"แก้ไขวันที่ฉีดและคำนวณนัดครั้งถัดไป"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"ค้นหานัดหมายที่ต้องแก้ไข"]})}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(se,{placeholder:"ค้นหาด้วยชื่อผู้ป่วย, ID, หรือประเภทวัคซีน",value:t,onChange:k=>s(k.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:D.map(k=>e.jsxs("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${(i==null?void 0:i.id)===k.id?"border-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:()=>S(k),children:[e.jsx("div",{className:"font-medium",children:k.patient_name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[k.vaccine_type," - ",new Date(k.appointment_date).toLocaleDateString("th-TH")]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",k.patient_id_number]})]},k.id))}),D.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t?"ไม่พบข้อมูลที่ค้นหา":"ไม่มีข้อมูลนัดหมาย"})]})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"แก้ไขข้อมูลนัดหมาย"]})}),e.jsx(R,{children:i?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"font-medium",children:i.patient_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:i.vaccine_type}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",i.patient_id_number]})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"lastDoseDate",children:["วันที่ฉีดเข็มล่าสุด (เข็มที่ ",d.doseNumber,")"]}),e.jsx(se,{id:"lastDoseDate",type:"date",value:d.lastDoseDate,onChange:k=>C(k.target.value)})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"doseNumber",children:"เข็มที่ฉีดล่าสุด"}),e.jsxs(ft,{value:d.doseNumber,onValueChange:T,children:[e.jsx(at,{children:e.jsx(gt,{})}),e.jsxs(nt,{children:[e.jsx(Ne,{value:"1",children:"เข็มที่ 1"}),e.jsx(Ne,{value:"2",children:"เข็มที่ 2"}),e.jsx(Ne,{value:"3",children:"เข็มที่ 3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(q,{htmlFor:"nextDoseDate",children:["วันนัดเข็มถัดไป (เข็มที่ ",parseInt(d.doseNumber)+1,")"]}),e.jsx(M,{type:"button",variant:"outline",size:"sm",onClick:()=>p(k=>({...k,customNextDate:!k.customNextDate})),children:d.customNextDate?"ใช้วันที่อัตโนมัติ":"กำหนดวันที่เอง"})]}),d.customNextDate?e.jsx(se,{id:"nextDoseDate",type:"date",value:d.nextDoseDate,onChange:k=>p(H=>({...H,nextDoseDate:k.target.value}))}):e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("div",{className:"font-medium text-lg text-green-800",children:d.nextDoseDate?new Date(d.nextDoseDate).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",weekday:"long"}):"กรุณาเลือกวันที่ฉีดเข็มล่าสุด"}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["📅 คำนวณอัตโนมัติตามช่วงห่างของวัคซีน",d.nextDoseDate&&d.lastDoseDate&&` (ห่างจากเข็มล่าสุด ${Math.ceil((new Date(d.nextDoseDate).getTime()-new Date(d.lastDoseDate).getTime())/(1e3*60*60*24))} วัน)`]})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notes",children:"หมายเหตุ"}),e.jsx(se,{id:"notes",value:d.notes,onChange:k=>p(H=>({...H,notes:k.target.value})),placeholder:"หมายเหตุเพิ่มเติม"})]}),e.jsxs("div",{className:"space-y-2",children:[h.length>0&&e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsxs("div",{className:"font-medium text-yellow-800 mb-2",children:["⚠️ นัดเก่าที่จะถูกยกเลิก (",h.length," รายการ):"]}),h.map((k,H)=>e.jsxs("div",{className:"text-sm text-yellow-700 ml-4",children:["• วันที่ ",new Date(k.appointment_date).toLocaleDateString("th-TH")," (",k.status,")"]},k.id))]}),d.nextDoseDate&&e.jsxs("div",{className:"p-2 bg-green-50 border border-green-200 rounded text-sm text-green-800",children:["✅ ระบบจะสร้างนัดหมายเข็มที่ ",parseInt(d.doseNumber)+1," ในวันที่ ",new Date(d.nextDoseDate).toLocaleDateString("th-TH")," อัตโนมัติ"]}),e.jsxs(M,{onClick:W,disabled:g||!d.lastDoseDate,className:"w-full",children:[g?e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(or,{className:"h-4 w-4 mr-2"}),g?"กำลังบันทึก...":h.length>0?"ยกเลิกนัดเก่าและสร้างนัดใหม่":"บันทึกและสร้างนัดอัตโนมัติ"]})]})]}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(ve,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"เลือกนัดหมายที่ต้องการแก้ไขจากรายการด้านซ้าย"})]})})]})]})]})},wx=()=>{const[t,s]=u.useState(!1),[a,n]=u.useState([]),{toast:r}=fe(),o=async()=>{s(!0),n([]);const d=[];try{d.push({test:"Database Connection",status:"success",message:"เชื่อมต่อฐานข้อมูลสำเร็จ"});try{const{data:l,error:m}=await B.from("appointment_notifications").select("count").limit(1);if(m)throw m;d.push({test:"Notifications Table",status:"success",message:"ตาราง appointment_notifications พร้อมใช้งาน"})}catch(l){d.push({test:"Notifications Table",status:"error",message:`ตาราง appointment_notifications มีปัญหา: ${l.message}`})}try{const l=new Date;l.setDate(l.getDate()+1);const m=l.toISOString().split("T")[0],{data:g,error:b}=await B.from("appointments").select("*").eq("appointment_date",m).eq("status","scheduled");if(b)throw b;d.push({test:"Tomorrow Appointments",status:g&&g.length>0?"success":"warning",message:`พบนัดหมายพรุ่งนี้ ${(g==null?void 0:g.length)||0} รายการ`,details:g})}catch(l){d.push({test:"Tomorrow Appointments",status:"error",message:`ไม่สามารถตรวจสอบนัดหมายได้: ${l.message}`})}try{const l=new Date().toISOString().split("T")[0],{data:m,error:g}=await B.from("appointments").select("*").lt("appointment_date",l).eq("status","scheduled");if(g)throw g;d.push({test:"Overdue Appointments",status:m&&m.length>0?"warning":"success",message:`พบนัดเกินกำหนด ${(m==null?void 0:m.length)||0} รายการ`,details:m})}catch(l){d.push({test:"Overdue Appointments",status:"error",message:`ไม่สามารถตรวจสอบนัดเกินกำหนดได้: ${l.message}`})}try{const{data:l,error:m}=await B.functions.invoke("manual-notification-trigger",{body:{test:!0}});if(m)throw m;d.push({test:"Notification Function",status:"success",message:"ฟังก์ชันแจ้งเตือนทำงานได้",details:l})}catch(l){d.push({test:"Notification Function",status:"error",message:`ฟังก์ชันแจ้งเตือนมีปัญหา: ${l.message}`})}try{d.push({test:"CRON Job Status",status:"warning",message:"ไม่สามารถตรวจสอบสถานะ CRON job ได้ (ต้องใช้สิทธิ์ admin หรือเข้าถึงจาก server-side)"})}catch{d.push({test:"CRON Job Status",status:"warning",message:"ไม่สามารถตรวจสอบ CRON job ได้"})}try{const{data:l,error:m}=await B.from("appointment_notifications").select("*").order("created_at",{ascending:!1}).limit(5);if(m)throw m;d.push({test:"Recent Notifications",status:"success",message:`พบการแจ้งเตือนล่าสุด ${(l==null?void 0:l.length)||0} รายการ`,details:l})}catch(l){d.push({test:"Recent Notifications",status:"error",message:`ไม่สามารถตรวจสอบการแจ้งเตือนได้: ${l.message}`})}try{const{data:l,error:m}=await B.from("notification_jobs").select("*").order("created_at",{ascending:!1}).limit(5);if(m)throw m;const g=(l==null?void 0:l.filter(b=>b.status==="pending"))||[];d.push({test:"Notification Jobs Queue",status:"success",message:`พบงานแจ้งเตือน ${(l==null?void 0:l.length)||0} รายการ (รอดำเนินการ: ${g.length})`,details:{total:l==null?void 0:l.length,pending:g.length,jobs:l}})}catch(l){d.push({test:"Notification Jobs Queue",status:"warning",message:`ไม่สามารถตรวจสอบ notification_jobs ได้: ${l.message}`})}}catch(l){d.push({test:"General Error",status:"error",message:`เกิดข้อผิดพลาดทั่วไป: ${l.message}`})}n(d),s(!1);const p=d.filter(l=>l.status==="success").length,h=d.filter(l=>l.status==="error").length,f=d.filter(l=>l.status==="warning").length;r({title:"การทดสอบเสร็จสิ้น",description:`สำเร็จ: ${p}, เตือน: ${f}, ข้อผิดพลาด: ${h}`,variant:h>0?"destructive":"default"})},i=d=>{switch(d){case"success":return e.jsx(Z,{className:"h-4 w-4 text-green-600"});case"warning":return e.jsx(pt,{className:"h-4 w-4 text-yellow-600"});case"error":return e.jsx(pt,{className:"h-4 w-4 text-red-600"});default:return e.jsx($e,{className:"h-4 w-4 text-gray-600"})}},c=d=>{switch(d){case"success":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Qa,{className:"h-5 w-5 text-primary"}),"ทดสอบระบบแจ้งเตือนอัตโนมัติ"]})}),e.jsxs(R,{children:[e.jsxs(de,{className:"mb-4",children:[e.jsx(Tt,{className:"h-4 w-4"}),e.jsx(ue,{children:"เครื่องมือนี้จะทดสอบการทำงานของระบบแจ้งเตือนอัตโนมัติ รวมถึงการเชื่อมต่อฐานข้อมูล, การตรวจสอบนัดหมาย, และการทำงานของฟังก์ชันแจ้งเตือน"})]}),e.jsxs(M,{onClick:o,disabled:t,className:"w-full mb-6",children:[t?e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Qa,{className:"h-4 w-4 mr-2"}),t?"กำลังทดสอบ...":"เริ่มทดสอบระบบ"]}),a.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-lg mb-3",children:"ผลการทดสอบ:"}),a.map((d,p)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i(d.status),e.jsx("span",{className:"font-medium",children:d.test})]}),e.jsx(te,{className:c(d.status),children:d.status==="success"?"สำเร็จ":d.status==="warning"?"เตือน":"ข้อผิดพลาด"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:d.message}),d.details&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"ดูรายละเอียด"}),e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(d.details,null,2)})]})]},p))]})]})]})})};function _x(){const[t,s]=u.useState([]),[a,n]=u.useState(!0),[r,o]=u.useState(""),[i,c]=u.useState(""),[d,p]=u.useState("healthcare_staff"),{toast:h}=fe(),f=async()=>{n(!0);try{const{data:x,error:j}=await B.from("user_roles").select("user_id, role");if(j)throw j;const{data:{session:_}}=await B.auth.getSession();if(!_)throw new Error("ไม่ได้เข้าสู่ระบบ");const S=new Map;x==null||x.forEach(T=>{var W;S.has(T.user_id)||S.set(T.user_id,[]),(W=S.get(T.user_id))==null||W.push(T.role)});const C=Array.from(S.entries()).map(([T,W])=>({id:T,email:`user-${T.slice(0,8)}@example.com`,user_created_at:new Date().toISOString(),last_sign_in_at:new Date().toISOString(),roles:W,is_admin:W.includes("admin"),is_healthcare_staff:W.includes("admin")||W.includes("healthcare_staff")}));_.user&&!S.has(_.user.id)&&C.unshift({id:_.user.id,email:_.user.email||"unknown@example.com",user_created_at:_.user.created_at,last_sign_in_at:_.user.last_sign_in_at||null,roles:[],is_admin:!1,is_healthcare_staff:!1}),s(C)}catch(x){console.error("Error loading users:",x),h({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลผู้ใช้ได้",variant:"destructive"})}finally{n(!1)}},l=async(x,j)=>{try{const{data:{user:_}}=await B.auth.getUser();if(!_)throw new Error("ไม่ได้เข้าสู่ระบบ");let S=_.id;x!==_.email&&console.warn("Cannot assign role to different user in demo mode");const{error:C}=await B.from("user_roles").insert({user_id:S,role:j,created_by:_.id});if(C&&!C.message.includes("duplicate"))throw C;h({title:"สำเร็จ",description:`กำหนดสิทธิ์ ${v(j)} ให้ ${x} แล้ว`}),f()}catch(_){console.error("Error assigning role:",_),h({title:"เกิดข้อผิดพลาด",description:_ instanceof Error?_.message:"ไม่สามารถกำหนดสิทธิ์ได้",variant:"destructive"})}},m=async()=>{if(!i.trim()){h({title:"ข้อมูลไม่ครบถ้วน",description:"กรุณากรอกอีเมลผู้ใช้",variant:"destructive"});return}await l(i,d),c("")};u.useEffect(()=>{f()},[]);const g=t.filter(x=>x.email.toLowerCase().includes(r.toLowerCase())),b=x=>{switch(x){case"admin":return"bg-red-100 text-red-800 border-red-200";case"healthcare_staff":return"bg-blue-100 text-blue-800 border-blue-200";case"patient":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},v=x=>{switch(x){case"admin":return"ผู้ดูแลระบบ";case"healthcare_staff":return"เจ้าหน้าที่";case"patient":return"ผู้ป่วย";default:return x}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"จัดการสิทธิ์ผู้ใช้"]})}),e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(q,{htmlFor:"search",children:"ค้นหาผู้ใช้"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),e.jsx(se,{id:"search",value:r,onChange:x=>o(x.target.value),placeholder:"ค้นหาด้วยอีเมล...",className:"pl-10 cursor-text"})]})]}),e.jsxs("div",{className:"space-y-2 sm:w-auto w-full",children:[e.jsx(q,{className:"hidden sm:block",children:" "}),e.jsxs(M,{onClick:f,disabled:a,className:"w-full sm:w-auto cursor-pointer disabled:cursor-not-allowed",children:[e.jsx(De,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),"รีเฟรชข้อมูล"]})]})]})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"กำหนดสิทธิ์ให้ผู้ใช้"]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"userEmail",children:"อีเมลผู้ใช้"}),e.jsx(se,{id:"userEmail",value:i,onChange:x=>c(x.target.value),placeholder:"user@example.com",type:"email",className:"cursor-text"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"userRole",children:"สิทธิ์"}),e.jsxs(ft,{value:d,onValueChange:x=>p(x),children:[e.jsx(at,{className:"cursor-pointer",children:e.jsx(gt,{})}),e.jsxs(nt,{children:[e.jsx(Ne,{value:"healthcare_staff",className:"cursor-pointer",children:"เจ้าหน้าที่"}),e.jsx(Ne,{value:"admin",className:"cursor-pointer",children:"ผู้ดูแลระบบ"}),e.jsx(Ne,{value:"patient",className:"cursor-pointer",children:"ผู้ป่วย"})]})]})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[e.jsx(q,{className:"hidden lg:block",children:" "}),e.jsxs(M,{onClick:m,className:"w-full cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"กำหนดสิทธิ์"]})]})]})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{children:["รายชื่อผู้ใช้ (",g.length," คน)"]})}),e.jsx(R,{children:a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(De,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]}):g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Se,{className:"h-8 w-8 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"ไม่พบผู้ใช้"})]}):e.jsx("div",{className:"space-y-4",children:g.map(x=>e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow cursor-default",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium truncate select-text",title:x.email,children:x.email}),e.jsx("div",{className:"flex flex-wrap gap-1",children:x.roles.length>0?x.roles.map(j=>e.jsx(te,{className:`${b(j)} text-xs`,children:v(j)},j)):e.jsx(te,{variant:"outline",className:"text-xs",children:"ไม่มีสิทธิ์"})})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{className:"select-text",children:["สมัครเมื่อ: ",new Date(x.user_created_at).toLocaleDateString("th-TH")]}),x.last_sign_in_at&&e.jsxs("p",{className:"select-text",children:["เข้าสู่ระบบล่าสุด: ",new Date(x.last_sign_in_at).toLocaleDateString("th-TH")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2 lg:flex-shrink-0",children:[!x.is_healthcare_staff&&e.jsxs(M,{size:"sm",onClick:()=>l(x.email,"healthcare_staff"),className:"cursor-pointer hover:shadow-sm transition-shadow text-xs sm:text-sm",children:[e.jsx(Ee,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"ให้สิทธิ์เจ้าหน้าที่"}),e.jsx("span",{className:"sm:hidden",children:"เจ้าหน้าที่"})]}),!x.is_admin&&e.jsxs(M,{size:"sm",variant:"outline",onClick:()=>l(x.email,"admin"),className:"cursor-pointer hover:shadow-sm transition-shadow text-xs sm:text-sm",children:[e.jsx(Ee,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"ให้สิทธิ์ Admin"}),e.jsx("span",{className:"sm:hidden",children:"Admin"})]})]})]})},x.id))})})]})]})}const Sx=()=>{const[t,s]=u.useState(null),[a,n]=u.useState(null),[r,o]=u.useState(!1),[i,c]=u.useState(!1),[d,p]=u.useState(!0),h=Nt(),{toast:f}=fe();u.useEffect(()=>{(async()=>{var v,x;try{const{data:{session:j},error:_}=await B.auth.getSession();if(_)throw _;if(!j){p(!1);return}n(j),s(j.user);const{data:S,error:C}=await B.rpc("is_healthcare_staff",{_user_id:j.user.id});if(C){console.error("Error checking staff status:",C);const D=((v=j.user.email)==null?void 0:v.endsWith("@vchomehospital.co.th"))||!1;o(D)}else if(S)o(S);else{const D=((x=j.user.email)==null?void 0:x.endsWith("@vchomehospital.co.th"))||!1,k=["admin@vchomehospital.co.th","staff@vchomehospital.co.th"].includes(j.user.email||"");o(D||k)}const{data:T,error:W}=await B.rpc("has_role",{_user_id:j.user.id,_role:"admin"});if(W){console.error("Error checking admin status:",W);const D=j.user.email==="admin@vchomehospital.co.th"||j.user.email==="superadmin@vchomehospital.co.th";c(D)}else if(T)c(T);else{const D=j.user.email==="admin@vchomehospital.co.th"||j.user.email==="superadmin@vchomehospital.co.th";c(D)}}catch(j){console.error("Auth check error:",j),f({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถตรวจสอบสิทธิ์การเข้าถึงได้",variant:"destructive"})}finally{p(!1)}})();const{data:{subscription:b}}=B.auth.onAuthStateChange(async(v,x)=>{(v==="SIGNED_OUT"||!x)&&(s(null),n(null),o(!1),c(!1),h("/auth"))});return()=>b.unsubscribe()},[h,f]);const l=async()=>{try{const{error:g}=await B.auth.signOut();if(g)throw g;f({title:"ออกจากระบบแล้ว",description:"คุณได้ออกจากระบบเรียบร้อยแล้ว"}),h("/auth")}catch(g){console.error("Sign out error:",g),f({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถออกจากระบบได้",variant:"destructive"})}},m=()=>{h("/auth")};return d?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsx(A,{className:"w-96",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"กำลังตรวจสอบสิทธิ์..."})]})})}):t?r?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white",children:[e.jsx("div",{className:"bg-white border-b shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"container mx-auto px-2 sm:px-4 py-3 sm:py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl overflow-hidden shadow-md flex-shrink-0 bg-gradient-to-br from-blue-50 to-blue-100 p-1",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"โลโก้โรงพยาบาลโฮม",className:"w-full h-full object-contain",onError:g=>{const b=g.target,v="./";b.src.includes("hospital-logo.png")?b.src=`${v}images/home-hospital-logo.png`:b.src.includes("home-hospital-logo.png")&&(b.src=`${v}favicon-hospital.png`)}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-foreground truncate",children:"ระบบจัดการวัคซีน"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:"โรงพยาบาลโฮม"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"text-right hidden lg:block",children:[e.jsx("p",{className:"text-sm font-medium truncate max-w-[200px]",title:t.email,children:t.email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i?"ผู้ดูแลระบบ":"เจ้าหน้าที่"})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx(M,{variant:"ghost",size:"sm",className:"lg:hidden p-2",title:`${t.email} - ${i?"ผู้ดูแลระบบ":"เจ้าหน้าที่"}`,children:e.jsx(xt,{className:"h-4 w-4"})}),e.jsxs(M,{onClick:l,variant:"outline",size:"sm",className:"px-2 sm:px-4",children:[e.jsx(gs,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"ออกจากระบบ"})]})]})]})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs(Xe,{defaultValue:"staff-portal",className:"w-full",children:[e.jsx("div",{className:"block lg:hidden mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Oe,{className:"flex w-max gap-1 p-1",children:[e.jsx(K,{value:"staff-portal",className:"text-xs px-3 py-2 whitespace-nowrap",children:"นัดวันนี้"}),e.jsx(K,{value:"registrations",className:"text-xs px-3 py-2 whitespace-nowrap",children:"ลงทะเบียน"}),e.jsxs(e.Fragment,{children:[e.jsx(K,{value:"next-appointments",className:"text-xs px-3 py-2 whitespace-nowrap",children:"นัดถัดไป"}),e.jsx(K,{value:"past-vaccinations",className:"text-xs px-3 py-2 whitespace-nowrap",children:"ประวัติ"}),e.jsx(K,{value:"edit-appointments",className:"text-xs px-3 py-2 whitespace-nowrap",children:"แก้ไขนัด"}),e.jsx(K,{value:"vaccine-calculator",className:"text-xs px-3 py-2 whitespace-nowrap",children:"คำนวณ"})]}),i&&!0&&e.jsx(K,{value:"user-roles",className:"text-xs px-3 py-2 whitespace-nowrap",children:"จัดการสิทธิ์"}),i&&!0&&e.jsx(K,{value:"settings",className:"text-xs px-3 py-2 whitespace-nowrap",children:"ตั้งค่า"})]})})}),e.jsxs(Oe,{className:`hidden lg:grid w-full mb-6 gap-1 ${i?"grid-cols-8":"grid-cols-6"}`,children:[e.jsx(K,{value:"staff-portal",className:"text-sm px-2 py-2",children:"นัดวันนี้"}),e.jsx(K,{value:"registrations",className:"text-sm px-2 py-2",children:"รายการลงทะเบียน"}),e.jsx(K,{value:"next-appointments",className:"text-sm px-2 py-2",children:"นัดครั้งถัดไป"}),e.jsx(K,{value:"past-vaccinations",className:"text-sm px-2 py-2",children:"ประวัติการฉีด"}),e.jsx(K,{value:"edit-appointments",className:"text-sm px-2 py-2",children:"แก้ไขนัด"}),e.jsx(K,{value:"vaccine-calculator",className:"text-sm px-2 py-2",children:"คำนวณวัคซีน"}),i&&e.jsx(K,{value:"user-roles",className:"text-sm px-2 py-2",children:"จัดการสิทธิ์"}),i&&e.jsx(K,{value:"settings",className:"text-sm px-2 py-2",children:"ตั้งค่า"})]}),e.jsx(ee,{value:"staff-portal",children:e.jsx(_o,{})}),e.jsx(ee,{value:"registrations",children:e.jsx(vx,{})}),e.jsx(ee,{value:"next-appointments",children:e.jsx(bx,{})}),e.jsx(ee,{value:"past-vaccinations",children:e.jsx(yx,{})}),e.jsx(ee,{value:"edit-appointments",children:e.jsx(Nx,{})}),e.jsx(ee,{value:"vaccine-calculator",children:e.jsx(gx,{})}),i&&e.jsx(ee,{value:"user-roles",children:e.jsx(_x,{})}),i&&e.jsx(ee,{value:"settings",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsx(F,{children:"ตั้งค่าระบบ"}),e.jsx(ie,{children:"จัดการการตั้งค่าระบบและสิทธิ์การเข้าถึง"})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"การจัดการผู้ใช้"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["อีเมล: ",t.email]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["สิทธิ์: ",i?"ผู้ดูแลระบบ":"เจ้าหน้าที่"]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"การตั้งค่าวัคซีน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"จัดการประเภทวัคซีนและตารางการให้"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"ระบบแจ้งเตือน"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsx(jx,{}),e.jsx(wx,{})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"จัดการนัดหมายผู้ป่วย"}),e.jsx("div",{className:"mt-2",children:e.jsx(So,{})})]})]})})]})})]})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsxs(A,{className:"w-96",children:[e.jsx($,{className:"text-center",children:e.jsxs(F,{className:"flex items-center justify-center gap-2 text-2xl text-destructive",children:[e.jsx(Ee,{className:"h-6 w-6"}),"ไม่มีสิทธิ์เข้าถึง"]})}),e.jsxs(R,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-muted-foreground",children:"คุณไม่มีสิทธิ์เข้าถึงระบบจัดการเจ้าหน้าที่"}),e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"อีเมล:"})," ",t==null?void 0:t.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"สถานะ:"})," ไม่มีสิทธิ์เจ้าหน้าที่"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"หากคุณเป็นเจ้าหน้าที่ กรุณาติดต่อผู้ดูแลระบบเพื่อขอสิทธิ์การเข้าถึง"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{onClick:()=>window.location.reload(),className:"w-full",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"ลองใหม่"]}),e.jsxs(M,{onClick:l,variant:"outline",className:"w-full",children:[e.jsx(gs,{className:"h-4 w-4 mr-2"}),"ออกจากระบบ"]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center",children:e.jsxs(A,{className:"w-96",children:[e.jsx($,{className:"text-center",children:e.jsxs(F,{className:"flex items-center justify-center gap-2 text-2xl",children:[e.jsx(Ee,{className:"h-6 w-6 text-primary"}),"ต้องเข้าสู่ระบบ"]})}),e.jsxs(R,{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:"กรุณาเข้าสู่ระบบเพื่อเข้าถึงระบบจัดการเจ้าหน้าที่"}),e.jsx(M,{onClick:m,className:"w-full",children:"เข้าสู่ระบบ"})]})]})})},kn=()=>e.jsx(Sx,{}),si=({className:t="mx-auto",size:s=128})=>{const a="./",n=a.endsWith("/")?a:a+"/";return e.jsx("div",{className:t,style:{width:s,height:s},children:e.jsx("div",{className:"w-full h-full rounded-3xl overflow-hidden bg-gradient-to-br from-white/50 to-transparent p-2 backdrop-blur-sm",children:e.jsx("img",{src:n+"images/hospital-logo.png",alt:"รพ.โฮม - VCHome Hospital Logo",className:"w-full h-full object-contain drop-shadow-2xl",onError:r=>{const o=r.target,i=[n+"images/home-hospital-logo.png",n+"images/home-hospital-logo.svg",n+"favicon-hospital.png"],c=o.src;let d=-1;c.includes("hospital-logo.png")?d=0:c.includes("home-hospital-logo.png")?d=1:c.includes("home-hospital-logo.svg")&&(d=2),d>=0&&d<i.length&&(o.src=i[d])}})})})},Zs=768;function Cx(){const[t,s]=u.useState(void 0);return u.useEffect(()=>{const a=window.matchMedia(`(max-width: ${Zs-1}px)`),n=()=>{s(window.innerWidth<Zs)};return a.addEventListener("change",n),s(window.innerWidth<Zs),()=>a.removeEventListener("change",n)},[]),!!t}const kx=Gi,Dx=Vi,ai=u.forwardRef(({className:t,...s},a)=>e.jsx(Yn,{className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));ai.displayName=Yn.displayName;const Ex=wt("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ni=u.forwardRef(({side:t="right",className:s,children:a,...n},r)=>e.jsxs(Dx,{children:[e.jsx(ai,{}),e.jsxs(Gn,{ref:r,className:G(Ex({side:t}),s),...n,children:[a,e.jsxs(Yi,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Na,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ni.displayName=Gn.displayName;const Ix=u.forwardRef(({className:t,...s},a)=>e.jsx(qn,{ref:a,className:G("text-lg font-semibold text-foreground",t),...s}));Ix.displayName=qn.displayName;const Tx=u.forwardRef(({className:t,...s},a)=>e.jsx(Kn,{ref:a,className:G("text-sm text-muted-foreground",t),...s}));Tx.displayName=Kn.displayName;function Dn({className:t,...s}){return e.jsx("div",{className:G("animate-pulse rounded-md bg-muted",t),...s})}const Px="sidebar:state",Ax=60*60*24*7,Rx="16rem",Mx="18rem",Ox="3rem",Lx="b",ri=u.createContext(null);function Ts(){const t=u.useContext(ri);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}const oi=u.forwardRef(({defaultOpen:t=!0,open:s,onOpenChange:a,className:n,style:r,children:o,...i},c)=>{const d=Cx(),[p,h]=u.useState(!1),[f,l]=u.useState(t),m=s??f,g=u.useCallback(j=>{const _=typeof j=="function"?j(m):j;a?a(_):l(_),document.cookie=`${Px}=${_}; path=/; max-age=${Ax}`},[a,m]),b=u.useCallback(()=>d?h(j=>!j):g(j=>!j),[d,g,h]);u.useEffect(()=>{const j=_=>{_.key===Lx&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),b())};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[b]);const v=m?"expanded":"collapsed",x=u.useMemo(()=>({state:v,open:m,setOpen:g,isMobile:d,openMobile:p,setOpenMobile:h,toggleSidebar:b}),[v,m,g,d,p,h,b]);return e.jsx(ri.Provider,{value:x,children:e.jsx(mo,{delayDuration:0,children:e.jsx("div",{style:{"--sidebar-width":Rx,"--sidebar-width-icon":Ox,...r},className:G("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:c,...i,children:o})})})});oi.displayName="SidebarProvider";const ii=u.forwardRef(({side:t="left",variant:s="sidebar",collapsible:a="offcanvas",className:n,children:r,...o},i)=>{const{isMobile:c,state:d,openMobile:p,setOpenMobile:h}=Ts();return a==="none"?e.jsx("div",{className:G("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:i,...o,children:r}):c?e.jsx(kx,{open:p,onOpenChange:h,...o,children:e.jsx(ni,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":Mx},side:t,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:r})})}):e.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":d,"data-collapsible":d==="collapsed"?a:"","data-variant":s,"data-side":t,children:[e.jsx("div",{className:G("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",s==="floating"||s==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),e.jsx("div",{className:G("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",s==="floating"||s==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...o,children:e.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:r})})]})});ii.displayName="Sidebar";const li=u.forwardRef(({className:t,onClick:s,...a},n)=>{const{toggleSidebar:r}=Ts();return e.jsxs(M,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:G("h-7 w-7",t),onClick:o=>{s==null||s(o),r()},...a,children:[e.jsx(ml,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});li.displayName="SidebarTrigger";const $x=u.forwardRef(({className:t,...s},a)=>{const{toggleSidebar:n}=Ts();return e.jsx("button",{ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:G("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...s})});$x.displayName="SidebarRail";const Fx=u.forwardRef(({className:t,...s},a)=>e.jsx("main",{ref:a,className:G("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",t),...s}));Fx.displayName="SidebarInset";const Wx=u.forwardRef(({className:t,...s},a)=>e.jsx(se,{ref:a,"data-sidebar":"input",className:G("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",t),...s}));Wx.displayName="SidebarInput";const zx=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"header",className:G("flex flex-col gap-2 p-2",t),...s}));zx.displayName="SidebarHeader";const Bx=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"footer",className:G("flex flex-col gap-2 p-2",t),...s}));Bx.displayName="SidebarFooter";const Ux=u.forwardRef(({className:t,...s},a)=>e.jsx(_e,{ref:a,"data-sidebar":"separator",className:G("mx-2 w-auto bg-sidebar-border",t),...s}));Ux.displayName="SidebarSeparator";const ci=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"content",className:G("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...s}));ci.displayName="SidebarContent";const ha=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"group",className:G("relative flex w-full min-w-0 flex-col p-2",t),...s}));ha.displayName="SidebarGroup";const pa=u.forwardRef(({className:t,asChild:s=!1,...a},n)=>{const r=s?Lt:"div";return e.jsx(r,{ref:n,"data-sidebar":"group-label",className:G("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...a})});pa.displayName="SidebarGroupLabel";const Hx=u.forwardRef(({className:t,asChild:s=!1,...a},n)=>{const r=s?Lt:"button";return e.jsx(r,{ref:n,"data-sidebar":"group-action",className:G("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",t),...a})});Hx.displayName="SidebarGroupAction";const xa=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"group-content",className:G("w-full text-sm",t),...s}));xa.displayName="SidebarGroupContent";const fa=u.forwardRef(({className:t,...s},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu",className:G("flex w-full min-w-0 flex-col gap-1",t),...s}));fa.displayName="SidebarMenu";const ga=u.forwardRef(({className:t,...s},a)=>e.jsx("li",{ref:a,"data-sidebar":"menu-item",className:G("group/menu-item relative",t),...s}));ga.displayName="SidebarMenuItem";const Vx=wt("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),va=u.forwardRef(({asChild:t=!1,isActive:s=!1,variant:a="default",size:n="default",tooltip:r,className:o,...i},c)=>{const d=t?Lt:"button",{isMobile:p,state:h}=Ts(),f=e.jsx(d,{ref:c,"data-sidebar":"menu-button","data-size":n,"data-active":s,className:G(Vx({variant:a,size:n}),o),...i});return r?(typeof r=="string"&&(r={children:r}),e.jsxs(iu,{children:[e.jsx(lu,{asChild:!0,children:f}),e.jsx(ho,{side:"right",align:"center",hidden:h!=="collapsed"||p,...r})]})):f});va.displayName="SidebarMenuButton";const Yx=u.forwardRef(({className:t,asChild:s=!1,showOnHover:a=!1,...n},r)=>{const o=s?Lt:"button";return e.jsx(o,{ref:r,"data-sidebar":"menu-action",className:G("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",t),...n})});Yx.displayName="SidebarMenuAction";const Gx=u.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,"data-sidebar":"menu-badge",className:G("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t),...s}));Gx.displayName="SidebarMenuBadge";const qx=u.forwardRef(({className:t,showIcon:s=!1,...a},n)=>{const r=u.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return e.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:G("rounded-md h-8 flex gap-2 px-2 items-center",t),...a,children:[s&&e.jsx(Dn,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),e.jsx(Dn,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":r}})]})});qx.displayName="SidebarMenuSkeleton";const Kx=u.forwardRef(({className:t,...s},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu-sub",className:G("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",t),...s}));Kx.displayName="SidebarMenuSub";const Jx=u.forwardRef(({...t},s)=>e.jsx("li",{ref:s,...t}));Jx.displayName="SidebarMenuSubItem";const Xx=u.forwardRef(({asChild:t=!1,size:s="md",isActive:a,className:n,...r},o)=>{const i=t?Lt:"a";return e.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":s,"data-active":a,className:G("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",s==="sm"&&"text-xs",s==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...r})});Xx.displayName="SidebarMenuSubButton";const Qx=[{title:"หน้าหลัก",url:"/",icon:ir,roles:["admin"]},{title:"จัดการเจ้าหน้าที่",url:"/staff-portal",icon:Se,roles:["admin","healthcare_staff"]},{title:"LINE Bot",url:"/LineBot",icon:qt,roles:["admin"]},{title:"ลงทะเบียนผู้ป่วย",url:"/PatientPortal",icon:We,roles:["admin","healthcare_staff"]}],Zx=[{title:"ระบบผู้ดูแล",url:"/admin",icon:Ee,roles:["admin"]}];function ef(){const s=Xn().pathname,a=r=>r==="/"?s==="/":s.startsWith(r),n=r=>a(r)?"nav-link-active":"nav-link";return e.jsx(ii,{className:"glass-sidebar border-r border-border/20",children:e.jsxs(ci,{className:"bg-gradient-sidebar",children:[e.jsx("div",{className:"p-6 border-b border-border/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden shadow-md",children:e.jsx("img",{src:"./images/hospital-logo.png",alt:"โลโก้โรงพยาบาลโฮม",className:"w-full h-full object-contain object-center"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg text-foreground",children:"โรงพยาบาลโฮม"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ระบบจัดการวัคซีน"})]})]})}),e.jsxs(ha,{children:[e.jsx(pa,{className:"text-primary font-semibold",children:"เมนูหลัก"}),e.jsx(xa,{children:e.jsx(fa,{children:Qx.map(r=>e.jsx(ga,{children:e.jsx(va,{asChild:!0,children:e.jsxs(Ka,{to:r.url,className:n(r.url),children:[e.jsx(r.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:r.title})]})})},r.title))})})]}),e.jsxs(ha,{children:[e.jsx(pa,{className:"text-medical-error font-semibold",children:"ผู้ดูแลระบบ"}),e.jsx(xa,{children:e.jsx(fa,{children:Zx.map(r=>e.jsx(ga,{children:e.jsx(va,{asChild:!0,children:e.jsxs(Ka,{to:r.url,className:n(r.url),children:[e.jsx(r.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:r.title})]})})},r.title))})})]}),e.jsx("div",{className:"mt-auto p-6",children:e.jsx("div",{className:"card-glass",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Vt,{className:"h-8 w-8 mx-auto text-primary mb-2"}),e.jsx("h3",{className:"font-semibold text-sm text-foreground mb-1",children:"ระบบทำงานปกติ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"อัปเดตล่าสุด: วันนี้"})]})})})]})})}function tf({children:t,user:s,showSidebar:a=!0,title:n}){const{toast:r}=fe(),o=Nt(),i=async()=>{const{error:c}=await B.auth.signOut();c?r({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถออกจากระบบได้",variant:"destructive"}):(o("/auth"),r({title:"ออกจากระบบสำเร็จ",description:"คุณได้ออกจากระบบเรียบร้อยแล้ว"}))};return a?e.jsx(oi,{children:e.jsxs("div",{className:"min-h-screen flex w-full bg-gradient-hero",children:[e.jsx(ef,{}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"h-14 md:h-16 bg-white/80 backdrop-blur-xl border-b border-border/50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-full px-3 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(li,{className:"text-primary hover:bg-primary/10 transition-colors p-1 md:p-2"}),n&&e.jsx("div",{children:e.jsx("h1",{className:"text-lg md:text-xl font-semibold text-foreground truncate",children:n})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-3 px-3 md:px-4 py-1.5 md:py-2 rounded-lg md:rounded-xl bg-accent/50 border border-border/30",children:[e.jsx(xt,{className:"h-4 w-4 text-primary"}),e.jsx("div",{className:"text-sm",children:e.jsx("p",{className:"font-medium text-foreground truncate max-w-[120px] md:max-w-none",children:s.email})})]}),e.jsxs(M,{onClick:i,variant:"outline",size:"sm",className:"h-8 md:h-9 px-2 md:px-3 border-destructive/20 hover:bg-destructive/10 hover:text-destructive",children:[e.jsx(gs,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"ออกจากระบบ"})]})]})]})}),e.jsx("main",{className:"flex-1 p-3 md:p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:t})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-hero",children:t})}const En=()=>{const[t,s]=u.useState(null),[a,n]=u.useState(null),[r,o]=u.useState(!0),[i,c]=u.useState(!1),[d,p]=u.useState(!1),h=Nt();return fe(),u.useEffect(()=>{o(!1),c(!0);const{data:{subscription:f}}=B.auth.onAuthStateChange(async(l,m)=>{n(m),s((m==null?void 0:m.user)??null),m!=null&&m.user&&setTimeout(async()=>{try{const{data:g,error:b}=await B.rpc("has_role",{_user_id:m.user.id,_role:"admin"}),{data:v,error:x}=await B.rpc("is_healthcare_staff",{_user_id:m.user.id});!b&&!x&&(c(g),p(v))}catch(g){console.error("Role check failed:",g)}},100)});return setTimeout(()=>{B.auth.getSession().then(({data:{session:l}})=>{n(l),s((l==null?void 0:l.user)??null)})},50),()=>f.unsubscribe()},[h]),r?e.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md bg-white rounded-2xl p-8 shadow-lg",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"กำลังโหลดระบบ"}),e.jsx("p",{className:"text-muted-foreground",children:"โปรดรอสักครู่..."})]})}):i?e.jsxs(tf,{user:t,title:"ระบบจัดการหลัก - ผู้ดูแลระบบ",children:[e.jsxs("div",{className:"mb-8 text-center bg-gradient-to-br from-teal-50 via-white to-cyan-50 rounded-2xl p-8 border border-teal-200/50",children:[e.jsx("div",{className:"mb-6",children:e.jsx(si,{className:"mx-auto",size:140})}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-teal-600 via-cyan-600 to-blue-600 bg-clip-text text-transparent",children:"ระบบจัดการวัคซีน"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-2xl md:text-3xl font-semibold text-gray-700",children:[e.jsx(hl,{className:"h-6 w-6 text-red-500"}),e.jsx("span",{children:"VCHome Hospital"}),e.jsx(pl,{className:"h-6 w-6 text-yellow-500"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"ระบบจัดการที่ครบครันสำหรับการดูแลผู้ป่วยและการจัดการวัคซีน พร้อมเทคโนโลจีที่ทันสมัย ปลอดภัย และใช้งานง่าย"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-green-100 text-green-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"ระบบพร้อมใช้งาน"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx(Ee,{className:"h-4 w-4"}),"ปลอดภัย 100%"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-purple-100 text-purple-700 px-4 py-2 rounded-full text-sm font-medium",children:[e.jsx(Vt,{className:"h-4 w-4"}),"24/7 Support"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"นัดหมายวันนี้"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:"12"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+8.2% จากเมื่อวาน"})]}),e.jsx(ve,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"ผู้ป่วยทั้งหมด"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:"156"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+12.5% เดือนนี้"})]}),e.jsx(Se,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"เจ้าหน้าที่"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:"8"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"ออนไลน์"})]}),e.jsx(Ee,{className:"h-8 w-8 text-purple-600"})]})}),e.jsx(A,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"ความสำเร็จ"}),e.jsx("p",{className:"text-3xl font-bold text-teal-600",children:"98.5%"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+2.1% ปรับปรุง"})]}),e.jsx(vs,{className:"h-8 w-8 text-teal-600"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-8",children:[e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-teal-100 rounded-xl",children:e.jsx(Se,{className:"h-6 w-6 text-teal-600"})}),"จัดการนัดหมาย"]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:"หน้าสำหรับเจ้าหน้าที่จัดการนัดหมายผู้ป่วยและติดตามการฉีดวัคซีน พร้อมระบบแจ้งเตือนและรายงานแบบเรียลไทม์"}),e.jsx(M,{asChild:!0,className:"w-full",children:e.jsxs(Ls,{to:"/auth",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"เข้าสู่ระบบ"]})})]})]}),e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(qt,{className:"h-6 w-6 text-blue-600"})}),"LINE Bot Management"]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:"จัดการการตั้งค่า LINE Bot และทดสอบการเชื่อมต่อกับผู้ป่วย รวมถึงการส่งข้อความแจ้งเตือนอัตโนมัติ"}),e.jsx(M,{asChild:!0,className:"w-full",variant:"outline",children:e.jsxs(Ls,{to:"/LineBot",children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"เข้าสู่ระบบ"]})})]})]}),e.jsxs(A,{className:"hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(We,{className:"h-6 w-6 text-green-600"})}),"ลงทะเบียนผู้ป่วย"]})}),e.jsxs(R,{children:[e.jsx("p",{className:"text-muted-foreground mb-6 leading-relaxed",children:"หน้าสำหรับผู้ป่วยลงทะเบียนฉีดวัคซีนและจองนัดหมาย พร้อมระบบตรวจสอบประวัติและคำแนะนำ"}),e.jsx(M,{asChild:!0,className:"w-full",variant:"outline",children:e.jsxs(Ls,{to:"/PatientPortal",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"เข้าสู่ระบบ"]})})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[e.jsx(A,{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border-teal-200",children:e.jsxs(R,{className:"p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-4 bg-teal-600 rounded-2xl",children:e.jsx(Ee,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:"สิทธิ์ผู้ดูแลระบบ"}),e.jsx("p",{className:"text-gray-600",children:"Administrator Access"})]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"คุณมีสิทธิ์เข้าถึงทุกระบบและจัดการข้อมูลทั้งหมด รวมถึงการตั้งค่าระบบ จัดการผู้ใช้งาน และควบคุมการเข้าถึงข้อมูล"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Full Access"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx(Vt,{className:"h-3 w-3"}),"System Active"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full text-sm font-medium",children:[e.jsx(Za,{className:"h-3 w-3"}),"Analytics"]})]})]})}),e.jsx(A,{children:e.jsxs(R,{className:"p-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"การดำเนินการด่วน"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(M,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/admin"),children:[e.jsx(Ce,{className:"h-4 w-4 mr-3"}),"ตั้งค่าระบบ"]}),e.jsxs(M,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/reports"),children:[e.jsx(Za,{className:"h-4 w-4 mr-3"}),"รายงานและสถิติ"]}),e.jsxs(M,{className:"w-full justify-start h-12",variant:"outline",onClick:()=>h("/notifications"),children:[e.jsx(Ae,{className:"h-4 w-4 mr-3"}),"จัดการการแจ้งเตือน"]}),e.jsxs(M,{className:"w-full justify-start h-12 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white",onClick:()=>h("/download"),children:[e.jsx(Rt,{className:"h-4 w-4 mr-3"}),"ดาวน์โหลด Desktop App"]})]})]})})]}),e.jsxs("div",{className:"mt-8 p-8 bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"📊 ระบบรายงานและสถิติ"}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5,6,7,8].map(f=>e.jsxs(A,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2",children:["รายงานที่ ",f]}),e.jsx("p",{className:"text-muted-foreground",children:"ข้อมูลสถิติและรายงานต่างๆ ของระบบ รวมถึงการวิเคราะห์ข้อมูลผู้ป่วย การติดตามผลการฉีดวัคซีน และประสิทธิภาพของระบบโดยรวม ช่วยให้สามารถ ตัดสินใจเชิงกลยุทธ์ได้อย่างมีประสิทธิภาพ"})]},f))})]})]}):null},sf="./",In=(window.location.origin+sf).replace(/\/+$/,""),Tn=()=>{const[t,s]=u.useState(null),[a,n]=u.useState(null),[r,o]=u.useState(""),[i,c]=u.useState(""),[d,p]=u.useState(!1),[h,f]=u.useState(!1),[l,m]=u.useState(!1),[g,b]=u.useState(!1),[v,x]=u.useState(""),[j,_]=u.useState(""),S=Nt(),{toast:C}=fe(),T=u.useRef(!1);u.useEffect(()=>{const y=new URL(window.location.href),E=y.searchParams,P=new URLSearchParams(y.hash.slice(1)),L=E.get("type")||P.get("type"),z=E.get("code")||P.get("code"),I=P.get("access_token"),N=P.get("refresh_token");L==="recovery"&&(T.current=!0,b(!0),z?B.auth.exchangeCodeForSession(z).then(({error:Y})=>{Y&&(console.error("exchangeCodeForSession error:",Y),C({title:"ลิงก์รีเซ็ตรหัสผ่านใช้ไม่ได้",description:"ลิงก์อาจหมดอายุหรือไม่ถูกต้อง",variant:"destructive"}),b(!1),T.current=!1)}):I&&N&&B.auth.setSession({access_token:I,refresh_token:N}).then(({error:Y})=>{Y&&(console.error("setSession error:",Y),C({title:"เกิดข้อผิดพลาด",description:"ลิงก์รีเซ็ตรหัสผ่านไม่ถูกต้องหรือหมดอายุแล้ว",variant:"destructive"}),b(!1),T.current=!1)}));const{data:{subscription:O}}=B.auth.onAuthStateChange((Y,U)=>{if(n(U),s((U==null?void 0:U.user)??null),Y==="PASSWORD_RECOVERY"){b(!0),T.current=!0;return}U!=null&&U.user&&!T.current&&(S("/staff-portal",{replace:!0}),C({title:"เข้าสู่ระบบสำเร็จ",description:"ยินดีต้อนรับเข้าสู่ระบบจัดการนัดหมาย"}))});return B.auth.getSession().then(({data:{session:Y}})=>{n(Y),s((Y==null?void 0:Y.user)??null),Y!=null&&Y.user&&!T.current&&S("/staff-portal",{replace:!0})}),()=>O.unsubscribe()},[S,C]);const W=async()=>{var y;p(!0);try{const{error:E}=await B.auth.signInWithPassword({email:r,password:i});if(E){E instanceof vl&&E.status===400?C({title:"ข้อผิดพลาด",description:"อีเมลหรือรหัสผ่านไม่ถูกต้อง",variant:"destructive"}):(y=E.message)!=null&&y.toLowerCase().includes("email not confirmed")?C({title:"ยืนยันอีเมล",description:"กรุณาตรวจสอบอีเมลและคลิกลิงก์ยืนยัน",variant:"destructive"}):C({title:"เกิดข้อผิดพลาด",description:E.message,variant:"destructive"});return}}catch{C({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถเข้าสู่ระบบได้ กรุณาลองใหม่",variant:"destructive"})}finally{p(!1)}},D=async()=>{var y,E;p(!0);try{const P=`${In}/`,{error:L}=await B.auth.signUp({email:r,password:i,options:{emailRedirectTo:P}});if(L){(y=L.message)!=null&&y.toLowerCase().includes("already registered")?C({title:"ข้อผิดพลาด",description:"อีเมลนี้ได้รับการลงทะเบียนแล้ว กรุณาเข้าสู่ระบบ",variant:"destructive"}):(E=L.message)!=null&&E.toLowerCase().includes("password")?C({title:"รหัสผ่านไม่ถูกต้อง",description:"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร",variant:"destructive"}):C({title:"เกิดข้อผิดพลาด",description:L.message,variant:"destructive"});return}C({title:"ลงทะเบียนสำเร็จ",description:"กรุณาตรวจสอบอีเมลเพื่อยืนยันบัญชี"}),f(!1)}catch{C({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถลงทะเบียนได้ กรุณาลองใหม่",variant:"destructive"})}finally{p(!1)}},k=async()=>{if(!r){C({title:"กรุณากรอกอีเมล",description:"กรุณากรอกอีเมลของคุณเพื่อรีเซ็ตรหัสผ่าน",variant:"destructive"});return}p(!0);try{const{error:y}=await B.auth.resetPasswordForEmail(r,{redirectTo:`${In}/auth?type=recovery`});y?C({title:"เกิดข้อผิดพลาด",description:y.message,variant:"destructive"}):(C({title:"ส่งอีเมลรีเซ็ตรหัสผ่านแล้ว",description:"กรุณาตรวจสอบอีเมลของคุณและคลิกลิงก์เพื่อรีเซ็ตรหัสผ่าน"}),m(!1))}catch{C({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถส่งอีเมลรีเซ็ตรหัสผ่านได้ กรุณาลองใหม่",variant:"destructive"})}finally{p(!1)}},H=async()=>{if(!v||!j){C({title:"กรุณากรอกรหัสผ่าน",description:"กรุณากรอกรหัสผ่านใหม่และยืนยันรหัสผ่าน",variant:"destructive"});return}if(v!==j){C({title:"รหัสผ่านไม่ตรงกัน",description:"รหัสผ่านใหม่และการยืนยันรหัสผ่านไม่ตรงกัน",variant:"destructive"});return}if(v.length<6){C({title:"รหัสผ่านสั้นเกินไป",description:"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร",variant:"destructive"});return}p(!0);try{const{error:y}=await B.auth.updateUser({password:v});y?C({title:"เกิดข้อผิดพลาด",description:y.message,variant:"destructive"}):(C({title:"เปลี่ยนรหัสผ่านสำเร็จ",description:"รหัสผ่านของคุณได้รับการอัปเดตแล้ว กำลังนำคุณเข้าสู่ระบบ"}),S("/auth",{replace:!0}),setTimeout(()=>{T.current=!1,b(!1),S("/staff-portal",{replace:!0})},800))}catch{C({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถเปลี่ยนรหัสผ่านได้ กรุณาลองใหม่",variant:"destructive"})}finally{p(!1)}},w=y=>{y.preventDefault(),g?H():l?k():h?D():W()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-green-100/30 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-primary/20 via-green-400/10 to-emerald-500/20 rounded-full blur-2xl animate-pulse"})}),e.jsxs("div",{className:"relative z-10 space-y-3",children:[e.jsx("h1",{className:"text-5xl font-black bg-gradient-to-r from-primary via-green-600 to-emerald-600 bg-clip-text text-transparent animate-fade-in",children:"โรงพยาบาลโฮม"}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-primary to-emerald-500 mx-auto rounded-full"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xl font-semibold text-foreground/90",children:"ระบบจัดการการนัดหมายและวัคซีน"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"เข้าสู่ระบบเพื่อจัดการข้อมูลอย่างปลอดภัย"})]})]}),g?e.jsxs(A,{className:"border-2 border-blue-200 shadow-xl bg-white/95 backdrop-blur-sm animate-scale-in",children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-center",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(os,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent",children:"ตั้งรหัสผ่านใหม่"})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"กรุณาสร้างรหัสผ่านใหม่สำหรับบัญชีของคุณ"})]})})}),e.jsx(R,{children:e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"new-password",children:"รหัสผ่านใหม่"}),e.jsx(se,{id:"new-password",type:"password",placeholder:"รหัสผ่านใหม่ (อย่างน้อย 6 ตัวอักษร)",value:v,onChange:y=>x(y.target.value),required:!0,minLength:6,className:"border-2 border-blue-300 focus:border-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"confirm-password",children:"ยืนยันรหัสผ่านใหม่"}),e.jsx(se,{id:"confirm-password",type:"password",placeholder:"ยืนยันรหัสผ่านใหม่",value:j,onChange:y=>_(y.target.value),required:!0,minLength:6,className:"border-2 border-blue-300 focus:border-blue-500"})]}),e.jsxs(M,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-500/90 hover:to-purple-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):null,"อัปเดตรหัสผ่าน"]}),e.jsx("div",{className:"text-center",children:e.jsx(M,{type:"button",variant:"link",onClick:()=>{b(!1),T.current=!1,S("/auth",{replace:!0})},className:"text-sm text-muted-foreground hover:text-foreground font-medium",children:"กลับไปเข้าสู่ระบบ"})})]})})]}):e.jsxs(A,{className:"border-2 border-green-200 shadow-xl bg-white/95 backdrop-blur-sm animate-scale-in",children:[e.jsx($,{className:"pb-2",children:e.jsx(F,{className:"text-center",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx(os,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-emerald-600 bg-clip-text text-transparent",children:"เข้าสู่ระบบ"})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"เลือกระหว่างเข้าสู่ระบบหรือสร้างบัญชีใหม่"})]})})}),e.jsx(R,{children:l?e.jsxs("div",{className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"รีเซ็ตรหัสผ่าน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"กรอกอีเมลของคุณเพื่อรับลิงก์รีเซ็ตรหัสผ่าน"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"reset-email",children:"อีเมล"}),e.jsx(se,{id:"reset-email",type:"email",placeholder:"example@email.com",value:r,onChange:y=>o(y.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(M,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-500/90 hover:to-purple-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):null,"ส่งลิงก์รีเซ็ตรหัสผ่าน"]}),e.jsx("div",{className:"text-center",children:e.jsx(M,{type:"button",variant:"link",onClick:()=>m(!1),className:"text-sm text-muted-foreground hover:text-foreground font-medium",children:"กลับไปเข้าสู่ระบบ"})})]})]}):e.jsxs(Xe,{value:h?"signup":"signin",onValueChange:y=>f(y==="signup"),children:[e.jsxs(Oe,{className:"grid w-full grid-cols-2 bg-green-50 p-1 rounded-xl border border-green-200",children:[e.jsxs(K,{value:"signin",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-green-200 rounded-lg font-semibold transition-all duration-300",children:[e.jsx(os,{className:"h-4 w-4"}),"เข้าสู่ระบบ"]}),e.jsxs(K,{value:"signup",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-green-200 rounded-lg font-semibold transition-all duration-300",children:[e.jsx(We,{className:"h-4 w-4"}),"ลงทะเบียน"]})]}),e.jsxs(ee,{value:"signin",className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"ยินดีต้อนรับกลับ"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"กรอกข้อมูลเพื่อเข้าสู่ระบบ"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"email",children:"อีเมล"}),e.jsx(se,{id:"email",type:"email",placeholder:"example@email.com",value:r,onChange:y=>o(y.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"password",children:"รหัสผ่าน"}),e.jsx(se,{id:"password",type:"password",placeholder:"รหัสผ่าน",value:i,onChange:y=>c(y.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(M,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-primary to-emerald-500 hover:from-primary/90 hover:to-emerald-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(os,{className:"h-5 w-5 mr-3"}),"เข้าสู่ระบบ"]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(M,{type:"button",variant:"link",onClick:()=>m(!0),className:"text-sm text-primary hover:text-primary/80 font-medium",children:"ลืมรหัสผ่าน?"})})]})]}),e.jsxs(ee,{value:"signup",className:"mt-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"สร้างบัญชีใหม่"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เริ่มต้นใช้งานระบบจัดการการนัดหมาย"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"signup-email",children:"อีเมล"}),e.jsx(se,{id:"signup-email",type:"email",placeholder:"example@email.com",value:r,onChange:y=>o(y.target.value),required:!0,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"signup-password",children:"รหัสผ่าน"}),e.jsx(se,{id:"signup-password",type:"password",placeholder:"รหัสผ่าน (อย่างน้อย 6 ตัวอักษร)",value:i,onChange:y=>c(y.target.value),required:!0,minLength:6,className:"border-2 border-green-300 focus:border-primary"})]}),e.jsxs(M,{type:"submit",className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-500/90 hover:to-green-500/90 shadow-lg hover:shadow-xl transition-all duration-300",disabled:d,"aria-busy":d,children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(We,{className:"h-5 w-5 mr-3"}),"ลงทะเบียน"]})]})]})]})})]}),!g&&e.jsx("div",{className:"text-center",children:e.jsxs(M,{variant:"outline",onClick:()=>S("/"),className:"flex items-center gap-2 border-2 border-green-200 hover:bg-green-50 hover:border-primary transition-all duration-300 font-medium",children:[e.jsx(ir,{className:"h-4 w-4"}),"กลับหน้าหลัก"]})})]})})},af=()=>{const[t,s]=u.useState(!1),a=Nt(),n=()=>{s(!0),setTimeout(()=>{a("/admin")},500)},r=()=>{s(!0),setTimeout(()=>{a("/auth")},500)},o=()=>{s(!0),setTimeout(()=>{a("/patient-portal")},500)};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',background:"hsl(210, 40%, 98%)"},children:e.jsxs("div",{style:{textAlign:"center",color:"hsl(210, 25%, 15%)",maxWidth:"500px",padding:"40px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",background:"hsl(170, 50%, 45%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 30px",fontSize:"50px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:"🏥"}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"32px",fontWeight:"700",color:"hsl(170, 50%, 45%)"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 40px 0",fontSize:"24px",color:"hsl(210, 25%, 15%)",fontWeight:"600"},children:"ระบบจัดการวัคซีน"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginBottom:"30px"},children:[e.jsx("button",{onClick:n,disabled:t,style:{padding:"15px 30px",background:"hsl(170, 50%, 45%)",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",transition:"all 0.2s"},children:t?"กำลังเข้าสู่ระบบ...":"🔧 เข้าสู่ระบบผู้ดูแล"}),e.jsx("button",{onClick:r,disabled:t,style:{padding:"15px 30px",background:"white",color:"hsl(170, 50%, 45%)",border:"2px solid hsl(170, 50%, 45%)",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,transition:"all 0.2s"},children:t?"กำลังเข้าสู่ระบบ...":"👩‍⚕️ เจ้าหน้าที่"}),e.jsx("button",{onClick:o,disabled:t,style:{padding:"15px 30px",background:"white",color:"hsl(170, 50%, 45%)",border:"2px solid hsl(170, 50%, 45%)",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:t?"not-allowed":"pointer",opacity:t?.7:1,transition:"all 0.2s"},children:t?"กำลังเข้าสู่ระบบ...":"👤 ผู้ป่วย"})]}),e.jsxs("div",{style:{padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"hsl(170, 50%, 45%)",fontSize:"18px"},children:"🚀 เข้าใช้งานด่วน"}),e.jsxs("p",{style:{margin:"0",fontSize:"14px",color:"hsl(210, 25%, 40%)",lineHeight:"1.5"},children:["เลือกประเภทผู้ใช้งานเพื่อเข้าสู่ระบบ",e.jsx("br",{}),"ระบบจะนำคุณไปยังหน้าที่เหมาะสม"]})]}),e.jsx("p",{style:{margin:"0",opacity:"0.5",fontSize:"13px"},children:"VCHome Hospital Management System v1.0.0"})]})})},nf=()=>{const[t,s]=u.useState(0),[a,n]=u.useState("เริ่มต้นระบบ..."),r=Nt();return u.useEffect(()=>{const o=[{progress:20,status:"กำลังโหลดส่วนประกอบ...",delay:300},{progress:40,status:"กำลังเตรียมระบบ...",delay:500},{progress:60,status:"กำลังตรวจสอบการเชื่อมต่อ...",delay:700},{progress:80,status:"เกือบเสร็จแล้ว...",delay:900},{progress:100,status:"เสร็จสิ้น!",delay:1200}];let i=0;const c=setInterval(()=>{if(i<o.length){const d=o[i];s(d.progress),n(d.status),i++}else clearInterval(c),setTimeout(()=>{r("/auth")},500)},400);return()=>clearInterval(c)},[r]),e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',background:"hsl(210, 40%, 98%)"},children:e.jsxs("div",{style:{textAlign:"center",color:"hsl(210, 25%, 15%)",maxWidth:"400px",padding:"40px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"hsl(170, 50%, 45%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 30px",fontSize:"40px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:"🏥"}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"28px",fontWeight:"700",color:"hsl(170, 50%, 45%)"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 30px 0",fontSize:"20px",color:"hsl(210, 25%, 15%)",fontWeight:"600"},children:"ระบบจัดการวัคซีน"}),e.jsx("div",{style:{width:"100%",height:"8px",background:"hsl(170, 50%, 45%, 0.2)",borderRadius:"4px",overflow:"hidden",marginBottom:"20px"},children:e.jsx("div",{style:{width:`${t}%`,height:"100%",background:"hsl(170, 50%, 45%)",borderRadius:"4px",transition:"width 0.3s ease-out"}})}),e.jsx("p",{style:{margin:"0 0 10px 0",opacity:"0.7",fontSize:"16px"},children:a}),e.jsxs("p",{style:{margin:"0",opacity:"0.5",fontSize:"14px"},children:[t,"%"]}),e.jsx("div",{style:{marginTop:"40px",padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:e.jsxs("p",{style:{margin:"0",fontSize:"14px",color:"hsl(210, 25%, 40%)",lineHeight:"1.5"},children:["โรงพยาบาลโฮม",e.jsx("br",{}),"ระบบจัดการวัคซีนและนัดหมายการฉีดวัคซีน"]})})]})})},rf=()=>{const[t,s]=u.useState(!0),[a,n]=u.useState(0),r=Nt();u.useEffect(()=>{const i=setInterval(()=>{n(c=>c>=100?(clearInterval(i),s(!1),100):c+20)},200);return()=>clearInterval(i)},[]);const o=i=>{r(i)};return t?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)"},children:e.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.1)",maxWidth:"400px",width:"90%"},children:[e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",fontSize:"40px"},children:"🏥"}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"24px",fontWeight:"700",color:"#0ea5e9"},children:"VCHome Hospital"}),e.jsx("p",{style:{margin:"0 0 30px 0",color:"#64748b",fontSize:"16px"},children:"ระบบจัดการวัคซีน"}),e.jsx("div",{style:{width:"100%",height:"8px",background:"#e2e8f0",borderRadius:"4px",overflow:"hidden",marginBottom:"15px"},children:e.jsx("div",{style:{width:`${a}%`,height:"100%",background:"linear-gradient(90deg, #0ea5e9 0%, #06b6d4 100%)",transition:"width 0.2s ease"}})}),e.jsxs("p",{style:{margin:"0",color:"#0ea5e9",fontSize:"18px",fontWeight:"600"},children:[a,"%"]})]})}):e.jsx("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",padding:"40px 20px"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",background:"linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",fontSize:"50px",boxShadow:"0 10px 30px rgba(0,0,0,0.1)"},children:"🏥"}),e.jsx("h1",{style:{margin:"0 0 10px 0",fontSize:"36px",fontWeight:"700",color:"#0ea5e9"},children:"VCHome Hospital"}),e.jsx("h2",{style:{margin:"0 0 20px 0",fontSize:"20px",color:"#64748b",fontWeight:"500"},children:"ระบบจัดการวัคซีน"}),e.jsx("p",{style:{margin:"0 auto",fontSize:"16px",color:"#64748b",maxWidth:"500px"},children:"เลือกระบบที่คุณต้องการเข้าใช้งาน"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"20px",marginBottom:"40px"},children:[e.jsxs("div",{onClick:()=>o("/admin"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-2px)",i.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:"🔧"}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#0ea5e9"},children:"ระบบผู้ดูแล"}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:"จัดการระบบและตั้งค่าทั่วไป"})]}),e.jsxs("div",{onClick:()=>o("/staff-portal"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-2px)",i.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:"👩‍⚕️"}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#10b981"},children:"เจ้าหน้าที่"}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:"จัดการนัดหมายและข้อมูลผู้ป่วย"})]}),e.jsxs("div",{onClick:()=>o("/patient-portal"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-2px)",i.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:"👤"}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#8b5cf6"},children:"ผู้ป่วย"}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:"ลงทะเบียนและตรวจสอบสถานะวัคซีน"})]}),e.jsxs("div",{onClick:()=>o("/line-bot"),style:{background:"white",borderRadius:"12px",padding:"30px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid #e2e8f0"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-2px)",i.currentTarget.style.boxShadow="0 8px 30px rgba(0,0,0,0.12)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:"40px",marginBottom:"15px"},children:"🤖"}),e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"600",color:"#f59e0b"},children:"LINE Bot"}),e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px",lineHeight:"1.5"},children:"ระบบแชทบอทและการแจ้งเตือน"})]})]}),e.jsx("div",{style:{textAlign:"center",padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsx("p",{style:{margin:"0",color:"#64748b",fontSize:"14px"},children:"VCHome Hospital Management System v1.0.0"})})]})})},of=()=>{const t="your-liff-id",[s,a]=u.useState({fullName:"",phone:""}),[n,r]=u.useState(!1),[o,i]=u.useState(!1),[c,d]=u.useState(!1),[p,h]=u.useState(!1),[f,l]=u.useState(null),[m,g]=u.useState(null),{toast:b}=fe();u.useEffect(()=>{(async()=>{try{if(typeof window<"u"&&window.liff)if(console.log("LIFF SDK found, initializing..."),await window.liff.init({liffId:t}),d(!0),h(window.liff.isInClient()),window.liff.isLoggedIn())try{const T=await window.liff.getProfile();l(T),a(W=>({...W,lineUserId:T.userId,lineDisplayName:T.displayName,linePictureUrl:T.pictureUrl,fullName:T.displayName||W.fullName})),console.log("LIFF Profile loaded:",T),b({title:"เชื่อมต่อ LINE สำเร็จ",description:`ยินดีต้อนรับ ${T.displayName}`})}catch(T){console.error("Error getting LIFF profile:",T),g("ไม่สามารถดึงข้อมูลโปรไฟล์ LINE ได้")}else console.log("User not logged in to LINE"),window.liff.isInClient()&&window.liff.login();else console.log("LIFF SDK not found, loading..."),await v()}catch(T){console.error("LIFF initialization failed:",T),g(`LIFF เริ่มต้นไม่สำเร็จ: ${T}`)}})()},[t,b]);const v=()=>new Promise((C,T)=>{const W=document.createElement("script");W.src="https://static.line-scdn.net/liff/edge/2/sdk.js",W.onload=async()=>{try{if(await window.liff.init({liffId:t}),d(!0),h(window.liff.isInClient()),window.liff.isLoggedIn()){const D=await window.liff.getProfile();l(D),a(k=>({...k,lineUserId:D.userId,lineDisplayName:D.displayName,linePictureUrl:D.pictureUrl,fullName:D.displayName||k.fullName}))}C()}catch(D){T(D)}},W.onerror=T,document.head.appendChild(W)}),x=(C,T)=>{a(W=>({...W,[C]:T}))},j=async()=>{if(!s.fullName||!s.phone){b({title:"ข้อผิดพลาด",description:"กรุณากรอกข้อมูลให้ครบถ้วน",variant:"destructive"});return}if(!/^[0-9]{9,10}$/.test(s.phone.replace(/[-\s]/g,""))){b({title:"ข้อผิดพลาด",description:"กรุณากรอกหมายเลขโทรศัพท์ให้ถูกต้อง",variant:"destructive"});return}r(!0);try{const T=`HOM-${Date.now().toString().slice(-6)}`,W=new Date(Date.now()+24*60*60*1e3).toISOString().split("T")[0],{data:D,error:k}=await B.from("appointments").insert({appointment_id:T,patient_name:s.fullName,patient_phone:s.phone,patient_id_number:s.lineUserId,vaccine_type:"general_service",appointment_date:W,appointment_time:"09:00",status:"scheduled",scheduled_by:"patient_liff",line_user_id:s.lineUserId,notes:`ลงทะเบียนผ่าน LINE LIFF - ${s.lineDisplayName}`}).select().single();if(k)throw k;if(i(!0),b({title:"ลงทะเบียนสำเร็จ",description:`ลงทะเบียนรับบริการสำเร็จแล้ว (ID: ${T})`}),s.lineUserId)try{await B.functions.invoke("send-line-message",{body:{userId:s.lineUserId,message:`✅ ลงทะเบียนรับบริการสำเร็จ

📋 รายละเอียด:
• ชื่อ: ${s.fullName}
• เบอร์โทร: ${s.phone}
• วันที่: ${W}
• รหัสนัดหมาย: ${T}

🏥 โรงพยาบาลโฮม
เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย`,type:"template",templateData:{appointmentId:T,patientName:s.fullName,appointmentDate:W}}})}catch(H){console.error("Error sending LINE message:",H)}if(p&&window.liff)try{await window.liff.sendMessages([{type:"text",text:`✅ ลงทะเบียนรับบริการสำเร็จ

ชื่อ: ${s.fullName}
เบอร์: ${s.phone}
รหัส: ${T}

โรงพยาบาลโฮม
เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย`}])}catch(H){console.error("Error sending LINE chat message:",H)}setTimeout(()=>{p&&window.liff&&window.liff.closeWindow()},8e3)}catch(T){console.error("Registration error:",T),b({title:"ลงทะเบียนไม่สำเร็จ",description:`เกิดข้อผิดพลาด: ${T}`,variant:"destructive"})}finally{r(!1)}},_=()=>{a({fullName:(f==null?void 0:f.displayName)||"",phone:"",lineUserId:f==null?void 0:f.userId,lineDisplayName:f==null?void 0:f.displayName,linePictureUrl:f==null?void 0:f.pictureUrl}),i(!1)},S=()=>{window.liff&&window.liff.isInClient()&&window.liff.closeWindow()};return o?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx(A,{className:"border-green-200 bg-green-50",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx(Z,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"ลงทะเบียนสำเร็จ!"}),e.jsxs("p",{className:"text-green-700 mb-6",children:["ขอบคุณที่ลงทะเบียน เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย",p&&e.jsx("span",{className:"block mt-2 text-sm font-medium",children:"⏰ หน้าต่างจะปิดอัตโนมัติใน 8 วินาที"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"ข้อมูลที่ลงทะเบียน:"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ชื่อ:"})," ",s.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"เบอร์โทร:"})," ",s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"สถานที่:"})," โรงพยาบาลโฮม"]}),s.lineUserId&&e.jsxs("p",{children:[e.jsx("strong",{children:"LINE ID:"})," ",s.lineUserId]})]})]}),e.jsxs("div",{className:"space-y-2",children:[!p&&e.jsx(M,{onClick:_,variant:"outline",className:"w-full",children:"ลงทะเบียนใหม่"}),p&&e.jsx(M,{onClick:S,className:"w-full",children:"ปิดหน้าต่าง"})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"ลงทะเบียนรับบริการ"}),e.jsx("h2",{className:"text-xl text-muted-foreground mt-2 font-semibold",children:"โรงพยาบาลโฮม"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:"กรุณากรอกข้อมูลเพื่อลงทะเบียนรับบริการ"})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),"สถานะ LINE App"]})}),e.jsx(R,{children:m?e.jsxs(de,{variant:"destructive",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsx(ue,{children:m})]}):e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"LIFF พร้อมใช้:"}),e.jsx("span",{className:c?"text-green-600":"text-red-600",children:c?"✓ พร้อม":"✗ ไม่พร้อม"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ใน LINE App:"}),e.jsx("span",{className:p?"text-green-600":"text-yellow-600",children:p?"✓ ใช่":"✗ เบราว์เซอร์"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"โปรไฟล์:"}),e.jsx("span",{className:f?"text-green-600":"text-yellow-600",children:f?"✓ เชื่อมต่อแล้ว":"✗ ยังไม่เชื่อมต่อ"})]})]})})]}),f&&e.jsx(A,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[f.pictureUrl&&e.jsx("img",{src:f.pictureUrl,alt:"LINE Profile",className:"w-12 h-12 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:f.displayName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เชื่อมต่อจาก LINE"})]})]})})}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-5 w-5"}),"ข้อมูลผู้ลงทะเบียน"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"fullName",children:"ชื่อ-นามสกุล"}),e.jsx(se,{id:"fullName",placeholder:"นาย/นาง/นางสาว ชื่อ นามสกุล",value:s.fullName,onChange:C=>x("fullName",C.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"phone",children:"หมายเลขโทรศัพท์"}),e.jsx(se,{id:"phone",placeholder:"08x-xxx-xxxx",value:s.phone,onChange:C=>x("phone",C.target.value),className:"mt-1"})]})]})]}),e.jsx(M,{onClick:j,disabled:n,className:"w-full",size:"lg",children:n?"กำลังลงทะเบียน...":"ลงทะเบียนรับบริการ"}),e.jsx(de,{children:e.jsxs(ue,{children:["หลังจากลงทะเบียน เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันนัดหมาย และแจ้งข้อมูลบริการที่ต้องการ",p&&" ข้อความยืนยันจะถูกส่งไปที่แชท LINE ของคุณ"]})})]})})},lf=()=>e.jsx(of,{}),cf=()=>{const[t,s]=u.useState([]),[a,n]=u.useState([]),[r,o]=u.useState(""),[i,c]=u.useState(null),[d,p]=u.useState(!1),[h,f]=u.useState(!0),[l,m]=u.useState(null),{toast:g}=fe();u.useEffect(()=>{b()},[]),u.useEffect(()=>{if(!r.trim())n(t);else{const _=t.filter(S=>S.full_name.toLowerCase().includes(r.toLowerCase())||S.phone.includes(r)||S.registration_id.toLowerCase().includes(r.toLowerCase()));n(_)}},[r,t]);const b=async()=>{try{f(!0);const{data:_,error:S}=await B.from("patient_registrations").select("*").order("full_name",{ascending:!0});if(S)throw S;s(_||[])}catch{g({variant:"destructive",title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดรายชื่อผู้ป่วยได้"})}finally{f(!1)}},v=async _=>{p(!0),c(_);try{const T=await fetch("https://fljyjbrgfzervxofrilo.supabase.co/functions/v1/secure-vaccine-status-lookup",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZsanlqYnJnZnplcnZ4b2ZyaWxvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMDE1MDUsImV4cCI6MjA2OTY3NzUwNX0.2_rGfy-3UA4cPnRsg8Lm8uvj9KBCOoz5IhwCbSWYIq4"},body:JSON.stringify({searchType:"phone",searchValue:_.phone})});if(!T.ok){const D=await T.json();throw new Error(D.error||"เกิดข้อผิดพลาดในการค้นหาข้อมูล")}const W=await T.json();m({appointments:W.appointments||[],logs:W.vaccineLogs||[],registrations:W.registrations||[]}),g({title:"โหลดข้อมูลสำเร็จ",description:`โหลดข้อมูลของ ${_.full_name} สำเร็จ`})}catch(S){console.error("Error:",S),g({variant:"destructive",title:"เกิดข้อผิดพลาด",description:"ไม่สามารถโหลดข้อมูลวัคซีนได้"})}finally{p(!1)}},x=_=>{const S={completed:{label:"เสร็จสิ้น",variant:"default",icon:Z},in_progress:{label:"กำลังดำเนินการ",variant:"secondary",icon:$e},scheduled:{label:"นัดหมายแล้ว",variant:"outline",icon:ve},cancelled:{label:"ยกเลิก",variant:"destructive",icon:ws}},C=S[_]||S.in_progress,T=C.icon;return e.jsxs(te,{variant:C.variant,className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),C.label]})},j=_=>_?new Date(_).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"-";return e.jsx("div",{className:"container mx-auto p-4 max-w-6xl",children:e.jsxs(A,{children:[e.jsxs($,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"ตรวจสอบสถานะการฉีดวัคซีน"]}),e.jsx(ie,{children:"เลือกผู้ป่วยเพื่อดูข้อมูลการฉีดวัคซีนและประวัติการรักษา"})]}),e.jsx(R,{className:"space-y-6",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-medium",children:[e.jsx(xt,{className:"h-5 w-5"}),"ข้อมูลผู้ป่วย: ",i.full_name]}),e.jsx(M,{variant:"outline",onClick:()=>{c(null),m(null)},children:"กลับไปยังรายชื่อ"})]}),d?e.jsx("div",{className:"text-center py-8",children:"กำลังโหลดข้อมูลวัคซีน..."}):l&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{className:"text-lg",children:"ข้อมูลการลงทะเบียน"})}),e.jsx(R,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ชื่อ-นามสกุล:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.full_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"เบอร์โทร:"}),e.jsx("span",{className:"ml-2",children:i.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"โรงพยาบาล:"}),e.jsx("span",{className:"ml-2",children:i.hospital})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"รหัสลงทะเบียน:"}),e.jsx("span",{className:"ml-2",children:i.registration_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"วันที่ลงทะเบียน:"}),e.jsx("span",{className:"ml-2",children:j(i.created_at)})]}),i.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"หมายเหตุ:"}),e.jsx("p",{className:"text-sm mt-1",children:i.notes})]})]})})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsx(F,{className:"text-lg",children:"นัดหมายการฉีดวัคซีน"})}),e.jsx(R,{children:l.appointments&&l.appointments.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.appointments.map(_=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:_.vaccine_type}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ve,{className:"h-3 w-3"}),j(_.appointment_date),_.appointment_time&&e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-3 w-3 ml-1"}),_.appointment_time.substring(0,5)]})]})]}),x(_.status)]}),_.notes&&e.jsx("p",{className:"text-sm text-muted-foreground",children:_.notes})]},_.id))}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"ไม่มีนัดหมาย"})})]}),e.jsxs(A,{className:"lg:col-span-2",children:[e.jsx($,{children:e.jsx(F,{className:"text-lg",children:"ประวัติการฉีดวัคซีน"})}),e.jsx(R,{children:l.logs&&l.logs.length>0?e.jsx("div",{className:"space-y-3",children:l.logs.map(_=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h4",{className:"font-medium",children:_.vaccine_type}),e.jsxs(te,{variant:"outline",children:["เข็มที่ ",_.dose_number]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"วันที่ฉีด:"}),e.jsx("p",{className:"font-medium",children:j(_.administered_date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ฉีดโดย:"}),e.jsx("p",{className:"font-medium",children:_.administered_by})]}),_.batch_number&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Batch:"}),e.jsx("p",{className:"font-medium",children:_.batch_number})]}),_.side_effects&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ผลข้างเคียง:"}),e.jsx("p",{className:"font-medium",children:_.side_effects})]})]}),_.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"หมายเหตุ:"}),e.jsx("p",{className:"text-sm mt-1",children:_.notes})]})]},_.id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"ไม่มีประวัติการฉีดวัคซีน"})})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"ค้นหาด้วยชื่อ เบอร์โทร หรือรหัสลงทะเบียน",value:r,onChange:_=>o(_.target.value),className:"pl-10"})]}),e.jsxs(A,{children:[e.jsx($,{children:e.jsxs(F,{className:"text-lg",children:["รายชื่อผู้ป่วย (",a.length," คน)"]})}),e.jsx(R,{children:h?e.jsx("div",{className:"text-center py-8",children:"กำลังโหลดรายชื่อผู้ป่วย..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t.length===0?"ไม่พบข้อมูลผู้ป่วยในระบบ":"ไม่พบผู้ป่วยที่ตรงกับการค้นหา"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.map(_=>e.jsx("div",{className:"border rounded-lg p-3 hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>v(_),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:_.full_name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xt,{className:"h-3 w-3"}),_.phone]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-3 w-3"}),j(_.created_at)]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["รหัส: ",_.registration_id]})]}),e.jsx(te,{variant:_.status==="pending"?"secondary":"default",className:"ml-2",children:_.status==="pending"?"รอการนัดหมาย":_.status})]})},_.id))})})]})]})})]})})},df=()=>e.jsx(cf,{}),uf=()=>{const[t,s]=u.useState(null),[a,n]=u.useState(!0),[r,o]=u.useState(0),[i,c]=u.useState(!1);u.useEffect(()=>{d()},[]);const d=async()=>{try{const h=await fetch("https://moradok.github.io/VaccineHomeBot/release-info.json");if(h.ok){const f=await h.json();s(f)}else s({version:"1.0.0",downloadUrl:"https://moradok.github.io/VaccineHomeBot/downloads/VCHome-Hospital-Setup.exe",size:"186.8 MB",releaseDate:"9 ตุลาคม 2025",changelog:["ระบบจัดการวัคซีนครบครัน","หน้าต่างผู้ดูแลระบบ","ระบบเจ้าหน้าที่และผู้ป่วย","การเชื่อมต่อ LINE Bot","ฐานข้อมูล Supabase"]})}catch(h){console.error("Failed to fetch release info:",h),s({version:"1.0.0",downloadUrl:"#",size:"186.8 MB",releaseDate:"9 ตุลาคม 2025",changelog:["ระบบจัดการวัคซีนครบครัน"]})}finally{n(!1)}},p=async()=>{if(t){c(!0),o(0);try{const h=setInterval(()=>{o(l=>l>=100?(clearInterval(h),c(!1),100):l+10)},200),f=document.createElement("a");f.href=t.downloadUrl,f.download=`VCHome-Hospital-Setup-${t.version}.exe`,document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(h){console.error("Download failed:",h),c(!1),o(0)}}};return a?e.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"กำลังตรวจสอบเวอร์ชันล่าสุด..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-hero",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(si,{className:"mx-auto mb-6",size:120}),e.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-primary bg-clip-text text-transparent",children:"ดาวน์โหลด VCHome Hospital"}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"ระบบจัดการวัคซีนสำหรับโรงพยาบาลโฮม"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs(A,{className:"card-balanced",children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-3",children:[e.jsx(en,{className:"h-6 w-6 text-primary"}),"Windows Desktop App"]})}),e.jsx(R,{children:t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["เวอร์ชัน ",t.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["อัพเดท: ",t.releaseDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:t.size}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ขนาดไฟล์"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"ความต้องการของระบบ:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Windows 10/11 (64-bit หรือ 32-bit)"}),e.jsx("li",{children:"• RAM 4GB ขั้นต่ำ (แนะนำ 8GB)"}),e.jsx("li",{children:"• พื้นที่ว่าง 500MB"}),e.jsx("li",{children:"• การเชื่อมต่ออินเทอร์เน็ต"})]})]}),e.jsxs("div",{className:"space-y-3",children:[i?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:e.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-300",style:{width:`${r}%`}})}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:["กำลังดาวน์โหลด... ",r,"%"]})]}):e.jsxs(M,{onClick:p,className:"w-full btn-primary",size:"lg",children:[e.jsx(Rt,{className:"mr-2 h-5 w-5"}),"ดาวน์โหลดตัวติดตั้ง"]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"ดาวน์โหลดจาก: moradok.github.io/VaccineHomeBot"})]})]})})]}),e.jsxs(A,{className:"card-balanced",children:[e.jsx($,{children:e.jsxs(F,{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-6 w-6 text-medical-success"}),"วิธีการติดตั้ง"]})}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"ดาวน์โหลดไฟล์"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'คลิกปุ่ม "ดาวน์โหลดตัวติดตั้ง" ด้านซ้าย'})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"รันไฟล์ติดตั้ง"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เปิดไฟล์ .exe ที่ดาวน์โหลดมา"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"ทำตามขั้นตอน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ติดตั้งตามขั้นตอนที่แสดงบนหน้าจอ"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-medical-success text-white rounded-full flex items-center justify-center text-sm font-bold",children:"✓"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"เริ่มใช้งาน"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"เปิดแอปจาก Start Menu หรือ Desktop"})]})]})]}),e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ws,{className:"h-4 w-4 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"หมายเหตุด้านความปลอดภัย"}),e.jsx("p",{className:"text-xs text-amber-700",children:'Windows อาจแสดงคำเตือนเนื่องจากไฟล์ยังไม่ได้ลงนามดิจิทัล คลิก "More info" → "Run anyway" เพื่อติดตั้ง'})]})]})})]})})]})]}),t&&e.jsxs(A,{className:"card-balanced mt-8",children:[e.jsx($,{children:e.jsx(F,{children:"🆕 ฟีเจอร์ในเวอร์ชันนี้"})}),e.jsx(R,{children:e.jsx("ul",{className:"space-y-2",children:t.changelog.map((h,f)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-medical-success"}),e.jsx("span",{children:h})]},f))})})]}),e.jsxs(A,{className:"card-balanced mt-8",children:[e.jsx($,{children:e.jsx(F,{children:"🌐 ตัวเลือกอื่น"})}),e.jsx(R,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(en,{className:"h-5 w-5 text-primary"}),e.jsx("h4",{className:"font-semibold",children:"เว็บแอปพลิเคชัน"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"ใช้งานผ่านเว็บเบราว์เซอร์โดยไม่ต้องติดตั้ง"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>window.open("https://moradok.github.io/VaccineHomeBot/","_blank"),children:"เปิดเว็บแอป"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ns,{className:"h-5 w-5 text-medical-success"}),e.jsx("h4",{className:"font-semibold",children:"LINE Bot"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"ใช้งานผ่าน LINE สำหรับผู้ป่วย"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>window.open("https://line.me/R/ti/p/@vchome","_blank"),children:"เพิ่มเพื่อน LINE"})]})]})})]}),e.jsxs("div",{className:"text-center mt-8 p-6 bg-card rounded-lg border",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"ต้องการความช่วยเหลือ?"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"หากมีปัญหาในการติดตั้งหรือใช้งาน กรุณาติดต่อทีมสนับสนุน"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(M,{variant:"outline",onClick:()=>window.open("https://github.com/moradok/VaccineHomeBot/issues","_blank"),children:"รายงานปัญหา"}),e.jsx(M,{variant:"outline",onClick:()=>window.open("mailto:support@vchome.hospital","_blank"),children:"ติดต่อสนับสนุน"})]})]})]})]})})},mf=new xl,ba=window.location.protocol==="file:",di="./";console.log("[App] Protocol:",window.location.protocol);console.log("[App] Using",ba?"HashRouter":"BrowserRouter");console.log("[App] Basename:",di);const hf=()=>{const t=ba?Ki:Ji,s=ba?{}:{basename:di};return e.jsx(mu,{children:e.jsx(fl,{client:mf,children:e.jsxs(mo,{children:[e.jsx(wc,{}),e.jsx(Qc,{}),e.jsx(t,{...s,children:e.jsx("div",{className:"min-h-screen flex flex-col bg-background text-foreground",children:e.jsx("main",{className:"flex-1 scroll-area",children:e.jsxs(Xi,{children:[e.jsx(ye,{path:"/",element:e.jsx(En,{})}),e.jsx(ye,{path:"/home",element:e.jsx(En,{})}),e.jsx(ye,{path:"/loading",element:e.jsx(nf,{})}),e.jsx(ye,{path:"/auth",element:e.jsx(Tn,{})}),"            ",e.jsx(ye,{path:"/Auth",element:e.jsx(Tn,{})}),"            ",e.jsx(ye,{path:"/auth-simple",element:e.jsx(af,{})})," ",e.jsx(ye,{path:"/admin",element:e.jsx(Mu,{})}),e.jsx(ye,{path:"/staff-portal",element:e.jsx(kn,{})}),e.jsx(ye,{path:"/StaffPortal",element:e.jsx(kn,{})}),e.jsx(ye,{path:"/patient-portal",element:e.jsx(fn,{})}),e.jsx(ye,{path:"/PatientPortal",element:e.jsx(fn,{})}),e.jsx(ye,{path:"/liff-patient-portal",element:e.jsx(lf,{})}),e.jsx(ye,{path:"/vaccine-status",element:e.jsx(df,{})}),e.jsx(ye,{path:"/line-bot",element:e.jsx(xn,{})}),e.jsx(ye,{path:"/LineBot",element:e.jsx(xn,{})}),e.jsx(ye,{path:"/download",element:e.jsx(uf,{})}),e.jsx(ye,{path:"/fast",element:e.jsx(rf,{})}),e.jsx(ye,{path:"*",element:e.jsx(Ou,{})})]})})})})]})})})};lr(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(hf,{})}));
//# sourceMappingURL=main-DtAyUr-I.js.map
