# แก้ไขการแสดงโดสวัคซีนในตารางติดตามผู้ป่วย

## ปัญหาที่พบ

ในหน้า **การติดตามผู้ป่วย** (Patient Tracking) ของ VaccineScheduleCalculator มีการแสดงข้อมูลโดสวัคซีนที่สับสนและไม่ชัดเจน:

### ปัญหาเดิม:
- แสดง "ฉีดแล้ว 1 จาก 3 เข็ม" แต่ไม่ชัดว่าเข็มไหนที่ฉีดไปแล้ว
- แสดง "เข็มที่ 1" ในส่วน "เข็มล่าสุด" ทำให้สับสนว่าหมายถึงเข็มที่ฉีดไปแล้วหรือเข็มถัดไป
- ไม่มีข้อความยืนยันเมื่อฉีดครบตามตารางแล้ว

### ตัวอย่างที่ทำให้สับสน:
```
ความคืบหน้า: ฉีดแล้ว 1 จาก 3 เข็ม
โดสถัดไป: เข็มที่ 2

เข็มล่าสุด: 15 ม.ค. 2568
เข็มที่ 1  ← สับสน! นี่คือเข็มที่ฉีดไปแล้วหรือเข็มถัดไป?
```

## การแก้ไข

### 1. ปรับข้อความ "ความคืบหน้า" ให้ชัดเจน
**ก่อน:**
```tsx
{track.current_dose > 0 ? `ฉีดแล้ว ${track.current_dose} จาก ${track.total_doses} เข็ม` : 'ยังไม่เริ่มฉีด'}
```

**หลัง:**
```tsx
{track.current_dose > 0 ? `ฉีดแล้ว ${track.current_dose} เข็ม จาก ${track.total_doses} เข็ม` : 'ยังไม่เริ่มฉีด'}
```

### 2. เปลี่ยนคำว่า "โดสถัดไป" เป็น "เข็มถัดไป"
**ก่อน:**
```tsx
<p className="text-xs text-green-600">โดสถัดไป: เข็มที่ {track.current_dose + 1}</p>
```

**หลัง:**
```tsx
<p className="text-xs text-green-600">เข็มถัดไป: เข็มที่ {track.current_dose + 1}</p>
```

### 3. เพิ่มข้อความยืนยันเมื่อฉีดครบแล้ว
**เพิ่มใหม่:**
```tsx
{track.current_dose >= track.total_doses && (
  <p className="text-xs text-green-600">✓ ครบตามตารางแล้ว</p>
)}
```

### 4. ปรับข้อความ "เข็มล่าสุด" ให้ชัดเจน
**ก่อน:**
```tsx
<span className="text-muted-foreground">เข็มล่าสุด:</span>
...
<p className="text-xs text-muted-foreground">เข็มที่ {track.current_dose}</p>
```

**หลัง:**
```tsx
<span className="text-muted-foreground">เข็มล่าสุดที่ฉีด:</span>
...
<p className="text-xs text-muted-foreground">ฉีดเข็มที่ {track.current_dose} แล้ว</p>
```

## ผลลัพธ์หลังแก้ไข

### ตัวอย่างการแสดงผลใหม่:

#### กรณีฉีดไป 1 เข็ม จาก 3 เข็ม:
```
ความคืบหน้า: ฉีดแล้ว 1 เข็ม จาก 3 เข็ม
เข็มถัดไป: เข็มที่ 2

เข็มล่าสุดที่ฉีด: 15 ม.ค. 2568
ฉีดเข็มที่ 1 แล้ว  ← ชัดเจน! นี่คือเข็มที่ฉีดไปแล้ว

นัดครั้งถัดไป: 15 ก.พ. 2568
เข็มที่ 2 • อีก 30 วัน
```

#### กรณีฉีดครบ 3 เข็มแล้ว:
```
ความคืบหน้า: ฉีดแล้ว 3 เข็ม จาก 3 เข็ม
✓ ครบตามตารางแล้ว

เข็มล่าสุดที่ฉีด: 15 มี.ค. 2568
ฉีดเข็มที่ 3 แล้ว

นัดครั้งถัดไป: เสร็จสิ้น
ครบตามตาราง
```

#### กรณียังไม่เริ่มฉีด:
```
ความคืบหน้า: ยังไม่เริ่มฉีด

เข็มล่าสุดที่ฉีด: ยังไม่ได้ฉีด

นัดครั้งถัดไป: ต้องกำหนดนัด
เข็มที่ 1
```

## ไฟล์ที่แก้ไข

- `src/components/VaccineScheduleCalculator.tsx` (บรรทัด 803-823)

## การทดสอบ

1. เปิดหน้า Staff Portal → ตั้งค่า → ตารางวัคซีน
2. ไปที่แท็บ "ติดตามผู้ป่วย"
3. ตรวจสอบว่าข้อความแสดงชัดเจนและไม่สับสน:
   - ✅ "ฉีดแล้ว X เข็ม จาก Y เข็ม"
   - ✅ "เข็มถัดไป: เข็มที่ Z"
   - ✅ "ฉีดเข็มที่ X แล้ว"
   - ✅ "✓ ครบตามตารางแล้ว" (เมื่อฉีดครบ)

## ประโยชน์

- ✅ ลดความสับสนในการอ่านข้อมูล
- ✅ เข้าใจได้ง่ายว่าฉีดไปกี่เข็มแล้ว
- ✅ รู้ชัดเจนว่าเข็มถัดไปคือเข็มที่เท่าไหร่
- ✅ มีการยืนยันเมื่อฉีดครบตามตารางแล้ว
- ✅ ใช้คำศัพท์ที่สอดคล้องกันทั้งระบบ

## หมายเหตุ

การแก้ไขนี้เป็นการปรับปรุง UI/UX เท่านั้น ไม่มีผลต่อ:
- การคำนวนวันที่นัด
- การบันทึกข้อมูลในฐานข้อมูล
- ตรรกะการทำงานของระบบ
